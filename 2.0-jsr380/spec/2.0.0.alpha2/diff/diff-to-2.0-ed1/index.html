
<!-- saved from url=(0036)http://63.249.66.211/comparison.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ChangeDetection - Comparison of: Bean Validation specification</title>
<!-- ChangeDetection CSS/JAVASCRIPT -->
<style type="text/css">

A.cdopcbacklnks:link, A.cdopcbacklnks:visited {
	color: #000099;
	text-decoration: none;
}
A.cdopcbacklnks:hover {
	text-decoration: underline;
}

A.cdopchomelnks:link, A.cdopchomelnks:visited {
	color: #000099;
	text-decoration: none;
}
A.cdopchomelnks:hover {
	text-decoration: underline;
}

A.cdopchelplnks:link, A.cdopchelplnks:visited {
	color: #000099;
	text-decoration: none;
}
A.cdopchelplnks:hover {
	text-decoration: underline;
}

A.cdopccmplnks:link {
	text-decoration: underline;
	color: blue;
}
A.cdopccmplnks:visited {
	text-decoration: underline;
	color: purple;
}
A.cdopccmplnks:hover {
	text-decoration: underline;
	color: blue;
}
</style>

<script language="JavaScript" type="text/javascript"><!--

//  --------  Generic javascript  --------


function cdopcGetElementByID(whichid)
{
	var e = null;
	if (document.getElementById)
	{
		// this is the way the standards work
		e = document.getElementById(whichid);
	}
	else if (document.all)
	{
		// this is the way old msie versions work
		e = document.all[whichid];
	}
	else if (document.layers)
	{
		// this is the way nn4 works
		e = document.layers[whichid];
	}
	return e;
}

function cdopcGetStyleByID(whichid)
{
	var e = cdopcGetElementByID(whichid);
	if(e == null) {
		return null;
	}
	var s = e.style;
	return s;
}


function cdopcSubmitForm(formName)
{

	var form = document.forms[formName];
	if( form == null) 
	{
		return;
	}
	//var op = cdopcGetElementByID( 'cdopcop');
	//op.name = 'op';
	form.submit();
}

function cdopcDoOnLoad()
{
	var cdopccpm = cdopcGetElementByID('cdopccpm').value;
	cdopcGetElementByID('ctlte').style.fontStyle = cdopccpm == 'textextract' ? 'italic' : 'normal';
	cdopcGetElementByID('ctlft').style.fontStyle = cdopccpm == 'fulltext' ? 'italic' : 'normal';
	cdopcGetElementByID('ctlh').style.fontStyle = cdopccpm == 'html' ? 'italic' : 'normal';
	cdopcSetTextExtractVisibilities(cdopcGetElementByID('cdopcteopta').value, cdopcGetElementByID('cdopcteoptb').value);
}

function cdopcDoTextExtracts()
{
	cdopcGetElementByID('cdopccpm').value = 'textextract';
	cdopcSubmitForm('cdopcmainform');
}

function cdopcDoFullText()
{
	cdopcGetElementByID('cdopccpm').value = 'fulltext';
	cdopcSubmitForm('cdopcmainform');
}

function cdopcDoHTML()
{
	cdopcGetElementByID('cdopccpm').value = 'html';
	cdopcSubmitForm('cdopcmainform');
}


// cdopcteopta: 0 = added and deleted, 1 = added only, 2 = deleted only
// cdopcteoptb: 0 = show extracts, 1 = hide extracts
// new version with "diff-cont" spans
function cdopcSetTextExtractVisibilities(cdopcteopta, cdopcteoptb)
{
	var spans = document.getElementsByTagName('span');
	if(spans == null) {
		return;
	}
	var bShowAll = cdopcteopta == 0 && cdopcteoptb == 0;
	var bEllipsis = false;
	for(var n = 0; n < spans.length; n++)
	{
		var e = spans[n];
		if(e.className == 'rcl-dd')
		{
			if(cdopcteopta == 1) {
				e.style.display = 'none';
			} else {
				e.style.display = '';
				bEllipsis = false;
			}
		}
		else if(e.className == 'rcl-de') 
		{
			if(cdopcteoptb == 0) {
				e.style.display = '';
				bEllipsis = false;
			} else {
				e.style.display = 'none';
			}
		} 
		else if(e.className == 'rcl-da') 
		{
			if(cdopcteopta == 2) {
				e.style.display = 'none';
			} else {
				e.style.display = '';
				bEllipsis = false;
			}
		}
		else if(e.className == 'rcl-dde')
		{
			e.style.display = bEllipsis ? 'none' : '';
			bEllipsis = true;
		}
		else if(e.className == 'rcl-dee')
		{
			e.style.display = bEllipsis ? 'none' : '';
			bEllipsis = true;
		}
		else if(e.className == 'rcl-dae')
		{
			e.style.display = bEllipsis ? 'none' : '';
			bEllipsis = true;
		}
		else if(e.className == 'rcl-ddef')
		{
			if(bShowAll) {
				e.style.display = 'none';
			} else {
				e.style.display = bEllipsis ? 'none' : '';
				bEllipsis = true;
			}
		}
		else if(e.className == 'rcl-deef')
		{
			if(bShowAll) {
				e.style.display = 'none';
			} else {
				e.style.display = bEllipsis ? 'none' : '';
				bEllipsis = true;
			}
		}
		else if(e.className == 'rcl-daef')
		{
			if(bShowAll) {
				e.style.display = 'none';
			} else {
				e.style.display = bEllipsis ? 'none' : '';
				bEllipsis = true;
			}
		}
	}

// cdopcteopta: 0 = added and deleted, 1 = added only, 2 = deleted only
// cdopcteoptb: 0 = show extracts, 1 = hide extracts
	cdopcGetElementByID('ctladdedanddeleted').style.fontStyle = cdopcteopta == 0 ? 'italic' : 'normal';
	cdopcGetElementByID('ctlonlyadded').style.fontStyle = cdopcteopta == 1 ? 'italic' : 'normal';
	cdopcGetElementByID('ctlonlydeleted').style.fontStyle = cdopcteopta == 2 ? 'italic' : 'normal';
	if ( cdopcGetElementByID('cdopccpm').value.indexOf('html') != 0 )
	{
		cdopcGetElementByID('ctlshowextracts').style.fontStyle = cdopcteoptb == 0 ? 'italic' : 'normal';
		cdopcGetElementByID('ctlhideextracts').style.fontStyle = cdopcteoptb != 0 ? 'italic' : 'normal';
	}
}



function cdopcShowAddedAndDeleted()
{
	cdopcGetElementByID('cdopcteopta').value = 0;
	cdopcSetTextExtractVisibilities(0, cdopcGetElementByID('cdopcteoptb').value);
}
	
function cdopcShowOnlyAdded()
{
	cdopcGetElementByID('cdopcteopta').value = 1;
	cdopcSetTextExtractVisibilities(1, cdopcGetElementByID('cdopcteoptb').value);
}
	
function cdopcShowOnlyDeleted()
{
	cdopcGetElementByID('cdopcteopta').value = 2;
	cdopcSetTextExtractVisibilities(2, cdopcGetElementByID('cdopcteoptb').value);
}
	
function cdopcShowExtracts()
{
	cdopcGetElementByID('cdopcteoptb').value = 0;
	cdopcSetTextExtractVisibilities(cdopcGetElementByID('cdopcteopta').value, 0);
}
	
function cdopchideExtracts()
{
	cdopcGetElementByID('cdopcteoptb').value = 1;
	cdopcSetTextExtractVisibilities(cdopcGetElementByID('cdopcteopta').value, 1);
}
--></script>

<style type="text/css"><!--

.rcl-da
{
	background-color: FFFF99;
}
.rcl-dae
{
	background-color: FFFF99;
}
.rcl-daef
{
	background-color: FFFF99;
}
.rcl-dd
{
	text-decoration: line-through;
}
.rcl-dde
{
	text-decoration: line-through;
}
.rcl-ddef
{
	text-decoration: line-through;
}
.rcl-de
{
}
.rcl-dee
{
}
.rcl-deef
{
}

					
#textdiffbox {
	margin-top:12;
	width:95%;
	background-color:#F9F9F9;
	border-width: 1;
	border-style: solid;
	border-color: black;
	padding-top:6;
	padding-bottom:6;
	font-size: 10.0pt;
	font-family: Verdana, sans-serif;
	font-style: normal;
}

.content
{
    margin-left: 6px;
    margin-right: 6px;
}

.pg1opt1, .pg2opt1, .pg3opt1, .pg4opt2
{
    display: block;
}

.pg1opt2, .pg1opt3, .pg2opt2, .pg2opt3, .pg3opt2, .pg3opt3, .pg3opt4, .pg4opt1
{
    display: none;
}

.reqnote
{
	color: maroon;
/*	font-style: super;	*/
}

.cdopcinfomsg
{
	margin-top:12;
	width:80%;
	background-color:#FFFFE0;
	border-width: 1;
	border-style: solid;
	border-color: blue;
	padding-top:6;
	padding-bottom:6;
	font-size: 10pt;
}

--></style>
</head>
<body onload="cdopcDoOnLoad();" style="margin-top:0px;margin-left:0px;margin-right:0px;" class="article toc2 toc-left">


<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Gunnar Morling">


<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style><style type="text/css">
.diff-add
{
	background-color: yellow;
}
.diff-del
{
	text-decoration: line-through;
}
</style>

<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>





<!-- place to put text extracts -->


<!--  START OF DIFF PAGE DATA till end (for HTML compares) -->


<div id="header">
<h1>Bean Validation specification</h1>
<div class="details">
<span id="author" class="author">Gunnar Morling</span><br>
<span id="revnumber">version 2.0.0.Alpha<a name="cdfirstchange"></a><span class="rcl-da">2</span><span class="rcl-dd">1 </span> <span class="rcl-dd">(Early Draft 1)</span>,</span>
<span id="revdate"><span class="rcl-da">2017-03-28</span><span class="rcl-dd">2017-02-02 </span></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_evaluation_license">Evaluation license</a></li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#introduction-expertgroup">1.1. Expert group</a></li>
<li><a href="#introduction-goals">1.2. Specification goals</a></li>
<li><a href="#introduction-requirements">1.3. Required Java version</a></li>
<li><a href="#introduction-documentorganization">1.4. How this document is organized</a></li>
<li><a href="#introduction-commentingprocess">1.5. How to comment</a></li>
</ul>
</li>
<li><a href="#whatsnew">2. What’s new</a>
<ul class="sectlevel2">
<li><a href="#whatsnew-20">2.1. What’s new in 2.0</a></li>
<li><a href="#whatsnew-11">2.2. What’s new in 1.1</a>
<ul class="sectlevel3">
<li><a href="#whatsnew-11-openness"><span class="rcl-da">2.2.1</span><span class="rcl-da">.</span> <span class="rcl-da">Openness</span></a></li>
<li><a href="#whatsnew-11-cdi"><span class="rcl-da">2.2.2</span><span class="rcl-da">.</span> <span class="rcl-da">Dependency</span> <span class="rcl-da">injection</span></a></li>
<li><a href="#whatsnew-11-methodvalidation"><span class="rcl-da">2.2.3</span><span class="rcl-da">.</span> <span class="rcl-da">Method</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#whatsnew-11-contextcdi"><span class="rcl-da">2.2.4</span><span class="rcl-da">.</span> <span class="rcl-da">Integration</span> <span class="rcl-da">with</span> <span class="rcl-da">Context</span> <span class="rcl-da">and</span> <span class="rcl-da">Dependency</span> <span class="rcl-da">Injection</span></a></li>
<li><a href="#whatsnew-11-groupconversion"><span class="rcl-da">2.2.5</span><span class="rcl-da">.</span> <span class="rcl-da">Group</span> <span class="rcl-da">conversion</span></a></li>
<li><a href="#whatsnew-11-expressionlanguage"><span class="rcl-da">2.2.6</span><span class="rcl-da">.</span> <span class="rcl-da">Message</span> <span class="rcl-da">interpolation</span> <span class="rcl-da">via</span> <span class="rcl-da">the</span> <span class="rcl-da">unified</span> <span class="rcl-da">expression</span> <span class="rcl-da">language</span></a></li>
<li><a href="#whatsnew-11-others"><span class="rcl-da">2.2.7</span><span class="rcl-da">.</span> <span class="rcl-da">Others</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#constraintsdefinitionimplementation">3. Constraint Definition</a>
<ul class="sectlevel2">
<li><a href="#constraintsdefinitionimplementation-constraintdefinition">3.1. Constraint annotation</a>
<ul class="sectlevel3">
<li><a href="#constraintsdefinitionimplementation-constraintdefinition-properties"><span class="rcl-da">3.1.1</span><span class="rcl-da">.</span> <span class="rcl-da">Constraint</span> <span class="rcl-da">definition</span> <span class="rcl-da">properties</span></a></li>
<li><a href="#constraintsdefinitionimplementation-constraintdefinition-examples"><span class="rcl-da">3.1.2</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
</ul>
</li>
<li><a href="#constraintsdefinitionimplementation-multipleconstraints">3.2. Applying multiple constraints of the same type</a></li>
<li><a href="#constraintsdefinitionimplementation-constraintcomposition">3.3. Constraint composition</a></li>
<li><a href="#constraintsdefinitionimplementation-validationimplementation">3.4. Constraint validation implementation</a>
<ul class="sectlevel3">
<li><a href="#constraintsdefinitionimplementation-validationimplementation-temporalvalidators"><span class="rcl-da">3.4.1</span><span class="rcl-da">.</span> <span class="rcl-da">Implementation</span> <span class="rcl-da">of</span> <span class="rcl-da">temporal</span> <span class="rcl-da">constraint</span> <span class="rcl-da">validators</span></a></li>
<li><a href="#constraintsdefinitionimplementation-validationimplementation-example"><span class="rcl-da">3.4.2</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
</ul>
</li>
<li><a href="#constraintsdefinitionimplementation-constraintfactory">3.5. The ConstraintValidatorFactory</a></li>
</ul>
</li>
<li><a href="#constraintdeclarationvalidationprocess">4. Constraint declaration and validation process</a>
<ul class="sectlevel2">
<li><a href="#constraintdeclarationvalidationprocess-requirements">4.1. Requirements on classes to be validated</a>
<ul class="sectlevel3">
<li><a href="#constraintdeclarationvalidationprocess-requirements-objectvalidation"><span class="rcl-da">4.1.1</span><span class="rcl-da">.</span> <span class="rcl-da">Object</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-requirements-propertyvalidation"><span class="rcl-da">4.1.2</span><span class="rcl-da">.</span> <span class="rcl-da">Field</span> <span class="rcl-da">and</span> <span class="rcl-da">property</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-requirements-graphvalidation"><span class="rcl-da">4.1.3</span><span class="rcl-da">.</span> <span class="rcl-da">Graph</span> <span class="rcl-da">validation</span></a></li>
</ul>
</li>
<li><a href="#constraintdeclarationvalidationprocess-constraintdeclaration">4.2. Constraint declaration</a></li>
<li><a href="#constraintdeclarationvalidationprocess-inheritance">4.3. Inheritance (interface and superclass)</a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence">4.4. Group and group sequence</a>
<ul class="sectlevel3">
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-groupinheritance"><span class="rcl-da">4.4.1</span><span class="rcl-da">.</span> <span class="rcl-da">Group</span> <span class="rcl-da">inheritance</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-groupsequence"><span class="rcl-da">4.4.2</span><span class="rcl-da">.</span> <span class="rcl-da">Group</span> <span class="rcl-da">sequence</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-redefiningdefaultgroup"><span class="rcl-da">4.4.3</span><span class="rcl-da">.</span> <span class="rcl-da">Redefining</span> <span class="rcl-da">the</span> <span class="rcl-da">Default</span> <span class="rcl-da">group</span> <span class="rcl-da">for</span> <span class="rcl-da">a</span> <span class="rcl-da">class</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-implicitgrouping"><span class="rcl-da">4.4.4</span><span class="rcl-da">.</span> <span class="rcl-da">Implicit</span> <span class="rcl-da">grouping</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion"><span class="rcl-da">4.4.5</span><span class="rcl-da">.</span> <span class="rcl-da">Group</span> <span class="rcl-da">conversion</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition"><span class="rcl-da">4.4.6</span><span class="rcl-da">.</span> <span class="rcl-da">Formal</span> <span class="rcl-da">group</span> <span class="rcl-da">definitions</span></a></li>
</ul>
</li>
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints">4.5. Method and constructor constraints</a>
<ul class="sectlevel3">
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-requirements"><span class="rcl-da">4.5.1</span><span class="rcl-da">.</span> <span class="rcl-da">Requirements</span> <span class="rcl-da">on</span> <span class="rcl-da">methods</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">validated</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints"><span class="rcl-da">4.5.2</span><span class="rcl-da">.</span> <span class="rcl-da">Declaring</span> <span class="rcl-da">parameter</span> <span class="rcl-da">constraints</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-returnvalueconstraints"><span class="rcl-da">4.5.3</span><span class="rcl-da">.</span> <span class="rcl-da">Declaring</span> <span class="rcl-da">return</span> <span class="rcl-da">value</span> <span class="rcl-da">constraints</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-cascadedvalidation"><span class="rcl-da">4.5.4</span><span class="rcl-da">.</span> <span class="rcl-da">Marking</span> <span class="rcl-da">parameters</span> <span class="rcl-da">and</span> <span class="rcl-da">return</span> <span class="rcl-da">values</span> <span class="rcl-da">for</span> <span class="rcl-da">cascaded</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance"><span class="rcl-da">4.5.5</span><span class="rcl-da">.</span> <span class="rcl-da">Method</span> <span class="rcl-da">constraints</span> <span class="rcl-da">in</span> <span class="rcl-da">inheritance</span> <span class="rcl-da">hierarchies</span></a></li>
</ul>
</li>
<li><a href="#constraintdeclarationvalidationprocess-validationroutine">4.6. Validation routine</a>
<ul class="sectlevel3">
<li><a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation"><span class="rcl-da">4.6.1</span><span class="rcl-da">.</span> <span class="rcl-da">Object</span> <span class="rcl-da">graph</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-validationroutine-methodconstructorvalidation"><span class="rcl-da">4.6.2</span><span class="rcl-da">.</span> <span class="rcl-da">Method</span> <span class="rcl-da">and</span> <span class="rcl-da">constructor</span> <span class="rcl-da">validation</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-validationroutine-traversable"><span class="rcl-da">4.6.3</span><span class="rcl-da">.</span> <span class="rcl-da">Traversable</span> <span class="rcl-da">property</span></a></li>
<li><a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution"><span class="rcl-da">4.6.4</span><span class="rcl-da">.</span> <span class="rcl-da">ConstraintValidator</span> <span class="rcl-da">resolution</span> <span class="rcl-da">algorithm</span></a></li>
</ul>
</li>
<li><a href="#constraintdeclarationvalidationprocess-validationroutine-examples">4.7. Examples</a></li>
</ul>
</li>
<li><a href="#validationapi">5. Validation APIs</a>
<ul class="sectlevel2">
<li><a href="#validationapi-validatorapi">5.1. Validator API</a>
<ul class="sectlevel3">
<li><a href="#validationapi-validatorapi-validationmethods"><span class="rcl-da">5.1.1</span><span class="rcl-da">.</span> <span class="rcl-da">Validation</span> <span class="rcl-da">methods</span></a></li>
<li><a href="#validationapi-validatorapi-methodlevelvalidationmethods"><span class="rcl-da">5.1.2</span><span class="rcl-da">.</span> <span class="rcl-da">Methods</span> <span class="rcl-da">for</span> <span class="rcl-da">validating</span> <span class="rcl-da">method</span> <span class="rcl-da">and</span> <span class="rcl-da">constructor</span> <span class="rcl-da">constraints</span></a></li>
<li><a href="#validationapi-validatorapi-groups"><span class="rcl-da">5.1.3</span><span class="rcl-da">.</span> <span class="rcl-da">groups</span></a></li>
</ul>
</li>
<li><a href="#validationapi-constraintviolation">5.2. ConstraintViolation</a>
<ul class="sectlevel3">
<li><a href="#validationapi-constraintviolation-examples"><span class="rcl-da">5.2.1</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
<li><a href="#validationapi-constraintviolation-examplesexecutables"><span class="rcl-da">5.2.2</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span> <span class="rcl-da">for</span> <span class="rcl-da">method</span> <span class="rcl-da">and</span> <span class="rcl-da">constructor</span> <span class="rcl-da">constraint</span> <span class="rcl-da">violations</span></a></li>
</ul>
</li>
<li><a href="#validationapi-message">5.3. Message interpolation</a>
<ul class="sectlevel3">
<li><a href="#validationapi-message-defaultmessageinterpolation"><span class="rcl-da">5.3.1</span><span class="rcl-da">.</span> <span class="rcl-da">Default</span> <span class="rcl-da">message</span> <span class="rcl-da">interpolation</span></a></li>
<li><a href="#validationapi-message-customresolution"><span class="rcl-da">5.3.2</span><span class="rcl-da">.</span> <span class="rcl-da">Custom</span> <span class="rcl-da">message</span> <span class="rcl-da">interpolation</span></a></li>
<li><a href="#validationapi-message-examples"><span class="rcl-da">5.3.3</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
</ul>
</li>
<li><a href="#validationapi-triggeringmethodvalidation">5.4. Triggering method validation</a></li>
<li><a href="#validationapi-bootstrapping">5.5. Bootstrapping</a>
<ul class="sectlevel3">
<li><a href="#validationapi-bootstrapping-examples"><span class="rcl-da">5.5.1</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
<li><a href="#validationapi-bootstrapping-validatorfactory"><span class="rcl-da">5.5.2</span><span class="rcl-da">.</span> <span class="rcl-da">ValidatorFactory</span></a></li>
<li><a href="#validationapi-bootstrapping-configuration"><span class="rcl-da">5.5.3</span><span class="rcl-da">.</span> <span class="rcl-da">Configuration</span></a></li>
<li><a href="#validationapi-bootstrapping-validationprovider"><span class="rcl-da">5.5.4</span><span class="rcl-da">.</span> <span class="rcl-da">ValidationProvider</span> <span class="rcl-da">and</span> <span class="rcl-da">ValidationProviderResolver</span></a></li>
<li><a href="#validationapi-bootstrapping-validation"><span class="rcl-da">5.5.5</span><span class="rcl-da">.</span> <span class="rcl-da">Validation</span></a></li>
<li><a href="#validationapi-bootstrapping-xmlconfiguration"><span class="rcl-da">5.5.6</span><span class="rcl-da">.</span> <span class="rcl-da">XML</span> <span class="rcl-da">configuration</span><span class="rcl-da">:</span> <span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span></a></li>
<li><a href="#validationapi-bootstrapping-usageandcontainerexpectation"><span class="rcl-da">5.5.7</span><span class="rcl-da">.</span> <span class="rcl-da">Bootstrapping</span> <span class="rcl-da">considerations</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#constraintmetadata">6. Constraint metadata request APIs</a>
<ul class="sectlevel2">
<li><a href="#constraintmetadata-validator">6.1. Validator</a></li>
<li><a href="#constraintmetadata-elementdescriptor">6.2. ElementDescriptor</a></li>
<li><a href="#constraintmetadata-beandescriptor">6.3. BeanDescriptor</a></li>
<li><a href="#constraintmetadata-cascadabledescriptor">6.4. CascadableDescriptor</a></li>
<li><a href="#constraintmetadata-groupconversiondescriptor">6.5. GroupConversionDescriptor</a></li>
<li><a href="#constraintmetadata-propertydescriptor">6.6. PropertyDescriptor</a></li>
<li><a href="#constraintmetadata-executabledescriptor">6.7. ExecutableDescriptor, MethodDescriptor and ConstructorDescriptor</a></li>
<li><a href="#constraintmetadata-parameterdescriptor">6.8. ParameterDescriptor</a></li>
<li><a href="#constraintmetadata-crossparameterdescriptor">6.9. CrossParameterDescriptor</a></li>
<li><a href="#constraintmetadata-returnvaluedescriptor">6.10. ReturnValueDescriptor</a></li>
<li><a href="#constraintmetadata-constraintdescriptor">6.11. ConstraintDescriptor</a></li>
<li><a href="#constraintmetadata-example">6.12. Example</a></li>
</ul>
</li>
<li><a href="#builtinconstraints">7. Built-in Constraint definitions</a></li>
<li><a href="#xml">8. XML deployment descriptor</a>
<ul class="sectlevel2">
<li><a href="#xml-mapping">8.1. Constraint definition and declaration</a>
<ul class="sectlevel3">
<li><a href="#xml-mapping-constraintdeclarationinxml"><span class="rcl-da">8.1.1</span><span class="rcl-da">.</span> <span class="rcl-da">Constraint</span> <span class="rcl-da">declaration</span> <span class="rcl-da">in</span> <span class="rcl-da">XML</span></a></li>
<li><a href="#xml-mapping-constraintdefinition"><span class="rcl-da">8.1.2</span><span class="rcl-da">.</span> <span class="rcl-da">Overriding</span> <span class="rcl-da">constraint</span> <span class="rcl-da">definitions</span> <span class="rcl-da">in</span> <span class="rcl-da">XML</span></a></li>
<li><a href="#xml-mapping-typeconversion"><span class="rcl-da">8.1.3</span><span class="rcl-da">.</span> <span class="rcl-da">Converting</span> <span class="rcl-da">the</span> <span class="rcl-da">string</span> <span class="rcl-da">representation</span> <span class="rcl-da">of</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span></a></li>
<li><a href="#xml-mapping-xsd"><span class="rcl-da">8.1.4</span><span class="rcl-da">.</span> <span class="rcl-da">XML</span> <span class="rcl-da">Schema</span></a></li>
</ul>
</li>
<li><a href="#xml-config-xsd">8.2. Configuration schema</a></li>
</ul>
</li>
<li><a href="#exception">9. Exception model</a>
<ul class="sectlevel2">
<li><a href="#exception-errorreport">9.1. Error report: <code class="classname">ConstraintViolationException</code></a></li>
<li><a href="#exception-constraintdefinition">9.2. Constraint definition: <code class="classname">ConstraintDefinitionException</code></a></li>
<li><a href="#exception-constraintdeclaration">9.3. Constraint declaration: <code class="classname">ConstraintDeclarationException</code> and <code class="classname">UnexpectedTypeException</code></a></li>
<li><a href="#exception-groupdefinition">9.4. Group definition: <code class="classname">GroupDefinitionException</code></a></li>
<li><a href="#exception-noprovider"><span class="rcl-da">9.5</span><span class="rcl-da">.</span> <span class="rcl-da">No</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">Provider</span> <span class="rcl-da">detected</span><span class="rcl-da">:</span> <code><span class="rcl-da">NoProviderFoundException</span></code></a></li>
</ul>
</li>
<li><a href="#integration">10. Integration</a>
<ul class="sectlevel2">
<li><a href="#integration-general">10.1. General requirements</a>
<ul class="sectlevel3">
<li><a href="#integration-general-objectslifecycle"><span class="rcl-da">10.1.1</span><span class="rcl-da">.</span> <span class="rcl-da">Objects</span> <span class="rcl-da">lifecycle</span></a></li>
<li><a href="#integration-general-executable"><span class="rcl-da">10.1.2</span><span class="rcl-da">.</span> <span class="rcl-da">Method</span> <span class="rcl-da">and</span> <span class="rcl-da">constructor</span> <span class="rcl-da">validation</span></a></li>
</ul>
</li>
<li><a href="#integration-javaee">10.2. Java EE</a></li>
<li><a href="#integration-cdi">10.3. Context and Dependency Injection (CDI) integration</a>
<ul class="sectlevel3">
<li><a href="#integration-cdi-validatorfactory"><span class="rcl-da">10.3.1</span><span class="rcl-dd">10.4</span>.<span class="rcl-dd">Java </span><span class="rcl-dd">Persistence </span><span class="rcl-dd">2.0 </span><span class="rcl-dd">integration </span> <code class="classname"><span class="rcl-da">ValidatorFactory</span></code> <span class="rcl-da">and</span> <code class="classname"><span class="rcl-da">Validator</span></code></a></li>
<li><a href="#integration-cdi-customconfiguration"><span class="rcl-da">10.3.2</span><span class="rcl-dd">10.5</span>.<span class="rcl-dd">Java </span><span class="rcl-dd">Server </span><span class="rcl-dd">Faces </span><span class="rcl-dd">2.0 </span><span class="rcl-dd">integration </span> <code class="classname"><span class="rcl-da">ConstraintValidatorFactory</span></code><span class="rcl-da">,</span> <code class="classname"><span class="rcl-da">MessageInterpolator</span></code><span class="rcl-da">,</span> <code class="classname"><span class="rcl-da">ParameterNameProvider</span></code><span class="rcl-da">,</span> <code class="classname"><span class="rcl-da">ClockProvider</span></code> <span class="rcl-da">and</span> <code class="classname"><span class="rcl-da">TraversableResolver</span></code></a></li>
<li><a href="#integration-cdi-methodconstructorvalidation"><span class="rcl-da">10.3.3</span><span class="rcl-dd">10.6</span>. <span class="rcl-da">Method</span> <span class="rcl-da">and</span> <span class="rcl-da">constructor</span> <span class="rcl-da">validation</span><span class="rcl-dd">JAX-RS </span><span class="rcl-dd">2 </span><span class="rcl-dd">integration </span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#terminology">Appendix A: Terminology</a></li>
<li><a href="#appendix-value-extraction">Appendix B: Value extraction for cascaded validation and type argument constraints (BVAL-508)</a>
<ul class="sectlevel2">
<li><a href="#_motivation">B.1. Motivation</a></li>
<li><a href="#_requirements">B.2. Requirements</a></li>
<li><a href="#_non_requirements">B.3. Non-requirements</a></li>
<li><a href="#_solution">B.4. Solution</a>
<ul class="sectlevel3">
<li><a href="#__extractedvalue">B.<span class="rcl-da">4.1</span><span class="rcl-da">.</span> <span class="rcl-da">@</span><span class="rcl-da">ExtractedValue</span></a></li>
<li><a href="#_extensions_to_code_node_code"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.2</span><span class="rcl-da">.</span> <span class="rcl-da">Extensions</span> <span class="rcl-da">to</span> <code><span class="rcl-da">Node</span></code></a></li>
<li><a href="#_default_extractors"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.3</span><span class="rcl-da">.</span> <span class="rcl-da">Default</span> <span class="rcl-da">extractors</span></a></li>
<li><a href="#_plugging_in_custom_extractors"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.4</span><span class="rcl-da">.</span> <span class="rcl-da">Plugging</span> <span class="rcl-da">in</span> <span class="rcl-da">custom</span> <span class="rcl-da">extractors</span></a></li>
<li><a href="#appendix-valueextraction-wrappedelements"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.5</span><span class="rcl-da">.</span> <span class="rcl-da">Applying</span> <span class="rcl-da">element-level</span> <span class="rcl-da">constraints</span> <span class="rcl-da">to</span> <span class="rcl-da">wrapped</span> <span class="rcl-da">elements</span></a></li>
<li><a href="#appendix-valueextraction-extractorretrieval"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.6</span><span class="rcl-da">.</span> <span class="rcl-da">Retrieval</span> <span class="rcl-da">of</span> <span class="rcl-da">extractors</span></a></li>
<li><a href="#_examples_2"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.7</span><span class="rcl-da">.</span> <span class="rcl-da">Examples</span></a></li>
<li><a href="#_xml_based_configuration"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.8</span><span class="rcl-da">.</span> <span class="rcl-da">XML</span> <span class="rcl-da">based</span> <span class="rcl-da">configuration</span></a></li>
<li><a href="#_metadata_retrieval"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.9</span><span class="rcl-da">.</span> <span class="rcl-da">Metadata</span> <span class="rcl-da">retrieval</span></a></li>
<li><a href="#_misc"><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.10</span><span class="rcl-da">.</span> <span class="rcl-da">Misc</span><span class="rcl-da">.</span></a></li>
</ul>
</li>
<li><a href="#_extensions_to_the_exception_model"><span class="rcl-da">B</span><span class="rcl-da">.</span>5. Extensions to the exception model</a></li>
<li><a href="#_open_questions">B.6. Open questions</a></li>
</ul>
</li>
<li><a href="#standard-resolver-messages">Appendix C: Standard ResourceBundle messages</a></li>
<li><a href="#appendix-jpa">Appendix D: Java Persistence 2.0 and schema generation</a></li>
<li><a href="#changelog">Appendix E: Changelog</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_evaluation_license"><a class="anchor" href="#_evaluation_license"></a>Evaluation license</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright 2007-2017 Red Hat, Inc.</p>
</div>
<div class="paragraph">
<p>All rights reserved.</p>
</div>
<div class="paragraph">
<p>NOTICE</p>
</div>
<div class="paragraph">
<p>The Specification is protected by copyright and the information described therein may be protected by one or more U.S. patents, foreign patents, or pending applications. Except as provided under the following license, no part of the Specification may be reproduced in any form by any means without the prior written authorization of Red Hat Inc. and its licensors, if any. Any use of the Specification and the information described therein will be governed by the terms and conditions of this Agreement.</p>
</div>
<div class="paragraph">
<p>Subject to the terms and conditions of this license, including your compliance with Paragraphs 1 and 2 below, Red Hat Inc. hereby grants you a fully-paid, non-exclusive, non-transferable, limited license (without the right to sublicense) under Red Hat Inc.'s intellectual property rights to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Review the Specification for the purposes of evaluation. This includes: (i) developing implementations of the Specification for your internal, non-commercial use; (ii) discussing the Specification with any third party; and (iii) excerpting brief portions of the Specification in oral or written communications which discuss the Specification provided that such excerpts do not in the aggregate constitute a significant portion of the Specification.</p>
</li>
<li>
<p>Distribute implementations of the Specification to third parties for their testing and evaluation use, provided that any such implementation:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>(i) does not modify, subset, superset or otherwise extend the Licensor Name Space, or include any public or protected packages, classes, Java interfaces, fields or methods within the Licensor Name Space other than those required/authorized by the Specification or Specifications being implemented;</p>
</div>
<div class="paragraph">
<p>(ii) is clearly and prominently marked with the word "UNTESTED" or "EARLY ACCESS" or "INCOMPATIBLE" or "UNSTABLE" or "BETA" in any list of available builds and in proximity to every link initiating its download, where the list or link is under Licensee’s control; and</p>
</div>
<div class="paragraph">
<p>(iii) includes the following notice:</p>
</div>
<div class="paragraph">
<p>"This is an implementation of an early-draft specification developed under the Java Community Process (JCP). The code is not compatible with any specification of the JCP."</p>
</div>
<div class="paragraph">
<p>The grant set forth above concerning your distribution of implementations of the Specification is contingent upon your agreement to terminate development and distribution of your implementation of early draft upon final completion of the Specification. If you fail to do so, the foregoing grant shall be considered null and void.</p>
</div>
<div class="paragraph">
<p>No provision of this Agreement shall be understood to restrict your ability to make and distribute to third parties applications written to the Specification.</p>
</div>
<div class="paragraph">
<p>Other than this limited license, you acquire no right, para or interest in or to the Specification or any other Red Hat Inc. intellectual property, and the Specification may only be used in accordance with the license terms set forth herein. This license will expire on the earlier of: (a) two (2) years from the date of Release listed above; (b) the date on which the final version of the Specification is publicly released; or (c) the date on which the Java Specification Request (JSR) to which the Specification corresponds is withdrawn. In addition, this license will terminate immediately without notice from Red Hat Inc. if you fail to comply with any provision of this license. Upon termination, you must cease use of or destroy the Specification.</p>
</div>
<div class="paragraph">
<p>"Licensor Name Space" means the public class or interface declarations whose names begin with "java", "javax", "com.redhat", "com.jboss", "org.jboss", "org.hibernate" or their equivalents in any subsequent naming convention adopted through the Java Community Process, or any recognized successors or replacements thereof.</p>
</div>
<div class="paragraph">
<p>TRADEMARKS</p>
</div>
<div class="paragraph">
<p>No right, para, or interest in or to any trademarks, service marks, or trade names of Red Hat Inc. or Red Hat’s licensors is granted hereunder. Java and Java-related logos, marks and names are trademarks or registered trademarks of <span class="rcl-da">Oracle</span> <span class="rcl-da">and</span><span class="rcl-da">/</span><span class="rcl-da">or</span> <span class="rcl-da">its</span> <span class="rcl-da">affiliates</span><span class="rcl-dd">Sun </span><span class="rcl-dd">Microsystems</span><span class="rcl-dd">, </span><span class="rcl-dd">Inc</span><span class="rcl-dd">. </span> in the U.S. and other countries.</p>
</div>
<div class="paragraph">
<p>DISCLAIMER OF WARRANTIES</p>
</div>
<div class="paragraph">
<p>THE SPECIFICATION IS PROVIDED "AS IS" AND IS EXPERIMENTAL AND MAY CONTAIN DEFECTS OR DEFICIENCIES WHICH CANNOT OR WILL NOT BE CORRECTED BY RED HAT Inc. RED HAT Inc. MAKES NO REPRESENTATIONS OR WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT THAT THE CONTENTS OF THE SPECIFICATION ARE SUITABLE FOR ANY PURPOSE OR THAT ANY PRACTICE OR IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADE SECRETS OR OTHER RIGHTS. This document does not represent any commitment to release or implement any portion of the Specification in any product.</p>
</div>
<div class="paragraph">
<p>THE SPECIFICATION COULD INCLUDE TECHNICAL INACCURACIES OR TYPOGRAPHICAL ERRORS. CHANGES ARE PERIODICALLY ADDED TO THE INFORMATION THEREIN; THESE CHANGES WILL BE INCORPORATED INTO NEW VERSIONS OF THE SPECIFICATION, IF ANY. RED HAT Inc. MAY MAKE IMPROVEMENTS AND/OR CHANGES TO THE PRODUCT(S) AND/OR THE PROGRAM(S) DESCRIBED IN THE SPECIFICATION AT ANY TIME. Any use of such changes in the Specification will be governed by the then-current license for the applicable version of the Specification.</p>
</div>
<div class="paragraph">
<p>LIMITATION OF LIABILITY</p>
</div>
<div class="paragraph">
<p>TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT WILL RED HAT Inc. OR ITS LICENSORS BE LIABLE FOR ANY DAMAGES, INCLUDING WITHOUT LIMITATION, LOST REVENUE, PROFITS OR DATA, OR FOR SPECIAL, INDIRECT, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF OR RELATED TO ANY FURNISHING, PRACTICING, MODIFYING OR ANY USE OF THE SPECIFICATION, EVEN IF RED HAT Inc. AND/OR ITS LICENSORS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
</div>
<div class="paragraph">
<p>You will hold Red Hat Inc. (and its licensors) harmless from any claims based on your use of the Specification for any purposes other than the limited right of evaluation as described above, and from any claims that later versions or releases of any Specification furnished to you are incompatible with the Specification provided to you under this license.</p>
</div>
<div class="paragraph">
<p>RESTRICTED RIGHTS LEGEND</p>
</div>
<div class="paragraph">
<p>If this Software is being acquired by or on behalf of the U.S. Government or by a U.S. Government prime contractor or subcontractor (at any tier), then the Government’s rights in the Software and accompanying documentation shall be only as set forth in this license; this is in accordance with 48 C.F.R. 227.7201 through 227.7202-4 (for Department of Defense (DoD) acquisitions) and with 48 C.F.R. 2.101 and 12.212 (for non-DoD acquisitions).</p>
</div>
<div class="paragraph">
<p>REPORT</p>
</div>
<div class="paragraph">
<p>You may wish to report any ambiguities, inconsistencies or inaccuracies you may find in connection with your evaluation of the Specification ("Feedback"). To the extent that you provide Red Hat Inc. with any Feedback, you hereby: (i) agree that such Feedback is provided on a non-proprietary and non-confidential basis, and (ii) grant Red Hat Inc. a perpetual, non-exclusive, worldwide, fully paid-up, irrevocable license, with the right to sublicense through multiple levels of sublicensees, to incorporate, disclose, and use without limitation the Feedback for any purpose related to the Specification and future versions, implementations, and test suites thereof.</p>
</div>
<div class="paragraph">
<p>GENERAL TERMS</p>
</div>
<div class="paragraph">
<p>Any action related to this Agreement will be governed by California law and controlling U.S. federal law. The U.N. Convention for the International Sale of Goods and the choice of law rules of any jurisdiction will not apply.</p>
</div>
<div class="paragraph">
<p>The Specification is subject to U.S. export control laws and may be subject to export or import regulations in other countries. Licensee agrees to comply strictly with all such laws and regulations and acknowledges that it has the responsibility to obtain such licenses to export, re-export or import as may be required after delivery to Licensee.</p>
</div>
<div class="paragraph">
<p>This Agreement is the parties' entire agreement relating to its subject matter. It supersedes all prior or contemporaneous oral or written communications, proposals, conditions, representations and warranties and prevails over any conflicting or additional terms of any quote, order, acknowledgment, or other communication between the parties relating to its subject matter during the term of this Agreement. No modification to this Agreement will be binding, unless in writing and signed by an authorized representative of each party.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is the specification of the Java API for JavaBean validation in Java EE and Java SE. The technical objective of this work is to provide an object level constraint declaration and validation facility for the Java application developer, as well as a constraint metadata repository and query API.</p>
</div>
<div class="paragraph">
<p>It also offers method and constructor validation facilities to ensure constraints on their parameters and return values.</p>
</div>
<div class="sect2">
<h3 id="introduction-expertgroup"><a class="anchor" href="#introduction-expertgroup"></a>1.1. Expert group</h3>
<div class="paragraph">
<p>This work has been conducted as part of JSR 380 and formerly JSRs 349 and 303 under the Java Community Process Program.
This specification is the result of the collaborative work of the members of the JSR 380 Expert Group and the community at large.</p>
</div>
<div class="paragraph">
<p>The following persons have actively contributed to Bean Validation 2.0 as members of the JSR 380 expert group and the community at large in alphabetical order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Matt Benson</p>
</li>
<li>
<p>Emmanuel Bernard (Red Hat, Inc.)</p>
</li>
<li>
<p>Linda DeMichiel (Oracle)</p>
</li>
<li>
<p>Hendrik Ebbers (Canoo AG)</p>
</li>
<li>
<p>Hardy Ferentschik (Red Hat, Inc.)</p>
</li>
<li>
<p>Christian Kaltepoth (ingenit GmbH &amp; Co. KG)</p>
</li>
<li>
<p>Werner Keil</p>
</li>
<li>
<p>Marco Molteni (Genidea Sagl)</p>
</li>
<li>
<p>Gunnar Morling (Red Hat, Inc.) - Specification Lead</p>
</li>
<li>
<p>Michael Nascimento Santos</p>
</li>
<li>
<p>Otavio Santana</p>
</li>
<li>
<p>Guillaume Smet (Red Hat, Inc.)</p>
</li>
<li>
<p>Tsuyoshi Yoshitomi (Fujitsu Limited)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following persons have actively contributed to Bean Validation 1.1 as members of the JSR 349 expert group and the community at large in alphabetical order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Matt Benson</p>
</li>
<li>
<p>Paul Benedict</p>
</li>
<li>
<p>Emmanuel Bernard (Red Hat, Inc.) - Specification Lead</p>
</li>
<li>
<p>Edward Burns (Oracle)</p>
</li>
<li>
<p>Peter Davis</p>
</li>
<li>
<p>Linda DeMichiel (Oracle)</p>
</li>
<li>
<p>Hardy Ferentschik (Red Hat, Inc.)</p>
</li>
<li>
<p>Antonio Goncalves</p>
</li>
<li>
<p>Cemalettin Koç</p>
</li>
<li>
<p>Rich Midwinter</p>
</li>
<li>
<p>Gunnar Morling (individual then Red Hat, Inc.)</p>
</li>
<li>
<p>Pete Muir (Red Hat, Inc.)</p>
</li>
<li>
<p>Michael Nascimento Santos</p>
</li>
<li>
<p>Gerhard Petracek</p>
</li>
<li>
<p>Kevin Pollet (SERLI)</p>
</li>
<li>
<p>Jagadish Prasath Ramu (Oracle)</p>
</li>
<li>
<p>Bill Shannon (Oracle)</p>
</li>
<li>
<p>Sebastian Thomschke</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Former expert group members of JSR-303 in alphabetical order are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Geert Bevin</p>
</li>
<li>
<p>Emmanuel Bernard (Red Hat, Inc.) - Specification Lead</p>
</li>
<li>
<p>Uri Boness</p>
</li>
<li>
<p>Erik Brakkee (Ericsson AB)</p>
</li>
<li>
<p>Ed Burns (Sun Microsystems, Inc.)</p>
</li>
<li>
<p>Jason Carreira</p>
</li>
<li>
<p>Robert Clevenger (Oracle - retired)</p>
</li>
<li>
<p>Linda DeMichiel (Sun Microsystems, Inc.)</p>
</li>
<li>
<p>Tim Fennel</p>
</li>
<li>
<p>Bharath Ganesh (Pramati Technologies)</p>
</li>
<li>
<p>Romain Guy (Google Inc.)</p>
</li>
<li>
<p>Robert Harrop</p>
</li>
<li>
<p>Jacob J. Hookom</p>
</li>
<li>
<p>Bob Lee (Google Inc.)</p>
</li>
<li>
<p>Craig R. McClanahan (Sun Microsystems, Inc.)</p>
</li>
<li>
<p>Niall K. Pemberton</p>
</li>
<li>
<p>Steve Peterson</p>
</li>
<li>
<p>Dhanji R. Prasanna (Google Inc., formerly individual)</p>
</li>
<li>
<p>Gerhard Petracek</p>
</li>
<li>
<p>Matt Raible</p>
</li>
<li>
<p>Michael Nascimento Santos</p>
</li>
<li>
<p>Sebastian Thomschke</p>
</li>
<li>
<p>Jon Wetherbee (Oracle)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="introduction-goals"><a class="anchor" href="#introduction-goals"></a>1.2. Specification goals</h3>
<div class="paragraph">
<p>Validating data is a common task that occurs throughout an application, from the presentation layer to the persistence layer. Often the same validation logic is implemented in each layer, proving to be time consuming and error-prone. To avoid duplication of these validations in each layer, developers often bundle validation logic directly into the domain model, cluttering domain classes with validation code that is, in fact, metadata about the class itself.</p>
</div>
<div class="paragraph">
<p>This JSR defines a metadata model and API for JavaBean validation. The default metadata source is annotations, with the ability to override and extend the metadata through the use of XML validation descriptors.</p>
</div>
<div class="paragraph">
<p>The validation API developed by this JSR is not intended for use in any one tier or programming model. It is specifically not tied to either the web tier or the persistence tier, and is available for both server-side application programming, as well as rich client Swing application developers. This API is seen as a general extension to the JavaBeans object model, and as such is expected to be used as a core component in other specifications. Ease of use and flexibility have influenced the design of this specification.</p>
</div>
<div class="paragraph">
<p>As of version 1.1, Bean Validation constraints can also be applied to the parameters and return values of methods of arbitrary Java types. Thus the Bean Validation API can be used to describe and validate the contract (comprising pre- and postconditions) applying to a given method ("Programming by Contract", PbC). Note that it is <em>not</em> the goal of this specification to develop a fully-fledged PbC solution but rather an easy-to-use facility satisfying the most common needs related to applying constraints to method parameters and return values, based on the proven concepts of the Bean Validation API.</p>
</div>
</div>
<div class="sect2">
<h3 id="introduction-requirements"><a class="anchor" href="#introduction-requirements"></a>1.3. Required Java version</h3>
<div class="paragraph">
<p>The specification uses Java 8.0 language features. There is no requirement that implementations be compatible with Java language versions prior to 8.0.</p>
</div>
</div>
<div class="sect2">
<h3 id="introduction-documentorganization"><a class="anchor" href="#introduction-documentorganization"></a>1.4. How this document is organized</h3>
<div class="paragraph">
<p>This document describes each aspect of the Bean Validation specification in a separate chapter. One should remember that the specification is a consistent whole.</p>
</div>
<div class="paragraph">
<p><a href="#constraintsdefinitionimplementation">Constraint Definition</a> describes how constraints are defined.</p>
</div>
<div class="paragraph">
<p><a href="#constraintdeclarationvalidationprocess">Constraint declaration and validation process</a> describes how a JavaBean class is decorated with annotations to describe constraints.</p>
</div>
<div class="paragraph">
<p><a href="#validationapi">Validation APIs</a> describes how to programmatically validate a JavaBean.</p>
</div>
<div class="paragraph">
<p><a href="#constraintmetadata">Constraint metadata request APIs</a> describes how the metadata query API works.</p>
</div>
<div class="paragraph">
<p><a href="#builtinconstraints">Built-in Constraint definitions</a> list all the built-in constraints.</p>
</div>
<div class="paragraph">
<p><a href="#xml">XML deployment descriptor</a> describes the XML deployment descriptors for the configuration and the mapping.</p>
</div>
<div class="paragraph">
<p><a href="#exception">Exception model</a> describes the exception model and hierarchy used by Bean Validation.</p>
</div>
<div class="paragraph">
<p><a href="#integration">Integration</a> describes the different integration points of Bean Validation with other technologies. In some cases one has to refer to the respective specifications for the up-to-date integration rules.</p>
</div>
<div class="paragraph">
<p>In <a href="#terminology">Terminology</a>, key concepts are summarized. Some reviewers have found that reading the terminology section first helps to better understand the specification.</p>
</div>
<div class="paragraph">
<p>The changelog can be found at <a href="#changelog">Changelog</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="introduction-commentingprocess"><a class="anchor" href="#introduction-commentingprocess"></a>1.5. How to comment</h3>
<div class="paragraph">
<p>The expert group is eager to receive feedback from readers. Feel free to contact us. You can get all the details at <a href="http://beanvalidation.org/contribute/" class="bare">http://beanvalidation.org/contribute/</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="whatsnew"><a class="anchor" href="#whatsnew"></a>2. What’s new</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="whatsnew-20"><a class="anchor" href="#whatsnew-20"></a>2.1. What’s new in 2.0</h3>
<div class="paragraph">
<p>The main contribution of Bean Validation 2.0 is leveraging the new language features and API additions of Java 8 for the purposes of validation.
The changes include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for the new date/time data types for <code>@Past</code> and <code>@Future</code> (see <a href="#builtinconstraints">Built-in Constraint definitions</a>);
fine-grained control over the current time and time zone used for validation (see <a href="#constraintsdefinitionimplementation-validationimplementation-temporalvalidators">Implementation of temporal constraint validators</a>)</p>
</li>
<li>
<p>Advanced support for validating container elements by annotating type arguments of generic type, e.g. <code>List&lt;@Min(1) Integer&gt; positiveNumbers</code> (see <a href="#appendix-value-extraction">Value extraction for cascaded validation and type argument constraints (BVAL-508)</a>);
this also includes:</p>
<div class="ulist">
<ul>
<li>
<p>More flexible cascaded validation of collection types, e.g. <code>Map&lt;@Valid CustomerType, @Valid Customer&gt; customersByType</code></p>
</li>
<li>
<p>Support for <code>java.util.Optional</code></p>
</li>
<li>
<p>Support for the property types declared by JavaFX</p>
</li>
</ul>
</div>
</li>
<li>
<p>All built-in constraints are marked as repeatable (see <a href="#builtinconstraints">Built-in Constraint definitions</a>)</p>
</li>
<li>
<p>Parameter names are retrieved using reflection (see <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters">Naming parameters</a>)</p>
</li>
<li>
<p><code>ConstraintValidator#initialize()</code> is a default method (see <a href="#constraintsdefinitionimplementation-validationimplementation">Constraint validation implementation</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Further changes will be incorporated in the course of future Early Draft(s) and/or Public Draft(s) of Bean Validation 2.0.</p>
</div>
</div>
<div class="sect2">
<h3 id="whatsnew-11"><a class="anchor" href="#whatsnew-11"></a>2.2. What’s new in 1.1</h3>
<div class="paragraph">
<p>Bean Validation 1.1 improves and builds upon Bean Validation 1.0. The expert group and the community have been working on a few specific areas.</p>
</div>
<div class="sect3">
<h4 id="whatsnew-11-openness"><a class="anchor" href="#whatsnew-11-openness"></a>2.2.1. Openness</h4>
<div class="paragraph">
<p>All of Bean Validation 1.1 work has been done in the open and in an open source way. Source code for the API, reference implementation, test compatibility kit as well as the specification and the website sources are available in the open. All discussions are done in the open in the publicly available development mailing list. Road map and proposals are also published on the website.</p>
</div>
<div class="paragraph">
<p>You can find all the details (mailing lists, source repositories etc.) at <a href="http://beanvalidation.org/" class="bare">http://beanvalidation.org</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-cdi"><a class="anchor" href="#whatsnew-11-cdi"></a>2.2.2. Dependency injection</h4>
<div class="paragraph">
<p>Bean Validation uses a few components <code class="classname">MessageInterpolator</code>, <code class="classname">TraversableResolver</code>, <code class="classname">ParameterNameProvider</code>, <code class="classname">ConstraintValidatorFactory</code> and <code class="classname">ConstraintValidator</code>. Bean Validation 1.1 standardizes how these objects are managed by a container and how these objects can benefit from container services. In particular, CDI support within Java EE is being defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-methodvalidation"><a class="anchor" href="#whatsnew-11-methodvalidation"></a>2.2.3. Method validation</h4>
<div class="paragraph">
<p>Bean Validation 1.1 allows to put constraints to the parameters and return values of arbitrary methods and constructors. That way the Bean Validation API can be used to describe and validate the contract applying to a given method or constructor, that is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the preconditions that must be met by the caller before the method or constructor may be invoked and</p>
</li>
<li>
<p>the postconditions that are guaranteed to the caller after a method or constructor invocation returns.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This enables a programming style known as "Programming by Contract" (PbC). Compared to traditional means of checking the sanity of argument and return values this approach has several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>These checks are expressed declaratively and don’t have to be performed manually, which results in less code to write, read and maintain.</p>
</li>
<li>
<p>The pre- and postconditions applying for a method or constructor don’t have to be expressed again in the documentation, since any of its annotations will automatically be included in the generated JavaDoc. This reduces redundancies, thus avoiding efforts and inconsistencies between implementation and documentation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-contextcdi"><a class="anchor" href="#whatsnew-11-contextcdi"></a>2.2.4. Integration with Context and Dependency Injection</h4>
<div class="paragraph">
<p>The integration points with Context and Dependency Injection (CDI) have been increased and reworked. This opens up for a more natural and standard integration both in Java EE and Java SE and encompass dependency injection, component lifecycle management and interception for method validation.</p>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-groupconversion"><a class="anchor" href="#whatsnew-11-groupconversion"></a>2.2.5. Group conversion</h4>
<div class="paragraph">
<p>The specification offers a way to alter the targeted group when validation cascading in happening. This feature is particularly useful to reuse a given object (graph) and to avoid leaking groups between various object subgraphs. It also makes for more readable constraints.</p>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-expressionlanguage"><a class="anchor" href="#whatsnew-11-expressionlanguage"></a>2.2.6. Message interpolation via the unified expression language</h4>
<div class="paragraph">
<p>Constraint violation messages can now use EL expressions for a much more flexible rendering and string formatting. In particular a formatter object is injected in the EL context to convert numbers, dates etc. into the locale specific string representation. Likewise, the validated value is also available in the EL context.</p>
</div>
</div>
<div class="sect3">
<h4 id="whatsnew-11-others"><a class="anchor" href="#whatsnew-11-others"></a>2.2.7. Others</h4>
<div class="paragraph">
<p>Many more minor changes have been done. Check out the change log for more details at <a href="#changelog">Changelog</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraintsdefinitionimplementation"><a class="anchor" href="#constraintsdefinitionimplementation"></a>3. Constraint Definition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Constraints are defined by the combination of a constraint annotation and a list of constraint validation implementations. The constraint annotation is applied on types, fields, methods, constructors, parameters or other constraint annotations in case of composition.</p>
</div>
<div class="paragraph">
<p>Unless stated otherwise the default package name for the Bean Validation APIs is <code class="classname">javax.validation</code>.</p>
</div>
<div class="sect2">
<h3 id="constraintsdefinitionimplementation-constraintdefinition"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition"></a>3.1. Constraint annotation</h3>
<div class="paragraph">
<p>A constraint on a JavaBean is expressed through one or more annotations. <span class="tck-not-testable">An annotation is considered a constraint definition if its retention policy contains <code>RUNTIME</code> and if the annotation itself is annotated with <code>javax.validation.Constraint</code></span> .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Marks an annotation as being a Bean Validation constraint.
 * &lt;p&gt;
 * A given constraint annotation must be annotated by a {@code @Constraint}
 * annotation which refers to its list of constraint validation implementations.
 * &lt;p&gt;
 * Each constraint annotation must host the following attributes:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code String message() default [...];} which should default to an error
 *     message key made of the fully-qualified class name of the constraint followed by
 *     {@code .message}. For example {@code "{com.acme.constraints.NotSafe.message}"}&lt;/li&gt;
 *     &lt;li&gt;{@code Class&lt;?&gt;[] groups() default {};} for user to customize the targeted
 *     groups&lt;/li&gt;
 *     &lt;li&gt;{@code Class&lt;? extends Payload&gt;[] payload() default {};} for
 *     extensibility purposes&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * When building a constraint that is both generic and cross-parameter, the constraint
 * annotation must host the {@code validationAppliesTo()} property.
 * A constraint is generic if it targets the annotated element and is cross-parameter if
 * it targets the array of parameters of a method or constructor.
 * &lt;pre&gt;
 *     ConstraintTarget validationAppliesTo() default ConstraintTarget.IMPLICIT;
 * &lt;/pre&gt;
 * This property allows the constraint user to choose whether the constraint
 * targets the return type of the executable or its array of parameters.
 *
 * A constraint is both generic and cross-parameter if
 * &lt;ul&gt;
 *     &lt;li&gt;two kinds of {@code ConstraintValidator}s are attached to the
 *     constraint, one targeting {@link ValidationTarget#ANNOTATED_ELEMENT}
 *     and one targeting {@link ValidationTarget#PARAMETERS},&lt;/li&gt;
 *     &lt;li&gt;or if a {@code ConstraintValidator} targets both
 *     {@code ANNOTATED_ELEMENT} and {@code PARAMETERS}.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * Such dual constraints are rare. See {@link SupportedValidationTarget} for more info.
 * &lt;p&gt;
 * Here is an example of constraint definition:
 * &lt;pre&gt;
 * &amp;#64;Documented
 * &amp;#64;Constraint(validatedBy = OrderNumberValidator.class)
 * &amp;#64;Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
 * &amp;#64;Retention(RUNTIME)
 * public &amp;#64;interface OrderNumber {
 *     String message() default "{com.acme.constraint.OrderNumber.message}";
 *     Class&amp;lt;?&amp;gt;[] groups() default {};
 *     Class&amp;lt;? extends Payload&amp;gt;[] payload() default {};
 * }
 * &lt;/pre&gt;
 *
 * @author Emmanuel Bernard
 * @author Gavin King
 * @author Hardy Ferentschik
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ ANNOTATION_TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Constraint {

    <span class="comment">/**
     * {@link ConstraintValidator} classes must reference distinct target types
     * for a given {@link ValidationTarget}
     * If two {@code ConstraintValidator}s refer to the same type,
     * an exception will occur.
     * &lt;p&gt;
     * At most one {@code ConstraintValidator} targeting the array of parameters of
     * methods or constructors (aka cross-parameter) is accepted. If two or more
     * are present, an exception will occur.
     *
     * @return array of (@code ConstraintValidator} classes implementing the constraint
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ConstraintValidator&lt;?, ?&gt;&gt;<span class="type">[]</span> validatedBy();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A constraint is said to be generic if it has at least one constraint validator targeting the element annotated i.e. targeting the (returned) element annotated by the constraint (a bean, a field, a getter, a method/constructor return value or a method/constructor parameter). A constraint is said to be cross-parameter if it has one constraint validator targeting the array of parameters of a method or constructor (to validate the consistency of several method/constructor parameters). A Bean Validation constraint is most of the time either a generic constraint or a cross-parameter constraint. In rare situations, a constraint can be both.</p>
</div>
<div class="paragraph tck-not-testable">
<p></p><div class="paragraph">
<p>Generic constraint annotations can target any of the following <code class="classname">ElementType</code>s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FIELD</code> for constrained attributes</p>
</li>
<li>
<p><code>METHOD</code> for constrained getters and constrained method return values</p>
</li>
<li>
<p><code class="classname">CONSTRUCTOR</code> for constrained constructor return values</p>
</li>
<li>
<p><code class="classname">PARAMETER</code> for constrained method and constructor parameters</p>
</li>
<li>
<p><code>TYPE</code> for constrained beans</p>
</li>
<li>
<p><code>ANNOTATION_TYPE</code> for constraints composing other constraints</p>
</li>
<li>
<p><code>TYPE_USE</code> for type argument constraints</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph tck-not-testable">
<p></p><div class="paragraph">
<p>Cross-parameter constraint annotations can target any of the following <code class="classname">ElementType</code>s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>METHOD</code></p>
</li>
<li>
<p><code>CONSTRUCTOR</code></p>
</li>
<li>
<p><code>ANNOTATION_TYPE</code> for cross-parameter constraints composing other cross-parameter constraints</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">A constraint annotation that is both can target the union of the generic and cross-parameter constraint annotations targets.</span></p>
</div>
<div class="paragraph">
<p>While other <code class="classname">ElementType</code>s are not forbidden, the provider does not have to recognize and process constraints placed on such types.</p>
</div>
<div class="paragraph">
<p>Since a given constraint definition applies to one or more specific Java types, the JavaDoc for the constraint annotation should clearly state which types are supported. <span class="tck-testable">Applying a constraint annotation to an incompatible type will raise an <code class="classname">UnexpectedTypeException</code>.</span> Care should be taken on defining the list of <code class="classname">ConstraintValidator</code>s. The type resolution algorithm (see <a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution">ConstraintValidator resolution algorithm</a>) could lead to exceptions if the <code class="classname">ConstraintValidator</code> list leads to ambiguities.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">At most one <code class="classname">ConstraintValidator</code> supporting cross-parameter validation must be present for a given constraint. A <code class="classname">ConstraintDefinitionException</code> is raised otherwise.</span> The JavaDoc should clearly state if the constraint is a generic and / or a cross-parameter constraint.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a constraint definition is not valid, a <code class="classname">ConstraintDefinitionException</code> is raised either at validation time or when the metadata is requested.</span> Invalid constraint definitions causes are multiple but include missing or illegal <code class="methodname">message</code> or <code class="methodname">groups</code> elements (see <a href="#constraintsdefinitionimplementation-constraintdefinition-properties">Constraint definition properties</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Bean Validation defines rules for applying constraint annotations in inheritance hierarchies, described in <a href="#constraintdeclarationvalidationprocess-inheritance">Inheritance (interface and superclass)</a> and <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance">Method constraints in inheritance hierarchies</a>. It is therefore not recommended to specify the meta annotation <code class="classname">java.lang.annotation.Inherited</code> at constraint annotation types, as it is not relevant in the context of Bean Validation and would conflict with the proposed rules.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="constraintsdefinitionimplementation-constraintdefinition-properties"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties"></a>3.1.1. Constraint definition properties</h4>
<div class="paragraph">
<p><span class="tck-testable">A constraint definition may have attributes that are specified at the time the constraint is applied to a JavaBean.</span> The properties are mapped as annotation elements. The annotation element names <code>message</code>, <code>groups</code>, <code>validationAppliesTo</code> and <code>payload</code> are considered reserved names; <span class="tck-testable">annotation elements starting with <code>valid</code> are not allowed</span> ; a constraint may use any other element name for its attributes.</p>
</div>
<div class="sect4">
<h5 id="constraintsdefinitionimplementation-constraintdefinition-properties-message"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties-message"></a><span class="rcl-da">3.1.1.1</span><span class="rcl-da">.</span> message</h5>
<div class="paragraph">
<p><span class="tck-testable">Every constraint annotation must define a <code>message</code> element of type <code>String</code>.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.MyConstraint.message}</span><span class="delimiter">"</span></span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="methodname">message</code> element value is used to create the error message. See <a href="#validationapi-message">Message interpolation</a> for a detailed explanation. It is recommended to default <code>message</code> values to resource bundle keys to enable internationalization. It is also recommended to use the following convention: the resource bundle key should be the fully qualified class name of the constraint annotation concatenated to <code>.message</code> as shown in the previous program listing.</p>
</div>
<div class="paragraph">
<p>Built-in Bean Validation constraints follow this convention.</p>
</div>
</div>
<div class="sect4">
<h5 id="constraintsdefinitionimplementation-constraintdefinition-properties-groups"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties-groups"></a><span class="rcl-da">3.1.1.2</span><span class="rcl-da">.</span> groups</h5>
<div class="paragraph">
<p><span class="tck-testable">Every constraint annotation must define a <code>groups</code> element that specifies the processing groups with which the constraint declaration is associated.</span> <span class="tck-testable">The type of the <code>groups</code> parameter is <code class="classname">Class&lt;?&gt;[]</code>.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The default value must be an empty array.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If no group is specified when declaring the constraint on an element, the <code>Default</code> group is considered declared.</span></p>
</div>
<div class="paragraph">
<p>See <a href="#validationapi-validatorapi-groups">groups</a> for more information.</p>
</div>
<div class="paragraph">
<p>Groups are typically used to control the order in which constraints are evaluated, or to perform validation of the partial state of a JavaBean.</p>
</div>
</div>
<div class="sect4">
<h5 id="constraintsdefinitionimplementation-constraintdefinition-properties-payload"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties-payload"></a><span class="rcl-da">3.1.1.3</span><span class="rcl-da">.</span> payload</h5>
<div class="paragraph">
<p><span class="tck-testable">Constraint annotations must define a <code>payload</code> element that specifies the payload with which the constraint declaration is associated. The type of the <code>payload</code> parameter is <code class="classname">Payload[]</code>.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The default value must be an empty array.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Each attachable payload extends <code class="classname">Payload</code>.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Payload type that can be attached to a given
 * constraint declaration.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Payloads are typically used to carry on metadata information
 * consumed by a validation client.
 * &lt;/p&gt;
 * Use of payloads is not considered portable.
 *
 * @author Emmanuel Bernard
 * @author Gerhard Petracek
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Payload</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Payloads are typically used by validation clients to associate some metadata information with a given constraint declaration. Payloads are typically non-portable. Describing payloads as interface extensions as opposed to a string-based approach allows an easier and more type-safe approach.</p>
</div>
<div class="paragraph">
<p>One use case for payload shown in <a href="#example-payload">Use of payload to associate severity to a constraint</a> is to associate a severity to a constraint. This severity can be exploited by a presentation framework to adjust how a constraint failure is displayed.</p>
</div>
<div id="example-payload" class="exampleblock">
<div class="title">Example 1. Use of payload to associate severity to a constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.acme.severity</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Severity</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Info</span> <span class="directive">implements</span> Payload {};
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Error</span> <span class="directive">implements</span> Payload {};
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span>(message=<span class="string"><span class="delimiter">"</span><span class="content">would be nice if we had one</span><span class="delimiter">"</span></span>, payload=<span class="predefined-type">Severity</span>.Info.class)
    <span class="directive">public</span> <span class="predefined-type">String</span> getZipCode() { [...] }

    <span class="annotation">@NotNull</span>(message=<span class="string"><span class="delimiter">"</span><span class="content">the city is mandatory</span><span class="delimiter">"</span></span>, payload=<span class="predefined-type">Severity</span>.Error.class)
    <span class="predefined-type">String</span> getCity() { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>payload</code> information can be retrieved from error reports via the <code class="classname">ConstraintDescriptor</code> either accessed through the <code class="classname">ConstraintViolation</code> objects (see <a href="#validationapi-constraintviolation">ConstraintViolation</a>) or through the metadata API (see <a href="#constraintmetadata-constraintdescriptor">ConstraintDescriptor</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto"></a><span class="rcl-da">3.1.1.4</span><span class="rcl-da">.</span> validationAppliesTo</h5>
<div class="paragraph">
<p><code>validationAppliesTo</code> is used at constraint declaration time to clarify what the constraint targets (i.e. the annotated element, the method return value or the method parameters).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The element <code>validationAppliesTo</code> must only be present for constraints that are both generic and cross-parameter, it is mandatory in this situation. A <code class="classname">ConstraintDefinitionException</code> is raised if these rules are violated.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The type of the <code>validationAppliesTo</code> parameter is <code class="classname">ConstraintTarget</code>. The default value must be <code class="classname">ConstraintTarget.IMPLICIT</code>.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 2. validationAppliesTo and ConstraintTarget</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">ConstraintTarget validationAppliesTo() <span class="keyword">default</span> ConstraintTarget.IMPLICIT;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Defines the constraint target.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ConstraintTarget {

    <span class="comment">/**
     * Discover the type when no ambiguity is present
     * &lt;ul&gt;
     *     &lt;li&gt;if neither on a method nor a constructor, it implies the annotated element
     *     (type, field etc),&lt;/li&gt;
     *     &lt;li&gt;if on a method or constructor with no parameter, it implies
     *     {@code RETURN_VALUE},&lt;/li&gt;
     *     &lt;li&gt;if on a method with no return value ({@code void}), it implies
     *     {@code PARAMETERS}.&lt;/li&gt;
     * &lt;/ul&gt;
     * Otherwise, {@code IMPLICIT} is not accepted and either {@code RETURN_VALUE} or
     * {@code PARAMETERS} is required. This is the case for constructors with parameters
     * and methods with parameters and return value.
     */</span>
    IMPLICIT,

    <span class="comment">/**
     * Constraint applies to the return value of a method or a constructor.
     */</span>
    RETURN_VALUE,

    <span class="comment">/**
     * Constraint applies to the parameters of a method or a constructor
     */</span>
    PARAMETERS
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a <code class="classname">ConstraintTarget</code> is used in an illegal situation, a <code class="classname">ConstraintDeclarationException</code> is raised either at validation time or when the metadata is requested.</span> Examples of illegal situations are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">using <code>IMPLICIT</code> in a situation that cannot be inferred (see the JavaDoc for the detailed rules),</span></p>
</li>
<li>
<p><span class="tck-testable">using <code>PARAMETERS</code> on a constructor or method that has no parameter,</span></p>
</li>
<li>
<p><span class="tck-testable">using <code>RETURN_VALUE</code> on a method with no return value,</span></p>
</li>
<li>
<p><span class="tck-testable">using <code>PARAMETERS</code> or <code>RETURN_VALUE</code> on a type - class or interface - or on a field.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Constraint users are encouraged to explicitly set the <code class="classname">ConstraintTarget</code> target when using a constraint supporting both on a method or constructor as it improves readability.</p>
</div>
</div>
<div class="sect4">
<h5 id="constraintsdefinitionimplementation-constraintdefinition-properties-specific"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-properties-specific"></a><span class="rcl-da">3.1.1.5</span><span class="rcl-da">.</span> Constraint specific parameter</h5>
<div class="paragraph">
<p>The constraint annotation definitions may define additional elements to parameterize the constraint. For example, a constraint that validates the length of a string can use an annotation element named <code>length</code> to specify the maximum length at the time the constraint is declared.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="constraintsdefinitionimplementation-constraintdefinition-examples"><a class="anchor" href="#constraintsdefinitionimplementation-constraintdefinition-examples"></a>3.1.2. Examples</h4>
<div id="example-definition-notnull" class="exampleblock">
<div class="title">Example 3. Simple constraint definition</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming OrderNumberValidator is a generic constraint validator</span>

<span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="comment">/**
 * Mark a String as representing a well formed order number
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = OrderNumberValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> OrderNumber {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.OrderNumber.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-definition-notnull">Simple constraint definition</a> marks a <code class="classname">String</code> as a well-formed order number. The constraint validator is implemented by <code class="classname">OrderNumberValidator</code>.</p>
</div>
<div id="example-definition-crossparameter" class="exampleblock">
<div class="title">Example 4. Simple cross-parameter constraint definition</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming DateParametersConsistentValidator is a cross-parameter</span>
<span class="comment">//constraint validator</span>

<span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="comment">/**
 * Cross-parameter constraint ensuring that two date parameters of a method are in the correct order.
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = DateParametersConsistentValidator.class)
<span class="annotation">@Target</span>({ METHOD, CONSTRUCTOR, ANNOTATION_TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DateParametersConsistent {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.DateParametersConsistent.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-definition-crossparameter">Simple cross-parameter constraint definition</a> shows a cross-parameter constraint which ensures that two date parameters of a method are in the correct order. The constraint validator is implemented by <code class="classname">DateParametersConsistentValidator</code>.</p>
</div>
<div id="example-definition-genericandcrossparameter" class="exampleblock">
<div class="title">Example 5. Constraint that is both generic and cross parameter</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming ELAssertValidator is both a generic and cross-parameter</span>
<span class="comment">//constraint validator</span>

<span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="comment">/**
 * EL expression to be validated. This constraint accepts any type and can validate both the annotated type or apply
 * restrictions across parameters.
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = ELAssertValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, TYPE, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ELAssert {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.DateParametersConsistent.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    ConstraintTarget validationAppliesTo() <span class="keyword">default</span> ConstraintTarget.IMPLICIT;

    <span class="predefined-type">String</span> expression();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@ELAssert</span>(
    message=<span class="string"><span class="delimiter">"</span><span class="content">Please check that your passwords match and try again.</span><span class="delimiter">"</span></span>,
    expression=<span class="string"><span class="delimiter">"</span><span class="content">param[1]==param[2]</span><span class="delimiter">"</span></span>,
    validationAppliesTo=ConstraintType.PARAMETERS
)
<span class="directive">public</span> User createUser(<span class="predefined-type">String</span> email, <span class="predefined-type">String</span> password, <span class="predefined-type">String</span> repeatPassword) { [...] }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-definition-genericandcrossparameter">Constraint that is both generic and cross parameter</a> shows a constraint that can be applied both on the annotated element and across parameters of a method or a constructor. Note in this case the presence of <code class="methodname">validationAppliesTo</code>.</p>
</div>
<div id="example-definition-length" class="exampleblock">
<div class="title">Example 6. Constraint definition with default parameter</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="comment">/**
 * A frequency in Hz as audible to human ear. Adjustable to the age of the person. Accept Numbers.
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = AudibleValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Audible {

    Age age() <span class="keyword">default</span> Age.YOUNG;

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.Audible.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="directive">public</span> <span class="type">enum</span> Age {
        YOUNG,
        WONDERING,
        OLD
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-definition-length">Constraint definition with default parameter</a> ensures that a given frequency is within the scope of human ears. The constraint definition includes an optional parameter that may be specified when the constraint is applied.</p>
</div>
<div id="example-definition-mandatory" class="exampleblock">
<div class="title">Example 7. Constraint definition with mandatory parameter</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="comment">/**
 * Defines the list of values accepted. Accepts int or Integer objects.
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = DiscreteListOfIntegerValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Acceptable {

    <span class="type">int</span><span class="type">[]</span> value();

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.Acceptable.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-definition-mandatory">Constraint definition with mandatory parameter</a> defines a list of acceptable values expressed as an array: the <code class="methodname">value</code> property must be specified when the constraint is applied.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintsdefinitionimplementation-multipleconstraints"><a class="anchor" href="#constraintsdefinitionimplementation-multipleconstraints"></a>3.2. Applying multiple constraints of the same type</h3>
<div class="paragraph">
<p>It is often useful to declare the same constraint more than once to the same target, with different properties. A common example is the <code>@Pattern</code> constraint, which validates that its target matches a specified regular expression. Other constraints have this requirement as well. The same constraint type can belong to different groups and have specific error messages depending on the targeted group.</p>
</div>
<div class="paragraph">
<p>To support this requirement, <span class="tck-testable">the Bean Validation provider treats regular annotations (annotations not annotated by <code class="classname">@Constraint</code>) whose <code>value</code> element has a return type of an array of constraint annotations in a special way. Each element in the <code>value</code> array are processed by the Bean Validation implementation as regular constraint annotations.</span> This means that each constraint specified in the <code>value</code> element is applied to the target. The annotation must have retention <code>RUNTIME</code> and can be applied on a type, field, property, executable parameter, executable return value, executable cross-parameter or another annotation. It is recommended to use the same set of targets as the initial constraint.</p>
</div>
<div class="paragraph">
<p>Note to constraint designers: each constraint annotation should be coupled with its corresponding multi-valued annotation. The specification recommends, though does not mandate, the definition of an inner annotation named <code class="classname">List</code>.
Each constraint annotation type should be meta-annotated with <code class="classname">java.lang.annotation.Repeatable</code>, referencing the corresponding <code class="classname">List</code> annotation.
This marks the constraint annotation type as repeatable and lets users specify the constraint several times without explicitly using the <code class="classname">List</code> annotation.
All built-in annotations follow this pattern.</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. Multi-valued constraint definition</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Validate a zip code for a given country
 * The only supported type is String
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = ZipCodeValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="directive">public</span> <span class="annotation">@interface</span> ZipCode {

    <span class="predefined-type">String</span> countryCode();

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.ZipCode.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="comment">/**
     * Defines several @ZipCode annotations on the same element
     * @see (@link ZipCode}
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {
        ZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 9. Multi-valued constraint declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@ZipCode</span>(countryCode = <span class="string"><span class="delimiter">"</span><span class="content">fr</span><span class="delimiter">"</span></span>, groups = Default.class, message = <span class="string"><span class="delimiter">"</span><span class="content">zip code is not valid</span><span class="delimiter">"</span></span>)
    <span class="annotation">@ZipCode</span>(
        countryCode = <span class="string"><span class="delimiter">"</span><span class="content">fr</span><span class="delimiter">"</span></span>,
        groups = SuperUser.class,
        message = <span class="string"><span class="delimiter">"</span><span class="content">zip code invalid. Requires overriding before saving.</span><span class="delimiter">"</span></span>
    )
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, both constraints apply to the <code class="methodname">zipCode</code> field but with different groups and with different error messages.
It is also possible to specify a constraint several times by explicitly using the <code class="classname">@List</code> annotation (though simply repeating the annotation is the preferred idiom as of Bean Validation 2.0 and Java 8):</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Multi-valued constraint declaration using explicit <code class="classname">@List</code> annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@ZipCode</span>.List( {
        <span class="annotation">@ZipCode</span>(countryCode=<span class="string"><span class="delimiter">"</span><span class="content">fr</span><span class="delimiter">"</span></span>, groups=Default.class,
            message = <span class="string"><span class="delimiter">"</span><span class="content">zip code is not valid</span><span class="delimiter">"</span></span>),
        <span class="annotation">@ZipCode</span>(countryCode=<span class="string"><span class="delimiter">"</span><span class="content">fr</span><span class="delimiter">"</span></span>, groups=SuperUser.class,
            message = <span class="string"><span class="delimiter">"</span><span class="content">zip code invalid. Requires overriding before saving.</span><span class="delimiter">"</span></span>)
    } )
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using two different multi-constraint annotations for the same underlying constraint type on the same target (i.e. class or property) is not considered portable and is discouraged.</p>
</div>
</div>
<div class="sect2">
<h3 id="constraintsdefinitionimplementation-constraintcomposition"><a class="anchor" href="#constraintsdefinitionimplementation-constraintcomposition"></a>3.3. Constraint composition</h3>
<div class="paragraph">
<p>This specification allows you to compose constraints to create higher level constraints.</p>
</div>
<div class="paragraph">
<p>Constraint composition is useful in several ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid duplication and facilitate reuse of more primitive constraints.</p>
</li>
<li>
<p>Expose primitive constraints as part of a composed constraint in the metadata API and enhance tool awareness.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Composition is done by annotating a constraint annotation with the composing constraint annotations.</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. Composition is done by annotating the composed constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[0-9]*</span><span class="delimiter">"</span></span>)
<span class="annotation">@Size</span>(min = <span class="integer">5</span>, max = <span class="integer">5</span>)
<span class="annotation">@Constraint</span>(validatedBy = FrenchZipCodeValidator.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FrenchZipCode {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Wrong zip code</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {
        FrenchZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Annotating an element with <code class="classname">@FrenchZipCode</code> (the composed annotation) is equivalent to annotating it with <code class="classname">@Pattern(regexp="[0-9]*")</code>, <code class="classname">@Size(min=5, max=5)</code> (the composing annotations) and <code class="classname">@FrenchZipCode</code>. <span class="tck-testable">More formally, each constraint annotation hosted on a constraint annotation is applied to the target element and this is done recursively.</span> <span class="tck-testable">Note that the main annotation and its constraint validation implementation is also applied.</span> <span class="tck-testable">By default, each failing constraint generates an error report.</span> <span class="tck-testable">Groups from the main constraint annotation are inherited by the composing annotations.</span> <span class="tck-testable">Any <code class="methodname">groups</code> definition on a composing annotation is ignored.</span> <span class="tck-testable">Payload from the main constraint annotation is inherited by the composing annotations.</span> <span class="tck-testable">Any <code class="methodname">payload</code> definition on a composing annotation is ignored.</span> <span class="tck-testable">The constraint target from the main constraint annotation is inherited by the composing annotations.</span> <span class="tck-testable">Any <code class="methodname">validationAppliesTo</code> definition on a composing annotation is ignored.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The type upon which composed constraint is placed must be compatible with all constraints (composing and composed).</span> A constraint designer should ensure that such a type exists and lists in the JavaDoc all the compatible types.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">All composed and composing constraints must have a constraint type in common.</span> In particular, it is not legal to mix a pure generic constraint and a pure cross-parameter constraint.</p>
</div>
<div class="paragraph">
<p>It is possible to ensure that composing annotations do not raise individual error reports. In this scenario, if one or more composing annotations are invalid, the main constraint is automatically considered invalid and the corresponding error report is generated. To mark a constraint as raising a single constraint error report if either the composed or one of the composing constraints fail, use the <code class="classname">@ReportAsSingleViolation</code> annotation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. If any of the composing constraints fail, the error report corresponding to <code class="classname">@FrenchZipCode</code> is raised and none other.</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[0-9]*</span><span class="delimiter">"</span></span>)
<span class="annotation">@Size</span>(min = <span class="integer">5</span>, max = <span class="integer">5</span>)
<span class="annotation">@ReportAsSingleViolation</span>
<span class="annotation">@Constraint</span>(validatedBy = FrenchZipCodeValidator.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FrenchZipCode {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Wrong zip code</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {
        FrenchZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The definition of <code class="classname">@ReportAsSingleViolation</code> is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * A constraint annotation hosting this annotation will return the
 * composed annotation error report if any of the composing annotations fail.
 * The error reports of each individual composing constraint are ignored.
 * &lt;p&gt;
 * Note: Evaluation of composed constraints stops on the first validation
 * error in case the composing constraint is annotated with
 * {@code @ReportAsSingleViolation}.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ ANNOTATION_TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> ReportAsSingleViolation {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">More specifically, if a composed constraint is marked as <code class="classname">@ReportAsSingleViolation</code>, the evaluation of the composing constraints stops at the first failing constraint and the error report corresponding to the composed constraint is generated and returned.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Composing annotations can define the value of <code>message</code> and custom attributes (excluding <code class="methodname">groups</code>, <code class="methodname">payload</code> and <code class="methodname">validationAppliesTo</code>) but these are fixed in the composed constraint definition.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 13. Composing annotations can use attributes. They are fixed for a given main annotation. All <code class="classname">@FrenchZipCode</code> constraints have a <code class="classname">@Size</code> restricted to 5.</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[0-9]*</span><span class="delimiter">"</span></span>)
<span class="annotation">@Size</span>(min = <span class="integer">5</span>, max = <span class="integer">5</span>)
<span class="annotation">@Constraint</span>(validatedBy = FrenchZipCodeValidator.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FrenchZipCode {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Wrong zip code</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {
        FrenchZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>It is possible to override attributes and messages defined on a composing annotation.
An attribute from the main annotation is used to override one or more attributes of the composing annotations.
Such an attribute is annotated with <span class="rcl-da">one</span><span class="rcl-dd">the </span><span class="rcl-dd">@</span><span class="rcl-dd">OverridesAttribute </span><span class="rcl-dd">annotation </span> or <span class="rcl-da">more</span><span class="rcl-dd">its </span><span class="rcl-dd">multivalued </span><span class="rcl-dd">equivalent </span> <code>@OverridesAttribute<span class="rcl-dd">.</span><span class="rcl-dd">List </span></code> <span class="rcl-da">annotations</span>.</p>
</div><p></p>
</div>
<div id="example-composing-overridden" class="exampleblock">
<div class="title">Example 14. Attributes from composing annotations can be overridden by attributes from the composed annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[0-9]*</span><span class="delimiter">"</span></span>)
<span class="annotation">@Size</span>
<span class="annotation">@Constraint</span>(validatedBy = FrenchZipCodeValidator.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FrenchZipCode {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Wrong zip code</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@OverridesAttribute</span><span class="rcl-dd">.</span><span class="rcl-dd">List</span><span class="rcl-dd">({ </span><span class="rcl-dd">@</span><span class="rcl-dd">OverridesAttribute </span>(constraint = Size.class, name = <span class="string"><span class="delimiter">"</span><span class="content">min</span><span class="delimiter">"</span></span><span class="rcl-da">)</span><span class="rcl-dd">), </span>
    <span class="annotation">@OverridesAttribute</span>(constraint = Size.class, name = <span class="string"><span class="delimiter">"</span><span class="content">max</span><span class="delimiter">"</span></span>)<span class="rcl-dd">}) </span>
    <span class="type">int</span> size() <span class="keyword">default</span> <span class="integer">5</span>;

    <span class="annotation">@OverridesAttribute</span>(constraint = Size.class, name = <span class="string"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span>)
    <span class="predefined-type">String</span> sizeMessage() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.FrenchZipCode.zipCode.size}</span><span class="delimiter">"</span></span>;

    <span class="annotation">@OverridesAttribute</span>(constraint = <span class="predefined-type">Pattern</span>.class, name = <span class="string"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span>)
    <span class="predefined-type">String</span> numberMessage() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.FrenchZipCode.number.size}</span><span class="delimiter">"</span></span>;

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        FrenchZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The value of the composed constraint attribute annotated with <code class="classname">@OverridesAttribute</code> (<code class="methodname">@FrenchZipCode.sizeMessage</code>) is applied to the composing constraint attribute named after <code class="methodname">@OverridesAttribute.name</code> and hosted on the composing constraint of type <code class="methodname">@OverridesAttribute.constraint</code> (<code class="methodname">@Size.message</code>). Similarly, <code class="classname">@FrenchZipCode.numberMessage</code> value is mapped to <code class="classname">@Pattern.message</code>.</p>
</div>
<div class="paragraph">
<p>If left undefined, the default value for <code class="methodname">@OverridesAttribute.name</code> is the name of the composed constraint attribute hosting the <code class="classname">@OverridesAttribute</code> annotation.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The types of the overridden and overriding attributes must be identical.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><span class="tck-testable">A composing constraint can itself be a composed constraint. In this case, attribute values are overridden recursively according to the described rules.</span> Note however, that a forwarding rule (as defined by <code class="classname">@OverridesAttribute</code>) is only applied to the direct composing constraints.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Using <a href="#example-composing-overridden">Attributes from composing annotations can be overridden by attributes from the composed annotation</a>,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FrenchZipCode</span>(size=<span class="integer">9</span>, sizeMessage=<span class="string"><span class="delimiter">"</span><span class="content">Zip code should be of size {max}</span><span class="delimiter">"</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@FrenchZipCode</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>if <code class="classname">@FrenchZipCode</code> is defined as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[0-9]*</span><span class="delimiter">"</span></span>)
<span class="annotation">@Size</span>(min = <span class="integer">9</span>, max = <span class="integer">9</span>, message = <span class="string"><span class="delimiter">"</span><span class="content">Zip code should be of size {max}</span><span class="delimiter">"</span></span>)
<span class="annotation">@Constraint</span>(validatedBy = FrenchZipCodeValidator.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> FrenchZipCode {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Wrong zip code</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        FrenchZipCode<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a constraint is used more than once as a composing constraint, the multi value constraints model as described in <a href="#constraintsdefinitionimplementation-multipleconstraints">Applying multiple constraints of the same type</a> is used.</span></p>
</div>
<div class="paragraph">
<p>To select a specific composing constraint, <code class="methodname">OverridesAttribute.constraintIndex</code> is used.
<span class="tck-testable"><span class="rcl-da">If</span><span class="rcl-dd">It </span><span class="rcl-dd">represents </span> the <span class="rcl-da">composing</span> <span class="rcl-da">constraints</span> <span class="rcl-da">are</span> <span class="rcl-da">directly</span> <span class="rcl-da">given</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">composing</span> constraint<span class="rcl-da">,</span> <code><span class="rcl-da">constraintIndex</span></code> <span class="rcl-da">refers</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">left-to-right</span> <span class="rcl-da">order</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">constraints</span> <span class="rcl-da">of</span> <span class="rcl-da">this</span> <span class="rcl-da">type</span><span class="rcl-dd">index </span> in <span class="rcl-da">which</span> <span class="rcl-da">they</span> <span class="rcl-da">are</span> <span class="rcl-da">given</span> <span class="rcl-da">on</span> the <span class="rcl-da">composing</span> <span class="rcl-da">constraint</span><span class="rcl-da">.</span></span>
<span class="tck-testable"><span class="rcl-da">If</span> <span class="rcl-da">the</span> <span class="rcl-da">composing</span> <span class="rcl-da">constraints</span> <span class="rcl-da">are</span> <span class="rcl-da">specified</span> <span class="rcl-da">using</span> <span class="rcl-da">their</span> <span class="rcl-da">corresponding</span> <code><span class="rcl-da">List</span></code> <span class="rcl-da">annotation</span><span class="rcl-da">,</span> <code><span class="rcl-da">constraintIndex</span></code> <span class="rcl-da">refers</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">within</span> <span class="rcl-da">the</span> <code>value</code> array.</span></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p><span class="rcl-da">A</span> <span class="rcl-da">composing</span> <span class="rcl-da">constraint</span> <span class="rcl-da">must</span> <span class="rcl-da">not</span> <span class="rcl-da">be</span> <span class="rcl-da">given</span> <span class="rcl-da">directly</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">composing</span> <span class="rcl-da">constraint</span> <span class="rcl-da">and</span> <span class="rcl-da">using</span> <span class="rcl-da">the</span> <span class="rcl-da">corresponding</span> <code><span class="rcl-da">List</span></code> <span class="rcl-da">annotation</span> <span class="rcl-da">at</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">time</span><span class="rcl-da">.</span>
<span class="rcl-da">A</span> <code><span class="rcl-da">ConstraintDeclarationException</span></code> <span class="rcl-da">will</span> <span class="rcl-da">be</span> <span class="rcl-da">raised</span> <span class="rcl-da">in</span> <span class="rcl-da">this</span> <span class="rcl-da">case</span><span class="rcl-da">.</span></p>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If <code>index</code> is undefined, the single constraint declaration is targeted.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 15. Use of constraintIndex in @OverridesAttribute</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@<span class="rcl-da">Documented</span><span class="rcl-dd">Pattern </span></span><span class="rcl-dd">.</span><span class="rcl-dd">List</span><span class="rcl-dd">({ </span>
<span class="annotation">@<span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{})</span>
<span class="annotation"><span class="rcl-da">@</span>Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">[A-Z0-9._%+-]+@[A-Z0-9.-]+</span><span class="char">\\</span><span class="content">.[A-Z]{2,4}</span><span class="delimiter">"</span></span><span class="rcl-da">)</span><span class="rcl-dd">), </span> <span class="comment">// email</span>
<span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">"</span><span class="content">.*?emmanuel.*?</span><span class="delimiter">"</span></span>) <span class="comment">// emmanuel</span><span class="rcl-dd">}) </span>
<span class="annotation">@<span class="rcl-dd">Constraint </span><span class="rcl-dd">(</span><span class="rcl-dd">validatedBy </span><span class="rcl-dd">= </span><span class="rcl-dd">{}) </span><span class="rcl-dd">@</span><span class="rcl-dd">Documented </span><span class="rcl-dd">@</span>Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> EmmanuelsEmail {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Not emmanuel's email</span><span class="delimiter">"</span></span>;

    <span class="annotation">@OverridesAttribute</span>(constraint = <span class="predefined-type">Pattern</span>.class, name = <span class="string"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span>, constraintIndex = <span class="integer">0</span>)
    <span class="predefined-type">String</span> emailMessage() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Not an email</span><span class="delimiter">"</span></span>;

    <span class="annotation">@OverridesAttribute</span>(constraint = <span class="predefined-type">Pattern</span>.class, name = <span class="string"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span>, constraintIndex = <span class="integer">1</span>)
    <span class="predefined-type">String</span> emmanuelMessage() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">Not Emmanuel</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        EmmanuelsEmail<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="classname">@OverridesAttribute</code> definition is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Marks an attribute as overriding the attribute of a composing constraint.
 * Both attributes must share the same type.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@<span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span>Retention</span>(RUNTIME)
<span class="annotation">@Target</span>({ METHOD })
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="directive">public</span> <span class="annotation">@interface</span> OverridesAttribute {

    <span class="comment">/**
     * @return constraint type the attribute is overriding
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Annotation</span>&gt; constraint();

    <span class="comment">/**
     * Name of the Constraint attribute overridden.
     * Defaults to the name of the attribute hosting {@code @OverridesAttribute}.
     *
     * @return name of constraint attribute overridden
     */</span>
    <span class="predefined-type">String</span> name();

    <span class="comment">/**
     * The index of the targeted constraint declaration when using
     * multiple constraints of the same type.
     * &lt;p&gt;
     * The index represents the index of the constraint in the
     * {@code value()} array.
     * &lt;p&gt;
     * By default, no index is defined and the single constraint declaration
     * is targeted.
     *
     * @return constraint declaration index if multivalued annotation is used
     */</span>
    <span class="type">int</span> constraintIndex() <span class="keyword">default</span> -<span class="integer">1</span>;

    <span class="comment">/**
     * Defines several {@link OverridesAttribute} annotations on the same element
     *
     * @see javax.validation.OverridesAttribute
     */</span>
    <span class="annotation">@Documented</span>
    <span class="annotation">@Target</span>({ METHOD })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        OverridesAttribute<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following elements uniquely identify an overridden constraint attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="methodname">@OverridesAttribute.constraint</code></p>
</li>
<li>
<p><code class="methodname">@OverridesAttribute.name</code></p>
</li>
<li>
<p><code class="methodname">@OverridesAttribute.constraintIndex</code></p>
</li>
</ul>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>If the composition is invalid, e.g.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>infinitely recursive composition</p>
</li>
<li>
<p>wrong attribute overriding</p>
</li>
<li>
<p>a single attribute mapped to more than one source attribute</p>
</li>
<li>
<p>a composing and composed constraint marked as different constraint types (i.e., generic and cross-parameter)</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>a <code class="classname">ConstraintDefinitionException</code> is raised either at validation time or when the metadata is requested.</p>
</div><p></p>
</div>
<div class="paragraph">
<p>Constraint designers are encouraged to make use of composition (recursively or not) based on the built-in constraints defined by the specification. The composing constraints are exposed through the Bean Validation metadata API (<a href="#constraintmetadata-constraintdescriptor">ConstraintDescriptor</a>). This metadata is particularly useful for third-party metadata consumers like persistence frameworks generating database schemas (such as Java Persistence) or presentation frameworks.</p>
</div>
</div>
<div class="sect2">
<h3 id="constraintsdefinitionimplementation-validationimplementation"><a class="anchor" href="#constraintsdefinitionimplementation-validationimplementation"></a>3.4. Constraint validation implementation</h3>
<div class="paragraph">
<p><span class="tck-testable">A constraint validation implementation performs the validation of a given constraint annotation for a given type.</span> <span class="tck-testable">The implementation classes are specified by the <code>validatedBy</code> element of the <code class="classname">@Constraint</code> annotation that decorates the constraint definition.</span> <span class="tck-not-testable">The constraint validation implementation implements the <code class="classname">ConstraintValidator</code> interface.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Defines the logic to validate a given constraint {@code A}
 * for a given object type {@code T}.
 * &lt;p&gt;
 * Implementations must comply to the following restriction:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code T} must resolve to a non parameterized type&lt;/li&gt;
 *     &lt;li&gt;or generic parameters of {@code T} must be unbounded
 *     wildcard types&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * The annotation {@link SupportedValidationTarget} can be put on a
 * {@code ConstraintValidator} implementation to mark it as supporting
 * cross-parameter constraints. Check out {@link SupportedValidationTarget}
 * and {@link Constraint} for more information.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstraintValidator</span>&lt;A <span class="directive">extends</span> <span class="predefined-type">Annotation</span>, T&gt; {

    <span class="comment">/**
     * Initializes the validator in preparation for
     * {@link #isValid(Object, ConstraintValidatorContext)} calls.
     * The constraint annotation for a given constraint declaration
     * is passed.
     * &lt;p&gt;
     * This method is guaranteed to be called before any use of this instance for
     * validation.
     * &lt;p&gt;
     * The default implementation is a no-op.
     *
     * @param constraintAnnotation annotation instance for a given constraint declaration
     */</span>
    <span class="keyword">default</span> <span class="type">void</span> initialize(A constraintAnnotation) {
    }

    <span class="comment">/**
     * Implements the validation logic.
     * The state of {@code value} must not be altered.
     * &lt;p&gt;
     * This method can be accessed concurrently, thread-safety must be ensured
     * by the implementation.
     *
     * @param value object to validate
     * @param context context in which the constraint is evaluated
     *
     * @return {@code false} if {@code value} does not pass the constraint
     */</span>
    <span class="type">boolean</span> isValid(T value, ConstraintValidatorContext context);
}</code></pre>
</div>
</div>
<div class="paragraph tck-not-testable">
<p></p><div class="paragraph">
<p>Some restrictions apply on the generic type <code class="classname">T</code> (used in the <code class="methodname">isValid()</code> method). <code class="classname">T</code> must</p>
</div>
<div class="ulist">
<ul>
<li>
<p>resolve to a non parameterized type (i.e. because the type is not using generics or because the raw type is used instead of the generic version)</p>
</li>
<li>
<p>or generic parameters of <code class="classname">T</code> must be unbounded wildcard types (i.e. <code>&lt;?&gt;</code>).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This restriction is not a theoretical limitation and a future version of the specification might allow it.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">By default, a <code class="classname">ConstraintValidator</code> targets the (returned) element annotated by the constraint. You can make a <code class="classname">ConstraintValidator</code> target the array of parameters of a method or constructor (aka cross-parameter) by annotating the validator implementation with <code class="classname">@SupportedValidationTarget</code>.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 16. @SupportedValidationTarget annotation and ValidationTarget enum</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraintvalidation</span>;

<span class="comment">/**
 * Defines the target(s) a {@link ConstraintValidator} can validate.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * A {@code ConstraintValidator} can target the (returned) element
 * annotated by the constraint, the array of parameters of a method
 * or constructor (aka cross-parameter) or both.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * If {@code @SupportedValidationTarget} is not present, the
 * {@code ConstraintValidator} targets the (returned) element annotated
 * by the constraint.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * A {@code ConstraintValidator} targeting cross-parameter must accept
 * {@code Object[]} (or {@code Object}) as the type of object it validates.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="annotation">@Documented</span>
<span class="annotation">@Target</span>({ TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SupportedValidationTarget {

    ValidationTarget<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraintvalidation</span>;

<span class="comment">/**
 * List of possible targets for a {@link ConstraintValidator}.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ValidationTarget {

    <span class="comment">/**
     * (Returned) element annotated by the constraint.
     */</span>
    ANNOTATED_ELEMENT,

    <span class="comment">/**
     * Array of parameters of the annotated method or constructor (aka cross-parameter).
     */</span>
    PARAMETERS
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">ConstraintValidator</code> implementation can target both annotated elements and array of parameters.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a <code class="classname">ConstraintValidator</code> targets array of parameters (cross-parameter), <code class="classname">T</code> must resolve to <code class="classname">Object[]</code> (or <code class="classname">Object</code>) in order to have the array of parameter values passed to the <code class="methodname">isValid()</code> method. A <code class="classname">ConstraintDefinitionException</code> is raised otherwise.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Example of cross parameter ConstraintValidator</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@SupportedValidationTarget</span>(ValidationTarget.PARAMETERS)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ScriptAssertValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;ScriptAssert,<span class="predefined-type">Object</span><span class="type">[]</span>&gt; {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> initialize(ScriptAssert constraintAnnotation) {
        [...]
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">Object</span><span class="type">[]</span> value, ConstraintValidatorContext context) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#example-constraintsdefinitionimplementation-validationimplementation-validdef">Valid ConstraintValidator definitions</a> shows some examples of valid definitions.</p>
</div>
<div id="example-constraintsdefinitionimplementation-validationimplementation-validdef" class="exampleblock">
<div class="title">Example 18. Valid ConstraintValidator definitions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//String is not making use of generics</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForString</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">String</span>&gt; {
    [...]
}

<span class="comment">//Collection uses generics but the raw type is used</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForCollection</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">Collection</span>&gt; {
    [...]
}

<span class="comment">//Collection uses generics and unbounded windcard type</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForCollection</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">Collection</span>&lt;?&gt;&gt; {
    [...]
}

<span class="comment">//Validator for cross-parameter constraint</span>
<span class="annotation">@SupportedValidationTarget</span>(ValidationTarget.PARAMETERS)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DateParametersConsistentValidator</span>
    <span class="directive">implements</span> ConstraintValidator&lt;DateParametersConsistent, <span class="predefined-type">Object</span><span class="type">[]</span>&gt; {
    [...]
}

<span class="comment">//Validator for both annotated elements and executable parameters</span>
<span class="annotation">@SupportedValidationTarget</span>({ValidationTarget.ANNOTATED_ELEMENT, ValidationTarget.PARAMETERS})
<span class="directive">public</span> <span class="type">class</span> <span class="class">ELScriptValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;ELScript, <span class="predefined-type">Object</span>&gt; {
    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And some invalid definitions in <a href="#example-constraintsdefinitionimplementation-validationimplementation-invaliddef">Invalid ConstraintValidator definitions</a>.</p>
</div>
<div id="example-constraintsdefinitionimplementation-validationimplementation-invaliddef" class="exampleblock">
<div class="title">Example 19. Invalid ConstraintValidator definitions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//parameterized type</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForString</span> <span class="directive">implements</span>&lt;Size, <span class="predefined-type">Collection</span>&lt;<span class="predefined-type">String</span>&gt;&gt; {
    [...]
}

<span class="comment">//parameterized type using bounded wildcard</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForCollection</span> <span class="directive">implements</span>&lt;Size, <span class="predefined-type">Collection</span>&lt;? <span class="directive">extends</span> Address&gt;&gt; {
    [...]
}

<span class="comment">//cross-parameter validator accepting the wrong type</span>
<span class="annotation">@SupportedValidationTarget</span>(ValidationTarget.PARAMETERS)
<span class="directive">public</span> <span class="type">class</span> <span class="class">NumberPositiveValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;NumberPositive, <span class="predefined-type">Number</span>&gt; {
    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The lifecycle of a constraint validation implementation instance is undefined. Bean Validation providers are allowed to cache <code class="classname">ConstraintValidator</code> instances retrieved from the <code class="classname">ConstraintValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">initialize()</code> method is called by the Bean validation provider prior to any use of the constraint implementation.</span>
<span class="tck-testable">As of Bean Validation 2.0, <code>initialize()</code> has an empty default implementation,
allowing to omit the implementation from validators that don’t need to access any constraint attributes.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">isValid()</code> method is evaluated by the Bean Validation provider each time a given value is validated.</span> <span class="tck-not-testable">It returns <code>false</code> if the value is not valid, <code>true</code> otherwise.</span> <span class="tck-not-testable"><code>isValid()</code> implementations must be thread-safe.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the property is of an unanticipated type, an <code>UnexpectedTypeException</code> is raised.</span> <code class="classname">ConstraintValidator</code> implementations raise this exception themselves if they receive an unsupported type. However, constraint designers are encouraged to make use of specialized <code class="classname">ConstraintValidator</code> implementations and delegate the type resolution to the Bean Validation provider (see the type matching algorithm described in <a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution">ConstraintValidator resolution algorithm</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If an exception occurs either in the <code class="methodname">initialize()</code> or <code class="methodname">isValid()</code> method, the runtime exception is wrapped into a <code class="classname">ValidationException</code> by the Bean Validation engine.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">The constraint validation implementation is not allowed to change the state of the value passed to <code class="methodname">isValid()</code>.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>While not mandatory, it is considered a good practice to split the core constraint validation from the not null constraint validation (for example, an <code class="classname">@Email</code> constraint will return <code>true</code> on a null object, i.e. will not take care of the <code class="classname">@NotNull</code> validation).</p>
</div>
<div class="paragraph">
<p><code class="code">null</code> can have multiple meanings but is commonly used to express that a value does not make sense, is not available or is simply unknown. Those constraints on the value are orthogonal in most cases to other constraints. For example a String, if present, must be an email but can be null. Separating both concerns is a good practice.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The <code class="classname">ConstraintValidatorContext</code> object passed to the <code class="methodname">isValid()</code> method carries information and operations available in the context the constraint is validated to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Provides contextual data and operation when applying a given constraint validator.
 *
 * At least one {@link ConstraintViolation} must be defined (either the default one,
 * of if the default {@code ConstraintViolation} is disabled, a custom one).
 *
 * @author Emmanuel Bernard
 * @author Guillaume Smet
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstraintValidatorContext</span> {

    <span class="comment">/**
     * Disables the default {@link ConstraintViolation} object generation (which
     * is using the message template declared on the constraint).
     * &lt;p&gt;
     * Useful to set a different violation message or generate a {@code ConstraintViolation}
     * based on a different property.
     */</span>
    <span class="type">void</span> disableDefaultConstraintViolation();

    <span class="comment">/**
     * @return the current un-interpolated default message
     */</span>
    <span class="predefined-type">String</span> getDefaultConstraintMessageTemplate();


    <span class="comment">/**
     * Returns the provider for obtaining the current time in the form of a {@link Clock}, e.g. when validating the
     * {@code Future} and {@code Past} constraints.
     *
     * @return the provider for obtaining the current time, never {@code null}. If no specific provider has been
     * configured during bootstrap, a default implementation using the current system time and the current default time
     * zone as returned by {@link Clock#systemDefaultZone()} will be returned.
     *
     * @since 2.0
     */</span>
    ClockProvider getClockProvider();

    <span class="comment">/**
     * Returns a constraint violation builder building a violation report
     * allowing to optionally associate it to a sub path.
     * The violation message will be interpolated.
     * &lt;p&gt;
     * To create the {@link ConstraintViolation}, one must call either one of
     * the {@code addConstraintViolation()} methods available in one of the
     * interfaces of the fluent API.
     * If another method is called after {@code addConstraintViolation()} on
     * {@code ConstraintViolationBuilder} or any of its associated nested interfaces
     * an {@code IllegalStateException} is raised.
     * &lt;p&gt;
     * If {@link ConstraintValidator#isValid(Object, ConstraintValidatorContext)} returns
     * {@code false}, a {@code ConstraintViolation} object will be built per constraint
     * violation report including the default one (unless
     * {@link #disableDefaultConstraintViolation()} has been called).
     * &lt;p&gt;
     * {@code ConstraintViolation} objects generated from such a call
     * contain the same contextual information (root bean, path and so on) unless
     * the path has been overridden.
     * &lt;p&gt;
     * To create a different {@code ConstraintViolation}, a new constraint violation builder
     * has to be retrieved from {@code ConstraintValidatorContext}
     *
     * Here are a few usage examples:
     * &lt;pre&gt;
     * //assuming the following domain model
     * public class User {
     *     public Map&amp;lt;String,Address&amp;gt; getAddresses() { ... }
     * }
     *
     * public class Address {
     *     public String getStreet() { ... }
     *     public Country getCountry() { ... }
     * }
     *
     * public class Country {
     *     public String getName() { ... }
     * }
     *
     * //From a property-level constraint on User.addresses
     * //Build a constraint violation on the default path - i.e. the "addresses" property
     * context.buildConstraintViolationWithTemplate( "this detail is wrong" )
     *             .addConstraintViolation();
     *
     * //From a class level constraint on Address
     * //Build a constraint violation on the default path + "street"
     * //i.e. the street property of Address
     * context.buildConstraintViolationWithTemplate( "this detail is wrong" )
     *             .addPropertyNode( "street" )
     *             .addConstraintViolation();
     *
     * //From a property-level constraint on  User.addresses
     * //Build a constraint violation on the default path + the bean stored
     * //under the "home" key in the map
     * context.buildConstraintViolationWithTemplate( "Incorrect home address" )
     *             .addBeanNode()
     *                 .inIterable().atKey( "home" )
     *             .addConstraintViolation();
     *
     * //From a class level constraint on User
     * //Build a constraint violation on the default path + addresses["home"].country.name
     * //i.e. property "country.name" on the object stored under "home" in the map
     * context.buildConstraintViolationWithTemplate( "this detail is wrong" )
     *             .addPropertyNode( "addresses" )
     *             .addPropertyNode( "country" )
     *                 .inIterable().atKey( "home" )
     *             .addPropertyNode( "name" )
     *             .addConstraintViolation();
     * &lt;/pre&gt;
     * &lt;p&gt;
     * Cross-parameter constraints on a method can create a node specific
     * to a particular parameter if required. Let's explore a few examples:
     * &lt;pre&gt;
     * //Cross-parameter constraint on method createUser(String password, String passwordRepeat)
     * //Build a constraint violation on the default path + "passwordRepeat"
     * context.buildConstraintViolationWithTemplate("Passwords do not match")
     *             .addParameterNode(1)
     *             .addConstraintViolation();
     *
     * //Cross-parameter constraint on a method
     * //mergeAddresses(Map&amp;lt;String,Address&amp;gt; addresses, Map&amp;lt;String,Address&amp;gt; otherAddresses)
     * //Build a constraint violation on the default path + "otherAddresses["home"]
     * //i.e. the Address bean hosted in the "home" key of the "otherAddresses" map parameter
     * context.buildConstraintViolationWithTemplate(
     *         "Map entry home present in both and does not match")
     *             .addParameterNode(1)
     *             .addBeanNode()
     *                 .inIterable().atKey("home")
     *             .addConstraintViolation();
     *
     * //Cross-parameter constraint on a method
     * //mergeAddresses(Map&amp;lt;String,Address&amp;gt; addresses, Map&amp;lt;String,Address&amp;gt; otherAddresses)
     * //Build a constraint violation on the default path + "otherAddresses["home"].city
     * //i.e. on the "city" property of the Address bean hosted in
     * //the "home" key of the "otherAddresses" map
     * context.buildConstraintViolationWithTemplate(
     *         "Map entry home present in both but city does not match")
     *             .addParameterNode(1)
     *             .addPropertyNode("city")
     *                 .inIterable().atKey("home")
     *             .addConstraintViolation();
     * &lt;/pre&gt;
     *
     * @param messageTemplate new un-interpolated constraint message
     * @return returns a constraint violation builder
     */</span>
    ConstraintViolationBuilder buildConstraintViolationWithTemplate(<span class="predefined-type">String</span> messageTemplate);

    <span class="comment">/**
     * Returns an instance of the specified type allowing access to
     * provider-specific APIs. If the Bean Validation provider
     * implementation does not support the specified class,
     * {@link ValidationException} is thrown.
     *
     * @param type the class of the object to be returned
     * @param &lt;T&gt; the type of the object to be returned
     * @return an instance of the specified class
     * @throws ValidationException if the provider does not support the call
     *
     * @since 1.1
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * {@link ConstraintViolation} builder allowing to optionally associate
     * the violation report to a sub path.
     * &lt;p&gt;
     * To create the {@code ConstraintViolation}, one must call either one of
     * the {@code addConstraintViolation()} methods available in one of the
     * interfaces of the fluent API.
     * &lt;p&gt;
     * If another method is called after {@code addConstraintViolation()} on
     * {@code ConstraintViolationBuilder} or any of its associated objects
     * an {@code IllegalStateException} is raised.
     */</span>
    <span class="type">interface</span> <span class="class">ConstraintViolationBuilder</span> {

        <span class="comment">/**
         * Adds a node to the path the {@link ConstraintViolation} will be associated to.
         * &lt;p&gt;
         * {@code name} describes a single property. In particular,
         * dot (.) is not allowed.
         *
         * @param name property name
         * @return a builder representing node {@code name}
         * @deprecated since 1.1 - replaced by {@link #addPropertyNode(String)},
         *             {@link #addBeanNode()} and {@link #addParameterNode(int)}
         */</span>
        NodeBuilderDefinedContext addNode(<span class="predefined-type">String</span> name);

        <span class="comment">/**
         * Adds a property node to the path the {@link ConstraintViolation}
         * will be associated to.
         * &lt;p&gt;
         * {@code name} describes a single property. In particular,
         * dot (.) is not allowed.
         *
         * @param name property name
         * @return a builder representing node {@code name}
         * @throws IllegalArgumentException if the name is null
         *
         * @since 1.1
         */</span>
        NodeBuilderCustomizableContext addPropertyNode(<span class="predefined-type">String</span> name);

        <span class="comment">/**
         * Adds a bean node (class-level) to the path the {@link ConstraintViolation}
         * will be associated to.
         * Note that bean nodes are always leaf nodes.
         *
         * @return a builder representing the bean node
         *
         * @since 1.1
         */</span>
        LeafNodeBuilderCustomizableContext addBeanNode();

        <span class="comment">/**
         * Adds a method parameter node to the path the {@link ConstraintViolation}
         * will be associated to.
         * The parameter index must be valid (i.e. within the boundaries of the method
         * parameter indexes). May only be called from within cross-parameter validators.
         *
         * @param index the parameter index
         * @return a builder representing the index-th parameter node
         * @throws IllegalArgumentException if the index is not valid
         *
         * @since 1.1
         */</span>
        NodeBuilderDefinedContext addParameterNode(<span class="type">int</span> index);

        <span class="comment">/**
         * Adds the new {@link ConstraintViolation} to be generated if the
         * constraint validator marks the value as invalid.
         * &lt;p&gt;
         * Methods of this {@code ConstraintViolationBuilder} instance and its nested
         * objects throw {@code IllegalStateException} from now on.
         *
         * @return the {@code ConstraintValidatorContext} instance the
         *         {@code ConstraintViolationBuilder} comes from
         */</span>
        ConstraintValidatorContext addConstraintViolation();

        <span class="comment">/**
         * Represents a node whose context is known
         * (i.e. index, key and isInIterable)
         * and that is a leaf node (i.e. no subnode can be added).
         *
         * @since 1.1
         */</span>
        <span class="type">interface</span> <span class="class">LeafNodeBuilderDefinedContext</span> {

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator marks the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *         {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }

        <span class="comment">/**
         * Represents a node whose context is
         * configurable (i.e. index, key and isInIterable)
         * and that is a leaf node (i.e. no subnode can be added).
         *
         * @since 1.1
         */</span>
        <span class="type">interface</span> <span class="class">LeafNodeBuilderCustomizableContext</span> {

            <span class="comment">/**
             * Marks the node as being in an {@code Iterable} or a {@code Map}.
             *
             * @return a builder representing iterable details
             */</span>
            LeafNodeContextBuilder inIterable();

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator mark the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *         {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }

        <span class="comment">/**
         * Represents refinement choices for a node which is
         * in an {@code Iterator} or {@code Map}.
         * &lt;p&gt;
         * If the iterator is an indexed collection or a map,
         * the index or the key should be set.
         * &lt;p&gt;
         * The node is a leaf node (i.e. no subnode can be added).
         *
         * @since 1.1
         */</span>
        <span class="type">interface</span> <span class="class">LeafNodeContextBuilder</span> {

            <span class="comment">/**
             * Defines the key the object is into the {@code Map}.
             *
             * @param key map key
             * @return a builder representing the current node
             */</span>
            LeafNodeBuilderDefinedContext atKey(<span class="predefined-type">Object</span> key);

            <span class="comment">/**
             * Defines the index the object is into the {@code List} or array
             *
             * @param index index
             * @return a builder representing the current node
             */</span>
            LeafNodeBuilderDefinedContext atIndex(<span class="predefined-type">Integer</span> index);

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator mark the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *           {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }

        <span class="comment">/**
         * Represents a node whose context is known
         * (i.e. index, key and isInIterable)
         * and that is not necessarily a leaf node (i.e. subnodes can
         * be added).
         */</span>
        <span class="type">interface</span> <span class="class">NodeBuilderDefinedContext</span> {

            <span class="comment">/**
             * Adds a node to the path the {@link ConstraintViolation} will be associated to.
             * &lt;p&gt;
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @deprecated since 1.1 - replaced by {@link #addPropertyNode(String)}
             *             and {@link #addBeanNode()}
             */</span>
            NodeBuilderCustomizableContext addNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a property node to the path the {@link ConstraintViolation}
             * will be associated to.
             * &lt;p&gt;
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @throws IllegalArgumentException if the name is null
             *
             * @since 1.1
             */</span>
            NodeBuilderCustomizableContext addPropertyNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a bean node (class-level) to the path the {@link ConstraintViolation}
             * will be associated to.
             * Note that bean nodes are always leaf nodes.
             *
             * @return a builder representing the bean node
             *
             * @since 1.1
             */</span>
            LeafNodeBuilderCustomizableContext addBeanNode();

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator marks the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *           {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }

        <span class="comment">/**
         * Represents a node whose context is
         * configurable (i.e. index, key and isInIterable)
         * and that is not necessarily a leaf node (i.e. subnodes can
         * be added).
         */</span>
        <span class="type">interface</span> <span class="class">NodeBuilderCustomizableContext</span> {

            <span class="comment">/**
             * Marks the node as being in an {@code Iterable} or a {@code Map}.
             *
             * @return a builder representing iterable details
             */</span>
            NodeContextBuilder inIterable();

            <span class="comment">/**
             * Adds a node to the path the {@link ConstraintViolation} will be associated to.
             *
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @deprecated since 1.1 - replaced by {@link #addPropertyNode(String)}
             *             and {@link #addBeanNode()}
             */</span>
            NodeBuilderCustomizableContext addNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a property node to the path the {@link ConstraintViolation}
             * will be associated to.
             *
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @throws IllegalArgumentException if the name is null
             *
             * @since 1.1
             */</span>
            NodeBuilderCustomizableContext addPropertyNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a bean node (class-level) to the path the {@link ConstraintViolation}
             * will be associated to.
             * Note that bean nodes are always leaf nodes.
             *
             * @return a builder representing the bean node
             *
             * @since 1.1
             */</span>
            LeafNodeBuilderCustomizableContext addBeanNode();

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator mark the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *           {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }

        <span class="comment">/**
         * Represents refinement choices for a node which is
         * in an {@code Iterator} or {@code Map}.
         * &lt;p&gt;
         * If the iterator is an indexed collection or a map,
         * the index or the key should be set.
         * &lt;p&gt;
         * The node is not necessarily a leaf node (i.e. subnodes can
         * be added).
         */</span>
        <span class="type">interface</span> <span class="class">NodeContextBuilder</span> {

            <span class="comment">/**
             * Defines the key the object is into the {@code Map}.
             *
             * @param key map key
             * @return a builder representing the current node
             */</span>
            NodeBuilderDefinedContext atKey(<span class="predefined-type">Object</span> key);

            <span class="comment">/**
             * Defines the index the object is into the {@code List} or array.
             *
             * @param index index
             * @return a builder representing the current node
             */</span>
            NodeBuilderDefinedContext atIndex(<span class="predefined-type">Integer</span> index);

            <span class="comment">/**
             * Adds a node to the path the {@code ConstraintViolation} will be associated to.
             *
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @deprecated since 1.1 - replaced by {@link #addPropertyNode(String)}
             *             and {@link #addBeanNode()}
             */</span>
            NodeBuilderCustomizableContext addNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a property node to the path the {@link ConstraintViolation}
             * will be associated to.
             *
             * {@code name} describes a single property. In particular,
             * dot (.) is not allowed.
             *
             * @param name property name
             * @return a builder representing node {@code name}
             * @throws IllegalArgumentException if the name is null
             *
             * @since 1.1
             */</span>
            NodeBuilderCustomizableContext addPropertyNode(<span class="predefined-type">String</span> name);

            <span class="comment">/**
             * Adds a bean node (class-level) to the path the {@link ConstraintViolation}
             * will be associated to.
             * &lt;p&gt;
             * Note that bean nodes are always leaf nodes.
             *
             * @return a builder representing the bean node
             *
             * @since 1.1
             */</span>
            LeafNodeBuilderCustomizableContext addBeanNode();

            <span class="comment">/**
             * Adds the new {@link ConstraintViolation} to be generated if the
             * constraint validator mark the value as invalid.
             * &lt;p&gt;
             * Methods of the {@code ConstraintViolationBuilder} instance this object
             * comes from and the constraint violation builder nested
             * objects throw {@code IllegalStateException} after this call.
             *
             * @return {@code ConstraintValidatorContext} instance the
             *         {@code ConstraintViolationBuilder} comes from
             */</span>
            ConstraintValidatorContext addConstraintViolation();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="classname">ConstraintValidatorContext</code> interface provides access to contextual information useful for the validation of specific constraints (e.g. <code>getClockProvider()</code>, see <a href="#constraintsdefinitionimplementation-validationimplementation-temporalvalidators">Implementation of temporal constraint validators</a> ).</p>
</div>
<div class="paragraph">
<p>It also allows redefinition of the default constraint message generated when a constraint is not valid. <span class="tck-testable">By default, each invalid constraint leads to the generation of one error object represented by a <code class="classname">ConstraintViolation</code> object.
This object is built from the default constraint message template as defined by the constraint declaration and the context in which the constraint declaration is placed (bean, property, executable parameter, cross-parameter or executable return value).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="classname">ConstraintValidatorContext</code> methods let the constraint implementation disable the default <code class="classname">ConstraintViolation</code> generation and create one or more custom ones.</span> <span class="tck-testable">The non-interpolated message passed as a parameter is used to build the <code class="classname">ConstraintViolation</code> message (the message interpolation operation is applied to it).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">By default, the <code class="classname">Path</code> exposed on the <code class="classname">ConstraintViolation</code> represents the path to the bean, property, parameter, cross-parameter or return value hosting the constraint (see <a href="#validationapi-constraintviolation">ConstraintViolation</a> for more information).</span> <span class="tck-testable">You can point it to a subpath of this default path by using the constraint violation builder fluent API.</span></p>
</div>
<div class="paragraph">
<p><a href="#example-constraintsdefinitionimplementation-validationimplementation-errorbuilder">Using the fluent API to build custom constraint violations</a> shows a few examples.</p>
</div>
<div id="example-constraintsdefinitionimplementation-validationimplementation-errorbuilder" class="exampleblock">
<div class="title">Example 20. Using the fluent API to build custom constraint violations</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming the following domain model</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>,Address&gt; getAddresses() { [...] }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> getStreet() { [...] }
    <span class="directive">public</span> Country getCountry() { [...] }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Country</span> {
   <span class="directive">public</span> <span class="predefined-type">String</span> getName() { [...] }
}

<span class="comment">//From a property-level constraint on User.addresses</span>
<span class="comment">//Build a constraint violation on the default path - i.e. the "addresses" property</span>
context.buildConstraintViolationWithTemplate( <span class="string"><span class="delimiter">"</span><span class="content">this detail is wrong</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();

<span class="comment">//From a class level constraint on Address</span>
<span class="comment">//Build a constraint violation on the default path + "street"</span>
<span class="comment">//i.e. the street property of Address</span>
context.buildConstraintViolationWithTemplate( <span class="string"><span class="delimiter">"</span><span class="content">this detail is wrong</span><span class="delimiter">"</span></span> )
            .addPropertyNode( <span class="string"><span class="delimiter">"</span><span class="content">street</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();

<span class="comment">//From a property-level constraint on  User.addresses</span>
<span class="comment">//Build a constraint violation on the default path + the bean stored</span>
<span class="comment">//under the "home" key in the map</span>
context.buildConstraintViolationWithTemplate( <span class="string"><span class="delimiter">"</span><span class="content">Incorrect home address</span><span class="delimiter">"</span></span> )
            .addBeanNode()
                .inIterable().atKey( <span class="string"><span class="delimiter">"</span><span class="content">home</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();

<span class="comment">//From a class level constraint on User</span>
<span class="comment">//Build a constraint violation on the default path + addresses["home"].country.name</span>
<span class="comment">//i.e. property "country.name" on the object stored under "home" in the map</span>
context.buildConstraintViolationWithTemplate( <span class="string"><span class="delimiter">"</span><span class="content">this detail is wrong</span><span class="delimiter">"</span></span> )
            .addPropertyNode( <span class="string"><span class="delimiter">"</span><span class="content">addresses</span><span class="delimiter">"</span></span> )
            .addPropertyNode( <span class="string"><span class="delimiter">"</span><span class="content">country</span><span class="delimiter">"</span></span> )
                .inIterable().atKey( <span class="string"><span class="delimiter">"</span><span class="content">home</span><span class="delimiter">"</span></span> )
            .addPropertyNode( <span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();

<span class="comment">//To create a subnode representing a method parameter from a cross-parameter constraint violation</span>

<span class="comment">//Cross-parameter constraint on method createUser(String password, String passwordRepeat)</span>
<span class="comment">//Build a constraint violation on the default path + "passwordRepeat"</span>
context.buildConstraintViolationWithTemplate(<span class="string"><span class="delimiter">"</span><span class="content">Passwords do not match</span><span class="delimiter">"</span></span>)
            .addParameterNode(<span class="integer">1</span>)
            .addConstraintViolation();

<span class="comment">//Cross-parameter constraint on a method</span>
<span class="comment">//mergeAddresses(Map&lt;String,Address&gt; addresses, Map&lt;String,Address&gt; otherAddresses)</span>
<span class="comment">//Build a constraint violation on the default path + "otherAddresses["home"]</span>
<span class="comment">//i.e. the Address bean hosted in the "home" key of the "otherAddresses" map parameter</span>
context.buildConstraintViolationWithTemplate(
        <span class="string"><span class="delimiter">"</span><span class="content">Map entry home present in both and does not match</span><span class="delimiter">"</span></span> )
            .addParameterNode( <span class="integer">1</span> )
            .addBeanNode()
                .inIterable().atKey( <span class="string"><span class="delimiter">"</span><span class="content">home</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();

<span class="comment">//Cross-parameter constraint on a method</span>
<span class="comment">//mergeAddresses(Map&lt;String,Address&gt; addresses, Map&lt;String,Address&gt; otherAddresses)</span>
<span class="comment">//Build a constraint violation on the default path + "otherAddresses["home"].city</span>
<span class="comment">//i.e. on the "city" property of the Address bean hosted in</span>
<span class="comment">//the "home" key of the "otherAddresses" map</span>
context.buildConstraintViolationWithTemplate(
        <span class="string"><span class="delimiter">"</span><span class="content">Map entry home present in both but city does not match</span><span class="delimiter">"</span></span> )
            .addParameterNode( <span class="integer">1</span> )
            .addPropertyNode( <span class="string"><span class="delimiter">"</span><span class="content">city</span><span class="delimiter">"</span></span> )
                .inIterable().atKey( <span class="string"><span class="delimiter">"</span><span class="content">home</span><span class="delimiter">"</span></span> )
            .addConstraintViolation();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">If <code class="methodname">disableDefaultConstraintViolation()</code> is called, no custom error is added (using the error builder) and if the constraint is not valid, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="sect3">
<h4 id="constraintsdefinitionimplementation-validationimplementation-temporalvalidators"><a class="anchor" href="#constraintsdefinitionimplementation-validationimplementation-temporalvalidators"></a>3.4.1. Implementation of temporal constraint validators</h4>
<div class="paragraph">
<p><span class="tck-testable">Constraint validators for temporal constraints (either the built-in constraints <code>@Past</code> and <code>@Future</code> or custom temporal constraints) can obtain the current instant from the <code>ClockProvider</code> object exposed by <code>ConstraintValidatorContext#getClockProvider()</code>.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Contract for obtaining the {@link Clock} used as the reference for {@code now} when validating the {@code @Future}
 * and {@code @Past} constraints.
 * &lt;p&gt;
 * The default implementation will return the current system time. Plugging in custom implementations may be useful for
 * instance in batch applications which need to run with a specific logical date, e.g. with yesterday's date when
 * re-running a failed batch job execution.
 * &lt;p&gt;
 * Implementations must be safe for access from several threads at the same time.
 *
 * @author Gunnar Morling
 * @author Guillaume Smet
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ClockProvider</span> {

    <span class="comment">/**
     * Returns the clock which serves as the reference for {@code now}.
     *
     * @return the clock which serves as the reference for {@code now}; must not be {@code null}
     */</span>
    Clock getClock();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code>getClock()</code> method returns a <code>java.time.Clock</code> object which represents the current instant, date and time using a time zone.
A conforming Bean Validation implementation provides a default clock provider which returns a clock representing the current system time and default time zone.</span>
It is recommended that implementations call <code>Clock#systemDefaultZone()</code> to obtain the clock.</p>
</div>
<div class="paragraph">
<p>When bootstrapping a validator factory or validator, an alternative clock provider can be registered (see <a href="#validationapi-bootstrapping">Bootstrapping</a>).
This can be useful for testing, for applying the time zone of the currently logged in user in a multi-user, multi time zone application or for running batch applications with a logical date and time different from the actual current date and time.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintsdefinitionimplementation-validationimplementation-example"><a class="anchor" href="#constraintsdefinitionimplementation-validationimplementation-example"></a>3.4.2. Examples</h4>
<div class="exampleblock">
<div class="title">Example 21. ConstraintValidator implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Check that a text is within the authorized syntax
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SyntaxValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;Syntax, <span class="predefined-type">String</span>&gt; {
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Format</span>&gt; allowedFormats;

    <span class="comment">/**
     * Configure the constraint validator based on the elements
     * specified at the time it was defined.
     * @param constraint the constraint definition
     */</span>
    <span class="directive">public</span> <span class="type">void</span> initialize(Syntax constraint) {
        allowedFormats = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>( <span class="predefined-type">Arrays</span>.asList( constraint.value() ) );
    }

    <span class="comment">/**
     * Validate a specified value.
     * returns false if the specified value does not conform to the definition
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">String</span> value, ConstraintValidatorContext context) {
        <span class="keyword">if</span> ( value == <span class="predefined-constant">null</span> ) <span class="keyword">return</span> <span class="predefined-constant">true</span>;

        <span class="keyword">return</span> allowedFormats.size() == <span class="integer">0</span>
            || (! <span class="predefined-type">Collections</span>.disjoint( guessFormat(value), allowedFormats ) );
    }

    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Format</span>&gt; guessFormats(<span class="predefined-type">String</span> text) { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This <code class="classname">ConstraintValidator</code> checks that a text is within the accepted syntax. It also demonstrates an interesting best practice: return <code>true</code> on a null parameter.</p>
</div>
<div class="paragraph">
<p>The following listing shows a validator implementing the validation logic for a cross-parameter constraint.</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Cross-parameter validator implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Check that two date parameters of a method are in the expected order. Expects the
 * 2nd and 3rd parameter of the validated method to be of type java.util.Date.
 */</span>
<span class="annotation">@SupportedValidationTarget</span>(ValidationTarget.PARAMETERS)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DateParametersConsistentValidator</span> <span class="directive">implements</span>&lt;DateParametersConsistent, <span class="predefined-type">Object</span><span class="type">[]</span>&gt; {

    <span class="comment">/**
     * Configure the constraint validator based on the elements
     * specified at the time it was defined.
     * @param constraint the constraint definition
     */</span>
    <span class="directive">public</span> <span class="type">void</span> initialize(DateParametersConsistent constraint) {
    }

    <span class="comment">/**
     * Validate a specified value.
     * returns false if the specified value does not conform to the definition
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">Object</span><span class="type">[]</span> value, ConstraintValidatorContext context) {
        <span class="keyword">if</span> ( value.length != <span class="integer">3</span> ) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalStateException</span>( <span class="string"><span class="delimiter">"</span><span class="content">Unexpected method signature</span><span class="delimiter">"</span></span> );
        }
        <span class="comment">// one or both limits are unbounded =&gt; always consistent</span>
        <span class="keyword">if</span> ( value[<span class="integer">1</span>] == <span class="predefined-constant">null</span> || value[<span class="integer">2</span>] == <span class="predefined-constant">null</span> ) <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        <span class="keyword">return</span> ( (<span class="predefined-type">Date</span>) value[<span class="integer">1</span>] ).before( (<span class="predefined-type">Date</span>) value[<span class="integer">2</span>] );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following listing shows a validator implementing the validation logic for a constraint that is both generic and cross-parameter.</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Generic and cross-parameter validator implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Checks that an object passes the Expression Language expression
 * provided by the constraint.
 */</span>
<span class="annotation">@SupportedValidationTarget</span>({ValidationTarget.ANNOTATED_ELEMENT, ValidationTarget.PARAMETERS})
<span class="directive">public</span> <span class="type">class</span> <span class="class">ELScriptValidator</span> <span class="directive">implements</span>&lt;ELScript, <span class="predefined-type">Object</span>&gt; {

    <span class="directive">public</span> <span class="type">void</span> initialize(ELScript constraint) {
        [...]
    }

    <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">Object</span> value, ConstraintValidatorContext context) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The next example shows how to use <code class="classname">ConstraintValidatorContext</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. Use of ConstraintValidatorContext</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Check that a text is within the authorized syntax
 * Error messages are using either key:
 *  - com.acme.constraint.Syntax.unknown if no particular syntax is detected
 *  - com.acme.constraint.Syntax.unauthorized if the syntax is not allowed
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FineGrainedSyntaxValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;Syntax, <span class="predefined-type">String</span>&gt; {
    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Format</span>&gt; allowedFormats;

    <span class="comment">/**
     * Configure the constraint validator based on the elements
     * specified at the time it was defined.
     * @param constraint the constraint definition
     */</span>
    <span class="directive">public</span> <span class="type">void</span> initialize(Syntax constraint) {
        allowedFormats = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>( <span class="predefined-type">Arrays</span>.asList( constraint.value() ) );
    }

    <span class="comment">/**
     * Validate a specified value.
     * returns false if the specified value does not conform to the definition
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">String</span> value, ConstraintValidatorContext context) {
        <span class="keyword">if</span> ( value == <span class="predefined-constant">null</span> ) <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Format</span>&gt; guessedFormats = guessFormats(value);

        context.disableDefaultConstraintViolation();
        <span class="keyword">if</span> ( guessedFormats.size() == <span class="integer">0</span> ) {
            <span class="predefined-type">String</span> unknown = <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.Syntax.unknown}</span><span class="delimiter">"</span></span>;
            context.buildConstraintViolationWithTemplate(unknown)
                       .addConstraintViolation();
            <span class="keyword">return</span> <span class="predefined-constant">false</span>;
        }
        <span class="keyword">if</span> ( allowedFormats.size() != <span class="integer">0</span>
            &amp;&amp; <span class="predefined-type">Collections</span>.disjoint( guessedFormats, allowedFormats ) ) {

            <span class="predefined-type">String</span> unauthorized = <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.Syntax.unauthorized}</span><span class="delimiter">"</span></span>;
            context.buildConstraintViolationWithTemplate(unauthorized)
                       .addConstraintViolation();
            <span class="keyword">return</span> <span class="predefined-constant">false</span>;
        }
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }

    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Format</span>&gt; guessFormats(<span class="predefined-type">String</span> text) { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The default error message is disabled and replaced by a specific error message depending on the type of constraint violation detected. In this case, only one error report is returned at a given time but a constraint validation implementation can return several error reports.</p>
</div>
<div class="paragraph">
<p>The following example shows how to obtain the current date and time via the <code>ClockProvider</code> when validating a temporal constraint such as <code>@Past</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 25. Validation of a temporal constraint</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Validates that the given {@link ZonedDateTime} is in the past.
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PastValidatorForZonedDateTime</span> <span class="directive">implements</span> ConstraintValidator&lt;Past, ZonedDateTime&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> initialize(Past constraintAnnotation) {
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> isValid(ZonedDateTime value, ConstraintValidatorContext context) {
        <span class="keyword">if</span> ( value == <span class="predefined-constant">null</span> ) {
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }

        ZonedDateTime now = ZonedDateTime.now( context.getClockProvider().getClock() );

        <span class="keyword">return</span> value.isBefore( now );
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintsdefinitionimplementation-constraintfactory"><a class="anchor" href="#constraintsdefinitionimplementation-constraintfactory"></a>3.5. The ConstraintValidatorFactory</h3>
<div class="paragraph">
<p>Constraint validation implementation instances are created by a <code class="classname">ConstraintValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p>The lifecycle of <code class="classname">ConstraintValidator</code> instances is fully dependent of the Bean Validation provider and piloted by the <code class="classname">ConstraintValidatorFactory</code> methods. Therefore, <code class="classname">ConstraintValidatorFactory</code> implementations (such as dependency injection frameworks) must consider these instances as belonging to a dependent scope. <span class="tck-not-testable">Bean Validation providers must release each instance retrieved. The <code class="classname">ConstraintValidatorFactory</code> instance that has created a <code class="classname">ConstraintValidator</code> instance must be the one that releases it. In other words, passing an instance of <code class="classname">ConstraintValidator</code> to a <code class="classname">ConstraintValidatorFactory</code> that has not created it is an error.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code class="classname">ConstraintValidator</code> instances created by the <code class="classname">ValidatorFactory</code> -level <code class="classname">ConstraintValidatorFactory</code> can be released when the <code class="classname">ValidatorFactory</code> is being closed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 26. ConstraintValidatorFactory interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Instantiates a {@link ConstraintValidator} instance based off its class.
 * The {@code ConstraintValidatorFactory} is &lt;b&gt;not&lt;/b&gt; responsible
 * for calling {@link ConstraintValidator#initialize(java.lang.annotation.Annotation)}.
 *
 * @author Dhanji R. Prasanna
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstraintValidatorFactory</span> {

    <span class="comment">/**
     * @param key The class of the constraint validator to instantiate
     * <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">&lt;</span><span class="rcl-da">T</span><span class="rcl-da">&gt;</span> <span class="rcl-da">The</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">constraint</span> <span class="rcl-da">validator</span> <span class="rcl-da">to</span> <span class="rcl-da">instantiate</span>
     *
     <span class="rcl-da">*</span> @return A new constraint validator instance of the specified class
     */</span>
    &lt;T <span class="directive">extends</span> ConstraintValidator&lt;?, ?&gt;&gt; T getInstance(<span class="predefined-type">Class</span>&lt;T&gt; key);

    <span class="comment">/**
     * Signals {@code ConstraintValidatorFactory} that the instance is no longer
     * being used by the Bean Validation provider.
     *
     * @param instance validator being released
     *
     * @since 1.1
     */</span>
    <span class="type">void</span> releaseInstance(ConstraintValidator&lt;?, ?&gt; instance);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The default <code class="classname">ConstraintValidatorFactory</code> provided by the Bean Validation provider implementation uses the public no-arg constructor of the <code class="classname">ConstraintValidator</code> class.</span> A custom <code class="classname">ConstraintValidatorFactory</code> can be provided; for example it may benefit from dependency injection control in constraint implementations (see <a href="#validationapi-bootstrapping-usageandcontainerexpectation">Bootstrapping considerations</a>). Any constraint implementation relying on <code class="classname">ConstraintValidatorFactory</code> behaviors specific to an implementation (dependency injection, no no-arg constructor and so on) is not portable, hence great care should be given before walking that path. Make sure to configure the Bean Validation provider to honor any specific needs your <code class="classname">ConstraintValidator</code> has. As constraint designer and writer, make sure to document any specific non compliant requirements.</p>
</div>
<div class="paragraph">
<p><code class="classname">ConstraintValidatorFactory</code> should not cache instances as the state of each instance can be altered in the <code class="methodname">initialize()</code> method.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If an exception occurs in the factory while retrieving the <code class="classname">ConstraintValidator</code> instance, the runtime exception is wrapped in a <code class="classname">ValidationException</code>.</span> <span class="tck-testable">If the instance returned by the factory is null, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraintdeclarationvalidationprocess"><a class="anchor" href="#constraintdeclarationvalidationprocess"></a>4. Constraint declaration and validation process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Bean Validation specification defines a framework for declaring constraints on JavaBean classes, fields and properties. Constraints are declared on types and evaluated against instances or graphs of instances.</p>
</div>
<div class="paragraph">
<p>Bean Validation also offers a way to declare constructor and method constraints where parameters and return values are the constrained elements. We will discuss method constraints declaration in detail in <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints">Method and constructor constraints</a>.</p>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-requirements"><a class="anchor" href="#constraintdeclarationvalidationprocess-requirements"></a>4.1. Requirements on classes to be validated</h3>
<div class="paragraph">
<p>Objects hosting constraints and expecting to be validated by Bean Validation providers must fulfill the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Properties to be validated must follow the method signature conventions for JavaBeans read properties, as defined by the <a href="http://download.oracle.com/otndocs/jcp/7224-javabeans-1.01-fr-spec-oth-JSpec/">JavaBeans specification</a>. These properties are commonly referred as getters.</span></p>
</li>
<li>
<p><span class="tck-not-testable">Static fields and static methods are excluded from validation.</span></p>
</li>
<li>
<p><span class="tck-testable">Constraints can be applied to interfaces and superclasses.</span></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">What is a getter?</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The JavaBeans specification specifies that a getter is a method whose</p>
</div>
<div class="ulist">
<ul>
<li>
<p>name starts with <code>get</code> and has a return type but no parameter</p>
</li>
<li>
<p>name starts with <code>is</code>, has no parameter and is returning <code class="classname">boolean</code></p>
</li>
</ul>
</div><p></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The target of an annotation definition can be a field, property, type, constructor or method return value, constructor or method parameter or constructor or method cross-parameter provided that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the constraint definition supports the specified target (<code class="classname">java.lang.annotation.Target</code>)</p>
</li>
<li>
<p>one of the <code class="classname">ConstraintValidator</code>s declared on the constraint supports the declared type of the target or in the case of cross-parameter, one cross-parameter <code class="classname">ConstraintValidator</code> is present (see <a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution">ConstraintValidator resolution algorithm</a> to learn about <code class="classname">ConstraintValidator</code> resolution).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-requirements-objectvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-requirements-objectvalidation"></a>4.1.1. Object validation</h4>
<div class="paragraph">
<p><span class="tck-testable">Constraint declarations can be applied to a class or an interface.</span> <span class="tck-testable">Applying a constraint to a class or interface expresses a validation over the state of the class or the class implementing the interface.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-requirements-propertyvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-requirements-propertyvalidation"></a>4.1.2. Field and property validation</h4>
<div class="paragraph">
<p><span class="tck-testable">Constraint declarations can be applied on both fields and properties for the same object type.</span> <span class="tck-testable">The same constraint should however not be duplicated between a field and its associated property (the constraint validation would be applied twice).</span> It is recommended for objects holding constraint declarations to adhere to a single state access strategy (either annotated fields or properties).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Java Persistence and Bean Validation</div>
<div class="paragraph">
<p>For maximum portability, persistent properties hosting Bean Validation constraints should use the same access strategy used in Java Persistence. In other words, place your Bean Validation constraint annotations on the same element (field or getter) as your Java Persistence annotations.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">When a field is annotated with a constraint declaration, field access strategy is used to access the state validated by such constraint.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When a property is annotated with a constraint declaration, property access strategy is used to access the state validated by such constraint.</span></p>
</div>
<div class="paragraph">
<p>When using field access strategy, the Bean Validation provider accesses the instance variable directly. When using the property access strategy, the Bean Validation provider accesses the state via the property accessor method. It is required that the class follows the method signature conventions for JavaBeans read properties (as defined by the JavaBeans <code class="classname">Introspector</code> class) for constrained properties when constrained properties are used. In this case, for every constraint property of type <code class="classname">T</code>, there is a getter method named <code class="methodname">get&lt;Property-name&gt;</code>. The method must have no parameters. For <code class="code">boolean</code> properties, <code class="methodname">is&lt;Property-name&gt;</code> is an alternative name for the getter method. Specifically, if <code class="methodname">getX</code> is the name of the getter method, where <code class="classname">X</code> is a string, the name of the persistent property is defined by the result of <code class="code">java.beans.Introspector.decapitalize(X)</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The fields or methods visibility are not constrained.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-requirements-graphvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-requirements-graphvalidation"></a>4.1.3. Graph validation</h4>
<div class="paragraph">
<p>In addition to supporting instance validation, validation of graphs of objects is also supported. The result of a graph validation is returned as a unified set of constraint violations. <code class="classname">@Valid</code> is used to express validation traversal of an association.</p>
</div>
<div class="exampleblock">
<div class="title">Example 27. <code class="classname">@Valid</code> annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Marks a property, method parameter or method return type for validation cascading.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Constraints defined on the object and its properties are be validated when the
 * property, method parameter or method return type is validated.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * This behavior is applied recursively.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, CONSTRUCTOR, PARAMETER<span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> Valid {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">Consider the situation where bean <code class="classname">X</code> contains a field of type <code class="classname">Y</code>. By annotating field <code class="classname">Y</code> with the <code class="classname">@Valid</code> annotation, the Validator will validate <code class="classname">Y</code> (and its properties) when <code class="classname">X</code> is validated.</span> <span class="tck-testable">The exact type <code class="classname">Z</code> of the value contained in the field declared of type <code class="classname">Y</code> (subclass, implementation) is determined at runtime. The constraint definitions of <code class="classname">Z</code> are used.</span> This ensures proper polymorphic behavior for associations marked <code class="classname">@Valid</code>.</p>
</div>
<div class="paragraph">
<p>Collection-valued, array-valued and generally <code class="classname">Iterable</code> fields and properties may also be decorated with the <code class="classname">@Valid</code> annotation. This causes the contents of the iterator to be validated. <span class="tck-testable">Any object implementing <code class="classname">java.lang.Iterable</code> is supported.</span> This includes specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">arrays of objects</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">java.util.Collection</code></span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">java.util.Set</code></span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">java.util.List</code></span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">java.util.Map</code></span> (special treatment see below)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">Each object provided by the iterator is validated.</span> <span class="tck-testable">For <code class="classname">Map</code>, the value (retrieved by <code class="methodname">getValue</code>) of each <code class="classname">Map.Entry</code> is validated (the key is not validated).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Like regular references, its type is determined at runtime and the constraint definitions for this particular type are used.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="classname">@Valid</code> annotation is applied recursively.</span> A conforming implementation avoids infinite loops according to the rules described in <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-constraintdeclaration"><a class="anchor" href="#constraintdeclarationvalidationprocess-constraintdeclaration"></a>4.2. Constraint declaration</h3>
<div class="paragraph">
<p>Constraint declarations are placed on classes or interfaces primarily through annotations. A constraint annotation (see <a href="#constraintsdefinitionimplementation-constraintdefinition">Constraint annotation</a>), can be applied to a type, on any of the type’s fields or on any of the JavaBeans-compliant properties.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When a constraint is defined on a class, the class instance being validated is passed to the <code class="classname">ConstraintValidator</code>. When a constraint is defined on a field, the value of the field is passed to the <code class="classname">ConstraintValidator</code>. When a constraint is defined on a getter, the result of the getter invocation is passed to the <code class="classname">ConstraintValidator</code>.</span></p>
</div>
<div class="paragraph">
<p><a href="#constraintdeclarationvalidationprocess-methodlevelconstraints">Method and constructor constraints</a> discusses in detail constraints on methods and constructors.</p>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-inheritance"><a class="anchor" href="#constraintdeclarationvalidationprocess-inheritance"></a>4.3. Inheritance (interface and superclass)</h3>
<div class="paragraph">
<p><span class="tck-testable">A constraint declaration can be placed on an interface.</span> <span class="tck-testable">For a given class, constraint declarations held on superclasses as well as interfaces are evaluated by the Bean Validation provider.</span> Rules are formally described in <a href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition">Formal group definitions</a>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The effect of constraint declarations is cumulative. Constraints declared on a superclass getter will be validated along with any constraints defined on an overridden version of the getter according to the Java Language Specification visibility rules.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-groupsequence"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence"></a>4.4. Group and group sequence</h3>
<div class="paragraph">
<p>A group defines a subset of constraints. Instead of validating all constraints for a given object graph, only a subset is validated. This subset is defined by the group or groups targeted. Each constraint declaration defines the list of groups it belongs to. <span class="tck-testable">If no group is explicitly declared, a constraint belongs to the <code class="classname">Default</code> group.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Groups are represented by interfaces.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 28. Definition of groups</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Validation group verifing that a user is billable
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Billable</span> {}

<span class="comment">/**
 * Customer can buy without any harrassing checking process
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BuyInOneClick</span> {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">A constraint can belong to one or more groups.</span></p>
</div>
<div id="example-assigngrouptoconstraints" class="exampleblock">
<div class="title">Example 29. Assign groups to constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * User representation
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> firstname;

    <span class="annotation">@NotNull</span>(groups = Default.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastname;

    <span class="annotation">@NotNull</span>(groups = {Billable.class, BuyInOneClick.class})
    <span class="directive">private</span> CreditCard defaultCreditCard;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">During the validation call, one or more groups are validated. All the constraints belonging to this set of groups is evaluated on the object graph.</span> In <a href="#example-assigngrouptoconstraints">Assign groups to constraints</a>, <code class="classname">@NotNull</code> is checked on <code>defaultCreditCard</code> when either the <code class="classname">Billable</code> or <code class="classname">BuyInOneClick</code> group is validated. <code class="classname">@NotNull</code> on <code>firstname</code> and <code>lastname</code> are validated when the <code class="classname">Default</code> group is validated. Reminder: constraints held on superclasses and interfaces are considered.</p>
</div>
<div class="paragraph">
<p><code class="classname">Default</code> is a group predefined by the specification.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.groups</span>;

<span class="comment">/**
 * Default Bean Validation group.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Unless a list of groups is explicitly defined:
 * &lt;ul&gt;
 *     &lt;li&gt;constraints belong to the {@code Default} group&lt;/li&gt;
 *     &lt;li&gt;validation applies to the {@code Default} group&lt;/li&gt;
 * &lt;/ul&gt;
 * Most structural constraints should belong to the default group.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Default</span> {
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-groupinheritance"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-groupinheritance"></a>4.4.1. Group inheritance</h4>
<div class="paragraph">
<p>In some situations, a group is a superset of one or more groups. This can be described by Bean Validation. <span class="tck-testable">A group may inherit one or more groups by using interface inheritance.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 30. Groups can inherit other groups</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Customer can buy without harrassing checking process
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BuyInOneClick</span> <span class="directive">extends</span> Default, Billable {}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">For a given interface <code class="classname">Z</code>, constraints marked as belonging to the group <code class="classname">Z</code> (i.e. where the annotation element <code class="methodname">groups</code> contains the interface <code class="classname">Z</code>) or any of the super interfaces of <code class="classname">Z</code> (inherited groups) are considered part of the group <code class="classname">Z</code>.</span></p>
</div>
<div class="paragraph">
<p>In the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 31. Use of a inherited group</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * User representation
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> firstname;

    <span class="annotation">@NotNull</span>(groups = Default.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastname;

    <span class="annotation">@NotNull</span>(groups = Billable.class)
    <span class="directive">private</span> CreditCard defaultCreditCard;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>validating the group <code class="classname">BuyInOneClick</code> will lead to the following constraints checking:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">@NotNull</code> on <code>firstname</code> and <code>lastname</code></p>
</li>
<li>
<p><code class="classname">@NotNull</code> on <code>defaultCreditCard</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>because <code class="classname">Default</code> and <code class="classname">Billable</code> are superinterfaces of <code class="classname">BuyInOneClick</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-groupsequence"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-groupsequence"></a>4.4.2. Group sequence</h4>
<div class="paragraph">
<p><span class="tck-not-testable">By default, constraints are evaluated in no particular order regardless of which groups they belong to.</span> It is however useful in some situations to control the order of constraints evaluation. There are often scenarios where a preliminary set of constraints should be evaluated prior to other constraints. Here are two examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The second group depends on a stable state to run properly. This stable state is verified by the first group.</p>
</li>
<li>
<p>The second group is a heavy consumer of time, CPU or memory and its evaluation should be avoided if possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement such ordering, a group can be defined as a sequence of other groups. <span class="tck-testable">Each group in a group sequence must be processed sequentially in the order defined by <code class="methodname">@GroupSequence.value</code> when the group defined as a sequence is requested.</span> <span class="tck-testable">Note that a group member of a sequence can itself be composed of several groups via inheritance or sequence definition. In this case, each composed group must respect the sequence order as well.</span></p>
</div>
<div class="paragraph">
<p>Processing a group is defined in <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a> ; <span class="tck-testable">if one of the groups processed in the sequence generates one or more constraint violations, the groups following in the sequence must not be processed.</span> This ensures that a set of constraints is evaluated only if another set of constraints is valid.</p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>Groups defining a sequence and groups composing a sequence must not be involved in a cyclic dependency:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either directly or indirectly</p>
</li>
<li>
<p>either through cascaded sequence definitions or group inheritance</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a group containing such a circularity is evaluated, a <code class="classname">GroupDefinitionException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Groups defining a sequence should not directly inherit other groups. In other words, the interface hosting the group sequence should not have any super interface.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Groups defining a sequence should not be used directly in constraint declarations.</span> In other words, the interface hosting the group sequence should not be used in a constraint declaration.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">To define a group as a sequence, the interface must be annotated with the <code class="classname">@GroupSequence</code> annotation.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Defines group sequence.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * The interface hosting {@code @GroupSequence} is representing
 * the group sequence.
 * When hosted on a class, represents the {@link Default} group
 * for that class.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="annotation">@Target</span>({ TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> GroupSequence {

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is a usage example:</p>
</div>
<div id="example-groupsequence" class="exampleblock">
<div class="title">Example 32. Make use of group sequence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@ZipCodeCoherenceChecker</span>(groups = Address.HighLevelCoherence.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max = <span class="integer">50</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> street1;

    <span class="annotation">@NotNull</span> <span class="annotation">@ZipCode</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max = <span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="comment">/**
     * check coherence on the overall object
     * Needs basic checking to be green first
     */</span>
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">HighLevelCoherence</span> {}

    <span class="comment">/**
     * check both basic constraints and high level ones.
     * high level constraints are not checked if basic constraints fail
     */</span>
    <span class="annotation">@GroupSequence</span>({Default.class, HighLevelCoherence.class})
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">Complete</span> {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In <a href="#example-groupsequence">Make use of group sequence</a>, when the <code class="classname">Address.Complete</code> group is validated, all constraints belonging to the <code class="classname">Default</code> group are validated. If any of them fail, the validation skips the <code class="classname">HighLevelCoherence</code> group. If all <code class="classname">Default</code> constraints pass, <code class="classname">HighLevelCoherence</code> constraints are evaluated.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><span class="tck-testable">A given constraint can belong to two or more groups ordered by a sequence. In this case, the constraint is evaluated as part of the first group and ignored in the subsequent group(s).</span> See <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a> for more information.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-redefiningdefaultgroup"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-redefiningdefaultgroup"></a>4.4.3. Redefining the Default group for a class</h4>
<div class="paragraph">
<p>In <a href="#example-groupsequence">Make use of group sequence</a>, validating the <code class="classname">Default</code> group does not validate <code class="classname">HighLevelCoherence</code> constraints. To ensure a complete validation, a user must use the <code class="classname">Complete</code> group. This breaks some of the encapsulation you could expect. You can work around this by redefining what the <code class="classname">Default</code> group means for a given class. <span class="tck-testable">To redefine <code class="classname">Default</code> for a class, place a <code class="classname">@GroupSequence</code> annotation on the class; this sequence expresses the sequence of groups that does substitute <code class="classname">Default</code> for this class.</span></p>
</div>
<div id="example-overridedefaultgroup" class="exampleblock">
<div class="title">Example 33. Redefining Default group for Address</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GroupSequence</span>({Address.class, HighLevelCoherence.class})
<span class="annotation">@ZipCodeCoherenceChecker</span>(groups = Address.HighLevelCoherence.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max = <span class="integer">50</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> street1;

    <span class="annotation">@NotNull</span> <span class="annotation">@ZipCode</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max = <span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="comment">/**
     * check coherence on the overall object
     * Needs basic checking to be green first
     */</span>
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">HighLevelCoherence</span> {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In <a href="#example-overridedefaultgroup">Redefining Default group for Address</a>, when an address object is validated for the group <code class="classname">Default</code>, all constraints belonging to the group <code class="classname">Default</code> and hosted on <code class="classname">Address</code> are evaluated. If none fails, all <code class="classname">HighLevelCoherence</code> constraints present on <code class="classname">Address</code> are evaluated. In other words, when validating the <code class="classname">Default</code> group for <code class="classname">Address</code>, the group sequence defined on the <code class="classname">Address</code> class is used.</p>
</div>
<div class="paragraph">
<p>Since sequences cannot have circular dependencies, using <code class="classname">Default</code> in the declaration of a sequence is not an option. <span class="tck-not-testable">Constraints hosted on a class <code class="classname">A</code> and belonging to the <code class="classname">Default</code> group (by default or explicitly) implicitly belong to the group <code class="classname">A</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A sequence defined on a class <code class="classname">A</code> (i.e. redefining the <code class="classname">Default</code> groups for the class) must contain the group <code class="classname">A</code>.</span> In other words, the default constraints hosted on a class must be part of the sequence definition. <span class="tck-testable">If a <code class="classname">@GroupSequence</code> redefining the <code class="classname">Default</code> group for a class <code class="classname">A</code> does not contain the group <code class="classname">A</code>, a <code class="classname">GroupDefinitionException</code> is raised when the class is validated or when its metadata is requested.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-implicitgrouping"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-implicitgrouping"></a>4.4.4. Implicit grouping</h4>
<div class="paragraph">
<p>It is possible to implicitly group several constraints in the same group without explicitly listing such a group in the constraint declaration. <span class="tck-testable">Every constraint hosted on an interface <code class="classname">Z</code> and part of the <code class="classname">Default</code> group (implicitly or explicitly) belongs to the group <code class="classname">Z</code>.</span> This is useful to validate the partial state of an object based on a role represented by an interface.</p>
</div>
<div class="exampleblock">
<div class="title">Example 34. Example of interface / group hosting constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Auditable object contract
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Auditable</span> {
    <span class="annotation">@NotNull</span> <span class="predefined-type">String</span> getCreationDate();
    <span class="annotation">@NotNull</span> <span class="predefined-type">String</span> getLastUpdate();
    <span class="annotation">@NotNull</span> <span class="predefined-type">String</span> getLastModifier();
    <span class="annotation">@NotNull</span> <span class="predefined-type">String</span> getLastReader();
}

<span class="comment">/**
 * Represents an order in the system
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> <span class="directive">implements</span> Auditable {
    <span class="directive">private</span> <span class="predefined-type">String</span> creationDate;
    <span class="directive">private</span> <span class="predefined-type">String</span> lastUpdate;
    <span class="directive">private</span> <span class="predefined-type">String</span> lastModifier;
    <span class="directive">private</span> <span class="predefined-type">String</span> lastReader;

    <span class="directive">private</span> <span class="predefined-type">String</span> orderNumber;

    <span class="directive">public</span> <span class="predefined-type">String</span> getCreationDate() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.creationDate;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastUpdate() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.lastUpdate;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastModifier() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.lastModifier;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastReader() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.lastReader;
    }

    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">10</span>, max=<span class="integer">10</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getOrderNumber() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.orderNumber;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When an <code class="classname">Order</code> object is validated on the <code class="classname">Default</code> group, the following constraints are validated: <code class="classname">@NotNull</code> on <code class="methodname">getCreationDate</code>, <code class="methodname">getLastUpdate</code>, <code class="methodname">getLastModifier</code>, <code class="methodname">getLastReader</code>, <code class="methodname">getOrderNumber</code> and <code class="classname">@Size</code> on <code class="methodname">getOrderNumber</code> as all belong to the <code class="classname">Default</code> group.</p>
</div>
<div class="paragraph">
<p>When an <code class="classname">Order</code> object is validated on the <code class="classname">Auditable</code> group, the following constraints are validated: <code class="classname">@NotNull</code> on <code class="methodname">getCreationDate</code>, <code class="methodname">getLastUpdate</code>, <code class="methodname">getLastModifier</code>, <code class="methodname">getLastReader</code>. Only the constraints present on <code class="classname">Auditable</code> (and any of its super interfaces) and belonging to the <code class="classname">Default</code> group are validated when the group <code class="classname">Auditable</code> is requested. It allows the caller to validate that a given object can be safely audited even if the object state itself is not valid.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-groupconversion"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion"></a>4.4.5. Group conversion</h4>
<div class="paragraph">
<p>When performing cascading validation, it is possible to use a different group than the one originally requested using the group conversion feature. Group conversions are declared by using the <code class="classname">@ConvertGroup</code> annotation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 35. @ConvertGroup annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.groups</span>;

<span class="comment">/**
 * Converts group {@code from} to group {@code to} during cascading.
 * &lt;p&gt;
 * Can be used everywhere {@link Valid} is used and must be on an element
 * annotated with {@code Valid}.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="annotation">@Target</span>({ TYPE, METHOD, FIELD, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="directive">public</span> <span class="annotation">@interface</span> ConvertGroup {

    <span class="predefined-type">Class</span>&lt;?&gt; from();

    <span class="predefined-type">Class</span>&lt;?&gt; to();

    <span class="comment">/**
     * Defines several {@link ConvertGroup} annotations
     * on the same element.
     */</span>
    <span class="annotation">@Target</span>({ TYPE, METHOD, FIELD, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        ConvertGroup<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">@ConvertGroup</code> and <code class="classname">@ConvertGroup.List</code> can be used everywhere <code class="classname">@Valid</code> can be used (associations, method/constructor parameters and return value). If these annotations are used without <code class="classname">@Valid</code>, a <code class="classname">ConstraintDeclarationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p>When an element is annotated with <code class="classname">@Valid</code>, validation is propagated. <span class="tck-testable">Groups are passed as is to the nested elements unless the <code class="classname">@ConvertGroup</code> annotation is used.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the group expected to be passed to the nested element validation is defined as the <code>from</code> attribute of a <code class="classname">@ConvertGroup</code> annotation, the group used to effectively validate the nested element is the corresponding group defined in the <code>to</code> attribute.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Rules are not executed recursively.</span> If a rule is found matching, subsequent rules are no longer evaluated. In particular, if a set of <code class="classname">@ConvertGroup</code> declaration chains group <code>A</code> to <code>B</code> and <code>B</code> to <code>C</code>, the group <code>A</code> will be converted to <code>B</code> and not to <code>C</code>. This both makes rules clearer and let you switch two groups.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">It is not legal to have more than one conversion rule containing the same <code>from</code> value. In this case, a <code class="classname">ConstraintDeclarationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Like regular constraint declarations, the <code>from</code> attribute cannot refer to a group sequence. A <code class="classname">ConstraintDeclarationException</code> is raised in this situation.</span> <span class="tck-testable">The <code>to</code> attribute can. The group sequence will then be expanded before validating the associated object.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When validation is done, group sequences are expanded before validating the object and its cascaded objects with the expected groups. Group conversion on an associated object happens on the already expanded groups.</p>
</div>
<div class="paragraph">
<p>The group referred to in <code class="methodname">@ConvertGroup.from</code> works on expanded groups (i.e., after the group sequence has been expanded), not necessarily groups passed to the various <code class="methodname">validate</code> methods.</p>
</div>
<div class="paragraph">
<p>The group referred to in <code class="methodname">@ConvertGroup.to</code> will be expanded before validating the cascaded object just like a call to the various <code class="methodname">validate</code> method would have done.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Like most Bean Validation error cases, an illegal set of rules can be discovered statically (at compile time). For example, an annotation processor could detect such errors.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Group circularity in a group conversion are not problematic because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only one rule is applied for a given cascade (rules are not applied recursively)</p>
</li>
<li>
<p>validation cascading is stopped when the same instance / property is validated with the same group in a given path (existing rule)</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">@ConvertGroup</code> and <code class="classname">@ConvertGroup.List</code> can only be placed where <code class="classname">@Valid</code> is present to ensure proper respect of the Liskov substitution principle:</span> if rules were to be defined on an overriding method of a method marked as cascading validation, the rules could end up altering the list of constraints validated by the super type and thus violating the Liskov substitution principle.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Likewise, if a sub type overrides/implements a method originally defined in several parallel types of the hierarchy (e.g. two interfaces not extending each other, or a class and an interface not implemented by said class) and if that method’s return value has been marked for cascading validation in one of the parallel types, no group conversion rule may be declared for that method’s return value in the parallel types of the hierarchy.</span> This again is to avoid an unexpected altering of the post conditions to be guaranteed to the caller.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If any of these rules is violated, a <code class="classname">ConstraintDeclarationException</code> is raised by default as defined in <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance">Method constraints in inheritance hierarchies</a>.</span></p>
</div>
<div class="paragraph">
<p>Group conversion is quite useful to facilitate object graph reuse without spreading the validation group definitions across several layers. Let’s look at an example.</p>
</div>
<div class="sect4">
<h5 id="constraintdeclarationvalidationprocess-groupsequence-groupconversion-examples"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion-examples"></a><span class="rcl-da">4.4.5.1</span><span class="rcl-da">.</span> Group conversion examples</h5>
<div class="paragraph">
<p>In this example we will reuse the <code class="classname">Address</code> group split and match it to the <code class="classname">User</code> group split.</p>
</div>
<div class="exampleblock">
<div class="title">Example 36. Example of group conversion</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Complete</span> <span class="directive">extends</span> Default {}
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BasicPostal</span> {}
<span class="directive">public</span> <span class="type">interface</span> <span class="class">FullPostal</span> <span class="directive">extends</span> BasicPostal {}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span>(groups=BasicPostal.class)
    <span class="predefined-type">String</span> street1;

    <span class="predefined-type">String</span> street2;

    <span class="annotation">@ZipCode</span>(groups=BasicPostal.class)
    <span class="predefined-type">String</span> zipCode;

    <span class="annotation">@CodeChecker</span>(groups=FullPostal.class)
    <span class="predefined-type">String</span> doorCode;
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {
    <span class="annotation">@Valid</span>
    <span class="annotation">@ConvertGroup</span>.List( {
        <span class="annotation">@ConvertGroup</span>(from=Default.class, to=BasicPostal.class),
        <span class="annotation">@ConvertGroup</span>(from=Complete.class, to=FullPostal.class)
    } )
    <span class="predefined-type">Set</span>&lt;Address&gt; getAddresses() { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When validating an instance of <code class="classname">User</code> with the <code class="classname">Default</code> group, the associated addresses are validated with the <code class="classname">BasicPostal</code> group. When validating an instance of <code class="classname">User</code> with the <code class="classname">Complete</code> group, the associated addresses are validated with the <code class="classname">FullPostal</code> group.</p>
</div>
<div class="paragraph">
<p>The following example shows an illegal declaration of a group conversion rule on a method’s return value:</p>
</div>
<div class="exampleblock">
<div class="title">Example 37. Example of an illegal group conversion</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">interface</span> <span class="class">BasicPostal</span> {}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> { [...] }

<span class="directive">public</span> <span class="type">interface</span> <span class="class">RetailOrderService</span> {

    <span class="annotation">@Valid</span>
    Order placeOrder(<span class="predefined-type">String</span> itemNo, <span class="type">int</span> quantity);
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">B2BOrderService</span> {

    <span class="annotation">@Valid</span>
    <span class="annotation">@ConvertGroup</span>(from=Default.class, to=BasicPostal.class)
    Order placeOrder(<span class="predefined-type">String</span> itemNo, <span class="type">int</span> quantity);
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> <span class="directive">implements</span> RetailOrderService, B2BOrderService {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Order placeOrder(<span class="predefined-type">String</span> itemNo, <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the class <code class="classname">OrderService</code> implements the two unrelated interfaces <code class="classname">RetailOrderService</code> and <code class="classname">B2BOrderService</code>, which both define a method <code class="methodname">placeOrder()</code>, marking the return value as cascaded.</p>
</div>
<div class="paragraph">
<p>The group conversion declared in <code class="classname">B2BOrderService</code> is illegal as per the rules defined in the previous section, since the set of applied validation groups might be altered unexpectedly for a client of the <code class="classname">RetailOrderService</code> interface.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-groupsequence-formaldefinition"><a class="anchor" href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition"></a>4.4.6. Formal group definitions</h4>
<div class="paragraph">
<p>The formal rules defining groups are as followed. <em>Text in italic are comments about the rules.</em></p>
</div>
<div class="paragraph">
<p>For every class <code class="classname">X</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>For each superclass <code class="classname">Y</code> of <code class="classname">X</code>, the group <code class="classname">Y</code> contains all constraints of the group <code class="classname">Y</code> of <code class="classname">Y</code>
<em>this rule prepares formal concepts for recursive discovery</em></p>
</li>
</ol>
</div>
<div class="paragraph tck-testable">
<p></p><div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>The group <code class="classname">X</code> contains the following constraints:
<span class="tck-ignore">group <code class="classname">X</code> is a group used on sequences redefining the default group on a class (see <a href="#constraintdeclarationvalidationprocess-groupsequence-redefiningdefaultgroup">Redefining the Default group for a class</a>)</span></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>every constraint declared by the class <code class="classname">X</code> which does not declare a group or does declare the group <code class="classname">Default</code> explicitly.
<span class="tck-ignore"><em>all Default constraints hosted on X</em></span></p>
</li>
<li>
<p>every constraint declared by any interface implemented by <code class="classname">X</code> and not annotated <code class="classname">@GroupSequence</code> which does not explicitly declare a group or does declare the group <code class="classname">Default</code> explicitly.
<span class="tck-ignore"><em>all Default constraints hosted on interfaces of X: constraints are inherited by the class hierarchy. Interfaces marked as @GroupSequence are ignored.</em></span></p>
</li>
<li>
<p>if <code class="classname">X</code> has a direct superclass <code class="classname">Y</code>, every constraint in the group <code class="classname">Y</code>
<span class="tck-ignore"><em>all Default constraints hosted on the superclasses of X: constraints are inherited by the class hierarchy</em></span></p>
</li>
</ol>
</div>
</li>
</ol>
</div><p></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>If <code class="classname">X</code> has no <code class="classname">@GroupSequence</code> annotation, the group <code class="classname">Default</code> contains the following constraints:
<span class="tck-ignore"><em>this rule defines which constraints are evaluated when validating Default on X.</em></span></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>every constraint in the group <code class="classname">X</code></p>
</li>
<li>
<p>if <code class="classname">X</code> has a direct superclass <code class="classname">Y</code>, every constraint in the group <code class="classname">Default</code> of <code class="classname">Y</code>
<span class="tck-ignore"><em>this rule is necessary in case Y redefines the group Default</em></span></p>
</li>
</ol>
</div>
</li>
</ol>
</div><p></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><span class="tck-testable">If <code class="classname">X</code> does have a <code class="classname">@GroupSequence</code> annotation, the group <code class="classname">Default</code> contains every constraint belonging to every group declared by the <code class="classname">@GroupSequence</code> annotation.</span>
<em>this rule describes how a class can redefine the group Default for itself (see <a href="#constraintdeclarationvalidationprocess-groupsequence-redefiningdefaultgroup">Redefining the Default group for a class</a>)</em></p>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">the <code class="classname">@GroupSequence</code> annotation must declare the group <code class="classname">X</code></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph tck-testable">
<p></p><div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>For every interface <code class="classname">Z</code>, the group <code class="classname">Z</code> contains the following constraints:
<span class="tck-ignore"><em>this rule defines how non Default groups are defined</em></span></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>every constraint declared by the interface <code class="classname">Z</code> which does not explicitly declare a group or does declare the group <code class="classname">Default</code> explicitly.
<span class="tck-ignore"><em>all Default constraints hosted on Z: this rule formally defines implicit grouping per interface (see <a href="#constraintdeclarationvalidationprocess-groupsequence-implicitgrouping">Implicit grouping</a>)</em></span></p>
</li>
<li>
<p>every constraint (which does not explicitly declare a group) declared by any superinterface not annotated <code class="classname">@GroupSequence</code> of the interface <code class="classname">Z</code>
<span class="tck-ignore"><em>all Default constraints hosted on interfaces of Z: groups can be inherited (see <a href="#constraintdeclarationvalidationprocess-groupsequence-groupinheritance">Group inheritance</a>)</em></span></p>
</li>
<li>
<p>every constraint declared by the class <code class="classname">X</code> which explicitly declares the group <code class="classname">Z</code>
<span class="tck-ignore"><em>every constraint hosted by X and marked as belonging to the group Z</em></span></p>
</li>
<li>
<p>every constraint declared by any interface implemented by <code class="classname">X</code> and not annotated <code class="classname">@GroupSequence</code> which explicitly declares the group <code class="classname">Z</code>
<span class="tck-ignore"><em>every constraint hosted by any interface of X and marked as belonging to the group Z</em></span></p>
</li>
<li>
<p>if <code class="classname">X</code> has a direct superclass <code class="classname">Y</code>, every constraint in the group <code class="classname">Z</code> of <code class="classname">Y</code>
<span class="tck-ignore"><em>every constraint hosted by any superclass of X and marked as belonging to the group Z</em></span></p>
</li>
</ol>
</div>
</li>
</ol>
</div><p></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p><span class="tck-testable">For every interface <code class="classname">Z</code> annotated <code class="classname">@GroupSequence</code>, the group <code class="classname">Z</code> contains every constraint belonging to every group declared by the <code class="classname">@GroupSequence</code> annotation.</span>
<em>defines the composition side of group sequence but does not define the ordering behavior of sequence (see <a href="#constraintdeclarationvalidationprocess-groupsequence-groupsequence">Group sequence</a>)</em></p>
</li>
</ol>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>When a given group <code class="classname">G</code> (represented by an interface <code class="classname">G</code>) is requested for the validation of a class <code class="classname">X</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>constraints belonging to the group <code class="classname">G</code> are evaluated</p>
</li>
<li>
<p>if the interface <code class="classname">G</code> is not annotated <code class="classname">@GroupSequence</code>, every group represented by the super interface of <code class="classname">G</code> are requested for validation</p>
</li>
<li>
<p>if the interface <code class="classname">G</code> is annotated with <code class="classname">@GroupSequence</code>, every group represented by the interfaces declared by the <code class="classname">@GroupSequence</code> annotation are requested for validation</p>
<div class="ulist">
<ul>
<li>
<p>the validation of groups declared to the <code class="classname">@GroupSequence</code> must happen in the sequencing order declared by <code class="classname">@GroupSequence</code>: the sequencing order is propagated to the groups composing the sequenced group (via inheritance or group sequence)</p>
</li>
<li>
<p>if a group validation triggers the failure of one or more constraints, groups following in the sequence must not be evaluated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>if the group <code class="classname">G</code> represents the <code class="classname">Default</code> group of <code class="classname">X</code> overridden by <code class="classname">@GroupSequence</code>, operations are equivalent</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>When the <code class="classname">Default</code> group of a given class <code class="classname">X</code> is overridden via <code class="classname">@GroupSequence</code>, its validation is as followed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>every group represented by the interfaces declared by the <code class="classname">@GroupSequence</code> annotation are requested for validation</p>
<div class="ulist">
<ul>
<li>
<p>the validation of groups declared to the <code class="classname">@GroupSequence</code> must happen in the sequencing order declared by <code class="classname">@GroupSequence</code>: the sequencing order is propagated to the groups composing the sequenced group (via inheritance or group sequence)</p>
</li>
<li>
<p>if a group validation triggers the failure of one or more constraints, groups following in the sequence must not be evaluated.</p>
</li>
</ul>
</div>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Unless defined by a <code class="classname">@GroupSequence</code>, evaluation ordering is not constrained. In particular, several groups can be validated in the same pass.</span> <span class="tck-testable">If a group definition leads to a circular sequencing order between groups, a <code class="classname">GroupDefinitionException</code> is raised.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A group <code class="classname">G</code> sequenced (directly or indirectly) to be executed before itself is not considered a circular reference.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-methodlevelconstraints"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints"></a>4.5. Method and constructor constraints</h3>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In the following, the term "method constraint" refers to constraints declared on methods as well as constructors.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Method constraints are declared by adding constraint annotations directly to methods or constructors and/or their parameters. In the former case, all the parameters of an executable (cross-parameter constraint) or the return value is constrained, in the latter individual parameters are constrained. As with bean constraints, this can be done using either actual Java annotations or using an XML constraint mapping file (see <a href="#xml-mapping-constraintdeclarationinxml-methodleveloverriding">Method-level overriding</a>). Bean Validation providers are free to provide additional means of defining method constraints such as an API-based approach.</p>
</div>
<div class="paragraph">
<p>Getters are not considered constrained methods by default (see <a href="#integration-general-executable">Method and constructor validation</a>).</p>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-methodlevelconstraints-requirements"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-requirements"></a>4.5.1. Requirements on methods to be validated</h4>
<div class="paragraph">
<p><span class="tck-not-testable">Static methods are ignored by validation. Putting constraints on a static method is not portable.</span> No other restrictions exist from the perspective of this specification, however it is possible that technologies integrating with method validation impose further restrictions to methods for which a validation shall be applied. For instance certain integration technologies might require that methods to be validated must have <code class="methodname">public</code> visibility and/or must not be <code class="methodname">final</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints"></a>4.5.2. Declaring parameter constraints</h4>
<div class="paragraph">
<p><span class="tck-testable">Parameter constraints are declared by putting constraint annotations on method or constructor parameters.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 38. Declaring parameter constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="directive">public</span> OrderService(<span class="annotation">@NotNull</span> CreditCardProcessor creditCardProcessor) {
        [...]
    }

    <span class="directive">public</span> <span class="type">void</span> placeOrder(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">3</span>, max=<span class="integer">20</span>) <span class="predefined-type">String</span> customerCode,
        <span class="annotation">@NotNull</span> Item item,
        <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using constraint annotations, several preconditions are defined here. These preconditions which must be satisfied in order to legally invoke the methods of <code class="classname">OrderService</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code class="classname">CreditCardProcessor</code> passed to the constructor must not be null.</p>
</li>
<li>
<p>The customer code passed to the <code class="methodname">placeOrder()</code> method must not be null and must be between 3 and 20 characters long.</p>
</li>
<li>
<p>The <code class="classname">Item</code> passed to the <code class="methodname">placeOrder()</code> method must not be null.</p>
</li>
<li>
<p>The quantity value passed to the <code class="methodname">placeOrder()</code> method must be 1 at least.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that declaring these constraints does not automatically cause their validation when the concerned methods are invoked. It’s the responsibility of an integration layer to trigger the validation of the constraints using a method interceptor, dynamic proxy or similar. See section <a href="#validationapi-triggeringmethodvalidation">Triggering method validation</a> for more details.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>In order to use constraint annotations for method or constructor parameters, their element type must be <code class="varname">ElementType.PARAMETER</code>. In order to use constraint annotations for cross-parameter validation or on the return values of methods or constructors (see the following sections), their element type must be <code class="varname">ElementType.METHOD</code> respectively <code class="varname">ElementType.CONSTRUCTOR</code>. All built-in constraints support these element types and it is considered a best practice to do the same for custom constraints.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-crossparameterconstraints"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-crossparameterconstraints"></a><span class="rcl-da">4.5.2.1</span><span class="rcl-da">.</span> Cross-parameter constraints</h5>
<div class="paragraph">
<p>Cross-parameter constraints allow to express constraints based on the value of several method parameters, similar to class-level constraints which are based on several properties of a given class. <span class="tck-testable">Cross-parameter constraints are declared by putting cross-parameter constraint annotations on methods or constructors</span> as shown in the following example.</p>
</div>
<div class="exampleblock">
<div class="title">Example 39. Declaring cross-parameter constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">CalendarService</span> {

    <span class="annotation">@ConsistentDateParameters</span>
    <span class="directive">public</span> <span class="type">void</span> createEvent(
        <span class="predefined-type">String</span> title,
        <span class="annotation">@NotNull</span> <span class="predefined-type">Date</span> startDate,
        <span class="annotation">@NotNull</span> <span class="predefined-type">Date</span> endDate) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The cross-parameter constraint annotation expresses here that the given start date must be before the passed end date in order to legally invoke the <code class="methodname">createEvent()</code> method. The example also shows that it is often useful to combine constraints directly placed on individual parameters (<code class="classname">e.g. @NotNull</code>) and cross-parameter constraints.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Cross-parameter constraints as well as return value constraints are declared directly on a method or a constructor. To make it obvious for a reader that an annotation refers to the parameters of a method or constructor and not its return value, it is recommended to choose a name which clearly expresses this intention.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">It is not legal to declare a cross-parameter constraint on a method or constructor which has no parameters. A <code class="classname">ConstraintDeclarationException</code> is raised in this case.</span></p>
</div>
<div class="paragraph">
<p>Some constraints can target an executable’s return value as well as its array of parameters. <span class="tck-testable">They are known to be both generic and cross-parameter constraints. When using such a constraint on an executable to target the parameters, one must set <code class="methodname">validationAppliesTo</code> if there is an ambiguity.</span> The set of ambiguities is described in <a href="#constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto">validationAppliesTo</a>. Even without ambiguity, it is recommended to explicitly set <code class="methodname">validationAppliesTo</code> to <code>ConstraintTarget.PARAMETERS</code> as it improves readability.</p>
</div>
</div>
<div class="sect4">
<h5 id="constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters"></a><span class="rcl-da">4.5.2.2</span><span class="rcl-da">.</span> Naming parameters</h5>
<div class="paragraph">
<p>In case the validation of a parameter constraint fails, the concerned parameter needs to be identified in the resulting <code class="classname">ConstraintViolation</code> (see section <a href="#validationapi-constraintviolation">ConstraintViolation</a>). Bean Validation defines the <code class="classname">javax.validation.ParameterNameProvider</code> API to which the retrieval of parameter names is delegated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Provides names for method and constructor parameters.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Used by the Bean Validation runtime when creating constraint violation
 * objects for violated method constraints.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Implementations must be thread-safe.
 *
 * @author Gunnar Morling
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ParameterNameProvider</span> {

    <span class="comment">/**
     * Returns the names of the parameters of the given constructor.
     *
     * @param constructor the constructor for which the parameter names shall be
     *        retrieved; never {@code null}
     * @return a list containing the names of the parameters of the given
     *         constructor; may be empty but never {@code null}
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getParameterNames(<span class="predefined-type">Constructor</span>&lt;?&gt; constructor);

    <span class="comment">/**
     * Returns the names of the parameters of the given method.
     *
     * @param method the method for which the parameter names shall be retrieved;
     *        never {@code null}
     * @return a list containing the names of the parameters of the given method;
     *         may be empty but never {@code null}
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getParameterNames(<span class="predefined-type">Method</span> method);
}</code></pre>
</div>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>A conforming Bean Validation implementation provides a default <code class="classname">ParameterNameProvider</code> implementation which returns parameter names as stored in the class file containing the validated executable, if present. A conforming implementation must either use the Java reflection API or ensure behavioral compatibility to using the reflection API in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain the method’s or constructor’s parameters via <code class="methodname">java.lang.reflect.Executable.getParameters()</code></p>
</li>
<li>
<p>Obtain each parameter’s name via <code class="methodname">java.lang.reflect.Parameter.getName()</code></p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p>Depending on whether the class file of the validated executable contains parameter name information or not, the actual parameter names as provided in the executable’s definition will be returned or synthetic names in the form arg<code>PARAMETER_INDEX</code>, where <code>PARAMETER_INDEX</code> starts at 0 for the first parameter, e.g. <code class="varname">arg0</code>, <code class="varname">arg1</code> etc.</p>
</div>
<div class="paragraph">
<p>Bean Validation providers and integrators are free to provide additional implementations (e.g. based on annotations specifying parameter names, debug symbols etc.). If a user wishes to use another parameter name provider than the default implementation, they may specify the provider to use with help of the bootstrap API (see <a href="#validationapi-bootstrapping">Bootstrapping</a>) or the XML configuration (see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If an exception occurs during invocation of the <code class="methodname">getParameterNames()</code> methods, this exception is wrapped into a <code class="classname">ValidationException</code> by the Bean Validation engine.</span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-methodlevelconstraints-returnvalueconstraints"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-returnvalueconstraints"></a>4.5.3. Declaring return value constraints</h4>
<div class="paragraph">
<p><span class="tck-testable">Return value constraints are declared by putting constraint annotations directly on a method or constructor.</span></p>
</div>
<div class="paragraph">
<p>Some constraints can target both the return value and the array of parameters of an executable. <span class="tck-testable">They are known to be both generic and cross-parameter constraints. When using such constraint on an executable to target the return value, one must set <code class="methodname">validationAppliesTo</code> in case there is an ambiguity.</span> The set of ambiguities is described in <a href="#constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto">validationAppliesTo</a>. Even without ambiguity, it is recommended to explicitly set <code class="methodname">validationAppliesTo</code> to <code>ConstraintTarget.RETURN_VALUE</code> as it improves readability.</p>
</div>
<div class="exampleblock">
<div class="title">Example 40. Declaring return value constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="directive">private</span> CreditCardProcessor creditCardProcessor;

    <span class="annotation">@ValidOnlineOrderService</span>
    <span class="directive">public</span> OrderService(OnlineCreditCardProcessor creditCardProcessor) {
        <span class="local-variable">this</span>.creditCardProcessor = creditCardProcessor;
    }

    <span class="annotation">@ValidBatchOrderService</span>
    <span class="directive">public</span> OrderService(BatchCreditCardProcessor creditCardProcessor) {
        <span class="local-variable">this</span>.creditCardProcessor = creditCardProcessor;
    }

    <span class="annotation">@NotNull</span>
    <span class="annotation">@Size</span>(min=<span class="integer">1</span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;CreditCardProcessor&gt; getCreditCardProcessors() { [...] }

    <span class="annotation">@NotNull</span>
    <span class="annotation">@Future</span>
    <span class="directive">public</span> <span class="predefined-type">Date</span> getNextAvailableDeliveryDate() { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the following postconditions are defined which are guaranteed to the caller of the methods and constructors of the <code class="classname">OrderService</code> class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The newly created <code class="classname">OrderService</code> object returned by the first constructor satisfies the conditions of the custom <code class="classname">@ValidOnlineOrderService</code> constraint.</p>
</li>
<li>
<p>The newly created <code class="classname">OrderService</code> object returned by the second constructor satisfies the conditions of the custom <code class="classname">@ValidBatchOrderService</code> constraint.</p>
</li>
<li>
<p>The set of <code class="classname">CreditCardProcessor</code> objects returned by <code class="methodname">getCreditCardProcessors()</code> will neither be null nor be empty.</p>
</li>
<li>
<p>The <code class="classname">Date</code> object returned by <code class="methodname">getNextAvailableDeliveryDate()</code> will not be null and will be in the future.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Like parameter constraints, these return value constraints are not per-se validated upon method invocation, but instead an integration layer invoking the validation is required.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-methodlevelconstraints-cascadedvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-cascadedvalidation"></a>4.5.4. Marking parameters and return values for cascaded validation</h4>
<div class="paragraph">
<p><span class="tck-testable">The <code class="classname">@Valid</code> annotation is used to declare that a cascaded validation of the given method/constructor parameters or return values is performed by the Bean Validation provider. When marked, the parameter or return value is considered a bean object to validate.</span> The same rules as for standard object graph validation (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) apply, in particular</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">null arguments and null return values are ignored</span></p>
</li>
<li>
<p><span class="tck-testable">The validation is recursive; that is, if validated parameter or return value objects have references marked with <code class="classname">@Valid</code> themselves, these references will also be validated</span></p>
</li>
<li>
<p><span class="tck-not-testable">Bean Validation providers must guarantee the prevention of infinite loops during cascaded validation</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 41. Marking parameters and return values for cascaded validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="annotation">@NotNull</span> <span class="annotation">@Valid</span>
    <span class="directive">private</span> CreditCardProcessor creditCardProcessor;

    <span class="annotation">@Valid</span>
    <span class="directive">public</span> OrderService(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> CreditCardProcessor creditCardProcessor) {
        <span class="local-variable">this</span>.creditCardProcessor = creditCardProcessor;
    }

    <span class="annotation">@NotNull</span> <span class="annotation">@Valid</span>
    <span class="directive">public</span> Order getOrderByPk(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> OrderPK orderPk) { [...] }

    <span class="annotation">@NotNull</span> <span class="annotation">@Valid</span>
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Order&gt; getOrdersByCustomer(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> CustomerPK customerPk) { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the following recursive validations will happen when validating the methods of the <code class="classname">OrderService</code> class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validation of the constraints on the object passed for the <code class="varname">creditCardProcessor</code> parameter of the constructor</p>
</li>
<li>
<p>Validation of the constraints on the newly created <code class="classname">OrderService</code> instance returned by the constructor, i.e. the <code class="classname">@NotNull</code> constraint on the field <code class="varname">creditCardProcessor</code> and the constraints on the referenced <code class="classname">CreditCardProcessor</code> instance (as the field is annotated with <code class="classname">@Valid</code>).</p>
</li>
<li>
<p>Validation of the constraints on the object passed for the <code class="varname">orderPk</code> parameter and the returned <code class="classname">Order</code> object of the <code class="methodname">getOrderByPk()</code> method</p>
</li>
<li>
<p>Validation of the constraints on the object passed for the <code class="varname">customerPk</code> parameter and the constraints on each object contained within the returned <code class="varname">Set&lt;Order&gt;</code> of the <code class="methodname">getOrdersByCustomer()</code> method</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Again, solely marking parameters and return values for cascaded validation does not trigger the actual validation.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance"></a>4.5.5. Method constraints in inheritance hierarchies</h4>
<div class="paragraph">
<p>When defining method constraints within inheritance hierarchies (that is, class inheritance by extending base classes and interface inheritance by implementing or extending interfaces) one has to obey the <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution</a> principle which mandates that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a method’s preconditions (as represented by parameter constraints) must not be strengthened in sub types</p>
</li>
<li>
<p>a method’s postconditions (as represented by return value constraints) must not be weakened in sub types</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Very informally speaking, the Liskov substitution principle says that where a given type T is used, it should be possible to replace T with a sub-type S of T ("Behavioral subtyping"). If S overrides/implements a method from T and S would strengthen the method’s preconditions (e.g. by adding parameter constraints) this principle would be violated as client code working correctly against T might fail when working against S. Also if S overrides/implements a method from T and S weakens the method’s postconditions this principle would be violated. However S may strengthen the method’s postconditions (by adding return value constraints), as client code working against T still will work against S.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Therefore the following rules with respect to the definition of method level constraints in inheritance hierarchies apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">In sub types (be it sub classes/interfaces or interface implementations), no parameter constraints may be declared on overridden or implemented methods, nor may parameters be marked for cascaded validation. This would pose a strengthening of preconditions to be fulfilled by the caller.</span></p>
</li>
<li>
<p><span class="tck-testable">If a sub type overrides/implements a method originally defined in several parallel types of the hierarchy (e.g. two interfaces not extending each other, or a class and an interface not implemented by said class), no parameter constraints may be declared for that method at all nor parameters be marked for cascaded validation. This again is to avoid an unexpected strengthening of preconditions to be fulfilled by the caller.</span></p>
</li>
<li>
<p><span class="tck-testable">In sub types (be it sub classes/interfaces or interface implementations), return value constraints may be declared on overridden or implemented methods and the return value may be marked for cascaded validation. Upon validation, all return value constraints of the method in question are validated, wherever they are declared in the hierarchy. This only poses possibly a strengthening but no weakening of the method’s postconditions guaranteed to the caller.</span></p>
</li>
<li>
<p><span class="tck-testable">One must not mark a method return value for cascaded validation more than once in a line of a class hierarchy. In other words, overriding methods on sub types (be it sub classes/interfaces or interface implementations) cannot mark the return value for cascaded validation if the return value has already been marked on the overridden method of the super type or interface.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">Out of the box, a conforming Bean Validation provider must throw a <code class="classname">ConstraintDeclarationException</code> when discovering that any of these rules are violated.</span> In addition providers may implement alternative, potentially more liberal, approaches for handling constrained methods in inheritance hierarchies. Possible means for activating such alternative behavior include provider-specific configuration properties or annotations. Note that client code relying on such alternative behavior is not portable between Bean Validation providers.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The above rules do not apply when validating constructor constraints as constructors do not override one another. Parameter and return value constraints can be applied to any constructor in the type hierarchy, but only the constraints defined directly on the validated constructor are evaluated.</span></p>
</div>
<div class="sect4">
<h5 id="constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance-examples"><a class="anchor" href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance-examples"></a><span class="rcl-da">4.5.5.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>This sections provides some examples of illegal constraint definitions which violate the rules stated above in one way or another.</p>
</div>
<div class="exampleblock">
<div class="title">Example 42. Illegally declared parameter constraints on interface implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">interface</span> <span class="class">OrderService</span> {

    <span class="type">void</span> placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity);
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleOrderService</span> <span class="directive">implements</span> OrderService {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> placeOrder(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">3</span>, max=<span class="integer">20</span>) <span class="predefined-type">String</span> customerCode,
        <span class="annotation">@NotNull</span> Item item,
        <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraints in <code class="classname">SimpleOrderService</code> are illegal, as they strengthen the preconditions of the <code class="methodname">placeOrder()</code> method as constituted by the interface <code class="classname">OrderService</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 43. Illegally declared parameter constraints on sub class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="type">void</span> placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity) { [...] }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleOrderService</span> <span class="directive">extends</span> OrderService {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> placeOrder(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">3</span>, max=<span class="integer">20</span>) <span class="predefined-type">String</span> customerCode,
        <span class="annotation">@NotNull</span> Item item,
        <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The constraints in <code class="classname">SimpleOrderService</code> are illegal, as they strengthen the preconditions of the <code class="methodname">placeOrder()</code> method as constituted by the super class <code class="classname">OrderService</code>.</p>
</div>
<div id="illegal_constraints_in_parallel_types" class="exampleblock">
<div class="title">Example 44. Illegally declared parameter constraints on parallel types</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">interface</span> <span class="class">OrderService</span> {

    <span class="type">void</span> placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity);
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">OrderPlacementService</span> {

    <span class="directive">public</span> <span class="type">void</span> placeOrder(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">3</span>, max=<span class="integer">20</span>) <span class="predefined-type">String</span> customerCode,
        <span class="annotation">@NotNull</span> Item item,
        <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">int</span> quantity);
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleOrderService</span> <span class="directive">implements</span> OrderService, OrderPlacementService {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here the class <code class="classname">SimpleOrderService</code> implements the interfaces <code class="classname">OrderService</code> and <code class="classname">OrderPlacementService</code>, which themselves are unrelated to each other but both define a method <code class="methodname">placeOrder()</code> with an identical signature. This hierarchy is illegal with respect to the parameter constraints as a client of <code class="classname">SimpleOrderService</code> would have to fulfill the constraints defined on the interface <code class="classname">OrderPlacementService</code> even if the client only expects <code class="classname">OrderService</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 45. Correctly declared return value constraints on sub class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    Order placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity) {
        [...]
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleOrderService</span> <span class="directive">extends</span> OrderService {

    <span class="annotation">@Override</span>
    <span class="annotation">@NotNull</span>
    <span class="annotation">@Valid</span>
    <span class="directive">public</span> Order placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The return value constraints in <code class="classname">DefaultOrderService</code> are legal, as they strengthen the postconditions of the <code class="methodname">placeOrder()</code> method as constituted by the super class <code class="classname">OrderService</code> but don’t weaken them.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-validationroutine"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine"></a>4.6. Validation routine</h3>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>For a given group, the validation routine applied on a given bean instance is expected to execute the following constraint validations in no particular order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for all <em>reachable</em> fields, execute all field level validations (including the ones expressed on superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>for all <em>reachable</em> getters, execute all getter level validations (including the ones expressed on interfaces and superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>execute all class level validations (including the ones expressed on interfaces and superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>for all <em>reachable</em> and <em>cascadable</em> associations, execute all cascading validations (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) including the ones expressed on interfaces and superclasses (see <a href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition">Formal group definitions</a>). Note that group conversion can apply (see <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a>).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p>Reachable fields, getters and associations as well as cascadable associations are defined in <a href="#constraintdeclarationvalidationprocess-validationroutine-traversable">Traversable property</a>.</p>
</div>
<div class="paragraph">
<p>Note that this implies that a given validation constraint will not be processed more than once per validation per path. Some implementations might even process a single constraint only once across paths provided that they return the expected set of <code class="classname">ConstraintViolation</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Unless ordered by group sequences, groups can be validated in no particular order.</span> This implies that the validation routine can be run for several groups in the same pass.</p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The object validation routine is described as such. For each constraint declaration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>determine for the constraint declaration, the appropriate <code class="classname">ConstraintValidator</code> to use (see <a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution">ConstraintValidator resolution algorithm</a>).</p>
</li>
<li>
<p>execute the <code class="methodname">isValid</code> operation (from the constraint validation implementation) on the appropriate data (see <a href="#constraintsdefinitionimplementation-validationimplementation">Constraint validation implementation</a>)</p>
</li>
<li>
<p>if <code class="methodname">isValid()</code> returns <code>true</code>, continue to the next constraint,</p>
</li>
<li>
<p>if <code class="methodname">isValid()</code> returns <code>false</code>, the Bean Validation provider populates <code class="classname">ConstraintViolation</code> object(s) according to the rules defined in <a href="#constraintsdefinitionimplementation-validationimplementation">Constraint validation implementation</a> and appends these objects to the list of constraint violations.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-validationroutine-graphvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation"></a>4.6.1. Object graph validation</h4>
<div class="paragraph">
<p><span class="tck-testable">The <code class="classname">@Valid</code> annotation on a given association (i.e. object reference or collection, array, <code class="classname">Iterable</code> of objects), dictates the Bean Validator implementation to apply recursively the Bean Validation routine on (each of) the associated object(s).</span> <span class="tck-testable">This mechanism is recursive: an associated object can itself contain cascaded references.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Null references are ignored.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">To prevent infinite loops, the Bean Validation implementation must ignore the cascading operation if the associated object instance has already been validated in the current navigation path (starting from the root object).</span> See <a href="#example-oglimit">Object graph limits</a> for an example. A navigation path is defined as a set of <code class="classname">@Valid</code> associations starting from the root object instance and reaching the associated instance. A given navigation path cannot contain the same instance multiple times (the complete validated object graph can though). See <a href="#example-oglimit">Object graph limits</a> for an example.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This object graph navigation can lead to multiple validations of the same constraint and the same object instance but the set of constraint validation is deterministic and the algorithm prevents infinite loops.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="example-oglimit" class="exampleblock">
<div class="title">Example 46. Object graph limits</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>#assuming the following object graph

Order -(lines)→ Orderline1
Order -(lines)→ Orderline2
Orderline1 -(order)→ Order
Orderline2 -(order)→ Order
Order -(customer)→ User
Order -(shippingAddress)→ Address1
Order -(billingAddress)→ Address2
Address1 -(inhabitant)→ User
Address2 -(inhabitant)→ User
User -(addresses)→ Address1
User -(addresses)→ Address2

#validation branches are as followed
Order -(lines)→ Orderline1
  - order is ignored: Order is already present in the branch

Order -(lines)→ Orderline2
  - order is ignored: Order is already present in the branch

Order -(customer)→ User -(addresses)→ Address1
  - inhabitant is ignored: User is already present in the branch

Order -(customer)→ User -(addresses)→ Address2
  - inhabitant is ignored: User is already present in the branch

Order -(shippingAddress)→ Address1 -(inhabitant)→ User
  - addresses to Address1 is ignored: Address1 is already present in the branch

Order -(shippingAddress)→ Address1 -(inhabitant)→ User -(addresses)→ Address2
  - inhabitant is ignored: User is already present in the branch

Order -(billingAddress)→ Address2 -(inhabitant)→ User
  - addresses to Address2 is ignored: Address2 is already present in the branch

Order -(billingAddress)→ Address2 -(inhabitant)→ User -(addresses)→ Address1
  - inhabitant is ignored: User is already present in the branch</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code class="classname">ConstraintViolation</code> objects are built when a failing constraint on an associated object is found. They reflect the path to reach the object from the root validated object (See <a href="#validationapi-constraintviolation">ConstraintViolation</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">@Valid</code> is an orthogonal concept to the notion of group. If two groups are in sequence, the first group must pass for all associated objects before the second group is evaluated.</span> Note however that the <code class="classname">Default</code> group sequence overriding is local to the class it is defined on and is not propagated to the associated objects. The following example illustrates this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 47. Class Driver with redefined default group</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GroupSequence</span>({ Minimal.class, <span class="predefined-type">Driver</span>.class })
<span class="directive">public</span> <span class="type">class</span> <span class="class">Driver</span> {
  <span class="annotation">@Min</span>(value = <span class="integer">18</span>, groups = Minimal.class)
  <span class="type">int</span> age;

  <span class="annotation">@AssertTrue</span>
  <span class="predefined-type">Boolean</span> passedDrivingTest;

  <span class="annotation">@Valid</span>
  Car car;

  <span class="comment">// setter/getters</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 48. Class Car with redefined default group</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GroupSequence</span>({ Car.class, Later.class })
<span class="directive">public</span> <span class="type">class</span> <span class="class">Car</span> {
  <span class="annotation">@NotNull</span>
  <span class="predefined-type">String</span> type;

  <span class="annotation">@AssertTrue</span>(groups = Later.class)
  <span class="predefined-type">Boolean</span> roadWorthy;

  <span class="comment">// setter/getters</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 49. Defining a group sequence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GroupSequence</span>({ Minimal.class, Later.class })
<span class="directive">public</span> <span class="type">interface</span> <span class="class">SequencedGroups</span> {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 50. Group sequence overriding is not propagated to associated objects</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Validator</span> validator = Validation.buildDefaultValidatorFactory().getValidator();

<span class="predefined-type">Driver</span> driver = <span class="keyword">new</span> <span class="predefined-type">Driver</span>();
driver.setAge(<span class="integer">16</span>);
Car porsche = <span class="keyword">new</span> Car();
driver.setCar(porsche);


<span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;<span class="predefined-type">Driver</span>&gt;&gt; violations = validator.validate( driver );

<span class="keyword">assert</span> violations.size() == <span class="integer">2</span>;

violations = validator.validate( driver, SequencedGroups.class );

<span class="keyword">assert</span> violations.size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The default group sequence is redefined for the <code class="classname">Driver</code> as well as <code class="classname">Car</code>. When the default group is requested via <code class="methodname">validator.validate( driver )</code> the group <code class="classname">Minimal</code> gets validated in class <code class="classname">Driver</code>. The constraint will fail since the driver’s age in the example is only 16. The constraint on <code class="property">passedDrivingTest</code> will not be evaluated due to the redefined default sequence of <code class="classname">Driver</code>. However, there is one more constraint violation, namely the <code class="classname">@NotNull</code> on <code class="property">Car.type</code>. The reason for this is that the group <code class="classname">Default</code> gets propagated to <code class="classname">Car</code> (not <code class="classname">Minimal</code>). Class <code class="classname">Driver</code> defines its own group sequence which means that <code class="classname">only @NotNull</code> on <code class="property">type</code> gets evaluated.</p>
</div>
<div class="paragraph">
<p>In the second call to <code class="methodname">validate</code> the group <code class="classname">SequencedGroups</code> is requested which defines a sequence of <code class="classname">Minimal</code> followed by <code class="classname">Later</code>. In this case there is only one constraint violation. Again <code class="classname">@Min</code> on <code class="property">age</code> fails, but in this case the group <code class="classname">Minimal</code> gets propagated to <code class="classname">Car</code> which does not have any constraints defined against this group. Constraints belonging to the group <code class="classname">Later</code> won’t get validated until all constraints belonging to <code class="classname">Minimal</code> pass.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-validationroutine-methodconstructorvalidation"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-methodconstructorvalidation"></a>4.6.2. Method and constructor validation</h4>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>For a given group, the validation routine applied to validate parameters of a method or constructor is expected to execute the following constraint validations in no particular order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>execute all parameter validations (in case of overriding method validation, including the ones expressed on overridden methods of the interfaces and superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>execute all cross parameter validations (in case of overriding method validation, including the ones expressed on overridden methods of the interfaces and superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>for all parameters marked for cascaded validation, execute all cascading validations (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>), in case of overriding method validation including the ones expressed on overridden methods of the interfaces and superclasses (see <a href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition">Formal group definitions</a>). Note that group conversion can apply (see <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a>).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>For a given group, the validation routine applied to validate the return value of a method or constructor is expected to execute the following constraint validations in no particular order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>execute all return value validations (including the ones expressed on interfaces and superclasses) matching the targeted group unless the given validation constraint has already been processed during this validation routine for a given navigation path (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) as part of a previous group match.</p>
</li>
<li>
<p>if the return value is marked for cascaded validation, execute all cascading validations (see <a href="#constraintdeclarationvalidationprocess-validationroutine-graphvalidation">Object graph validation</a>) including the ones expressed on interfaces and superclasses (see <a href="#constraintdeclarationvalidationprocess-groupsequence-formaldefinition">Formal group definitions</a>). Note that group conversion can apply (see <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a>).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p>Note that this implies that a given validation constraint will not be processed more than once per validation per path. Some implementations might even process a single constraint only once across paths provided that they return the expected set of <code class="classname">ConstraintViolation</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Unless ordered by group sequences, groups can be validated in no particular order.</span> This implies that the validation routine can be run for several groups in the same pass.</p>
</div>
<div class="paragraph">
<p>The object validation routine is as defined in described in <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-validationroutine-traversable"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-traversable"></a>4.6.3. Traversable property</h4>
<div class="paragraph">
<p>In some cases, the state of some properties should not be accessed. For example, if a property loaded by a Java Persistence provider is a lazy property or a lazy association, accessing its state would trigger a load from the database. An undesired behavior.</p>
</div>
<div class="paragraph">
<p>Bean Validation offers a way to control which property can and cannot be accessed via the <code class="classname">TraversableResolver.isReachable</code>() contract.</p>
</div>
<div class="paragraph">
<p>Likewise, it is sometimes undesirable to cascade validation despite the use of <code class="classname">@Valid</code>. Java Persistence 2 for example does not cascade to associated entities during flush. You can control this behavior by implementing <code class="methodname">TraversableResolver.isCascadable()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Contract determining if a property can be accessed by the Bean Validation provider.
 * This contract is called for each property that is being either validated or cascaded.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * A traversable resolver implementation must be thread-safe.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TraversableResolver</span> {
    <span class="comment">/**
     * Determines if the Bean Validation provider is allowed to reach the property state.
     *
     * @param traversableObject object hosting {@code traversableProperty}
     *        or {@code null} if {@code validateValue} is called
     * @param traversableProperty the traversable property
     * @param rootBeanType type of the root object passed to the Validator
     *        or hosting the method or constructor validated
     * @param pathToTraversableObject path from the root object to
     *        {@code traversableObject}
     *        (using the path specification defined by Bean Validator)
     * @param elementType either {@code FIELD} or {@code METHOD}
     * @return {@code true} if the Bean Validation provider is allowed to
     *         reach the property state, {@code false} otherwise
     */</span>
    <span class="type">boolean</span> isReachable(<span class="predefined-type">Object</span> traversableObject,
                        Node traversableProperty,
                        <span class="predefined-type">Class</span>&lt;?&gt; rootBeanType,
                        Path pathToTraversableObject,
                        <span class="predefined-type">ElementType</span> elementType);

    <span class="comment">/**
     * Determines if the Bean Validation provider is allowed to cascade validation on
     * the bean instance returned by the property value
     * marked as {@code @Valid}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Note that this method is called only if
     * {@link #isReachable(Object, javax.validation.Path.Node, Class, Path, java.lang.annotation.ElementType)}
     * returns {@code true} for the same set of arguments and if the property
     * is marked as {@link Valid}.
     *
     * @param traversableObject object hosting {@code traversableProperty}
     *        or {@code null} if {@code validateValue} is called
     * @param traversableProperty the traversable property
     * @param rootBeanType type of the root object passed to the Validator
     *        or hosting the method or constructor validated
     * @param pathToTraversableObject path from the root object to
     *        {@code traversableObject}
     *        (using the path specification defined by Bean Validator)
     * @param elementType either {@code FIELD} or {@code METHOD}
     * @return {@code true} if the Bean Validation provider is allowed to
     *         cascade validation, {@code false} otherwise
     */</span>
    <span class="type">boolean</span> isCascadable(<span class="predefined-type">Object</span> traversableObject,
                         Node traversableProperty,
                         <span class="predefined-type">Class</span>&lt;?&gt; rootBeanType,
                         Path pathToTraversableObject,
                         <span class="predefined-type">ElementType</span> elementType);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">isReachable()</code> is called for every property about to be accessed either for validation or for cascading.</span> A property is <em>reachable</em> if this method returns <code>true</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">isCascadable()</code> is called for every property about to be cascaded (i.e. marked as <code class="classname">@Valid</code>).</span> A property is <em>cascadable</em> if it is reachable and if the <code class="methodname">isCascadable</code> method returns <code>true</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">isCascadable()</code> for a given property is only called if <code class="methodname">isReachable()</code> returns <code>true</code>. In other words, <code class="methodname">isReachable()</code> is always called before <code class="methodname">isCascadable()</code> for a given property.</span></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>traversableObject</code> is the object instance being evaluated. <code>null</code> if the check is triggered as part of a <code class="methodname">validateValue()</code> call.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>traversableProperty</code> is the <code class="classname">Node</code> representing the property hosted by the <code class="methodname">traversableObject</code> being considered for traversal. The name of a property is defined in <a href="#constraintdeclarationvalidationprocess-requirements-propertyvalidation">Field and property validation</a>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>rootBeanType</code> is the class of the root being validated, i.e. either the type of the object passed to the <code class="methodname">validate</code> method or the type declaring the validated method/constructor in case of method validation.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>pathToTraversableObject</code> is the <code class="classname">Path</code> from the <code class="methodname">rootBeanType</code> down to the <code class="methodname">traversableObject</code>. If the root object is <code class="classname">traversableObject</code>, <code class="classname">pathToTraversableObject</code> is composed of a single Node whose name is <code>null</code>. The path is described following the conventions described in <a href="#validationapi-constraintviolation">ConstraintViolation</a> (<code class="methodname">getPropertyPath</code>).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>elementType</code> is the <code class="classname">java.lang.annotation.ElementType</code> the annotation is placed on. It can be either <code>FIELD</code> or <code>METHOD</code>. Any other value is not expected.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The Bean Validation provider must not access the state of a property, nor validate its constraints if the property is not traversable. A property is traversable if <code class="classname">TraversableResolver</code> returns <code>true</code> for this property.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If an exception occurs when the <code class="classname">TraversableResolver</code> is called, the exception is wrapped into a <code class="classname">ValidationException</code>.</span></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The following elements are not passed through the traversable resolver filter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the bean instance validated</p>
</li>
<li>
<p>the method and constructor parameter values being validated</p>
</li>
<li>
<p>the method and constructor return value being validated</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">But the properties of these elements (if validated) are. In this case the complete path is provided via <code>pathToTraversableObject</code>.</span></p>
</div>
<div class="paragraph">
<p>The traversable resolver used by default by a Bean Validation provider behaves as followed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-not-testable">if Java Persistence is available in the runtime environment, a property is considered reachable if Java Persistence considers the property as loaded.</span> A typical implementation will use <code class="code">Persistence.getPersistenceUtil().isLoaded(Object, String)</code> to implement such contract.</p>
</li>
<li>
<p><span class="tck-not-testable">if Java Persistence is not available in the runtime environment, all properties are considered reachable.</span></p>
</li>
<li>
<p><span class="tck-not-testable">all properties are considered cascadable.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example implementation of such a resolver is shown in <a href="#constraintdeclarationvalidationprocess-validationroutine-traversable-jparesolver">Java Persistence aware TraversableResolver</a>.</p>
</div>
<div id="constraintdeclarationvalidationprocess-validationroutine-traversable-jparesolver" class="exampleblock">
<div class="title">Example 51. Java Persistence aware TraversableResolver</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">JPATraversableResolver</span> <span class="directive">implements</span> TraversableResolver {

    <span class="directive">public</span> <span class="type">boolean</span> isReachable(<span class="predefined-type">Object</span> traversableObject,
                               Path.Node traversableProperty,
                               <span class="predefined-type">Class</span>&lt;?&gt; rootBeanType,
                               Path pathToTraversableObject,
                               <span class="predefined-type">ElementType</span> elementType) {
        <span class="keyword">return</span> traversableObject == <span class="predefined-constant">null</span> ||
                Persistence.getPersistenceUtil().isLoaded(
                        traversableObject,
                        traversableProperty.getName() );
    }

    <span class="directive">public</span> <span class="type">boolean</span> isCascadable(<span class="predefined-type">Object</span> traversableObject,
                               Path.Node traversableProperty,
                               <span class="predefined-type">Class</span>&lt;?&gt; rootBeanType,
                               Path pathToTraversableObject,
                               <span class="predefined-type">ElementType</span> elementType) {
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#validationapi-bootstrapping">Bootstrapping</a> to learn how to pass a custom <code class="classname">TraversableResolver</code>.</p>
</div>
<div class="sect4">
<h5 id="constraintdeclarationvalidationprocess-validationroutine-traversable-examples"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-traversable-examples"></a><span class="rcl-da">4.6.3.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>The following example assumes the object graph defined in <a href="#example-ognav-definitions">Definitions used in the example</a> and assumes the validation operation is applied on an address object.</p>
</div>
<div id="example-ognav-definitions" class="exampleblock">
<div class="title">Example 52. Definitions used in the example</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Country</span> {
    <span class="annotation">@NotNull</span> <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="annotation">@Size</span>(max=<span class="integer">2</span>) <span class="directive">private</span> <span class="predefined-type">String</span> ISO2Code;
    <span class="annotation">@Size</span>(max=<span class="integer">3</span>) <span class="directive">private</span> <span class="predefined-type">String</span> ISO3Code;

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getISO2Code() {
        <span class="keyword">return</span> ISO2Code;
    }

    <span class="directive">public</span> <span class="type">void</span> setISO2Code(<span class="predefined-type">String</span> ISO2Code) {
        <span class="local-variable">this</span>.ISO2Code = ISO2Code;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getISO3Code() {
        <span class="keyword">return</span> ISO3Code;
    }

    <span class="directive">public</span> <span class="type">void</span> setISO3Code(<span class="predefined-type">String</span> ISO3Code) {
        <span class="local-variable">this</span>.ISO3Code = ISO3Code;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline1;
    <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline2;
    <span class="annotation">@Size</span>(max=<span class="integer">11</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;
    <span class="annotation">@Valid</span>
    <span class="directive">private</span> Country country;

    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline1() {
        <span class="keyword">return</span> addressline1;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline1(<span class="predefined-type">String</span> addressline1) {
        <span class="local-variable">this</span>.addressline1 = addressline1;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline2() {
        <span class="keyword">return</span> addressline2;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline2(<span class="predefined-type">String</span> addressline2) {
        <span class="local-variable">this</span>.addressline2 = addressline2;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getZipCode() {
        <span class="keyword">return</span> zipCode;
    }

    <span class="directive">public</span> <span class="type">void</span> setZipCode(<span class="predefined-type">String</span> zipCode) {
        <span class="local-variable">this</span>.zipCode = zipCode;
    }

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>) <span class="annotation">@NotNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }

    <span class="directive">public</span> Country getCountry() {
        <span class="keyword">return</span> country;
    }

    <span class="directive">public</span> <span class="type">void</span> setCountry(Country country) {
        <span class="local-variable">this</span>.country = country;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When the Bean Validation provider is about to check constraints of <code>ISO3Code</code>, it calls the <code class="classname">TraversableResolver.isReachable()</code> method to ensure that the <code>ISO3Code</code> property is reachable with the following parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>traversableObject</code>: country. The instance returned by <code class="code">address.getCountry()</code>.</p>
</li>
<li>
<p><code>traversableProperty</code>: a <code class="classname">PropertyNode</code> whose name is "ISO3Code". Represents the property of <code>traversableObject</code> being verified.</p>
</li>
<li>
<p><code class="methodname">rootBeanType</code>: <code class="classname">Address.class</code>. The type of the root object being validated.</p>
</li>
<li>
<p><code>pathtoTraversableObject</code>: a <code class="classname">Path</code> containing a single <code class="classname">PropertyNode</code> whose name is "country". The path from address to the country instance.</p>
</li>
<li>
<p><code>elementType</code>: <code class="classname">ElementType.FIELD</code>. The ISO3Code property is annotated on its field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the Bean Validation provider is about to cascade validation on <code>country</code> (<code class="classname">Address</code> object), it calls the <code class="classname">TraversableResolver.isReachable()</code> method to ensure that the <code>country</code> property is reachable and if this method returns <code>true</code>, it calls <code class="classname">TraversableResolver.isCascadable()</code> with the following parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>traversableObject</code>: address. The address instance.</p>
</li>
<li>
<p><code>traversableProperty</code>: a <code class="classname">PropertyNode</code> whose name is "country". Represents the property of <code>traversableObject</code> being verified.</p>
</li>
<li>
<p><code class="methodname">rootBeanType</code>: <code class="classname">Address.class</code>. The type of the root object being validated.</p>
</li>
<li>
<p><code>pathtoTraversableObject</code>: a <code class="classname">Path</code> containing a single <code class="classname">BeanNode</code> whose name is <code>null</code>.</p>
</li>
<li>
<p><code>elementType</code>: <code class="classname">ElementType.FIELD</code>. The country property is annotated on its field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example shows invocations of the <code class="classname">TraversableResolver</code> as to be performed by the Bean Validation provider during method validation. The example is based on the object graph defined in <a href="#example-ognav-definitions">Definitions used in the example</a> and the <code class="classname">AddressService</code> class shown in <a href="#example-ognav-definitions-methodvalidation">Examplary class <code class="classname">AddressService</code></a>. It assumes that a call of <code class="methodname">persistAddress()</code> is subject to method parameter validation.</p>
</div>
<div id="example-ognav-definitions-methodvalidation" class="exampleblock">
<div class="title">Example 53. Examplary class <code class="classname">AddressService</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">AddressService</span> {
    <span class="directive">public</span> <span class="type">void</span> persistAddress(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> Address address) {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When the Bean Validation provider is about to validate the <code class="classname">@NotNull</code> constraint on the <code class="varname">address</code> parameter, no call to <code class="methodname">isReachable()</code> is expected, since parameters are assumed to always be reachable. Similarly, no call to <code class="methodname">isCascadable()</code> is expected when performing cascaded validation of the <code class="varname">address</code> parameter, since parameters are assumed to always be cascadable.</p>
</div>
<div class="paragraph">
<p>When the Bean Validation provider is about to validate constraints on the field <code class="varname">addressline1</code> of the passed <code class="classname">Address</code> object, it calls the <code class="methodname">isReachable()</code> method to ensure that the property is reachable with the following parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>traversableObject</code>: address. The instance passed to <code class="methodname">persistAddress()</code>.</p>
</li>
<li>
<p><code>traversableProperty</code>: a <code class="classname">PropertyNode</code> whose name is "addressline1". Represents the property of <code>traversableObject</code> being verified.</p>
</li>
<li>
<p><code class="methodname">rootBeanType</code>: <code class="classname">AddressService.class</code>. The type of the root object being validated.</p>
</li>
<li>
<p><code>pathtoTraversableObject</code>: a <code class="classname">Path</code> comprising a <code class="classname">MethodNode</code> (named "persistService") and a <code class="classname">ParameterNode</code> (with parameter index 0). The path from <code class="classname">AddressService</code> to the <code class="classname">Address</code> instance.</p>
</li>
<li>
<p><code>elementType</code>: <code class="classname">ElementType.FIELD</code>. The <code class="varname">addressline1</code> property is annotated on its field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the Bean Validation provider is about to perform a cascaded validation of the <code class="varname">country</code> property of the passed <code class="classname">Address</code> object, it calls the <code class="methodname">isReachable()</code> method to ensure that the property is reachable. If this method returns <code>true</code>, it calls <code class="classname">TraversableResolver.isCascadable()</code> with the following parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>traversableObject</code>: address. The instance passed to <code class="methodname">persistAddress()</code>.</p>
</li>
<li>
<p><code>traversableProperty</code>: a <code class="classname">PropertyNode</code> whose name is "country". Represents the property of <code>traversableObject</code> being verified.</p>
</li>
<li>
<p><code class="methodname">rootBeanType</code>: <code class="classname">AddressService.class</code>. The type of the root object being validated.</p>
</li>
<li>
<p><code>pathtoTraversableObject</code>: a <code class="classname">Path</code> comprising a <code class="classname">MethodNode</code> (named "persistService") and a <code class="classname">ParameterNode</code> (with parameter index 0). The path from <code class="classname">AddressService</code> to the <code class="classname">Address</code> instance.</p>
</li>
<li>
<p><code>elementType</code>: <code class="classname">ElementType.FIELD</code>. The <code class="varname">country</code> property is annotated on its field.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution"></a>4.6.4. ConstraintValidator resolution algorithm</h4>
<div class="paragraph">
<p>A constraint is associated to one or more <code class="classname">ConstraintValidator</code> implementations. Each <code class="classname">ConstraintValidator&lt;A, T&gt;</code> accepts the type <code class="classname">T</code>. The <code class="classname">ConstraintValidator</code> executed depends on the type hosting the constraint. For a given constraint evaluation, a single <code class="classname">ConstraintValidator</code> is considered.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The list of <code class="classname">ConstraintValidator</code>s can contain at most one which targets cross-parameter. If the constraint targets the parameters of an executable either implicitly or by the use of <code class="methodname">validationAppliesTo</code> in the constraint - see <a href="#constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto">validationAppliesTo</a>, then the cross-parameter <code class="classname">ConstraintValidator</code> is used. If none is present, a <code class="classname">ConstraintDefinitionException</code> is raised. If more than one cross-parameter <code class="classname">ConstraintValidator</code> is present, a <code class="classname">ConstraintDefinitionException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the constraint is a generic constraint, the following rules apply. If the constraint declaration is hosted on a class or an interface, the targeted type is the class or the interface.</span> <span class="tck-testable">If the constraint is hosted on a class attribute, the type of the attribute is the targeted type.</span> <span class="tck-testable">If the constraint is hosted on a getter, the return type of the getter is the targeted type.</span> In other words, the resolution algorithm considers the type as defined in the method signature and not the runtime type of the value.</p>
</div>
<div class="paragraph">
<p>The rules written below describe formally the following statement: <span class="tck-testable">the <code class="classname">ConstraintValidator</code> chosen to validate the generic constraint on a declared type <code class="classname">T</code> is the one where the <code class="classname">ConstraintValidator</code> targets the annotated element, where the type supported by the <code class="classname">ConstraintValidator</code> is a supertype of <code class="classname">T</code> and where there is no other <code class="classname">ConstraintValidator</code> whose supported type is a supertype of <code class="classname">T</code> and not a supertype of the chosen <code class="classname">ConstraintValidator</code> supported type.</span></p>
</div>
<div class="paragraph">
<p>When validating a generic constraint <code class="classname">A</code> placed on a target declaring the type <code class="classname">T</code>, the following resolution rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Only <code class="classname">ConstraintValidator</code> implementations targeting annotated elements are considered.</span></p>
</li>
<li>
<p><span class="tck-testable">Primitive types are considered equivalent to their respective primitive wrapper class.</span></p>
</li>
<li>
<p>A <code class="classname">ConstraintValidator&lt;A, U&gt;</code> is said to be <em>compliant</em> with <code class="classname">T</code> if <code class="classname">T</code> is a subtype of <code class="classname">U</code> (according to the <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.10">Java Language Specification 3rd edition chapter 4.10 Subtyping</a>). Note that <code class="classname">T</code> is a subtype of <code class="classname">U</code> if <code class="classname">T</code> = <code class="classname">U</code>.</p>
</li>
<li>
<p><span class="tck-testable">If no <code class="classname">ConstraintValidator</code> compliant with <code class="classname">T</code> is found amongst the <code class="classname">ConstraintValidator</code>s listed by the constraint <code class="classname">A</code>, an <code class="classname">UnexpectedTypeException</code> is raised.</span></p>
</li>
<li>
<p><span class="tck-testable">A <code class="classname">ConstraintValidator&lt;A, U&gt;</code> compliant with <code class="classname">T</code> is considered <em>strictly more specific</em> than a <code class="classname">ConstraintValidator&lt;A, V&gt;</code> compliant with <code class="classname">T</code> if <code class="classname">U</code> is a strict subtype of <code class="classname">V</code>. <code class="classname">U</code> is a strict subtype of <code class="classname">V</code> if <code class="classname">U</code> is a subtype of <code class="classname">V</code> and <code class="classname">U</code> != <code class="classname">V</code> (according to the <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.10">Java Language Specification 3rd edition chapter 4.10 Subtyping</a>).</span></p>
</li>
<li>
<p>A <code class="classname">ConstraintValidator&lt;A, U&gt;</code> compliant with <code class="classname">T</code> is considered maximally specific if no other <code class="classname">ConstraintValidator&lt;A, V&gt;</code> compliant with <code class="classname">T</code> is strictly more specific than <code class="classname">ConstraintValidator&lt;A, U&gt;</code>.</p>
</li>
<li>
<p><span class="tck-testable">If more than one maximally specific <code class="classname">ConstraintValidator</code> is found, an <code class="classname">UnexpectedTypeException</code> is raised.</span></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>While the Java compiler itself cannot determine if a constraint declaration will lead to a <code class="classname">UnexpectedTypeException</code>, rules can be statically checked. A tool such as an IDE or a Java 6 annotation processor can apply these rules and prevent compilation in case of ambiguity. The specification encourages Bean Validation providers to provide such a tool to their users.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Let’s see a couple of declarations and their respective <code class="classname">ConstraintValidator</code> resolution. Assuming the definitions shown in <a href="#example-constraintvalidator-resolution">ConstraintValidator and type resolution</a>:</p>
</div>
<div id="example-constraintvalidator-resolution" class="exampleblock">
<div class="title">Example 54. ConstraintValidator and type resolution</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">[...]
<span class="annotation">@Constraint</span>(validatedBy={
    SizeValidatorForCollection.class,
    SizeValidatorForSet.class,
    SizeValidatorForSerializable.class })
<span class="directive">public</span> <span class="annotation">@interface</span> Size { [...] }

<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForCollection</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">Collection</span>&gt; {
    [...]
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForSet</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">Set</span>&gt; {
    [...]
}
<span class="directive">public</span> <span class="type">class</span> <span class="class">SizeValidatorForSerializable</span> <span class="directive">implements</span> ConstraintValidator&lt;Size, <span class="predefined-type">Serializable</span>&gt; {
    [...]
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">SerializableCollection</span> <span class="directive">extends</span> <span class="predefined-type">Serializable</span>, <span class="predefined-type">Collection</span> {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The resolutions shown in <a href="#table-constraintvalidator-resolution">Resolution of ConstraintValidator for various constraints declarations</a> occur.</p>
</div>
<table id="table-constraintvalidator-resolution" class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Resolution of ConstraintValidator for various constraints declarations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Declaration</th>
<th class="tableblock halign-left valign-top">Resolution</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size Collection getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">SizeValidatorForCollection</code>: direct
              match</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size Collection&lt;?&gt; getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">SizeValidatorForCollection</code>:
              <code class="classname">Collection</code>  is a direct supertype of
              <code class="classname">Collection&lt;?&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size Collection&lt;Address&gt; getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">SizeValidatorForCollection</code>:
              <code class="classname">Collection</code>  is a direct supertype of
              <code class="classname">Collection&lt;Address&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size Set&lt;Address&gt; getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">SizeValidatorForSet</code>: direct
              supertype of <code class="classname">Set&lt;Address&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size SortedSet&lt;Address&gt; getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">SizeValidatorForSet</code>:
              <code class="classname">Set</code>  is the closest supertype of
              <code class="classname">SortedSet&lt;Address&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size SerializableCollection getAddresses() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">UnexpectedTypeException</code>:
              <code class="classname">SerializableCollection</code>  is a subtype of
              both <code class="classname">Collection</code>  and
              <code class="classname">Serializable</code>  and neither
              <code class="classname">Collection</code>  nor
              <code class="classname">Serializable</code>  are subtypes of each
              other.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="code">@Size String getName() { […​] }</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">UnexpectedTypeException</code>: none of
              the <code class="classname">ConstraintValidator</code>  types are
              supertypes of <code class="classname">String</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="constraintdeclarationvalidationprocess-validationroutine-examples"><a class="anchor" href="#constraintdeclarationvalidationprocess-validationroutine-examples"></a>4.7. Examples</h3>
<div class="paragraph">
<p>The first example demonstrates how beans, fields and getters are annotated to express some constraints.</p>
</div>
<div class="exampleblock">
<div class="title">Example 55. Place constraint declarations on the element to validate</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@ZipCodeCityCoherenceChecker</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline1;

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline2;

    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline1() {
        <span class="keyword">return</span> addressline1;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline1(<span class="predefined-type">String</span> addressline1) {
        <span class="local-variable">this</span>.addressline1 = addressline1;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline2() {
        <span class="keyword">return</span> addressline2;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline2(<span class="predefined-type">String</span> addressline2) {
        <span class="local-variable">this</span>.addressline2 = addressline2;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getZipCode() {
        <span class="keyword">return</span> zipCode;
    }

    <span class="directive">public</span> <span class="type">void</span> setZipCode(<span class="predefined-type">String</span> zipCode) {
        <span class="local-variable">this</span>.zipCode = zipCode;
    }

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>) <span class="annotation">@NotNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>During the validation routine execution on an <code class="classname">Address</code> object,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="methodname">addressline1</code> field value is passed to the <code class="classname">@NotNull</code> as well as <code class="classname">@Size</code> constraint validation implementations.</p>
</li>
<li>
<p><code class="methodname">addressline2</code> field value is passed to the <code class="classname">@Size</code> constraint validation implementation.</p>
</li>
<li>
<p><code class="methodname">getCity</code> value is passed to the <code class="classname">@Size</code> and <code class="classname">@NotNull</code> constraint validation implementations.</p>
</li>
<li>
<p><code class="classname">@ZipCodeCoherenceChecker</code> is a constraint whose validation implementation’s <code class="methodname">isValid</code> method receives the <code class="classname">Address</code> object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second example demonstrates object graph validation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 56. Define object graph validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Country</span> {
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="annotation">@Size</span>(max=<span class="integer">2</span>) <span class="directive">private</span> <span class="predefined-type">String</span> ISO2Code;
    <span class="annotation">@Size</span>(max=<span class="integer">3</span>) <span class="directive">private</span> <span class="predefined-type">String</span> ISO3Code;

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getISO2Code() {
        <span class="keyword">return</span> ISO2Code;
    }

    <span class="directive">public</span> <span class="type">void</span> setISO2Code(<span class="predefined-type">String</span> ISO2Code) {
        <span class="local-variable">this</span>.ISO2Code = ISO2Code;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getISO3Code() {
        <span class="keyword">return</span> ISO3Code;
    }

    <span class="directive">public</span> <span class="type">void</span> setISO3Code(<span class="predefined-type">String</span> ISO3Code) {
        <span class="local-variable">this</span>.ISO3Code = ISO3Code;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline1;
    <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline2;
    <span class="annotation">@Size</span>(max=<span class="integer">11</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;
    <span class="annotation">@NotNull</span> <span class="annotation">@Valid</span>
    <span class="directive">private</span> Country country;

    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline1() {
        <span class="keyword">return</span> addressline1;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline1(<span class="predefined-type">String</span> addressline1) {
        <span class="local-variable">this</span>.addressline1 = addressline1;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline2() {
        <span class="keyword">return</span> addressline2;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline2(<span class="predefined-type">String</span> addressline2) {
        <span class="local-variable">this</span>.addressline2 = addressline2;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getZipCode() {
        <span class="keyword">return</span> zipCode;
    }

    <span class="directive">public</span> <span class="type">void</span> setZipCode(<span class="predefined-type">String</span> zipCode) {
        <span class="local-variable">this</span>.zipCode = zipCode;
    }

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>) <span class="annotation">@NotNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }

    <span class="directive">public</span> Country getCountry() {
        <span class="keyword">return</span> country;
    }

    <span class="directive">public</span> <span class="type">void</span> setCountry(Country country) {
        <span class="local-variable">this</span>.country = country;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>During the validation routine execution on an <code class="classname">Address</code> object, constraints on <code class="methodname">addressLine1</code>, <code class="methodname">addressLine2</code>, <code class="methodname">zipCode</code>, <code class="classname">getCity</code> and <code class="methodname">country</code> are processed as well as the validation of the <code class="classname">Country</code> object itself, more specifically <code class="methodname">country.name</code> is checked for <code class="classname">@NotNull</code>, <code class="methodname">ISO2Code</code> and <code class="methodname">ISO3Code</code> are checked for <code class="classname">@Size</code>.</p>
</div>
<div class="paragraph">
<p>Assuming that <code class="classname">@NotEmpty</code> is defined as such</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Documented</span>
<span class="annotation">@NotNull</span>
<span class="annotation">@Size</span>(min = <span class="integer">1</span>)
<span class="annotation">@ReportAsSingleViolation</span>
<span class="annotation">@Constraint</span>(validatedBy = NotEmpty.NotEmptyValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NotEmpty {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.NotEmpty.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {
        NotEmpty<span class="type">[]</span> value();
    }

    <span class="type">class</span> <span class="class">NotEmptyValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;NotEmpty, <span class="predefined-type">String</span>&gt; {

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> initialize(NotEmpty constraintAnnotation) {
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">String</span> value, ConstraintValidatorContext context) {
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The third example demonstrates superclass, inheritance and composite constraints.</p>
</div>
<div class="exampleblock">
<div class="title">Example 57. Use inheritance, constraints on superclasses and composite constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Person</span> {
    <span class="annotation">@NotEmpty</span>
    <span class="predefined-type">String</span> getFirstName();

    <span class="predefined-type">String</span> getMiddleName();

    <span class="annotation">@NotEmpty</span>
    <span class="predefined-type">String</span> getLastName();
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> <span class="directive">implements</span> Person {
    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;
    <span class="directive">private</span> <span class="predefined-type">String</span> middleName;
    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> customerId;
    <span class="annotation">@Password</span>(robustness=<span class="integer">5</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> password;

    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() {
        <span class="keyword">return</span> firstName;
    }

    <span class="directive">public</span> <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> firstName) {
        <span class="local-variable">this</span>.firstName = firstName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getMiddleName() {
        <span class="keyword">return</span> middleName;
    }

    <span class="directive">public</span> <span class="type">void</span> setMiddleName(<span class="predefined-type">String</span> middleName) {
        <span class="local-variable">this</span>.middleName = middleName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastName() {
        <span class="keyword">return</span> lastName;
    }

    <span class="directive">public</span> <span class="type">void</span> setLastName(<span class="predefined-type">String</span> lastName) {
        <span class="local-variable">this</span>.lastName = lastName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getCustomerId() {
        <span class="keyword">return</span> customerId;
    }

    <span class="directive">public</span> <span class="type">void</span> setCustomerId(<span class="predefined-type">String</span> customerId) {
        <span class="local-variable">this</span>.customerId = customerId;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getPassword() {
        <span class="keyword">return</span> password;
    }

    <span class="directive">public</span> <span class="type">void</span> setPassword(<span class="predefined-type">String</span> password) {
        <span class="local-variable">this</span>.password = password;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">PreferredGuest</span> <span class="directive">extends</span> Customer {
    <span class="annotation">@CreditCard</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> guestCreditCardNumber;

    <span class="directive">public</span> <span class="predefined-type">String</span> getGuestCreditCardNumber() {
        <span class="keyword">return</span> guestCreditCardNumber;
    }

    <span class="directive">public</span> <span class="type">void</span> setGuestCreditCardNumber(<span class="predefined-type">String</span> guestCreditCardNumber) {
        <span class="local-variable">this</span>.guestCreditCardNumber = guestCreditCardNumber;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CommonGuest</span> <span class="directive">extends</span> customer {}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When validating a <code class="classname">PreferredGuest</code> the following constraints are processed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">@NotEmpty</code>, <code class="classname">@NotNull</code> and <code class="classname">@Size(min=1)</code> on <code class="methodname">firstName</code></p>
</li>
<li>
<p><code class="classname">@NotEmpty</code>, <code class="classname">@NotNull</code> and <code class="classname">@Size(min=1)</code> on <code class="methodname">lastName</code></p>
</li>
<li>
<p><code class="classname">@NotNull</code> on <code class="methodname">customerId</code>, <code class="classname">@Password</code> on <code class="methodname">password</code></p>
</li>
<li>
<p><code class="classname">@CreditCard</code> on <code class="methodname">guestCreditCardNumber</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When validating <code class="classname">CommonGuest</code>, the following constraints are processed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">@NotEmpty</code>, <code class="classname">@NotNull</code> and <code class="classname">@Size(min=1)</code> on <code class="methodname">firstName</code></p>
</li>
<li>
<p><code class="classname">@NotEmpty</code>, <code class="classname">@NotNull</code> and <code class="classname">@Size(min=1)</code> on <code class="methodname">lastName</code></p>
</li>
<li>
<p><code class="classname">@NotNull</code> on <code class="methodname">customerId</code>, <code class="classname">@Password</code> on <code class="methodname">password</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The fourth example demonstrates the influence of group sequence.</p>
</div>
<div class="exampleblock">
<div class="title">Example 58. Use groups and group sequence to define constraint ordering</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@GroupSequence</span>({First.class, Second.class, Last.class})
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Complete</span> {}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {
    <span class="annotation">@NotEmpty</span>(groups=First.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> title;

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>, groups=Second.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> subtitle;

    <span class="annotation">@Valid</span>
    <span class="annotation">@NotNull</span>(groups=First.class)
    <span class="directive">private</span> Author author;

    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }

    <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getSubtitle() {
        <span class="keyword">return</span> subtitle;
    }

    <span class="directive">public</span> <span class="type">void</span> setSubtitle(<span class="predefined-type">String</span> subtitle) {
        <span class="local-variable">this</span>.subtitle = subtitle;
    }

    <span class="directive">public</span> Author getAuthor() {
        <span class="keyword">return</span> author;
    }

    <span class="directive">public</span> <span class="type">void</span> setAuthor(Author author) {
        <span class="local-variable">this</span>.author = author;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> {
    <span class="annotation">@NotEmpty</span>(groups=Last.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;

    <span class="annotation">@NotEmpty</span>(groups=First.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>, groups=Last.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> company;

    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() {
        <span class="keyword">return</span> firstName;
    }

    <span class="directive">public</span> <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> firstName) {
        <span class="local-variable">this</span>.firstName = firstName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastName() {
        <span class="keyword">return</span> lastName;
    }

    <span class="directive">public</span> <span class="type">void</span> setLastName(<span class="predefined-type">String</span> lastName) {
        <span class="local-variable">this</span>.lastName = lastName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getCompany() {
        <span class="keyword">return</span> company;
    }

    <span class="directive">public</span> <span class="type">void</span> setCompany(<span class="predefined-type">String</span> company) {
        <span class="local-variable">this</span>.company = company;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Assuming the validation of the <code class="classname">Complete</code> group on the following book instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Author author = <span class="keyword">new</span> Author();
author.setLastName( <span class="string"><span class="delimiter">"</span><span class="content">Baudelaire</span><span class="delimiter">"</span></span> );
author.setFirstName( <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span> );
<span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>();
book.setAuthor( author );</code></pre>
</div>
</div>
<div class="paragraph">
<p>the validation routine will return the following failure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">@NotNull</code> failure (from <code class="classname">@NotEmpty</code>) on the <code>title</code> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As both <code class="methodname">title</code> and <code class="methodname">author.lastname</code> are checked as part of the <code>First</code> group. If the instance is updated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">book.setTitle( <span class="string"><span class="delimiter">"</span><span class="content">Les fleurs du mal</span><span class="delimiter">"</span></span> );
author.setCompany(<span class="string"><span class="delimiter">"</span><span class="content">Some random publisher with a very very very long name</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>the validation routine will return the following failures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="methodname">author.firstName</code> fails to pass the <code class="classname">@Size(min=1)</code> (from <code class="classname">@NotEmpty</code>) constraint</p>
</li>
<li>
<p><code class="methodname">author.company</code> fails to pass the <code class="classname">@Size</code> constraint</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As the <code class="classname">First</code> and <code class="classname">Second</code> groups pass without failure, the <code class="classname">Last</code> group is going through validation.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validationapi"><a class="anchor" href="#validationapi"></a>5. Validation APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default package for the Bean Validation APIs is <code class="classname">javax.validation</code>.</p>
</div>
<div class="sect2">
<h3 id="validationapi-validatorapi"><a class="anchor" href="#validationapi-validatorapi"></a>5.1. Validator API</h3>
<div class="paragraph">
<p>The main Bean Validation API is the <code class="classname">javax.validation.Validator</code> interface.</p>
</div>
<div class="paragraph">
<p>A <code class="classname">Validator</code> instance is able to validate instances of beans and their associated objects if any. It is recommended to leave the caching of <code class="classname">Validator</code> instances to the <code class="classname">ValidatorFactory</code>. <span class="tck-not-testable"><code class="classname">Validator</code> implementations must be thread-safe.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 59. Validator interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Validates bean instances. Implementations of this interface must be thread-safe.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Validator</span> {

    <span class="comment">/**
     * Validates all constraints on {@code object}.
     *
     * @param object object to validate
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @param &lt;T&gt; the type of the object to validate
     * @return constraint violations or an empty set if none
     * @throws IllegalArgumentException if object is {@code null}
     *         or if {@code null} is passed to the varargs groups
     * @throws ValidationException if a non recoverable error happens
     *         during the validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validate(T object, <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Validates all constraints placed on the property of {@code object}
     * named {@code propertyName}.
     *
     * @param object object to validate
     * @param propertyName property to validate (i.e. field and getter constraints)
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @param &lt;T&gt; the type of the object to validate
     * @return constraint violations or an empty set if none
     * @throws IllegalArgumentException if {@code object} is {@code null},
     *         if {@code propertyName} is {@code null}, empty or not a valid object property
     *         or if {@code null} is passed to the varargs groups
     * @throws ValidationException if a non recoverable error happens
     *         during the validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateProperty(T object,
                                                     <span class="predefined-type">String</span> propertyName,
                                                     <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Validates all constraints placed on the property named {@code propertyName}
     * of the class {@code beanType} would the property value be {@code value}.
     * &lt;p&gt;
     * {@link ConstraintViolation} objects return {@code null} for
     * {@link ConstraintViolation#getRootBean()} and {@link ConstraintViolation#getLeafBean()}.
     *
     * @param beanType the bean type
     * @param propertyName property to validate
     * @param value property value to validate
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default}).
     * @param &lt;T&gt; the type of the object to validate
     * @return constraint violations or an empty set if none
     * @throws IllegalArgumentException if {@code beanType} is {@code null},
     *         if {@code propertyName} is {@code null}, empty or not a valid object property
     *         or if {@code null} is passed to the varargs groups
     * @throws ValidationException if a non recoverable error happens
     *         during the validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateValue(<span class="predefined-type">Class</span>&lt;T&gt; beanType,
                                                  <span class="predefined-type">String</span> propertyName,
                                                  <span class="predefined-type">Object</span> value,
                                                  <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Returns the descriptor object describing bean constraints.
     * &lt;p&gt;
     * The returned object (and associated objects including
     * {@link ConstraintDescriptor}s) are immutable.
     *
     * @param clazz class or interface type evaluated
     * @return the bean descriptor for the specified class
     * @throws IllegalArgumentException if clazz is {@code null}
     * @throws ValidationException if a non recoverable error happens
     *         during the metadata discovery or if some
     *         constraints are invalid.
     */</span>
    <span class="predefined-type">BeanDescriptor</span> getConstraintsForClass(<span class="predefined-type">Class</span>&lt;?&gt; clazz);

    <span class="comment">/**
     * Returns an instance of the specified type allowing access to
     * provider-specific APIs.
     * &lt;p&gt;
     * If the Bean Validation provider implementation does not support
     * the specified class, {@link ValidationException} is thrown.
     *
     * @param type the class of the object to be returned
     * @param &lt;T&gt; the type of the object to be returned
     * @return an instance of the specified class
     * @throws ValidationException if the provider does not support the call
     */</span>
    &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Returns the contract for validating parameters and return values of methods
     * and constructors.
     *
     * @return contract for method and constructor validation
     *
     * @since 1.1
     */</span>
    ExecutableValidator forExecutables();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The methods <code class="methodname">validate()</code>, <code class="methodname">validateProperty()</code> and <code class="methodname">validateValue()</code> are used for the validation of Java beans respectively single bean properties. See the next section for more details.</p>
</div>
<div class="paragraph">
<p><code class="methodname">forExecutables()</code> provides access to the contract for validating method and constructor parameters and return values. The individual methods for method and constructor validation are described in <a href="#validationapi-validatorapi-methodlevelvalidationmethods">Methods for validating method and constructor constraints</a>.</p>
</div>
<div class="paragraph">
<p><code class="methodname">getConstraintsForClass()</code> returns constraint-related metadata for given types and is described in detail in <a href="#constraintmetadata">Constraint metadata request APIs</a>.</p>
</div>
<div class="paragraph">
<p><code class="methodname">unwrap()</code> is provided as a way to access objects of a given type specific to a Bean Validation provider typically as a complement to the <code class="classname">Validator</code> contract. Using this method makes your code non portable.</p>
</div>
<div class="exampleblock">
<div class="title">Example 60. Using unwrap to access a provider specific contract</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//if using the ACME provider</span>
ACMEValidator acmeValidator = factory.unwrap(ACMEValidator.class);
acmeValidator.setSpecificConfiguration( [...] );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-validatorapi-validationmethods"><a class="anchor" href="#validationapi-validatorapi-validationmethods"></a>5.1.1. Validation methods</h4>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validate(T object, Class&lt;?&gt;... groups)</code> is used to validate a given object.</span> This method implements the logic described in <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a>. <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> is thrown when null is passed for the <code class="varname">object</code> parameter or the varargs <code class="varname">groups</code> parameter.</span> <span class="tck-testable">A <code class="classname">Set</code> containing all <code class="classname">ConstraintViolation</code> objects representing the failing constraints is returned, an empty <code class="classname">Set</code> is returned otherwise.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateProperty(T object, String propertyName, Class&lt;?&gt;... groups)</code> validates a given field or property of an object.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> is thrown when <code class="methodname">validateProperty()</code> is called and <code class="varname">object</code> is null or <code class="varname">propertyName</code> is null, empty or invalid or null is passed to the varargs <code class="varname">groups</code> parameter.</span> <span class="tck-testable">The property name is the JavaBeans property name (as defined by the JavaBeans <code class="classname">Introspector</code> class).</span> This method implements the logic described in <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a> but only to the given property. <span class="tck-testable"><code>@Valid</code> is not honored by this method.</span> This method is useful for partial object validation.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateValue(Class&lt;T&gt; beanType, String propertyName, Object value, Class&lt;?&gt;... groups)</code> validates the property referenced by <code class="parameter">propertyName</code> present on <code>beanType</code> or any of its superclasses, if the property value were <code class="parameter">value</code>.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> is thrown when <code class="methodname">validateValue()</code> is called and <code class="varname">beanType</code> is null or <code class="varname">propertyName</code> is null, empty or invalid or null is passed to the varargs <code class="varname">groups</code> parameter.</span> This method implements the logic described in <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a> and apply it only to the given property and for the given value. <span class="tck-testable"><code>@Valid</code> is not honored by this method.</span> This method is useful for ahead of time validation (i.e. before the JavaBean is populated or updated).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If multiple constrained fields or getters share the same name and hide one another in the class hierarchy according to the Java visibility rules, the list of constraints evaluated is unspecified. This will be clarified in a later version of this specification. Note that method overriding is not impacted.</p>
</div>
<div class="paragraph">
<p>If getters and fields share the same name and are present at different levels of the hierarchy, the list of constraints evaluated is unspecified. This will be clarified in a later version of this specification.</p>
</div>
<div class="paragraph">
<p>However, constraints hosted on the most specific (hierarchy wise) element type are always evaluated.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code class="methodname">validateProperty()</code> and <code class="methodname">validateValue()</code> accept property names and not full paths. Bean Validation implementations might accept string representations of paths but this behavior is not portable.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">If some unrecoverable failure happens during validation, a <code class="classname">ValidationException</code> is raised.</span> This exception can be specialized in some situations (invalid group definition, invalid constraint definition, invalid constraint declaration). See <a href="#exception">Exception model</a> or the relative sections for more information.</p>
</div>
<div class="sect4">
<h5 id="validationapi-validatorapi-validationmethods-examples"><a class="anchor" href="#validationapi-validatorapi-validationmethods-examples"></a><span class="rcl-da">5.1.1.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>All the examples will be based on the following class definition, constraint declarations and address instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline1;

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> addressline2;

    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline1() {
        <span class="keyword">return</span> addressline1;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline1(<span class="predefined-type">String</span> addressline1) {
        <span class="local-variable">this</span>.addressline1 = addressline1;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getAddressline2() {
        <span class="keyword">return</span> addressline2;
    }

    <span class="directive">public</span> <span class="type">void</span> setAddressline2(<span class="predefined-type">String</span> addressline2) {
        <span class="local-variable">this</span>.addressline2 = addressline2;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getZipCode() {
        <span class="keyword">return</span> zipCode;
    }

    <span class="directive">public</span> <span class="type">void</span> setZipCode(<span class="predefined-type">String</span> zipCode) {
        <span class="local-variable">this</span>.zipCode = zipCode;
    }

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>) <span class="annotation">@NotNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getCity() {
        <span class="keyword">return</span> city;
    }

    <span class="directive">public</span> <span class="type">void</span> setCity(<span class="predefined-type">String</span> city) {
        <span class="local-variable">this</span>.city = city;
    }
}

Address address = <span class="keyword">new</span> Address();
address.setAddressline1( <span class="predefined-constant">null</span> );
address.setAddressline2( <span class="predefined-constant">null</span> );
address.setCity(<span class="string"><span class="delimiter">"</span><span class="content">Llanfairpwllgwyngyllgogerychwyrndrobwyll-llantysiliogogogoch</span><span class="delimiter">"</span></span>);
<span class="comment">//town in North Wales</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code will return two <code class="classname">ConstraintViolation</code> objects. One for <code>addressline1</code> violating <code>@NotNull</code> and one for <code>city</code> violating <code>@Size</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address).size() == <span class="integer">2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code will return one <code class="classname">ConstraintViolation</code> since <code>city</code> violates <code>@Size</code> and only <code>city</code> is validated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validateProperty(address, <span class="string"><span class="delimiter">"</span><span class="content">city</span><span class="delimiter">"</span></span>).size() == <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code will return no <code class="classname">ConstraintViolation</code> objects because the value "Paris" for <code>city</code> would not raise any constraint failures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validateValue(<span class="string"><span class="delimiter">"</span><span class="content">city</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Paris</span><span class="delimiter">"</span></span>).size() == <span class="integer">0</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-validatorapi-methodlevelvalidationmethods"><a class="anchor" href="#validationapi-validatorapi-methodlevelvalidationmethods"></a>5.1.2. Methods for validating method and constructor constraints</h4>
<div class="paragraph">
<p>The methods for the validation of parameters and return values of methods and constructors can be found on the interface <code class="classname">javax.validation.executable.ExecutableValidator</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 61. ExecutableValidator interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.executable</span>;

<span class="comment">/**
 * Validates parameters and return values of methods and constructors.
 * Implementations of this interface must be thread-safe.
 *
 * @author Gunnar Morling
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ExecutableValidator</span> {

    <span class="comment">/**
     * Validates all constraints placed on the parameters of the given method.
     *
     * @param &lt;T&gt; the type hosting the method to validate
     * @param object the object on which the method to validate is invoked
     * @param method the method for which the parameter constraints is validated
     * @param parameterValues the values provided by the caller for the given method's
     *        parameters
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @return a set with the constraint violations caused by this validation;
     *         will be empty if no error occurs, but never {@code null}
     * @throws IllegalArgumentException if {@code null} is passed for any of the parameters
     *         or if parameters don't match with each other
     * @throws ValidationException if a non recoverable error happens during the
     *         validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateParameters(T object,
                                                       <span class="predefined-type">Method</span> method,
                                                       <span class="predefined-type">Object</span><span class="type">[]</span> parameterValues,
                                                       <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Validates all return value constraints of the given method.
     *
     * @param &lt;T&gt; the type hosting the method to validate
     * @param object the object on which the method to validate is invoked
     * @param method the method for which the return value constraints is validated
     * @param returnValue the value returned by the given method
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @return a set with the constraint violations caused by this validation;
     *         will be empty if no error occurs, but never {@code null}
     * @throws IllegalArgumentException if {@code null} is passed for any of the object,
     *         method or groups parameters or if parameters don't match with each other
     * @throws ValidationException if a non recoverable error happens during the
     *         validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateReturnValue(T object,
                                                        <span class="predefined-type">Method</span> method,
                                                        <span class="predefined-type">Object</span> returnValue,
                                                        <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Validates all constraints placed on the parameters of the given constructor.
     *
     * @param &lt;T&gt; the type hosting the constructor to validate
     * @param constructor the constructor for which the parameter constraints is validated
     * @param parameterValues the values provided by the caller for the given constructor's
     *        parameters
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @return a set with the constraint violations caused by this validation;
     *         Will be empty if no error occurs, but never {@code null}
     * @throws IllegalArgumentException if {@code null} is passed for any of the parameters
     *         or if parameters don't match with each other
     * @throws ValidationException if a non recoverable error happens during the
     *         validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateConstructorParameters(<span class="predefined-type">Constructor</span>&lt;? <span class="directive">extends</span> T&gt; constructor,
                                                                  <span class="predefined-type">Object</span><span class="type">[]</span> parameterValues,
                                                                  <span class="predefined-type">Class</span>&lt;?&gt;... groups);

    <span class="comment">/**
     * Validates all return value constraints of the given constructor.
     *
     * @param &lt;T&gt; the type hosting the constructor to validate
     * @param constructor the constructor for which the return value constraints is validated
     * @param createdObject the object instantiated by the given method
     * @param groups the group or list of groups targeted for validation (defaults to
     *        {@link Default})
     * @return a set with the constraint violations caused by this validation;
     *         will be empty, if no error occurs, but never {@code null}
     * @throws IllegalArgumentException if {@code null} is passed for any of the parameters
     *         or if parameters don't match with each other
     * @throws ValidationException if a non recoverable error happens during the
     *         validation process
     */</span>
    &lt;T&gt; <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;T&gt;&gt; validateConstructorReturnValue(<span class="predefined-type">Constructor</span>&lt;? <span class="directive">extends</span> T&gt; constructor,
                                                                   T createdObject,
                                                                   <span class="predefined-type">Class</span>&lt;?&gt;... groups);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateParameters(T object, Method method, Object[] parameterValues, Class&lt;?&gt;... groups)</code> validates the arguments (as given in <code class="varname">parameterValues</code>) for the parameters of a given method (identified by <code class="varname">method</code>). Cross-parameter constraints are also validated.</span> <span class="tck-testable">A set containing all <code class="classname">ConstraintViolation</code> objects representing the failing constraints is returned, an empty set is returned if no constraint violations occurred.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> will be thrown if null is passed for any of the parameters or if the parameters don’t match with each other (i.e. <code>object</code> and <code>method</code> don’t match, <code>parameterValues</code> and <code>method</code> don’t match).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateReturnValue(T object, Method method, Object returnValue, Class&lt;?&gt;... groups)</code> validates the return value (specified by <code class="varname">returnValue</code>) of a given method (identified by <code class="varname">method</code>).</span> <span class="tck-testable">A set containing all <code class="classname">ConstraintViolation</code> objects representing the failing constraints is returned, an empty set is returned if no constraint violations occurred.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> will be thrown if null is passed for any of the parameters <code class="varname">object</code>, <code class="varname">method</code> and <code class="varname">groups</code> or if the parameters don’t match with each other (i.e. <code>object</code> and <code>method</code> don’t match, <code>returnValue</code> and <code>method</code> don’t match).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateConstructorParameters(Constructor&lt;T&gt; constructor, Object[] parameterValues, Class&lt;?&gt;... groups)</code> validates the arguments (as given in <code class="varname">parameterValues</code>) for the parameters of a given constructor (identified by <code class="varname">constructor</code>). Cross-parameter constraints are also validated.</span> <span class="tck-testable">A set containing all <code class="classname">ConstraintViolation</code> objects representing the failing constraints is returned, an empty set is returned if no constraint violations occurred.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> will be thrown if null is passed for any of the parameters or if the parameters don’t match with each other (i.e. <code>parameterValues</code> and <code>constructor</code> don’t match).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">&lt;T&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateConstructorReturnValue(Constructor&lt;T&gt; constructor, T createdObject, Class&lt;?&gt;... groups)</code> validates the object (specified by <code class="varname">createdObject</code>) of a given constructor (identified by <code class="varname">constructor</code>).</span> <span class="tck-testable">A set containing all <code class="classname">ConstraintViolation</code> objects representing the failing constraints is returned, an empty set is returned if no constraint violations occurred.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> will be thrown if null is passed for any of the parameters or if the parameters don’t match with each other (i.e. <code>createdObject</code> and <code>constructor</code> don’t match).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">None of those methods honor the XML configuration around executable validation nor the presence of <code class="classname">@ValidateOnExecution</code>. In other words, elements will be validated regardless of these settings when explicitly calling the validation methods.</span></p>
</div>
<div class="sect4">
<h5 id="validationapi-validatorapi-methodlevelvalidationmethods-examples"><a class="anchor" href="#validationapi-validatorapi-methodlevelvalidationmethods-examples"></a><span class="rcl-da">5.1.2.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>All the examples will be based on the following class definitions, constraint declarations and instances.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> CreditCardProcessor creditCardProcessor;

    <span class="annotation">@Valid</span>
    <span class="directive">public</span> OrderService(<span class="annotation">@NotNull</span> CreditCardProcessor creditCardProcessor) {
        [...]
    }

    <span class="annotation">@NotNull</span>
    <span class="directive">public</span> Order placeOrder(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">3</span>, max=<span class="integer">20</span>) <span class="predefined-type">String</span> customerCode,
        <span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> Item item,
        <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">int</span> quantity) {

        [...]
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Item</span> {

    <span class="annotation">@NotNull</span>;
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> name; }
    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) { <span class="local-variable">this</span>.name = name; }
}

Item item1 = <span class="keyword">new</span> Item();
item1.setName(<span class="string"><span class="delimiter">"</span><span class="content">Kiwi</span><span class="delimiter">"</span></span>);

Item item2 = <span class="keyword">new</span> Item();
item2.setName(<span class="predefined-constant">null</span>);

<span class="predefined-type">Constructor</span>&lt;OrderService&gt; constructor = [...]; <span class="comment">//get constructor object</span>
<span class="predefined-type">Method</span> placeOrder = [...]; <span class="comment">//get method object</span>

OrderService orderService = <span class="keyword">new</span> OrderService(<span class="keyword">new</span> DefaultCreditCardProcessor());

ExecutableValidator executableValidator = Validation
    .buildDefaultValidatorFactory().getValidator().forExecutables();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following method parameter validation will return one <code class="classname">ConstraintViolation</code> object as the customer code is null:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//orderService.placeOrder(null, item1, 1);</span>
executableValidator.validateParameters(
    orderService, placeOrder, <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span> { <span class="predefined-constant">null</span>, item1, <span class="integer">1</span> }).size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following method parameter validation will return one <code class="classname">ConstraintViolation</code> object as the <code class="varname">item</code> parameter is marked for cascaded validation and the given <code class="classname">Item</code> instance is not valid (its name is null):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//orderService.placeOrder("CUST-123", item2, 1);</span>
executableValidator.validateParameters(
    orderService, placeOrder, <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span> { <span class="string"><span class="delimiter">"</span><span class="content">CUST-123</span><span class="delimiter">"</span></span>, item2, <span class="integer">1</span> }).size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following constructor parameter validation will return one <code class="classname">ConstraintViolation</code> object as null is passed for the <code class="varname">creditCardProcessor</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//new OrderService(null);</span>
executableValidator.validateConstructorParameters(constructor, <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span> { <span class="predefined-constant">null</span> })
    .size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the <code class="methodname">placeOrder()</code> method returned <code class="varname">null</code>, the following return value validation will return one <code class="classname">ConstraintViolation</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">executableValidator.validateReturnValue(orderService, placeOrder, <span class="predefined-constant">null</span>).size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the constructor of <code class="classname">OrderService</code> failed to store the given credit card processor into the <code class="varname">creditCardProcessor</code> field, the following validation of the constructor return value would fail as the constructor is marked with <code class="classname">@Valid</code> and the <code class="classname">@NotNull</code> constraint of the <code class="classname">OrderService</code> class would be violated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">executableValidator.validateConstructorReturnValue(constructor, orderService).size() == <span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let’s now look at how a validation interceptor would use these methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Interceptor</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SampleMethodInterceptor</span> {
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> <span class="predefined-type">Validator</span> validator;

    <span class="annotation">@AroundInvoke</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> validateMethodInvocation(InvocationContext ctx) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="comment">//validate parameters</span>
        <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;<span class="predefined-type">Object</span>&gt;&gt; violations;
        violations = validator.forExecutables().validateParameters(
                ctx.getTarget(),
                ctx.getMethod(),
                ctx.getParameters()
        );

        <span class="comment">//if a violation occurs for parameters, raise an exception</span>
        <span class="keyword">if</span> ( !violations.isEmpty() ) {
            <span class="keyword">throw</span> <span class="keyword">new</span> ConstraintViolationException(
                    buildMessage( ctx.getMethod(), ctx.getParameters(), violations ),
                    violations
            );
        }

        <span class="comment">//execute the method proper</span>
        <span class="predefined-type">Object</span> result = ctx.proceed();

        <span class="comment">//validate the return type</span>
        violations = validator.forExecutables().validateReturnValue(
                ctx.getTarget(),
                ctx.getMethod(),
                result
        );

        <span class="comment">//if a violation occurs for the return type, raise an exception</span>
        <span class="keyword">if</span> ( !violations.isEmpty() ) {
            <span class="keyword">throw</span> <span class="keyword">new</span> ConstraintViolationException(
                    buildMessage( ctx.getMethod(), ctx.getParameters(), violations ),
                    violations
            );
        }

        <span class="comment">//return the result</span>
        <span class="keyword">return</span> result;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-validatorapi-groups"><a class="anchor" href="#validationapi-validatorapi-groups"></a>5.1.3. groups</h4>
<div class="paragraph">
<p>Groups allow you to restrict the set of constraints applied during validation. Groups targeted are passed as parameters to the <code class="methodname">validate()</code>, <code class="methodname">validateProperty()</code> and <code class="methodname">validateValue()</code> methods as well as the methods to validate method/constructor constraints (see <a href="#validationapi-validatorapi-methodlevelvalidationmethods">Methods for validating method and constructor constraints</a>). <span class="tck-testable">All constraints belonging to the targeted group(s) are applied during the <a href="#constraintdeclarationvalidationprocess-validationroutine">Validation routine</a>.</span> <span class="tck-testable">If no group is passed, the <code>Default</code> group is assumed.</span> <a href="#constraintsdefinitionimplementation-constraintdefinition-properties-groups">groups</a> describes how to define groups on constraints.</p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">When more than one group is evaluated and passed to the various validate methods, order is not constrained.</span> It is equivalent to the validation of a group <code>G</code> inheriting all groups (i.e. implementing all interfaces) passed to the validation method.</p>
</div>
<div class="sect4">
<h5 id="validationapi-validatorapi-groups-examples"><a class="anchor" href="#validationapi-validatorapi-groups-examples"></a><span class="rcl-da">5.1.3.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/** Validates a minimal set of constraints */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Minimal</span> {}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {

    <span class="annotation">@NotEmpty</span>(groups = Minimal.class)
    <span class="annotation">@Size</span>(max=<span class="integer">50</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> street1;

    <span class="annotation">@NotEmpty</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="annotation">@NotEmpty</span>(groups = {Minimal.class, Default.class})
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    [...]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">street1</code> applies to the group <code class="classname">Minimal</code>, <code class="classname">@Size</code> on <code class="methodname">street1</code> applies to the group <code>Default</code> and <code class="classname">@NotEmpty</code>(and its composing constraints) on <code class="methodname">zipCode</code> applies to the groups <code>Default</code> and <code>Minimal</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address);</code></pre>
</div>
</div>
<div class="paragraph">
<p>validates the group <code class="classname">Default</code> (implicitly) and applies <code class="classname">@Size</code> on <code class="methodname">street1</code>, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">city</code>, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">zipCode</code>. Particularly, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">street1</code> are not applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address, Minimal.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>applies <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">street1</code> and <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">zipCode</code> because they belong to the <code class="classname">Minimal</code> group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address, Minimal.class, Default.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>validates both <code class="classname">Default</code> and <code class="classname">Minimal</code> groups. The routine applies <code class="classname">@NotEmpty</code> (and its composing constraints) and <code class="classname">@Size</code> on <code class="methodname">street1</code>, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">city</code>, <code class="classname">@NotEmpty</code> (and its composing constraints) on <code class="methodname">zipCode</code>. Note that if <code class="methodname">zipCode</code> is empty, only one <code class="classname">ConstraintViolation</code> object will represent the failure and the not empty validation will only be executed once.</p>
</div>
<div class="paragraph">
<p>Let’s look at a more complex example involving group sequence.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@NotEmpty</span>(groups = Minimal.class)
    <span class="annotation">@Size</span>(max=<span class="integer">50</span>, groups=FirstStep.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> street1;

    <span class="annotation">@NotEmpty</span>(groups=SecondStep.class)
    <span class="directive">private</span> <span class="predefined-type">String</span> city;

    <span class="annotation">@NotEmpty</span>(groups = {Minimal.class, SecondStep.class})
    <span class="directive">private</span> <span class="predefined-type">String</span> zipCode;

    [...]

    <span class="directive">public</span> <span class="type">interface</span> <span class="class">FirstStep</span> {}

    <span class="directive">public</span> <span class="type">interface</span> <span class="class">SecondStep</span> {}

    <span class="annotation">@GroupSequence</span>({Firststep.class, SecondStep.class})
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">Total</span> {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address, Minimal.class, Total.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>the validation process will process <code class="classname">@NotEmpty</code> (and its composing constraints) and <code class="classname">@Size</code> from <code class="methodname">street1</code> and <code class="classname">@NotEmpty</code> (and its composing constraints) from <code class="methodname">zipCode</code>. If <code class="classname">@Size</code> from <code class="methodname">street1</code> does not generate a failure, then <code class="classname">@NotEmpty</code> (and its composing constraints) from <code class="methodname">city</code> will be processed as part of <code class="classname">SecondStep</code>. Note that <code class="classname">@NotEmpty</code> (and its composing constraints) from <code class="methodname">zipCode</code> are not reprocessed as they have already been processed before.</p>
</div>
<div class="paragraph">
<p>When running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">validator.validate(address, Total.class, SecondStep.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code class="classname">@NotEmpty</code> (and its composing constraints) from <code class="methodname">city</code> and <code class="classname">@NotEmpty</code> (and its composing constraints) from <code class="methodname">zipCode</code> will be processed even if <code class="classname">@Size</code> from <code class="methodname">street1</code> fails: while <code>SecondStep</code> is in the <code>Total</code> group sequence and hence should not be triggered if <code>FirstStep</code> has a failure, it also has been requested outside the sequence (in this case explicitly).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the group definition is invalid, a <code class="classname">GroupDefinitionException</code> is raised.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validationapi-constraintviolation"><a class="anchor" href="#validationapi-constraintviolation"></a>5.2. ConstraintViolation</h3>
<div class="paragraph">
<p><code class="classname">ConstraintViolation</code> is the class describing a single constraint failure. A set of <code class="classname">ConstraintViolation</code> is returned for an object validation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Describes a constraint violation. This object exposes the constraint
 * violation context as well as the message describing the violation.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstraintViolation</span>&lt;T&gt; {

    <span class="comment">/**
     * @return the interpolated error message for this constraint violation
     */</span>
    <span class="predefined-type">String</span> getMessage();

    <span class="comment">/**
     * @return the non-interpolated error message for this constraint violation
     */</span>
    <span class="predefined-type">String</span> getMessageTemplate();

    <span class="comment">/**
     * Returns the root bean being validated. For method validation, returns
     * the object the method is executed on.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Returns {@code null} when:
     * &lt;ul&gt;
     *     &lt;li&gt;the {@code ConstraintViolation} is returned after calling
     *     {@link Validator#validateValue(Class, String, Object, Class[])}&lt;/li&gt;
     *     &lt;li&gt;the {@code ConstraintViolation} is returned after validating a
     *     constructor.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return the validated object, the object hosting the validated element or {@code null}
     */</span>
    T getRootBean();

    <span class="comment">/**
     * Returns the class of the root bean being validated.
     * For method validation, this is the object class the
     * method is executed on.
     * For constructor validation, this is the class the constructor
     * is declared on.
     *
     * @return the class of the root bean or of the object hosting the validated element
     */</span>
    <span class="predefined-type">Class</span>&lt;T&gt; getRootBeanClass();

    <span class="comment">/**
     * Returns:
     * &lt;ul&gt;
     *     &lt;li&gt;the bean instance the constraint is applied on if it is
     *     a bean constraint&lt;/li&gt;
     *     &lt;li&gt;the bean instance hosting the property the constraint
     *     is applied on if it is a property constraint&lt;/li&gt;
     *     &lt;li&gt;{@code null} when the {@code ConstraintViolation} is returned
     *     after calling {@link Validator#validateValue(Class, String, Object, Class[])}
     *     &lt;/li&gt;
     *     &lt;li&gt;the object the method is executed on if it is
     *     a method parameter, cross-parameter or return value constraint&lt;/li&gt;
     *     &lt;li&gt;{@code null} if it is a constructor parameter or
     *     cross-parameter constraint&lt;/li&gt;
     *     &lt;li&gt;the object the constructor has created if it is a
     *     constructor return value constraint&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return the leaf bean
     */</span>
    <span class="predefined-type">Object</span> getLeafBean();

    <span class="comment">/**
     * Returns an {@code Object[]} representing the constructor or method invocation
     * arguments if the {@code ConstraintViolation} is returned after validating the
     * method or constructor parameters.
     * Returns {@code null} otherwise.
     *
     * @return parameters of the method or constructor invocation or {@code null}
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">Object</span><span class="type">[]</span> getExecutableParameters();

    <span class="comment">/**
     * Returns the return value of the constructor or method invocation
     * if the {@code ConstraintViolation} is returned after validating the method
     * or constructor return value.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Returns {@code null} if the method has no return value.
     * Returns {@code null} otherwise.
     *
     * @return the method or constructor return value or {@code null}
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">Object</span> getExecutableReturnValue();

    <span class="comment">/**
     * @return the property path to the value from {@code rootBean}
     */</span>
    Path getPropertyPath();

    <span class="comment">/**
     * Returns the value failing to pass the constraint.
     * For cross-parameter constraints, an {@code Object[]} representing
     * the method invocation arguments is returned.
     *
     * @return the value failing to pass the constraint
     */</span>
    <span class="predefined-type">Object</span> getInvalidValue();

    <span class="comment">/**
     * Returns the constraint metadata reported to fail.
     * The returned instance is immutable.
     *
     * @return constraint metadata
     */</span>
    ConstraintDescriptor&lt;?&gt; getConstraintDescriptor();

    <span class="comment">/**
     * Returns an instance of the specified type allowing access to
     * provider-specific APIs. If the Bean Validation provider
     * implementation does not support the specified class,
     * {@link ValidationException} is thrown.
     *
     * @param type the class of the object to be returned
     * @<span class="rcl-da">param</span> <span class="rcl-da">&lt;</span><span class="rcl-da">U</span><span class="rcl-da">&gt;</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">object</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">returned</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span>return an instance of the specified class
     * @throws ValidationException if the provider does not support the call
     *
     * @since 1.1
     */</span>
    &lt;U&gt; U unwrap(<span class="predefined-type">Class</span>&lt;U&gt; type);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getMessage()</code> method returns the interpolated (localized) message for the failing constraint</span> (see <a href="#validationapi-message">Message interpolation</a> for more information on message interpolator). This can be used by clients to expose user friendly messages.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getMessageTemplate()</code> method returns the non-interpolated error message</span> (usually the <code>message</code> attribute on the constraint declaration). Frameworks can use this as an error code key.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getRootBean()</code> method returns the root object being validated that led to the failing constraint</span> (i.e. the object the client code passes to the <code class="methodname">Validator.validate()</code> method). <span class="tck-testable">For method validation, returns the object the method is executed on. For constructors or when <code class="methodname">Validator.validateValue()</code> is used, returns <code>null</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getRootBeanClass()</code> method returns the class of the root bean being validated. For method validation, this is the object class the method is executed on. For constructor validation, this is the class the constructor is declared on.</span></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The <code class="methodname">getLeafBean()</code> method returns the following object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a bean constraint, the bean instance the constraint is applied on.</p>
</li>
<li>
<p>If a property constraint, the bean instance hosting the property the constraint is applied on.</p>
</li>
<li>
<p>If a property constraint, <code>null</code> when the <code class="classname">ConstraintViolation</code> is returned after calling <code class="methodname">Validator.validateValue()</code>.</p>
</li>
<li>
<p>If a method parameter, cross-parameter or return value constraint, the object the method is executed on.</p>
</li>
<li>
<p>If a constructor parameter or cross-parameter constraint, <code>null</code>.</p>
</li>
<li>
<p>If a constructor return value constraint, the object the constructor has created.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getExecutableParameters()</code> returns the parameters provided to the method or constructor invocation or <code>null</code> if not validating the method or constructor parameters.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getExecutableReturnValue()</code> returns the return value of the method or constructor invocation or <code>null</code> if the method has no return value or if not validating the method or constructor return value.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getInvalidValue()</code> method returns the value (field, property, method/constructor parameter, method/constructor return value or validated object) being passed to <code class="methodname">isValid()</code>.</span> <span class="tck-testable">For a cross-parameter constraint failure, an <code class="code">Object[]</code> representing the method/constructor invocation arguments is returned.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintDescriptor()</code> provides access to the failing constraint metadata</span> (see <a href="#constraintmetadata-constraintdescriptor">ConstraintDescriptor</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getPropertyPath()</code> method returns the <code class="classname">Path</code> object representing the navigation path from the root object to the failing object.</span></p>
</div>
<div class="paragraph">
<p><code class="methodname">unwrap()</code> is provided as a way to access objects of a given type specific to a Bean Validation provider typically as a complement to the <code class="classname">ConstraintViolation</code> contract. Using this method makes your code non portable.</p>
</div>
<div class="exampleblock">
<div class="title">Example 62. Path, Node and ElementKind interfaces</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Represents the navigation path from an object to another
 * in an object graph.
 * Each path element is represented by a {@code Node}.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * The path corresponds to the succession of nodes
 * in the order they are returned by the {@code Iterator}.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Guillaume</span> <span class="rcl-da">Smet</span>
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Path</span> <span class="directive">extends</span> <span class="predefined-type">Iterable</span>&lt;Path.Node&gt; {

    <span class="comment">/**
     * <span class="rcl-da">Returns</span> <span class="rcl-da">a</span> <span class="rcl-da">human-readable</span> <span class="rcl-da">representation</span> <span class="rcl-da">of</span> <span class="rcl-da">this</span> <span class="rcl-da">path</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Clients</span> <span class="rcl-da">should</span> <span class="rcl-da">not</span> <span class="rcl-da">rely</span> <span class="rcl-da">on</span> <span class="rcl-da">any</span> <span class="rcl-da">specific</span> <span class="rcl-da">structure</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">returned</span> <span class="rcl-da">value</span><span class="rcl-da">.</span> <span class="rcl-da">Instead</span> <span class="rcl-da">they</span> <span class="rcl-da">should</span> <span class="rcl-da">iterate</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span>
     <span class="rcl-da">*</span> <span class="rcl-da">path</span> <span class="rcl-da">nodes</span> <span class="rcl-da">and</span> <span class="rcl-da">obtain</span> <span class="rcl-da">any</span> <span class="rcl-da">required</span> <span class="rcl-da">information</span> <span class="rcl-da">by</span> <span class="rcl-da">calling</span> <span class="rcl-da">the</span> <span class="rcl-da">methods</span> <span class="rcl-da">on</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Node</span><span class="rcl-da">}</span> <span class="rcl-da">and</span> <span class="rcl-da">its</span> <span class="rcl-da">sub-types</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">a</span> <span class="rcl-da">human-readable</span> <span class="rcl-da">representation</span> <span class="rcl-da">of</span> <span class="rcl-da">this</span> <span class="rcl-da">path</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Override</span></span>
    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">toString</span><span class="rcl-da">();</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> Represents an element of a navigation path.
     */</span>
    <span class="type">interface</span> <span class="class">Node</span> {

        <span class="comment">/**
         * Returns the name of the element which the node represents:
         * &lt;ul&gt;
         *     &lt;li&gt;{@code null} if it is a leaf node which represents an entity / bean.
         *     In particular, the node representing the root object.&lt;/li&gt;
         *     &lt;li&gt;The property name for a property.&lt;/li&gt;
         *     &lt;li&gt;The method name for a method.&lt;/li&gt;
         *     &lt;li&gt;The unqualified name of the type declaring the constructor
         *     for a constructor.&lt;/li&gt;
         *     &lt;li&gt;The parameter named as defined by the {@link ParameterNameProvider}
         *     for a method or constructor parameter.&lt;/li&gt;
         *     &lt;li&gt;The literal {@code &lt;cross-parameter&gt;} for a method or constructor
         *     cross-parameter.&lt;/li&gt;
         *     &lt;li&gt;The literal {@code &lt;return value&gt;} for a method or constructor return
         *     value.&lt;/li&gt;
         * &lt;/ul&gt;
         *
         * @return name of the element which the node represents
         */</span>
        <span class="predefined-type">String</span> getName();

        <span class="comment">/**
         * @return {@code true} if the node represents an object contained in an
         *         {@code Iterable} or in a {@code Map}, {@code false} otherwise
         */</span>
        <span class="type">boolean</span> isInIterable();

        <span class="comment">/**
         * @return the index the node is placed in if contained in an array or
         *         {@code List}; {@code null} otherwise
         */</span>
        <span class="predefined-type">Integer</span> getIndex();

        <span class="comment">/**
         * @return the key the node is placed in if contained in a {@code Map},
         *         {@code null} otherwise
         */</span>
        <span class="predefined-type">Object</span> getKey();

        <span class="comment">/**
         * The kind of element represented by the node. The following relationship
         * between an {@link ElementKind} and its {@code Node} subtype exists:
         * &lt;ul&gt;
         *     &lt;li&gt;{@link ElementKind#BEAN}: {@link BeanNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#PROPERTY}: {@link PropertyNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#METHOD}: {@link MethodNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#CONSTRUCTOR}: {@link ConstructorNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#PARAMETER}: {@link ParameterNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#CROSS_PARAMETER}: {@link CrossParameterNode}&lt;/li&gt;
         *     &lt;li&gt;{@link ElementKind#RETURN_VALUE}: {@link ReturnValueNode}&lt;/li&gt;
         *     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">link</span> <span class="rcl-da">ElementKind</span><span class="rcl-da">#</span><span class="rcl-da">CONTAINER</span><span class="rcl-da">_</span><span class="rcl-da">ELEMENT</span><span class="rcl-da">}:</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ContainerElementNode</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
         <span class="rcl-da">*</span> &lt;/ul&gt;
         * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
         * This is useful to narrow down the {@code Node} type and access node specific
         * information:
         * &lt;pre&gt;
         * switch(node.getKind() {
         * case METHOD:
         *     name = node.getName();
         *     params = node.as(MethodNode.class).getParameterTypes();
         * case PARAMETER:
         *     index = node.as(ParameterNode.class).getParameterIndex();
         * [...]
         * }
         * &lt;/pre&gt;
         *  @return the {@code ElementKind}
         *
         * @since 1.1
         */</span>
        ElementKind getKind();

        <span class="comment">/**
         * Narrows the type of this node down to the given type. The appropriate
         * type should be checked before by calling {@link #getKind()}.
         *
         * @param &lt;T&gt; the type to narrow down to
         * @param nodeType class object representing the descriptor type to narrow down to
         *                 to
         *
         * @return this node narrowed down to the given type.
         *
         * @throws ClassCastException If this node is not assignable to the type {@code T}
         * @since 1.1
         */</span>
        &lt;T <span class="directive">extends</span> Node&gt; T as(<span class="predefined-type">Class</span>&lt;T&gt; nodeType);

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Returns</span> <span class="rcl-da">a</span> <span class="rcl-da">human-readable</span> <span class="rcl-da">representation</span> <span class="rcl-da">of</span> <span class="rcl-da">this</span> <span class="rcl-da">node</span><span class="rcl-da">.</span>
         <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Clients</span> <span class="rcl-da">should</span> <span class="rcl-da">not</span> <span class="rcl-da">rely</span> <span class="rcl-da">on</span> <span class="rcl-da">any</span> <span class="rcl-da">specific</span> <span class="rcl-da">structure</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">returned</span> <span class="rcl-da">value</span><span class="rcl-da">.</span> <span class="rcl-da">Instead</span> <span class="rcl-da">they</span> <span class="rcl-da">should</span> <span class="rcl-da">obtain</span> <span class="rcl-da">any</span>
         <span class="rcl-da">*</span> <span class="rcl-da">required</span> <span class="rcl-da">information</span> <span class="rcl-da">by</span> <span class="rcl-da">calling</span> <span class="rcl-da">the</span> <span class="rcl-da">methods</span> <span class="rcl-da">on</span> <span class="rcl-da">this</span> <span class="rcl-da">interface</span> <span class="rcl-da">and</span> <span class="rcl-da">its</span> <span class="rcl-da">sub-types</span><span class="rcl-da">.</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">a</span> <span class="rcl-da">human-readable</span> <span class="rcl-da">representation</span> <span class="rcl-da">of</span> <span class="rcl-da">this</span> <span class="rcl-da">node</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
         <span class="rcl-da">*/</span></span>
        <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Override</span></span>
        <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">toString</span><span class="rcl-da">();</span>
    }

    <span class="comment">/**
     * Node representing a method.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">MethodNode</span> <span class="directive">extends</span> Node {

        <span class="comment">/**
         * @return the list of parameter types
         */</span>
        <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getParameterTypes();
    }

    <span class="comment">/**
     * Node representing a constructor.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">ConstructorNode</span> <span class="directive">extends</span> Node {

        <span class="comment">/**
         * @return the list of parameter types
         */</span>
        <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getParameterTypes();
    }

    <span class="comment">/**
     * Node representing the return value of a method or constructor.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">ReturnValueNode</span> <span class="directive">extends</span> Node {
    }

    <span class="comment">/**
     * Node representing a parameter of a method or constructor.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">ParameterNode</span> <span class="directive">extends</span> Node {

        <span class="comment">/**
         * @return the parameter index in the method or constructor definition
         */</span>
        <span class="type">int</span> getParameterIndex();
    }

    <span class="comment">/**
     * Node representing the element holding cross-parameter constraints
     * of a method or constructor.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">CrossParameterNode</span> <span class="directive">extends</span> Node {
    }

    <span class="comment">/**
     * Node representing a bean.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">BeanNode</span> <span class="directive">extends</span> Node {

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">container</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">is</span> <span class="rcl-da">placed</span> <span class="rcl-da">in</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span>
         <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span>} <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span><span class="rcl-da">,</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">otherwise</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">getContainerClass</span><span class="rcl-da">();</span>

        <span class="comment">/**
         * <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">affected</span> <span class="rcl-da">by</span> <span class="rcl-da">the</span> <span class="rcl-da">violated</span> <span class="rcl-da">constraint</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">generic</span>
         <span class="rcl-da">*</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Map</span><span class="rcl-da">}.</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Integer</span></span> <span class="rcl-da">getTypeArgumentIndex</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> Node representing a property.
     *
     * @since 1.1
     */</span>
    <span class="type">interface</span> <span class="class">PropertyNode</span> <span class="directive">extends</span> Node {

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">container</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">is</span> <span class="rcl-da">placed</span> <span class="rcl-da">in</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span>
         <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span>} <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span><span class="rcl-da">,</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span>} <span class="rcl-da">otherwise</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">getContainerClass</span><span class="rcl-da">();</span>

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">affected</span> <span class="rcl-da">by</span> <span class="rcl-da">the</span> <span class="rcl-da">violated</span> <span class="rcl-da">constraint</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">generic</span>
         <span class="rcl-da">*</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Map</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">otherwise</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Integer</span></span> <span class="rcl-da">getTypeArgumentIndex</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Node</span> <span class="rcl-da">representing</span> <span class="rcl-da">an</span> <span class="rcl-da">element</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">container</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="type"><span class="rcl-da">interface</span></span> <span class="class"><span class="rcl-da">ContainerElementNode</span></span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Node</span> <span class="rcl-da">{</span>

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">container</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">is</span> <span class="rcl-da">placed</span> <span class="rcl-da">in</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">getContainerClass</span><span class="rcl-da">();</span>

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">affected</span> <span class="rcl-da">by</span> <span class="rcl-da">the</span> <span class="rcl-da">violated</span> <span class="rcl-da">constraint</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">generic</span>
         <span class="rcl-da">*</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Map</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span>
         <span class="rcl-da">*/</span></span>
        <span class="predefined-type"><span class="rcl-da">Integer</span></span> <span class="rcl-da">getTypeArgumentIndex</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Enum of possible kinds of elements encountered in Bean Validation.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Mostly elements that can be constrained and described in the metadata
 * but also elements that can be part of a {@link Path} and represented
 * by a {@link Path.Node}
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 * <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Guillaume</span> <span class="rcl-da">Smet</span>
 *
 <span class="rcl-da">*</span> @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ElementKind {
    <span class="comment">/**
     * A Java Bean or object.
     */</span>
    BEAN,

    <span class="comment">/**
     * A property of a Java Bean.
     */</span>
    PROPERTY,

    <span class="comment">/**
     * A method.
     */</span>
    METHOD,

    <span class="comment">/**
     * A constructor.
     */</span>
    CONSTRUCTOR,

    <span class="comment">/**
     * A parameter of a method or constructor.
     */</span>
    PARAMETER,

    <span class="comment">/**
     * Element holding cross-parameter constraints of a method or constructor.
     */</span>
    CROSS_PARAMETER,

    <span class="comment">/**
     * The return value of a method or constructor.
     */</span>
    RETURN_VALUE<span class="rcl-da">,</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">An</span> <span class="rcl-da">element</span> <span class="rcl-da">stored</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">container</span><span class="rcl-da">,</span> <span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">wrapped</span> <span class="rcl-da">by</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">stored</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span>} <span class="rcl-da">or</span>
     <span class="rcl-da">*</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">stored</span> <span class="rcl-da">in</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="rcl-da">CONTAINER</span><span class="rcl-da">_</span><span class="rcl-da">ELEMENT</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="classname">Path</code> is an iterable of <code class="classname">Node</code> objects. <code class="classname">Node</code> offers the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable"><code class="methodname">getName()</code> returns the name of the element which the node represents:</span></p>
<div class="ulist">
<ul>
<li>
<p><code>null</code> if it is a leaf node which represents an entity / bean. In particular, the node representing the root object.</p>
</li>
<li>
<p>The property name for a property.</p>
</li>
<li>
<p>The method name for a method.</p>
</li>
<li>
<p>The unqualified name of the type declaring the constructor for a constructor.</p>
</li>
<li>
<p>The parameter named as defined by the <code class="classname">ParameterNameProvider</code> (see <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters">Naming parameters</a>) for a method or constructor parameter.</p>
</li>
<li>
<p>The literal <code>&lt;cross-parameter&gt;</code> for a method or constructor cross-parameter.</p>
</li>
<li>
<p>The literal <code>&lt;return value&gt;</code> for a method or constructor return value.</p>
</li>
</ul>
</div>
</li>
<li>
<p><span class="tck-testable"><code class="methodname">isInIterable()</code> returns <code>true</code> if the node represents an object contained in an <code class="classname">Iterable</code> or in a <code class="classname">Map</code>, <code>false</code> otherwise.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="methodname">getIndex()</code> returns the index of the node if it is contained in an array or <code class="classname">List</code>. Returns <code>null</code> otherwise.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="methodname">getKey()</code> returns the key of the node if it is contained in a <code class="classname">Map</code>. Returns <code>null</code> otherwise.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="methodname">getKind()</code> returns the <code class="classname">ElementKind</code> corresponding to the actual node type. This can be used in conjunction with the method <code class="methodname">as()</code> to narrow the type and access node specific methods</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="methodname">as(Class&lt;? extends Node&gt;)</code> returns the node instance narrowed to the type passed as a parameter or <code class="classname">ClassCastException</code> if the type and node don’t match.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nodes are of the following possible types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">BeanNode</code></p>
</li>
<li>
<p><code class="classname">PropertyNode</code></p>
</li>
<li>
<p><code class="classname">MethodNode</code></p>
</li>
<li>
<p><code class="classname">ConstructorNode</code></p>
</li>
<li>
<p><code class="classname">ParameterNode</code></p>
</li>
<li>
<p><code class="classname">CrossParameterNode</code></p>
</li>
<li>
<p><code class="classname">ReturnValueNode</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to narrow a node instance to its precise type and extract node specific information by the use of <code class="methodname">Node.getKind()</code> and <code class="methodname">Node.as(Class&lt;? extends Node&gt;)</code>. <span class="tck-testable">In particular, <code class="classname">MethodNode</code> and <code class="classname">ConstructorNode</code> host <code class="methodname">getParameterTypes()</code> which return the method or constructor parameter list.</span> <span class="tck-testable">Likewise <code class="classname">ParameterNode</code> hosts <code class="methodname">getParameterIndex()</code> which returns the parameter index in the method or constructor parameter list.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 63. Narrow a node to its specific type</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Node node = [...];
<span class="keyword">switch</span> ( node.getKind() ) {
<span class="keyword">case</span> METHOD:
    MethodNode methodNode = node.as(MethodNode.class);
    methodName = methodNode.getName();
    params = methodNode.getParameterTypes().toArray(
        <span class="keyword">new</span> <span class="predefined-type">Class</span>&lt;?&gt;[methodNode.getParameterTypes().size()] );
    <span class="keyword">break</span>;
<span class="keyword">case</span> CONSTRUCTOR:
    ConstructorNode constructorNode = node.as(ConstructorNode.class);
    methodName = constructorNode.getName();
    params = constructorNode.getParameterTypes().toArray(
        <span class="keyword">new</span> <span class="predefined-type">Class</span>&lt;?&gt;[constructorNode.getParameterTypes().size()] );
    <span class="keyword">break</span>;
<span class="keyword">case</span> PARAMETER:
    arg = node.as(ParameterNode.class).getParameterIndex();
    <span class="keyword">break</span>;
<span class="keyword">case</span> CROSS_PARAMETER:
    [...]
<span class="keyword">case</span> RETURN_VALUE:
    [...]
<span class="keyword">case</span> PARAMETER:
    [...]
<span class="keyword">case</span> BEAN:
    [...]
<span class="keyword">case</span> PROPERTY:
    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="classname">Path</code> objects are built according to the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">The runtime type is considered, not the static type. For example if a property is declared <code class="classname">Collection&lt;String&gt;</code> but its runtime type is <code class="classname">ArrayList&lt;String&gt;</code>, the property is considered an <code class="classname">ArrayList&lt;String&gt;</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">If the failing object is the root object, a <code class="classname">BeanNode</code> with name set to <code class="classname">null</code> is added to the <code class="classname">Path</code>. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.BEAN</code>.</span></p>
</li>
<li>
<p>When an association is traversed:</p>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">a <code class="classname">PropertyNode</code> object whose <code>name</code> equals the name of the association property (field name or Java Bean property name) is added to <code class="classname">Path</code>. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.PROPERTY</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if the association is a <code class="classname">List</code> or an array, the following <code class="classname">Node</code> object added contains the index value in <code class="methodname">getIndex()</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if the association is a <code class="classname">Map</code>, the following <code class="classname">Node</code> object added (representing a given map entry) contains the key value in <code class="methodname">getKey()</code></span></p>
</li>
<li>
<p><span class="tck-testable">for all <code class="classname">Iterable</code> or <code class="classname">Map</code>, the following <code class="classname">Node</code> object added is marked as <code>inIterable</code> (<code class="methodname">isInIterable()</code>)</span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph tck-testable">
<p></p><div class="ulist">
<ul>
<li>
<p>For a property level constraint (field and getter)</p>
<div class="ulist">
<ul>
<li>
<p>a <code class="classname">PropertyNode</code> object is added to <code class="classname">Path</code> whose <code>name</code> equals the name of the property (field name or Java Bean property name). The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.PROPERTY</code>.</p>
</li>
<li>
<p>the property path is considered complete</p>
</li>
</ul>
</div>
</li>
</ul>
</div><p></p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code class="classname">PropertyNode</code> object is added to <code class="classname">Path</code> whose <code>name</code> equals the name of the property (field name or Java Bean property name). The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.PROPERTY</code>.</p>
</li>
<li>
<p>the property path is considered complete</p>
</li>
</ul>
</div>
<div class="paragraph tck-testable">
<p></p><div class="ulist">
<ul>
<li>
<p>For a class level constraint:</p>
<div class="ulist">
<ul>
<li>
<p>a <code class="classname">BeanNode</code> object is added to <code class="classname">Path</code> whose <code>name</code> is null. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.BEAN</code>.</p>
</li>
<li>
<p>the property path is considered complete</p>
</li>
</ul>
</div>
</li>
</ul>
</div><p></p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a method/constructor constraint (parameter, cross-parameter or return value constraint on a method or constructor):</p>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">a <code class="classname">MethodNode</code> respectively a <code class="classname">ConstructorNode</code> object is added to the <code class="classname">Path</code> which represents the validated method respectively constructor. The <code>name</code> of the node equals the validated method name or the validated constructor’s unqualified class name, the <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.METHOD</code> respectively <code class="varname">ElementKind.CONSTRUCTOR</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if the constraint is on a parameter, a <code class="classname">ParameterNode</code> object is added to the <code class="classname">Path</code> which represents the validated parameter. The <code>name</code> of the node equals the parameter name as determined by the current parameter name provider (see <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters">Naming parameters</a>). The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.PARAMETER</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if the constraint is a cross-parameter constraint, a <code class="classname">CrossParameterNode</code> object is added to the <code class="classname">Path</code> which represents the validated cross-parameter element. The <code>name</code> of the node has the constant value <code>&lt;cross-parameter&gt;</code>. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.CROSS_PARAMETER.</code></span></p>
</li>
<li>
<p><span class="tck-testable">if the constraint is on the return value, a <code class="classname">ReturnValueNode</code> object is added to the <code class="classname">Path</code> which represents the validated return value. The <code>name</code> of the node has the constant value <code>&lt;return value&gt;</code>. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.RETURN_VALUE.</code></span></p>
</li>
<li>
<p><span class="tck-testable">the property path is considered complete</span></p>
</li>
</ul>
</div>
</li>
<li>
<p>If a parameter or the return value of a method or constructor is traversed:</p>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">a <code class="classname">MethodNode</code> respectively <code class="classname">ConstructorNode</code> object is added to the <code class="classname">Path</code> which represents the concerned method respectively constructor. The <code>name</code> of the node equals the concerned method name or the constructor’s unqualified class name, the <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.METHOD</code> or <code class="varname">ElementKind.CONSTRUCTOR</code>, respectively.</span></p>
</li>
<li>
<p><span class="tck-testable">if a parameter is traversed, a <code class="classname">ParameterNode</code> object is added to the <code class="classname">Path</code> which represents the traversed parameter. The <code>name</code> of the node equals the parameter name as determined by the current parameter name provider. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.PARAMETER</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if a return value is traversed, a <code class="classname">ReturnValueNode</code> object is added to the <code class="classname">Path</code> which represents the traversed return value. The <code>name</code> of the node has the constant value <code>&lt;return value&gt;</code>. The <code class="classname">ElementKind</code> of the node is <code class="varname">ElementKind.RETURN_VALUE.</code></span></p>
</li>
<li>
<p><span class="tck-testable">if the parameter/return value is a <code class="classname">List</code> or an array, the following <code class="classname">Node</code> object added contains the index value in <code class="methodname">getIndex()</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if the parameter/return value is a <code class="classname">Map</code>, the following <code class="classname">Node</code> object added (representing a given map entry) contains the key value in <code class="methodname">getKey()</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">for all <code class="classname">Iterable</code> or <code class="classname">Map</code>, the following <code class="classname">Node</code> object added is marked as <code>inIterable</code> (<code class="methodname">isInIterable()</code>).</span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>If additional path nodes are added in a constraint validator implementation using the node builder API (see <a href="#constraintsdefinitionimplementation-validationimplementation">Constraint validation implementation</a>), the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the default path ends with a <code class="classname">BeanNode</code>, this node is removed and the first added node (a <code class="classname">PropertyNode</code>) inherits its <code>inIterable</code>, <code>key</code> and <code>index</code> values. <code>inIterable</code>, <code>key</code> and <code>index</code> value must not be specified directly on this first node by the user.</p>
</li>
<li>
<p>if the default path ends with a <code class="classname">CrossParameterNode</code>, this node is removed.</p>
</li>
<li>
<p>then the additional nodes are appended to the (possibly amended) path generated by the Bean Validation engine as previously described:</p>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">A <code class="classname">PropertyNode</code> is appended in case <code class="methodname">addPropertyNode(String)</code> is invoked. The node name is equal to the name provided. The <code class="classname">ElementKind</code> of the node is <code>ElementKind.PROPERTY</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">A <code class="classname">BeanNode</code> is appended in case <code class="methodname">addBeanNode()</code> is invoked. The node name is <code>null</code>. The <code class="classname">ElementKind</code> of the node is <code>ElementKind.BEAN</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">A <code class="classname">ParameterNode</code> is appended in case <code class="methodname">addParameterNode(int)</code> is invoked. The node name is equal to the parameter name at the provided index. The name is determined by the current parameter name provider. The <code class="classname">ElementKind</code> of the node is <code>ElementKind.PARAMETER</code>. The previous node (removed) must be a <code class="classname">CrossParameterNode</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">if <code class="methodname">inIterable()</code> is invoked, the node returns <code>true</code> for <code class="methodname">isInIterable()</code>, <code>false</code> otherwise.</span></p>
</li>
<li>
<p><span class="tck-testable">if <code class="methodname">atIndex(Integer)</code> is invoked, the node returns the provided integer for <code class="methodname">getIndex()</code>, <code>null</code> otherwise.</span></p>
</li>
<li>
<p><span class="tck-testable">if <code class="methodname">atKey(Object)</code> is invoked, the node returns the provided object for <code class="methodname">getKey()</code>, <code>null</code> otherwise.</span></p>
</li>
</ul>
</div>
</li>
</ul>
</div><p></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A given <code class="classname">Node</code> object derives its <code>inIterable</code>, <code>key</code> and <code>index</code> properties from the previous association, method parameter or return value traversed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>From <code class="methodname">getRootBean()</code>, <code class="methodname">getPropertyPath()</code>, <code class="methodname">getExecutableParameters()</code> and <code class="methodname">getExecutableReturnValue()</code>, it is possible to rebuild the context of the failure.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code class="classname">ConstraintViolation</code>s occurred during standard bean validation can be distinguished from violations occurred during method/constructor validation by analyzing the <code class="classname">ElementKind</code> of the <code class="classname">Node</code> of the first node in the violation’s property path. In case of constructor or method validation, that <code class="classname">ElementKind</code> will be either <code class="varname">CONSTRUCTOR</code> or <code class="varname">METHOD</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Let there be the following object definitions:</p>
</div>
<div class="exampleblock">
<div class="title">Example 64. Object model definition for examples</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@SecurityChecking</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;

    <span class="annotation">@NotEmpty</span>(message=<span class="string"><span class="delimiter">"</span><span class="content">lastname must not be null</span><span class="delimiter">"</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;

    <span class="annotation">@Size</span>(max=<span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> company;

    [...]

    <span class="annotation">@OldAndNewPasswordsDifferent</span> <span class="annotation">@NewPasswordsIdentical</span>
    <span class="directive">public</span> <span class="type">void</span> renewPassword(<span class="predefined-type">String</span> oldPassword, <span class="predefined-type">String</span> newPassword, <span class="predefined-type">String</span> retypedNewPassword);
}

<span class="annotation">@AvailableInStore</span>(groups={Availability.class})
<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {
    <span class="annotation">@NotEmpty</span>(groups={FirstLevelCheck.class, Default.class})
    <span class="directive">private</span> <span class="predefined-type">String</span> title;

    <span class="annotation">@Valid</span>
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;Author&gt; authors;

    <span class="annotation">@Valid</span>
    <span class="directive">private</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Review&gt; reviewsPerSource;

    <span class="annotation">@Valid</span>
    <span class="directive">private</span> Review pickedReview;

    [...]
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Review</span> {
    <span class="annotation">@Min</span>(<span class="integer">0</span>) <span class="directive">private</span> <span class="type">int</span> rating;
    [...]
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

    <span class="directive">public</span> Library(<span class="annotation">@NotNull</span> <span class="predefined-type">String</span> name, <span class="annotation">@NotNull</span> <span class="predefined-type">String</span> location) {
        [...]
    }

    <span class="directive">public</span> <span class="type">void</span> addBook(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> <span class="predefined-type">Book</span> book) {
        [...]
    }

    <span class="directive">public</span> <span class="type">void</span> addAllBooks(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; books) {
        [...]
    }

    <span class="annotation">@NotNull</span> <span class="directive">public</span> <span class="predefined-type">String</span> getLocation() {
        [...]
    }

    <span class="annotation">@Valid</span> <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;Author, <span class="predefined-type">Book</span>&gt; getMostPopularBookPerAuthor() {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Assuming a <code class="classname">Book</code> instance gets validated, the property paths to the different constraints would be as described in <a href="#table-propertypath">propertyPath examples</a>:</p>
</div>
<table id="table-propertypath" class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. propertyPath examples</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constraint</th>
<th class="tableblock halign-left valign-top">propertyPath</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@AvailableInStore</code>  on
            <code class="classname">Book</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BeanNode(name=null,inIterable=false, index=null, key=null, kind=ElementKind.BEAN)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotEmpty</code>  on
            <code class="classname">Book.title</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=title,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotNull</code>  on
            <code class="classname">Book.authors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=authors,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@SecurityChecking</code>  on the fourth
            author, <code class="classname">Author</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=authors,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)
</p><p class="tableblock">BeanNode(name=null,inIterable=true, index=3, key=null, kind=ElementKind.BEAN)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Size</code>  on the fourth author,
            <code class="classname">Author.lastname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=authors,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)
</p><p class="tableblock">PropertyNode(name=lastname,inIterable=true, index=4, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotEmpty</code>  on the first author,
            <code class="classname">Author.company</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=authors,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)
</p><p class="tableblock">PropertyNode(name=company,inIterable=true, index=0, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Min</code>  on the review associated to
            Consumer Report, <code class="classname">Review.rating</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=reviewsPerSource,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)
</p><p class="tableblock">PropertyNode(name=rating,inIterable=true, index=null, key="Consumer Report", kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Min</code>  on the picked review,
            <code class="classname">Review.rating</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertyNode(name=pickedReview,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)
</p><p class="tableblock">PropertyNode(name=rating,inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Assuming the constructor and methods of the <code class="classname">Library</code> class are subject to method constraint validation, the following property paths would exist for the different constraints:</p>
</div>
<table id="table-method-level-propertypath" class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Property path examples for constrained methods or constructors</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constraint</th>
<th class="tableblock halign-left valign-top">propertyPath</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotNull</code>  on the <code class="varname">location</code> parameter of the constructor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConstructorNode(name=Library, inIterable=false, index=null, key=null, kind=ElementKind.CONSTRUCTOR, parameterTypes=[String.class,String.class])
</p><p class="tableblock">ParameterNode(name=arg1, inIterable=false, index=null, key=null, kind=ElementKind.PARAMETER, parameterIndex=1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotNull</code> on the <code class="varname">book</code> parameter of the <code class="methodname">addBook()</code>
              method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=addBook, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[Book.class])
</p><p class="tableblock">ParameterNode(name=arg0, inIterable=false, index=null, key=null, kind=ElementKind.PARAMETER, parameterIndex=0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotEmpty</code>  on
              <code class="classname">Book.title</code>  during validation of
              <code class="methodname">addBook()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=addBook, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[Book.class])
</p><p class="tableblock">ParameterNode(name=arg0, inIterable=false, index=null, key=null, kind=ElementKind.PARAMETER, parameterIndex=0)
</p><p class="tableblock">PropertyNode(name=title, inIterable=false, index=null, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotEmpty</code>  on fourth book,
              <code class="classname">Book.title</code>  during validation of
              <code class="methodname">addAllBooks()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=addAllBooks, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[List.class])
</p><p class="tableblock">ParameterNode(name=arg0, inIterable=false, index=null, key=null, kind=ElementKind.PARAMETER, parameterIndex=0)
</p><p class="tableblock">PropertyNode(name=title,inIterable=true, index=3, key=null, kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotNull</code>  on the return value of
              the <code class="methodname">getLocation()</code>  method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=getLocation, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[])
</p><p class="tableblock">ReturnValueNode(name=&lt;return value&gt;, inIterable=false, index=null, key=null, kind=ElementKind.RETURN_VALUE)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotEmpty</code>  on most popular book of
              author "John Doe", <code class="classname">Book.title</code>  during
              validation of
              <code class="methodname">getMostPopularBookPerAuthor()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=getMostPopularBookPerAuthor, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[])
</p><p class="tableblock">ReturnValueNode(name=&lt;return value&gt;, inIterable=false, index=null, key=null, kind=ElementKind.RETURN_VALUE)
</p><p class="tableblock">PropertyNode(name=title,inIterable=true, index=null, key=Author(firstName=John, lastName=Doe), kind=ElementKind.PROPERTY)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@OldAndNewPasswordsDifferent</code>  when
              executing <code class="methodname">Author.renewPassword()</code>  with
              <code>oldPassword</code>, <code>newPassword</code>
              and <code>retypedNewPassword</code>  set to "foo".
              <code class="classname">@OldAndNewPasswordsDifferent</code>  is a
              cross-parameter constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=renewPassword, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[String.class, String.class, String.class])
</p><p class="tableblock">CrossParameterNode(name=&lt;cross-parameter&gt;, inIterable=false, index=null, key=null, kind=ElementKind.CROSS_PARAMETER)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NewPasswordsIdentical</code>  when
              executing <code class="methodname">Author.renewPassword()</code>  with
              <code>oldPassword</code>  as "foo",
              <code>newPassword</code>  as "bar" and
              <code>retypedNewPassword</code>  as "baz".
              <code class="classname">@NewPasswordsIdentical</code>  is a
              cross-parameter constraint creating a constraint violation on
              the <code>retypedNewPassword</code>  parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MethodNode(name=renewPassword, inIterable=false, index=null, key=null, kind=ElementKind.METHOD, parameterTypes=[String.class, String.class, String.class])
</p><p class="tableblock">ParameterNode(name=arg2, inIterable=false, index=null, key=null, kind=ElementKind.PARAMETER, parameterIndex=2)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><span class="tck-not-testable">Bean Validation implementations should ensure that a <code class="classname">ConstraintViolation</code> implementation is <code class="classname">Serializable</code> provided that the root bean, the leaf bean, the invalid value and keys in the <code class="classname">Path</code> object are <code class="classname">Serializable</code> objects.</span></p>
</div>
<div class="paragraph">
<p>If a user wishes to send <code class="classname">ConstraintViolation</code> remotely, it should make sure the object graph validated is itself <code class="classname">Serializable</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="validationapi-constraintviolation-examples"><a class="anchor" href="#validationapi-constraintviolation-examples"></a>5.2.1. Examples</h4>
<div class="paragraph">
<p>These examples assume the following definition of <code class="classname">@NotEmpty</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="annotation">@Documented</span>
<span class="annotation">@NotNull</span>
<span class="annotation">@Size</span>(min = <span class="integer">1</span>)
<span class="annotation">@ReportAsSingleViolation</span>
<span class="annotation">@Constraint</span>(validatedBy = NotEmpty.NotEmptyValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NotEmpty {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.NotEmpty.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        NotEmpty<span class="type">[]</span> value();
    }

    <span class="type">class</span> <span class="class">NotEmptyValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;NotEmpty, <span class="predefined-type">String</span>&gt; {

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> initialize(NotEmpty constraintAnnotation) {
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">String</span> value, ConstraintValidatorContext context) {
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the following class definitions</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> {

    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;

    <span class="annotation">@NotEmpty</span>(message = <span class="string"><span class="delimiter">"</span><span class="content">lastname must not be null</span><span class="delimiter">"</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;

    <span class="annotation">@Size</span>(max = <span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> company;

    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() {
        <span class="keyword">return</span> firstName;
    }

    <span class="directive">public</span> <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> firstName) {
        <span class="local-variable">this</span>.firstName = firstName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastName() {
        <span class="keyword">return</span> lastName;
    }

    <span class="directive">public</span> <span class="type">void</span> setLastName(<span class="predefined-type">String</span> lastName) {
        <span class="local-variable">this</span>.lastName = lastName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getCompany() {
        <span class="keyword">return</span> company;
    }

    <span class="directive">public</span> <span class="type">void</span> setCompany(<span class="predefined-type">String</span> company) {
        <span class="local-variable">this</span>.company = company;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {

    <span class="annotation">@NotEmpty</span>(groups = { FirstLevelCheck.class, Default.class })
    <span class="directive">private</span> <span class="predefined-type">String</span> title;

    <span class="annotation">@Valid</span>
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> Author author;

    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }

    <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }

    <span class="directive">public</span> Author getAuthor() {
        <span class="keyword">return</span> author;
    }

    <span class="directive">public</span> <span class="type">void</span> setAuthor(Author author) {
        <span class="local-variable">this</span>.author = author;
    }
}

Author author = <span class="keyword">new</span> Author();
author.setCompany(<span class="string"><span class="delimiter">"</span><span class="content">ACME</span><span class="delimiter">"</span></span>);
<span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>();
book.setTitle(<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>);
book.setAuthor(author);

<span class="predefined-type">Set</span>&lt;ConstraintViolation&gt; constraintViolations = validator.validate(book);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code class="classname">ConstraintViolations</code> is a set of size 2. One of the entries represents the failure of <code>@NotEmpty</code> (or more precisely <code class="classname">@Size(min=1)</code> a composing constraint of <code class="classname">@NotEmpty</code>) on the <code>title</code> property.</p>
</div>
<div class="paragraph">
<p>The <code class="classname">ConstraintViolation</code> object for this failure passes the following assertions:</p>
</div>
<div class="exampleblock">
<div class="title">Example 65. Test assertions on ContraintViolation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming an english locale, the interpolated message is returned</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">may not be null or empty</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );
<span class="keyword">assert</span> book == constraintViolation.getRootBean();
<span class="keyword">assert</span> book == constraintViolation.getLeafBean();

<span class="comment">//the offending value</span>
<span class="keyword">assert</span> book.getTitle().equals( constraintViolation.getInvalidValue() );

<span class="comment">//the offending property</span>
<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();
Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">title</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PROPERTY.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The second failure, <code>@NotEmpty</code> (or more precisely <code class="classname">@NotNull</code> a composing constraint of <code class="classname">@NotEmpty</code>) on the author’s <code class="methodname">lastname</code>, will produce the <code class="classname">ConstraintViolation</code> object satisfying the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">lastname must not be null</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );
<span class="keyword">assert</span> book == constraintViolation.getRootBean();
<span class="keyword">assert</span> author == constraintViolation.getLeafBean();

<span class="comment">//the offending value</span>
<span class="keyword">assert</span> book.getAuthor().getLastName() == constraintViolation.getInvalidValue();

<span class="comment">//the offending property</span>
<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">author</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PROPERTY.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">lastName</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PROPERTY.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-constraintviolation-examplesexecutables"><a class="anchor" href="#validationapi-constraintviolation-examplesexecutables"></a>5.2.2. Examples for method and constructor constraint violations</h4>
<div class="paragraph">
<p>The following examples assume the constraint, class and object definitions given in the previous section. Additionally the following class and object definitions are assumed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

    <span class="annotation">@PublicLibrary</span>
    <span class="directive">public</span> Library() {
        [...]
    }

    <span class="directive">public</span> Library(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; books) {
        [...]
    }

    <span class="directive">public</span> <span class="type">void</span> addBook(<span class="annotation">@NotNull</span> <span class="annotation">@Valid</span> <span class="predefined-type">Book</span> book) {
        [...]
    }

    <span class="annotation">@Valid</span> <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;Author, <span class="predefined-type">Book</span>&gt; getMostPopularBookPerAuthor() {
        [...]
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {

    <span class="annotation">@OldAndNewPasswordsDifferent</span>
    <span class="directive">public</span> <span class="type">void</span> renewPassword(<span class="predefined-type">String</span> oldPassword, <span class="predefined-type">String</span> newPassword, <span class="predefined-type">String</span> retypedNewPassword);
}

Library library = <span class="keyword">new</span> Library();
author.setLastName(<span class="string"><span class="delimiter">"</span><span class="content">Doe</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of <code class="methodname">addBook()</code> is subject to method parameter validation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">library.addBook(<span class="predefined-constant">null</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateParameters()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming an english locale, the interpolated message is returned</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">may not be null</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );

<span class="keyword">assert</span> library == constraintViolation.getRootBean();
<span class="keyword">assert</span> Library.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> library == constraintViolation.getLeafBean();
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getInvalidValue();

<span class="keyword">assert</span> <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span>{ <span class="predefined-constant">null</span> }.equals( constraintViolation.getExecutableParameters() );
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">addBook</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.METHOD.equals( node.getKind() );

node = nodeIter.next();
<span class="comment">//assuming the default parameter name provider is used</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">arg0</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PARAMETER.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of <code class="methodname">addBook()</code> is subject to method parameter validation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">library.addBook(book);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateParameters()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming an english locale, the interpolated message is returned</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">may not be null or empty</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );

<span class="keyword">assert</span> library == constraintViolation.getRootBean();
<span class="keyword">assert</span> Library.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> book == constraintViolation.getLeafBean();
<span class="keyword">assert</span> book.getTitle().equals( constraintViolation.getInvalidValue() );

<span class="keyword">assert</span> <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span>{ book }.equals( constraintViolation.getExecutableParameters() );
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">addBook</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.METHOD.equals( node.getKind() );

node = nodeIter.next();
<span class="comment">//assuming the default parameter name provider is used</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">arg0</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PARAMETER.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">title</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PROPERTY.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of <code class="methodname">User.renewPassword()</code> is subject to method parameter validation and the <code class="classname">@OldAndNewPasswordsDifferent</code> constraint is violated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">User user = [...];
user.renewPassword(<span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateParameters()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">assert</span> user == constraintViolation.getRootBean();
<span class="keyword">assert</span> User.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> user == getLeafBean();
<span class="keyword">assert</span> <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span>{ <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span> }.equals( constraintViolation.getInvalidValue() );

<span class="keyword">assert</span> <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span>{ <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">foo</span><span class="delimiter">"</span></span> }.equals( constraintViolation.getExecutableParameters() );
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">renewPassword</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.METHOD.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">&lt;cross-parameter&gt;</span><span class="delimiter">"</span></span> == node.getName();
<span class="keyword">assert</span> ElementKind.CROSS_PARAMETER.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of the <code class="classname">Library</code> constructor accepting a list of books is subject to constructor parameter validation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Library anotherLibrary = <span class="keyword">new</span> Library(<span class="predefined-constant">null</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateConstructorParameters()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming an english locale, the interpolated message is returned</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">may not be null</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );

<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getRootBean();
<span class="keyword">assert</span> Library.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getLeafBean();
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getInvalidValue();

<span class="keyword">assert</span> <span class="keyword">new</span> <span class="predefined-type">Object</span><span class="type">[]</span>{ <span class="predefined-constant">null</span> }.equals( constraintViolation.getExecutableParameters() );
<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">Library</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.CONSTRUCTOR.equals( node.getKind() );

node = nodeIter.next();
<span class="comment">//assuming the default parameter name provider is used</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">arg0</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PARAMETER.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of <code class="methodname">getMostPopularBookPerAuthor()</code> is subject to method return value validation and returns a <code class="classname">Map</code> containing one entry with key <code class="varname">author</code> and value <code class="varname">book</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Map</span>&lt;Author, <span class="predefined-type">Book</span>&gt; mostPopularBookPerAuthor = library.getMostPopularBookPerAuthor();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateReturnValue()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//assuming an english locale, the interpolated message is returned</span>
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">may not be null or empty</span><span class="delimiter">"</span></span>.equals( constraintViolation.getMessage() );

<span class="keyword">assert</span> library == constraintViolation.getRootBean();
<span class="keyword">assert</span> Library.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> book == constraintViolation.getLeafBean();
<span class="keyword">assert</span> book.getTitle().equals( constraintViolation.getInvalidValue() );

<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableParameters();
<span class="keyword">assert</span> mostPopularBookPerAuthor == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">getMostPopularBookPerAuthor</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.METHOD.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">&lt;return value&gt;</span><span class="delimiter">"</span></span> == node.getName();
<span class="keyword">assert</span> ElementKind.RETURN_VALUE.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">title</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.PROPERTY.equals( node.getKind() );
<span class="keyword">assert</span> author.equals( node.getKey() );
<span class="keyword">assert</span> <span class="predefined-constant">true</span> == node.isInIterable();

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the following invocation of the <code class="classname">Library</code> default constructor is subject to constructor return value validation and returns an instance which violates the <code class="classname">@PublicLibrary</code> constraint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Library publicLibrary = <span class="keyword">new</span> Library();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one <code class="classname">ConstraintViolation</code> object would be returned by <code class="methodname">ExecutableValidator.validateConstructorReturnValue()</code> which satisfies the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getRootBean();
<span class="keyword">assert</span> Library.class == constraintViolation.getRootBeanClass();
<span class="keyword">assert</span> publicLibrary == constraintViolation.getLeafBean();
<span class="keyword">assert</span> publicLibrary == constraintViolation.getInvalidValue();

<span class="keyword">assert</span> <span class="predefined-constant">null</span> == constraintViolation.getExecutableParameters();
<span class="keyword">assert</span> library == constraintViolation.getExecutableReturnValue();

<span class="predefined-type">Iterator</span>&lt;Node&gt; nodeIter = constraintViolation.getPropertyPath().iterator();

Node node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">Library</span><span class="delimiter">"</span></span>.equals( node.getName() );
<span class="keyword">assert</span> ElementKind.CONSTRUCTOR.equals( node.getKind() );

node = nodeIter.next();
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">&lt;return value&gt;</span><span class="delimiter">"</span></span> == node.getName();
<span class="keyword">assert</span> ElementKind.RETURN_VALUE.equals( node.getKind() );

<span class="keyword">assert</span> <span class="predefined-constant">false</span> == nodeIter.hasNext();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validationapi-message"><a class="anchor" href="#validationapi-message"></a>5.3. Message interpolation</h3>
<div class="paragraph">
<p>A message interpolator is responsible for transforming the so called message descriptor specified via the message attribute of the constraint into a fully expanded, human-readable error message.</p>
</div>
<div class="sect3">
<h4 id="validationapi-message-defaultmessageinterpolation"><a class="anchor" href="#validationapi-message-defaultmessageinterpolation"></a>5.3.1. Default message interpolation</h4>
<div class="paragraph">
<p><span class="tck-testable">Every conforming Bean Validation implementation includes a default message interpolator which has to comply with</span> the algorithm defined here to interpolate message descriptors. As precondition for message interpolation the following applies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Each constraint defines a message descriptor via its <code class="methodname">message</code> property.</span></p>
</li>
<li>
<p><span class="tck-testable">Every constraint definition defines a default message descriptor for that constraint.</span></p>
</li>
<li>
<p><span class="tck-testable">Messages can be overridden at constraint declaration time by setting the <code class="methodname">message</code> property on the constraint.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">The message descriptor is a string literal and may contain one or more message parameters or expressions. Message parameters and expressions are string literals enclosed in <code>{}</code> or <code>${}</code> respectively.</span> The following character escaping rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable"><code class="code">\{</code> is considered as the literal <code>{</code> instead of being considered as the beginning of a message parameter</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="code">\}</code> is considered as the literal <code>}</code> instead of being considered as the end of a message parameter</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="code">\\</code> is considered as the literal <code>\</code> instead of being considered as the escaping character</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="code">\$</code> is considered as the literal <code>$</code> instead of being considered as the beginning of a message expression</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below are two examples using message parameters and expressions. The second is evaluated using Expression Language as defined in <a href="#validationapi-message-defaultmessageinterpolation-expressionlanguage">Message expressions using Expression Language (EL)</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 66. Message using parameters</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Value must be between {min} and {max}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 67. Message using expressions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">Must be greater than <span class="error">$</span>{inclusive == <span class="predefined-constant">true</span> ? <span class="string"><span class="delimiter">'</span><span class="content">or equal to </span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>}{value}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="validationapi-message-defaultmessageinterpolation-resolutionalgorithm"><a class="anchor" href="#validationapi-message-defaultmessageinterpolation-resolutionalgorithm"></a><span class="rcl-da">5.3.1.1</span><span class="rcl-da">.</span> Default message interpolation algorithm</h5>
<div class="paragraph">
<p>The default message interpolator uses the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><span class="tck-testable">Message parameters are extracted from the message string and used as keys to search the <code class="classname">ResourceBundle</code> named <code>ValidationMessages</code></span> (often materialized as the property file <code class="filename">/ValidationMessages.properties</code> and its locale variations) using the defined locale (see <a href="#validationapi-message-defaultmessageinterpolation-locale">Locale for default message interpolation</a>). If a property is found, the message parameter is replaced with the property value in the message string. <span class="tck-testable">Step 1 is applied recursively until no replacement is performed</span> (i.e. a message parameter value can itself contain a message parameter).</p>
</li>
<li>
<p><span class="tck-testable">Message parameters are extracted from the message string and used as keys to search the Bean Validation provider’s built-in <code class="classname">ResourceBundle</code> using the defined locale (see <a href="#validationapi-message-defaultmessageinterpolation-locale">Locale for default message interpolation</a>). If a property is found, the message parameter is replaced with the property value in the message string.</span> <span class="tck-not-testable">Contrary to step 1, step 2 is not processed recursively.</span></p>
</li>
<li>
<p><span class="tck-not-testable">If step 2 triggers a replacement, then step 1 is applied again.</span> Otherwise step 4 is performed.</p>
</li>
<li>
<p><span class="tck-testable">Message parameters are extracted from the message string. Those matching the name of an attribute of the constraint are replaced by the value of that attribute in the constraint declaration. Parameter interpolation has precedence over message expressions. For example for the message descriptor <code>${value}</code>, trying to evaluate <code>{value}</code> as message parameter has precedence over evaluating <code>${value}</code> as message expression.</span></p>
</li>
<li>
<p><span class="tck-testable">Message expressions are extracted from the message string and evaluated using Expression Language. See also <a href="#validationapi-message-defaultmessageinterpolation-expressionlanguage">Message expressions using Expression Language (EL)</a>.</span></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The proposed algorithm ensures that custom resource bundle always have priority over built-in resource bundle at all level of the recursive resolution. It also ensures that constraint declarations attributes values are not interpolated further.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The precedence of message parameter over expression interpolation ensures backwards compatibility to Bean Validation 1.0.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="validationapi-message-defaultmessageinterpolation-locale"><a class="anchor" href="#validationapi-message-defaultmessageinterpolation-locale"></a><span class="rcl-da">5.3.1.2</span><span class="rcl-da">.</span> Locale for default message interpolation</h5>
<div class="paragraph">
<p>The locale to be used for message interpolation is defined as following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">if the locale is passed explicitly to the interpolator method via <code class="methodname">interpolate(String, Context, Locale)</code>, this provided instance is used.</span></p>
</li>
<li>
<p><span class="tck-testable">otherwise, the default <code class="classname">Locale</code> as provided by <code class="methodname">Locale.getDefault()</code> is used.</span></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="validationapi-message-defaultmessageinterpolation-expressionlanguage"><a class="anchor" href="#validationapi-message-defaultmessageinterpolation-expressionlanguage"></a><span class="rcl-da">5.3.1.3</span><span class="rcl-da">.</span> Message expressions using Expression Language (EL)</h5>
<div class="paragraph">
<p><span class="tck-testable">The default message interpolation allows the use of Expression Language (EL) as defined in JSR 341.</span> <span class="tck-testable">Expressions to be evaluated by EL need to be enclosed in <code>${}</code> within the message descriptor</span> . The following properties and beans have to be made available in the EL context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">the attribute values of the constraint declaration mapped to their attribute name</span></p>
</li>
<li>
<p><span class="tck-testable">the validated value mapped under the name <code>validatedValue</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">a bean mapped to the name <code>formatter</code> exposing the vararg method <code class="methodname">format(String format, Object... args)</code>. This method must behave like <code class="methodname">java.util.Formatter.format(String format, Object... args)</code>. The locale used for formatting is defined by <a href="#validationapi-message-defaultmessageinterpolation-locale">Locale for default message interpolation</a>. The <code>formatter</code> bean allows to format property values, for example in the case of the validated value being 98.12345678, <code>${formatter.format('%1$.2f', validatedValue)}</code> would format it to 98.12 (two digits after the decimal point, where the use of '.' vs ',' would be locale specific).</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">If an exception occurs during message interpolation, e.g. due invalid expressions or references to an unknown property, the message expression stays unchanged.</span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-message-customresolution"><a class="anchor" href="#validationapi-message-customresolution"></a>5.3.2. Custom message interpolation</h4>
<div class="paragraph">
<p>A custom message interpolator may be provided (e.g., to interpolate contextual data, or to adjust the default <code class="classname">Locale</code> used). A message interpolator implements the <code class="classname">MessageInterpolator</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Interpolates a given constraint violation message.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Implementations should be as tolerant as possible on syntax errors.
 * Implementations must be thread-safe.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MessageInterpolator</span> {

    <span class="comment">/**
     * Interpolates the message template based on the constraint validation context.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The locale is defaulted according to the {@code MessageInterpolator}
     * implementation. See the implementation documentation for more detail.
     *
     * @param messageTemplate the message to interpolate
     * @param context contextual information related to the interpolation
     *
     * @return interpolated error message
     */</span>
    <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> messageTemplate, <span class="predefined-type">Context</span> context);

    <span class="comment">/**
     * Interpolates the message template based on the constraint validation context.
     * The {@code Locale} used is provided as a parameter.
     *
     * @param messageTemplate the message to interpolate
     * @param context contextual information related to the interpolation
     * @param locale the locale targeted for the message
     *
     * @return interpolated error message
     */</span>
    <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> messageTemplate, <span class="predefined-type">Context</span> context,  <span class="predefined-type">Locale</span> locale);

    <span class="comment">/**
     * Information related to the interpolation context.
     */</span>
    <span class="type">interface</span> <span class="class">Context</span> {
        <span class="comment">/**
         * @return {@link ConstraintDescriptor} corresponding to the constraint being validated
         */</span>
        ConstraintDescriptor&lt;?&gt; getConstraintDescriptor();

        <span class="comment">/**
         * @return value being validated
         */</span>
        <span class="predefined-type">Object</span> getValidatedValue();

        <span class="comment">/**
         * Returns an instance of the specified type allowing access to
         * provider-specific APIs. If the Bean Validation provider
         * implementation does not support the specified class,
         * {@link ValidationException} is thrown.
         *
         * @param type the class of the object to be returned
         * @<span class="rcl-da">param</span> <span class="rcl-da">&lt;</span><span class="rcl-da">T</span><span class="rcl-da">&gt;</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">object</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">returned</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span>return an instance of the specified class
         * @throws ValidationException if the provider does not support the call
         *
         * @since 1.1
         */</span>
        &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; type);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="parameter">messageTemplate</code> is the value of the <code>message</code> attribute of the constraint declaration or provided to the <code class="classname">ConstraintValidatorContext</code> methods.</span></p>
</div>
<div class="paragraph">
<p>The <code class="classname">Context</code> object contains contextual information related to the interpolation.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintDescriptor()</code> returns the <code class="classname">ConstraintDescriptor</code> object representing the metadata of the failing constraint (see <a href="#constraintmetadata">Constraint metadata request APIs</a>).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getValidatedValue()</code> returns the value being validated.</span></p>
</div>
<div class="paragraph">
<p><code class="methodname">MessageInterpolator.interpolate(String, Context)</code> is invoked for each constraint violation report generated. The default <code class="classname">Locale</code> is implementation specific.</p>
</div>
<div class="paragraph">
<p><code class="methodname">MessageInterpolator.interpolate(String, Context, Locale)</code> can be invoked by a wrapping <code class="classname">MessageInterpolator</code> to enforce a specific <code class="classname">Locale</code> value by bypassing or overriding the default <code class="classname">Locale</code> strategy (see <a href="#validationapi-message-examples-specificlocale">Use MessageInterpolator to use a specific Locale value</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">A message interpolator implementation must be thread-safe.</span></p>
</div>
<div class="paragraph">
<p>The message interpolator is provided to the <code class="classname">ValidatorFactory</code> at construction time using <code class="methodname">Configuration.messageInterpolator(MessageInterpolator)</code>. This message interpolator is shared by all <code class="classname">Validator</code> objects generated by this <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">It is possible to override the <code class="classname">MessageInterpolator</code> implementation for a given <code class="classname">Validator</code> instance by invoking <code class="methodname">ValidatorFactory.usingContext().messageInterpolator(messageInterpolator).getValidator()</code>.</span></p>
</div>
<div class="paragraph">
<p>It is recommended that <code class="classname">MessageInterpolator</code> implementations delegate final interpolation to the Bean Validation default <code class="classname">MessageInterpolator</code> to ensure standard Bean Validation interpolation rules are followed, <span class="tck-testable">The default implementation is accessible through <code class="methodname">Configuration.getDefaultMessageInterpolator()</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the interpolation process leads to an exception, the exception is wrapped into a <code class="classname">ValidationException</code>.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-message-examples"><a class="anchor" href="#validationapi-message-examples"></a>5.3.3. Examples</h4>
<div class="paragraph">
<p>These examples describe message interpolation based on the default message interpolator’s built-in messages (see <a href="#standard-resolver-messages">Standard ResourceBundle messages</a>), and the <code class="filename">ValidationMessages.properties</code> file shown in table <a href="#table-messageinterpolation">message interpolation</a>. The current locale is assumed English.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//ValidationMessages.properties</span>
myapp.creditcard.error=credit card number not valid</code></pre>
</div>
</div>
<table id="table-messageinterpolation" class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. message interpolation</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failing constraint declaration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interpolated message</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@NotNull</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">must not be null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Max(30)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">must be less than or equal to 30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Size(min=5, max=15, message="Key must have \\{{min}\\} \\ \\{{max}\\} characters")</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key must have {5} \ {15} characters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@Digits(integer=9, fraction=2)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">numeric value out of bounds (&lt;9 digits&gt;.&lt;2
              digits&gt; expected)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="classname">@CreditCard(message={myapp.creditcard.error})</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">credit card number not valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here is an approach to specify the <code class="classname">Locale</code> value to choose on a given <code class="classname">Validator</code> using a <code class="classname">Locale</code> aware <code class="classname">MessageInterpolator</code>. See <a href="#validationapi-bootstrapping">Bootstrapping</a> for more details on the APIs.</p>
</div>
<div id="validationapi-message-examples-specificlocale" class="exampleblock">
<div class="title">Example 68. Use MessageInterpolator to use a specific Locale value</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Delegates to a MessageInterpolator implementation but enforces a given Locale
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LocaleSpecificMessageInterpolator</span> <span class="directive">implements</span> MessageInterpolator {
    <span class="directive">private</span> <span class="directive">final</span> MessageInterpolator defaultInterpolator;
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Locale</span> defaultLocale;

    <span class="directive">public</span> LocaleSpecificMessageInterpolator(MessageInterpolator interpolator, <span class="predefined-type">Locale</span> locale) {
        <span class="local-variable">this</span>.defaultLocale = locale;
        <span class="local-variable">this</span>.defaultInterpolator = interpolator;
    }

    <span class="comment">/**
     * enforces the locale passed to the interpolator
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> message,
                              <span class="predefined-type">Context</span> context) {
        <span class="keyword">return</span> defaultInterpolator.interpolate(message,
                                               context,
                                               <span class="local-variable">this</span>.defaultLocale);
    }

    <span class="comment">// no real use, implemented for completeness</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> message,
                              <span class="predefined-type">Context</span> context,
                              <span class="predefined-type">Locale</span> locale) {
        <span class="keyword">return</span> defaultInterpolator.interpolate(message, context, locale);
    }
}


<span class="predefined-type">Locale</span> locale = getMyCurrentLocale();
MessageInterpolator interpolator = <span class="keyword">new</span> LocaleSpecificMessageInterpolator(
                                       validatorFactory.getMessageInterpolator(),
                                       locale);

<span class="predefined-type">Validator</span> validator = validatorFactory.usingContext()
                                      .messageInterpolator(interpolator)
                                      .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Most of the time, however, the relevant <code class="classname">Locale</code> will be provided by your application framework transparently. This framework will implement its own version of <code class="classname">MessageInterpolator</code> and pass it during the <code class="classname">ValidatorFactory</code> configuration. The application will not have to set the <code class="classname">Locale</code> itself. This example shows how a container framework would implement <code class="classname">MessageInterpolator</code> to provide a user specific default locale.</p>
</div>
<div id="validationapi-message-examples-jsflocale" class="exampleblock">
<div class="title">Example 69. Contextual container possible <code class="classname">MessageInterpolator</code> implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">ContextualMessageInterpolator</span> <span class="directive">implements</span> MessageInterpolator {
    <span class="directive">private</span> <span class="directive">final</span> MessageInterpolator delegate;

    <span class="directive">public</span> ContextualMessageInterpolator(MessageInterpolator delegate) {
        <span class="local-variable">this</span>.delegate = delegate;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> message, <span class="predefined-type">Context</span> context) {
        <span class="predefined-type">Locale</span> locale = <span class="predefined-type">Container</span>.getManager().getUserLocale();
        <span class="keyword">return</span> <span class="local-variable">this</span>.delegate.interpolate(
                        message, context, locale );
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> interpolate(<span class="predefined-type">String</span> message, <span class="predefined-type">Context</span> context, <span class="predefined-type">Locale</span> locale) {
        <span class="keyword">return</span> <span class="local-variable">this</span>.delegate.interpolate(message, context, locale);
    }
}


<span class="comment">//Build the ValidatorFactory</span>
<span class="predefined-type">Configuration</span>&lt;?&gt; configuration = Validation.byDefaultProvider().configure();
ValidatorFactory factory = configuration
    .messageInterpolator(
        <span class="keyword">new</span> ContextualMessageInterpolator(
                configuration.getDefaultMessageInterpolator() ) )
    .buildValidatorFactory();

<span class="comment">//The container uses the factory to validate constraints using the specific MessageInterpolator</span>
<span class="predefined-type">Validator</span> validator = factory.getValidator();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validationapi-triggeringmethodvalidation"><a class="anchor" href="#validationapi-triggeringmethodvalidation"></a>5.4. Triggering method validation</h3>
<div class="paragraph">
<p>Bean Validation itself doesn’t trigger the evaluation of method constraints. That is, just annotating any methods or constructors with parameter or return value constraints doesn’t automatically enforce these constraints, just as annotating any fields or properties with bean constraints doesn’t enforce these either.</p>
</div>
<div class="paragraph">
<p>Instead method constraints must be validated by invoking the appropriate methods on <code class="classname">javax.validation.executable.ExecutableValidator</code>. Typically this won’t happen by manually calling these methods but rather automatically upon invocation of the constrained methods or constructors, using approaches and techniques such as CDI/EJB interceptors, aspect-oriented programming or dynamic proxies.</p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The validation of method / constructor constraints comprises the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Intercept the method call to be validated</p>
</li>
<li>
<p>Validate the parameter values provided by the method caller using <code class="methodname">ExecutableValidator.validateParameters()</code> or <code class="methodname">ExecutableValidator.validateConstructorParameters()</code>.</p>
</li>
<li>
<p>If this validation yields a non-empty set of constraint violations, throw a <code class="classname">ConstraintViolationException</code> wrapping the violations. Otherwise proceed with the actual method invocation.</p>
</li>
<li>
<p>Validate the result returned by the invoked method using <code class="methodname">ExecutableValidator.validateReturnValue()</code> or <code class="methodname">ExecutableValidator.validateConstructorReturnValue()</code>.</p>
</li>
<li>
<p>If this validation yields a non-empty set of constraint violations, throw a <code class="classname">ConstraintViolationException</code> wrapping the violations. Otherwise return the invocation result to the method caller.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p>By throwing a <code class="classname">ConstraintViolationException</code> if either of the validation steps fails, it is ensured that the control flow</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only arrives at the method’s body if the caller has satisfied the method’s preconditions and</p>
</li>
<li>
<p>only returns to the method caller if the method’s postconditions are guaranteed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, integrators intercept and validate methods hosting either a constraint or being marked for cascaded validation (<code class="classname">@Valid</code>) whether it be on the method itself or on any of its parameters. <span class="tck-testable">The <code class="classname">Default</code> group is used for validation out of the box.</span></p>
</div>
<div class="paragraph">
<p>Integrators are encouraged to use Bean Validation’s metadata API to find whether or not a method or a constructor should be intercepted. This guarantees that XML descriptors as well as future mapping strategies are taken into account. Note that the metadata API does not take into account the fact that a method or constructor validation has been enabled or disabled by the techniques described in <a href="#integration-general-executable">Method and constructor validation</a>.</p>
</div>
<div class="paragraph">
<p>Here is an example of what such metadata usage would be:</p>
</div>
<div class="exampleblock">
<div class="title">Example 70. Using metadata API to figure out if method interception is required</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//For methods</span>

<span class="comment">// is there any constrained method on this type</span>
<span class="comment">// assuming we don't validate on getter execution</span>
<span class="directive">public</span> <span class="type">boolean</span> interceptMethods(<span class="predefined-type">Class</span>&lt;?&gt; type) {
    <span class="keyword">return</span> validator.getConstraintsForClass( type ).getConstrainedMethods(MethodType.NON_GETTER).size() &gt; <span class="integer">0</span>;
}

<span class="comment">// is this method constrained</span>
<span class="directive">public</span> <span class="type">boolean</span> interceptMethod(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Method</span> method) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    <span class="predefined-type">MethodDescriptor</span> methodDescriptor = bean.getConstraintsForMethod(
        method.getName(), method.getParameterTypes() );
    <span class="keyword">return</span> methodDescriptor != <span class="predefined-constant">null</span>;
}

<span class="comment">// should method parameters be validated</span>
<span class="directive">public</span> <span class="type">boolean</span> requiresParametersValidation(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Method</span> method) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    <span class="predefined-type">MethodDescriptor</span> methodDescriptor = bean.getConstraintsForMethod(
        method.getName(), method.getParameterTypes() );
    <span class="keyword">if</span> ( methodDescriptor != <span class="predefined-constant">null</span> ) {
        <span class="keyword">return</span> methodDescriptor.hasConstrainedParameters();
    }
    <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }
}

<span class="comment">// should method return value be validated?</span>
<span class="directive">public</span> <span class="type">boolean</span> requiresReturnValueValidation(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Method</span> method) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    <span class="predefined-type">MethodDescriptor</span> methodDescriptor = bean.getConstraintsForMethod(
        method.getName(), method.getParameterTypes() );
    <span class="keyword">if</span> ( methodDescriptor != <span class="predefined-constant">null</span> ) {
        <span class="keyword">return</span> methodDescriptor.hasConstrainedReturnValue();
    }
    <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 71. Using metadata API to figure out if constructor interception is required</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//For constructors</span>

<span class="comment">// is there any constrained constructor on this type</span>
<span class="directive">public</span> &lt;T&gt; <span class="type">boolean</span> interceptConstructors(<span class="predefined-type">Class</span>&lt;T&gt; type) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    <span class="keyword">return</span> bean.getConstrainedConstructors().size() &gt; <span class="integer">0</span>;
}

<span class="comment">// is this constructor constrained</span>
<span class="directive">public</span> &lt;T&gt; <span class="type">boolean</span> interceptConstructor(<span class="predefined-type">Class</span>&lt;T&gt; type, <span class="predefined-type">Constructor</span>&lt;T&gt; ctor) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    ConstructorDescriptor constructorDescriptor = bean.getConstraintsForConstructor(
        ctor.getParameterTypes() );
    <span class="keyword">return</span> constructorDescriptor != <span class="predefined-constant">null</span>;
}

<span class="comment">// should constructor parameters be validated</span>
<span class="directive">public</span> &lt;T&gt; <span class="type">boolean</span> requiresParametersValidation(<span class="predefined-type">Class</span>&lt;T&gt; type, <span class="predefined-type">Constructor</span>&lt;T&gt; ctor) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    ConstructorDescriptor constructorDescriptor = bean.getConstraintsForConstructor(
        ctor.getParameterTypes() );
    <span class="keyword">if</span> ( constructorDescriptor != <span class="predefined-constant">null</span> ) {
        <span class="keyword">return</span> constructorDescriptor.hasConstrainedParameters();
    }
    <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }
}

<span class="comment">// should constructor return value be validated?</span>
<span class="directive">public</span> &lt;T&gt; <span class="type">boolean</span> requiresReturnValueValidation(<span class="predefined-type">Class</span>&lt;T&gt; type, <span class="predefined-type">Constructor</span>&lt;T&gt; ctor) {
    <span class="predefined-type">BeanDescriptor</span> bean = validator.getConstraintsForClass( type );
    ConstructorDescriptor constructorDescriptor = bean.getConstraintsForConstructor(
        ctor.getName(),
        ctor.getParameterTypes()
    );
    <span class="keyword">if</span> ( constructorDescriptor != <span class="predefined-constant">null</span> ) {
        <span class="keyword">return</span> constructorDescriptor.hasConstrainedReturnValue();
    }
    <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Calls to the metadata API is likely only going to be needed during the initialization phase of the interception framework. Results can then be cached.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Only methods or constructors intercepted by the underlying interception technology can be validated.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The integration technology must put the validation interceptor as late as possible (if not last) in the interception stack. In particular, validation of parameters should be done after the security and transaction start logic. Likewise, return value validation should be done before the transaction stop logic. Putting the validation interceptor as late as possible in the stack ensures this.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Why have the validation interceptor after other interceptors?</div>
<div class="paragraph">
<p>There are several reasons for delaying validation compared to other interceptors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You don’t want to start business code before security has been cleared</p>
</li>
<li>
<p>You might need transaction support in your validations</p>
</li>
<li>
<p>You want transaction to fail if the return value is invalid</p>
</li>
<li>
<p>Generally speaking, it makes more sense to apply technical layers around the more business focused constraints</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="validationapi-bootstrapping"><a class="anchor" href="#validationapi-bootstrapping"></a>5.5. Bootstrapping</h3>
<div class="paragraph">
<p>The bootstrapping API aims at providing a <code class="classname">ValidatorFactory</code> object which is used to create <code class="classname">Validator</code> instances. The bootstrap process is decoupled from the provider implementation initialization: <span class="tck-testable">a bootstrap implementation must be able to bootstrap any Bean Validation provider implementation.</span> The bootstrap sequence has been designed to achieve several goals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plug multiple implementations</p>
</li>
<li>
<p>choose a specific implementation</p>
</li>
<li>
<p>extensibility: an application using a specific provider implementation can use specific configurations</p>
</li>
<li>
<p>share and reuse of metadata across <code class="classname">Validator</code>s</p>
</li>
<li>
<p>leave as much freedom as possible to implementations</p>
</li>
<li>
<p>provide integration mechanisms to Java EE (starting from version 6) and other containers</p>
</li>
<li>
<p>type safety</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main artifacts involved in the bootstrap process are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">Validation</code>: API entry point. Lets you optionally define the Bean Validation provider targeted as well as a provider resolution strategy. <code class="classname">Validation</code> generates <code class="classname">Configuration</code> objects and can bootstrap any provider implementation.</p>
</li>
<li>
<p><code class="classname">ValidationProvider</code>: contract between the bootstrap procedure and a Bean Validation provider implementation.</p>
</li>
<li>
<p><code class="classname">ValidationProviderResolver</code>: returns a list of all Bean Validation providers available in the execution context (generally the classpath).</p>
</li>
<li>
<p><code class="classname">Configuration</code>: collects the configuration details that will be used to build <code class="classname">ValidatorFactory</code>. A specific sub interface of <code class="classname">Configuration</code> must be provided by Bean Validation providers. This sub interface typically hosts provider specific configurations.</p>
</li>
<li>
<p><code class="classname">ValidatorFactory</code>: result of the bootstrap process. Build <code class="classname">Validator</code> instances from a given Bean Validation provider.</p>
</li>
<li>
<p><code class="filename">META-INF/validation.xml</code>: a configuration file Bean Validation users can use to customize the configuration of the default <code class="classname">ValidatorFactory</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let’s first see the API in action through some examples before diving into the concrete definitions.</p>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-examples"><a class="anchor" href="#validationapi-bootstrapping-examples"></a>5.5.1. Examples</h4>
<div class="paragraph">
<p>The most simple approach is to initialize the default Bean Validation provider or the one defined in the XML configuration file. The <code class="classname">ValidatorFactory</code> is then ready to provide <code class="classname">Validator</code> instances.</p>
</div>
<div class="exampleblock">
<div class="title">Example 72. Simple Bean Validation bootstrap sequence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">ValidatorFactory factory = Validation.buildDefaultValidatorFactory();

<span class="comment">//cache the factory somewhere</span>
<span class="predefined-type">Validator</span> validator = factory.getValidator();

<span class="comment">//when the application shuts down, close ValidatorFactory</span>
factory.close();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">The <code class="classname">ValidatorFactory</code> object is thread-safe.</span> Building <code class="classname">Validator</code> instances is typically a cheap operation. Building a <code class="classname">ValidatorFactory</code> is typically more expensive. Make sure to check your Bean Validation implementation documentation for more accurate details.</p>
</div>
<div class="paragraph">
<p>The second example shows how a container can customize some Bean Validator resource handling to match its own behavior.</p>
</div>
<div class="exampleblock">
<div class="title">Example 73. Customize message resolution, traversable resolver, constraint validator factory, parameter name provider and clock provider implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//some customization from a container</span>
ValidatorFactory factory = Validation
       .byDefaultProvider().configure()
          .messageInterpolator( <span class="keyword">new</span> ContainerMessageInterpolator() )
          .constraintValidatorFactory( <span class="keyword">new</span> ContainerComponentConstraintValidatorFactory() )
          .traversableResolver( <span class="keyword">new</span> JPAAwareTraversableResolver() )
          .parameterNameProvider( <span class="keyword">new</span> AnnotationBasedParameterNameProvider() )
          .clockProvider( <span class="keyword">new</span> BatchJobClockProvider() )
          .buildValidatorFactory();

<span class="comment">//cache the factory somewhere</span>
<span class="predefined-type">Validator</span> validator = factory.getValidator();

<span class="comment">//when the application shuts down, close ValidatorFactory</span>
factory.close();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The third example shows how to bootstrap Bean Validation in an environment not following the traditional Java classloader strategies (such as tools or alternative service containers like OSGi). They can provide some alternative provider resolution strategy to discover Bean Validation providers.</p>
</div>
<div class="exampleblock">
<div class="title">Example 74. Customize the Bean Validation provider resolution mechanism</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//osgi environment</span>
ValidatorFactory factory = Validation
       .byDefaultProvider()
          .providerResolver( <span class="keyword">new</span> OSGiServiceDiscoverer() )
          .configure()
             .buildValidatorFactory();

<span class="comment">//cache the factory somewhere</span>
<span class="predefined-type">Validator</span> validator = factory.getValidator();

<span class="comment">//when the bundle shuts down, close ValidatorFactory</span>
factory.close();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The next example shows how a client can choose a specific Bean Validation provider and configure provider specific properties programmatically in a type-safe way.</p>
</div>
<div class="exampleblock">
<div class="title">Example 75. Use a specific provider and add specific configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">ValidatorFactory factory = Validation
       .byProvider( ACMEProvider.class )  <span class="comment">//chose a specific provider</span>
       .configure()
          .messageInterpolator( <span class="keyword">new</span> ContainerMessageInterpolator() ) <span class="comment">//default configuration option</span>
          .addConstraint(Address.class, customConstraintDescriptor) <span class="comment">//ACME specific method</span>
          .buildValidatorFactory();

<span class="comment">//same initialization decomposing calls</span>
ACMEConfiguration acmeConfiguration = Validation
       .byProvider( ACMEProvider.class )
       .configure();

ValidatorFactory factory = acmeConfiguration
          .messageInterpolator( <span class="keyword">new</span> ContainerMessageInterpolator() ) <span class="comment">//default configuration option</span>
          .addConstraint(Address.class, customConstraintDescriptor) <span class="comment">//ACME specific method</span>
          .buildValidatorFactory();

<span class="comment">/**
 * ACME specific validator configuration and configuration options
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ACMEConfiguration</span> <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;ACMEConfiguration&gt; {
    <span class="comment">/**
     * Programmatically add constraints. Specific to the ACME provider.
     */</span>
    ACMEConfiguration addConstraint(<span class="predefined-type">Class</span>&lt;?&gt; entity,
                                    ACMEConstraintDescriptor constraintDescriptor);
}

<span class="comment">/**
 * ACME validation provider
 * Note how ACMEConfiguration and ACMEProvider are linked together
 * via the generic parameter.
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ACMEProvider</span> <span class="directive">implements</span> ValidationProvider&lt;ACMEConfiguration&gt; {
    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The last example shows how a <code class="classname">Validator</code> can use a specific <code class="classname">MessageInterpolator</code> implementation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 76. Use a specific MessageInterpolator instance for a given Validator</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">ValidatorFactory factory = [...];
MessageInterpolator customInterpolator = <span class="keyword">new</span> LocaleSpecificMessageInterpolator(
    locale,
    factory.getMessageInterpolator()
);

<span class="predefined-type">Validator</span> localizedValidator =
    factory.usingContext()
                   .messageInterpolator(customInterpolator)
                   .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the same way, a custom <code class="classname">TraversableResolver</code> can be passed.</p>
</div>
<div class="paragraph">
<p>We will now explore the various interfaces, their constraints and usage. We will go from the <code class="classname">ValidatorFactory</code> to the <code class="classname">Validation</code> class walking up the bootstrap chain.</p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-validatorfactory"><a class="anchor" href="#validationapi-bootstrapping-validatorfactory"></a>5.5.2. ValidatorFactory</h4>
<div class="paragraph">
<p><code class="classname">ValidatorFactory</code> objects build and provide initialized instances of <code class="classname">Validator</code> to Bean Validation clients. Each <code class="classname">Validator</code> instance is configured for a given context (message interpolator, traversable resolver etc.). Clients should cache <code class="classname">ValidatorFactory</code> objects and reuse them for optimal performances. The API is designed to allow implementors to share constraint metadata in <code class="classname">ValidatorFactory</code>. <code class="classname">ValidatorFactory</code> instances must be closed (by calling the <code class="methodname">close()</code> method) by its creator when no longer in use.</p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable"><code class="classname">ValidatorFactory</code> implementations must be thread-safe.</span> <code class="classname">ValidatorFactory</code> implementations can cache <code class="classname">Validator</code> instances if needed.</p>
</div>
<div class="exampleblock">
<div class="title">Example 77. ValidatorFactory interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Factory returning initialized {@code Validator} instances.
 * &lt;p&gt;
 * Implementations are thread-safe and instances are typically cached and reused.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 * @author Hardy Ferentschik
 * @author Guillaume Smet
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ValidatorFactory</span> <span class="directive">extends</span> AutoCloseable {

    <span class="comment">/**
     * Returns an initialized {@link Validator} instance using the
     * factory defaults for message interpolator, traversable resolver
     * and constraint validator factory.
     * &lt;p&gt;
     * Validator instances can be pooled and shared by the implementation.
     *
     * @return an initialized {@code Validator} instance
     */</span>
    <span class="predefined-type">Validator</span> getValidator();

    <span class="comment">/**
     * Defines a new validator context and returns a {@code Validator}
     * compliant this new context.
     *
     * @return a {@link ValidatorContext} instance
     */</span>
    ValidatorContext usingContext();

    <span class="comment">/**
     * Returns the {@link MessageInterpolator} instance configured at
     * initialization time for the {@code ValidatorFactory}.
     * This is the instance used by {@link #getValidator()}.
     *
     * @return {@code MessageInterpolator} instance
     */</span>
    MessageInterpolator getMessageInterpolator();

    <span class="comment">/**
     * Returns the {@link TraversableResolver} instance configured
     * at initialization time for the {@code ValidatorFactory}.
     * This is the instance used by {@link #getValidator()}.
     *
     * @return {@code TraversableResolver} instance
     */</span>
    TraversableResolver getTraversableResolver();

    <span class="comment">/**
     * Returns the {@link ConstraintValidatorFactory} instance
     * configured at initialization time for the
     * {@code ValidatorFactory}.
     * This is the instance used by {@link #getValidator()}.
     *
     * @return {@code ConstraintValidatorFactory} instance
     */</span>
    ConstraintValidatorFactory getConstraintValidatorFactory();

    <span class="comment">/**
     * Returns the {@link ParameterNameProvider} instance configured at
     * initialization time for the {@code ValidatorFactory}.
     * This is the instance used by #getValidator().
     *
     * @return {@code ParameterNameProvider} instance
     *
     * @since 1.1
     */</span>
    ParameterNameProvider getParameterNameProvider();

    <span class="comment">/**
     * Returns the {@link ClockProvider} instance configured at
     * initialization time for the {@code ValidatorFactory}.
     * This is the instance used by #getValidator().
     *
     * @return {@code ClockProvider} instance
     *
     * @since 2.0
     */</span>
    ClockProvider getClockProvider();

    <span class="comment">/**
     * Returns an instance of the specified type allowing access to
     * provider-specific APIs. If the Bean Validation provider
     * implementation does not support the specified class, a
     * {@code ValidationException} is thrown.
     *
     * @param type the class of the object to be returned
     * @param &lt;T&gt; the type of the object to be returned
     * @return an instance of the specified class
     * @throws ValidationException if the provider does not
     *         support the call.
     */</span>
    <span class="directive">public</span> &lt;T&gt; T unwrap(<span class="predefined-type">Class</span>&lt;T&gt; type);

    <span class="comment">/**
     * Closes the {@code ValidatorFactory} instance.
     *
     * After the {@code ValidatorFactory} instance is closed, calling the following
     * methods is not allowed:
     * &lt;ul&gt;
     *     &lt;li&gt;methods of this {@code ValidatorFactory} instance&lt;/li&gt;
     *     &lt;li&gt;methods of {@link Validator} instances created by this {@code ValidatorFactory}&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @since 1.1
     */</span>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> close();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A <code class="classname">ValidatorFactory</code> is provided by a <code class="classname">Configuration</code> object.</p>
</div>
<div class="paragraph">
<p><code class="methodname">unwrap()</code> is provided as a way to access objects of a given type specific to a Bean Validation provider typically as a complement to the <code class="classname">ValidatorFactory</code> contract. Using this method makes your code non portable.</p>
</div>
<div class="exampleblock">
<div class="title">Example 78. Using unwrap to access a provider specific contract</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//if using the ACME provider</span>
ACMEValidatorFactory acmeFactory = factory.unwrap(ACMEValidatorFactory.class);
acmeFactory.setSpecificConfiguration( [...] );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="methodname">close()</code> closes the <code class="classname">ValidatorFactory</code> instance which becomes unavailable and should be immediately discarded. This is also true of all the <code class="classname">Validator</code> instances it has spawned. The behavior is undefined and non portable if these instances are used after the <code class="classname">ValidatorFactory</code> has been closed.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getMessageInterpolator()</code> returns the <code class="classname">MessageInterpolator</code> instance configured during the initialization of the <code class="classname">ValidatorFactory</code>.</span> It is particularly useful to build a <code class="classname">Validator</code> specific <code class="classname">MessageInterpolator</code> wrapping the one from the <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getTraversableResolver()</code> returns the <code class="classname">TraversableResolver</code> instance configured during the initialization of the <code class="classname">ValidatorFactory</code>.</span> It is particularly useful to build a <code class="classname">Validator</code> specific <code class="classname">TraversableResolver</code> wrapping the one from the <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintValidatorFactory()</code> returns the <code class="classname">ConstraintValidatorFactory</code> instance configured during the initialization of the <code class="classname">ValidatorFactory</code>.</span> It is particularly useful to build a <code class="classname">Validator</code> specific <code class="classname">ConstraintValidatorFactory</code> wrapping the one from the <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getParameterNameProvider()</code> returns the <code class="classname">ParameterNameProvider</code> instance configured during the initialization of the <code class="classname">ValidatorFactory</code>.</span> It is particularly useful to build a <code class="classname">Validator</code> specific <code class="classname">ParameterNameProvider</code> wrapping the one from the <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getClockProvider()</code> returns the <code class="classname">ClockProvider</code> instance configured during the initialization of the <code class="classname">ValidatorFactory</code>.</span> It is particularly useful to build a <code class="classname">Validator</code> specific <code class="classname">ClockProvider</code> wrapping the one from the <code class="classname">ValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><code class="classname">ValidatorContext</code> returned by <code class="methodname">usingContext()</code> can be used to customize the state in which the <code class="classname">Validator</code> must be initialized. This is used to customize the <code class="classname">MessageInterpolator</code>, the <code class="classname">TraversableResolver</code>, the <code class="classname">ParameterNameProvider</code>, the  <code class="classname">ClockProvider</code> or the <code class="classname">ConstraintValidatorFactory</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 79. ValidatorContext interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">import</span></span> <span class="include"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">valueextraction</span><span class="rcl-da">.</span><span class="rcl-da">ValueExtractor</span></span><span class="rcl-da">;</span>
<span class="keyword"><span class="rcl-da">import</span></span> <span class="include"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">valueextraction</span><span class="rcl-da">.</span><span class="rcl-da">ValueExtractorDeclarationException</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Represents the context that is used to create {@link Validator}
 * instances.
 *
 * A client may use methods of the {@code ValidatorContext} returned by
 * {@link ValidatorFactory#usingContext()} to customize
 * the context used to create {@code Validator} instances
 * (for instance establish different message interpolators or
 * traversable resolvers).
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 * @author Guillaume Smet
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ValidatorContext</span> {

    <span class="comment">/**
     * Defines the message interpolator implementation used by the
     * {@link Validator}.
     * &lt;p&gt;
     * If not set or if {@code null} is passed as a parameter,
     * the message interpolator of the {@link ValidatorFactory}
     * is used.
     *
     * @param messageInterpolator the {@link MessageInterpolator} used by the {@code Validator}
     *
     * @return self following the chaining method pattern
     */</span>
    ValidatorContext messageInterpolator(MessageInterpolator messageInterpolator);

    <span class="comment">/**
     * Defines the traversable resolver implementation used by the
     * {@link Validator}.
     * &lt;p&gt;
     * If not set or if {@code null} is passed as a parameter,
     * the traversable resolver of the {@link ValidatorFactory} is used.
     *
     * @param traversableResolver the {@code TraversableResolver} used by the {@code Validator}
     * @return self following the chaining method pattern
     */</span>
    ValidatorContext traversableResolver(TraversableResolver traversableResolver);

    <span class="comment">/**
     * Defines the constraint validator factory implementation used by the
     * {@link Validator}.
     * If not set or if {@code null} is passed as a parameter,
     * the constraint validator factory of the {@link ValidatorFactory} is used.
     *
     * @param factory the {@link ConstraintValidatorFactory} used by the {@code Validator}
     * @return self following the chaining method pattern
     */</span>
    ValidatorContext constraintValidatorFactory(ConstraintValidatorFactory factory);

    <span class="comment">/**
     * Defines the parameter name provider implementation used by the
     * {@link Validator}. If not set or if {@code null} is passed as a parameter,
     * the parameter name provider of the {@link ValidatorFactory} is used.
     *
     * @param parameterNameProvider parameter name provider implementation.
     * @return self following the chaining method pattern
     *
     * @since 1.1
     */</span>
    ValidatorContext parameterNameProvider(ParameterNameProvider parameterNameProvider);

    <span class="comment">/**
     * Defines the {@link ClockProvider} implementation used by the {@link Validator}.
     * If not set or if {@code null} is passed as a parameter,
     * the clock provider of the {@link ValidatorFactory} is used.
     *
     * @param clockProvider {@code ClockProvider} implementation
     * @return self following the chaining method pattern
     *
     * @since 2.0
     */</span>
    ValidatorContext clockProvider(ClockProvider clockProvider);

    <span class="comment">/**
     * <span class="rcl-da">Adds</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">used</span> <span class="rcl-da">by</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Validator</span><span class="rcl-da">}.</span> <span class="rcl-da">Has</span>
     <span class="rcl-da">*</span> <span class="rcl-da">priority</span> <span class="rcl-da">over</span> <span class="rcl-da">any</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span>
     <span class="rcl-da">*</span> <span class="rcl-da">detected</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span><span class="rcl-da">,</span> <span class="rcl-da">given</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">XML</span> <span class="rcl-da">configuration</span> <span class="rcl-da">or</span>
     <span class="rcl-da">*</span> <span class="rcl-da">configured</span> <span class="rcl-da">for</span> <span class="rcl-da">the</span> <span class="rcl-da">validator</span> <span class="rcl-da">factory</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">extractor</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">implementation</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">self</span> <span class="rcl-da">following</span> <span class="rcl-da">the</span> <span class="rcl-da">chaining</span> <span class="rcl-da">method</span> <span class="rcl-da">pattern</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">throws</span> <span class="rcl-da">ValueExtractorDeclarationException</span> <span class="rcl-da">If</span> <span class="rcl-da">more</span> <span class="rcl-da">than</span> <span class="rcl-da">one</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span>
     <span class="rcl-da">*</span>         <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">use</span> <span class="rcl-da">is</span> <span class="rcl-da">added</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="rcl-da">ValidatorContext</span> <span class="rcl-da">addValueExtractor</span><span class="rcl-da">(</span><span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">extractor</span><span class="rcl-da">);</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> Returns an initialized {@link Validator} instance respecting the defined state.
     * {@code Validator} instances can be pooled and shared by the implementation.
     *
     * @return contextualized {@code Validator}
     */</span>
    <span class="predefined-type">Validator</span> getValidator();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code>MessageInterpolator</code>, the <code>TraversableResolver</code>, the <code>ConstraintValidatorFactory</code>, the <code>ParameterNameProvider</code> or the <code>ClockProvider</code> passed to the <code>ValidatorContext</code> are used instead of the <code>ValidatorFactory</code>'s <code>MessageInterpolator</code>, <code>TraversableResolver</code>, <code>ConstraintValidatorFactory</code>, <code>ParameterNameProvider</code> or <code>ClockProvider</code> instances.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 80. Use of ValidatorFactory</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">ValidatorFactory factory = [...];
<span class="predefined-type">Validator</span> validatorUsingDefaults = factory.getValidator();
<span class="predefined-type">Validator</span> validatorUsingCustomTraversable = factory
                     .usingContext()
                     .traversableResolver( <span class="keyword">new</span> JPATraversableResolver() )
                     .getValidator();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#validationapi-message-examples-specificlocale">Use MessageInterpolator to use a specific Locale value</a> for an example using <code class="methodname">ValidatorFactory.getMessageInterpolator()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-configuration"><a class="anchor" href="#validationapi-bootstrapping-configuration"></a>5.5.3. Configuration</h4>
<div class="paragraph">
<p>The responsibility of the <code class="classname">Configuration</code> is to collect configuration information, to determine the correct provider implementation and to delegate the <code class="classname">ValidatorFactory</code> creation to the seleced provider. More concretely <code class="classname">Configuration</code> lets you define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the message interpolator instance</p>
</li>
<li>
<p>the traversable resolver instance</p>
</li>
<li>
<p>the constraint validator factory instance</p>
</li>
<li>
<p>the parameter name provider instance</p>
</li>
<li>
<p>the clock provider instance</p>
</li>
<li>
<p>XML constraint mappings</p>
</li>
<li>
<p>provider specific properties</p>
</li>
<li>
<p>whether or not <code class="classname">META-INF/validation.xml</code> is considered</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">Configuration</code> does provide a <code class="classname">MessageInterpolator</code> implementation following the default Bean Validation <code class="classname">MessageInterpolator</code> rules as defined in <a href="#validationapi-message-defaultmessageinterpolation">Default message interpolation</a>. You can access it by calling <code class="methodname">getDefaultMessageInterpolator()</code>.</span> Such an implementation is useful to let a custom <code class="classname">MessageInterpolator</code> delegate to the standard <code class="classname">MessageInterpolator</code> (see <a href="#validationapi-message-customresolution">Custom message interpolation</a> and an example making use of <code class="methodname">getDefaultMessageInterpolator()</code> in <a href="#validationapi-message-examples-jsflocale">Contextual container possible <code class="classname">MessageInterpolator</code> implementation</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">Configuration</code> does provide a <code class="classname">TraversableResolver</code> implementation following the default Bean Validation <code class="classname">TraversableResolver</code> rules as defined in <a href="#constraintdeclarationvalidationprocess-validationroutine-traversable">Traversable property</a>. You can access it by calling <code class="methodname">getDefaultTraversableResolver()</code>.</span> Such an implementation is useful to let a custom <code class="classname">TraversableResolver</code> delegate to the standard <code class="classname">TraversableResolver</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">Configuration</code> does provide a <code class="classname">ConstraintValidatorFactory</code> implementation following the default Bean Validation <code class="classname">ConstraintValidatorFactory</code> rules as defined in <a href="#constraintsdefinitionimplementation-constraintfactory">The ConstraintValidatorFactory</a>. You can access it by calling <code class="methodname">getDefaultConstraintValidatorFactory()</code>.</span> Such an implementation is useful to let a custom <code class="classname">ConstraintValidatorFactory</code> delegate to the standard <code class="classname">ConstraintValidatorFactory</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">Configuration</code> does provide a <code class="classname">ParameterNameProvider</code> implementation following the default Bean Validation <code class="classname">ParameterNameProvider</code> rules as defined in <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-parameterconstraints-namingparameters">Naming parameters</a>. You can access it by calling <code class="methodname">getDefaultParameterNameProvider()</code>.</span> Such an implementation is useful to let a custom <code class="classname">ParameterNameProvider</code> delegate to the standard <code class="classname">ParameterNameProvider</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">Configuration</code> does provide a <code class="classname">ClockProvider</code> implementation following the default Bean Validation <code class="classname">ClockProvider</code> rules as defined in <a href="#constraintsdefinitionimplementation-validationimplementation-temporalvalidators">Implementation of temporal constraint validators</a>. You can access it by calling <code class="methodname">getDefaultClockProvider()</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Via <code class="classname">getBootstrapConfiguration()</code>, <code class="classname">Configuration</code> also exposes data stored in <code class="classname">META-INF/validation.xml</code></span> (see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a>). This is particularly useful for containers wishing to control the instance creation and lifecycle (more information at <a href="#validationapi-bootstrapping-usageandcontainerexpectation">Bootstrapping considerations</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code class="methodname">BootstrapConfiguration.getDefaultValidatedExecutableTypes()</code> and <code class="methodname">BootstrapConfiguration.isExecutableValidationEnabled()</code> are not used by the Bean Validation engine but exposed here for interception technologies - see <a href="#integration-general-executable">Method and constructor validation</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">Using <code class="methodname">addMapping()</code>, additional constraint mapping XML descriptors can be added to the configuration</span> (see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a>). The given input streams should support the <code class="methodname">mark()</code> and <code class="methodname">reset()</code> methods defined by <code class="classname">java.io.InputStream</code>. <span class="tck-testable">Streams not supporting the <code class="methodname">mark()</code> and <code class="methodname">reset()</code> methods will be wrapped with an <code class="classname">InputStream</code> implementation supporting these methods by the Bean Validation provider in order to allow the streams to be read several times.</span></p>
</div>
<div class="paragraph">
<p>Clients call <code class="methodname">Configuration.buildValidatorFactory()</code> to retrieve the initialized <code class="classname">ValidatorFactory</code> instance. <span class="tck-testable">It is legal to invoke <code class="methodname">buildValidatorFactory()</code> several times, e.g. in order to retrieve several <code class="classname">ValidatorFactory</code> instances with a slightly different configuration (see <a href="#using-configuration-several-times">Using Configuration to create several validator factories</a>).</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 81. Configuration and BootstrapConfiguration interfaces</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">import</span></span> <span class="include"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">valueextraction</span><span class="rcl-da">.</span><span class="rcl-da">ValueExtractorDeclarationException</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Receives configuration information, selects the appropriate
 * Bean Validation provider and builds the appropriate {@link ValidatorFactory}.
 * &lt;p&gt;
 * Usage:
 * &lt;pre&gt;
 * Configuration&amp;lt;?&amp;gt; configuration = //provided by one of the Validation bootstrap methods
 *     ValidatorFactory = configuration
 *         .messageInterpolator( new CustomMessageInterpolator() )
 *         .buildValidatorFactory();
 * &lt;/pre&gt;
 * &lt;p&gt;
 * By default, the configuration information is retrieved from
 * {@code META-INF/validation.xml}.
 * It is possible to override the configuration retrieved from the XML file
 * by using one or more of the {@code Configuration} methods.
 * &lt;p&gt;
 * The {@link ValidationProviderResolver} is specified at configuration time
 * (see {@link ValidationProvider}).
 * If none is explicitly requested, the default {@code ValidationProviderResolver} is used.
 * &lt;p&gt;
 * The provider is selected in the following way:
 * &lt;ul&gt;
 *     &lt;li&gt;if a specific provider is requested programmatically using
 *     {@link Validation#byProvider(Class)}, find the first provider implementing
 *     the provider class requested and use it&lt;/li&gt;
 *     &lt;li&gt;if a specific provider is requested in {@code META-INF/validation.xml},
 *     find the first provider implementing the provider class requested and use it&lt;/li&gt;
 *     &lt;li&gt;otherwise, use the first provider returned by the {@code ValidationProviderResolver}&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * Implementations are not meant to be thread-safe.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 * @author Hardy Ferentschik
 * @author Guillaume Smet
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Configuration</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;T&gt;&gt; {

    <span class="comment">/**
     * Ignores data from the {@code META-INF/validation.xml} file if this
     * method is called.
     * &lt;p&gt;
     * This method is typically useful for containers that parse
     * {@code META-INF/validation.xml} themselves and pass the information
     * via the {@code Configuration} methods.
     *
     * @return {@code this} following the chaining method pattern.
     */</span>
    T ignoreXmlConfiguration();

    <span class="comment">/**
     * Defines the message interpolator used. Has priority over the configuration
     * based message interpolator.
     * &lt;p&gt;
     * If {@code null} is passed, the default message interpolator is used
     * (defined in XML or the specification default).
     *
     * @param interpolator message interpolator implementation
     * @return {@code this} following the chaining method pattern
     */</span>
    T messageInterpolator(MessageInterpolator interpolator);

    <span class="comment">/**
     * Defines the traversable resolver used. Has priority over the configuration
     * based traversable resolver.
     * &lt;p&gt;
     * If {@code null} is passed, the default traversable resolver is used
     * (defined in XML or the specification default).
     *
     * @param resolver traversable resolver implementation
     * @return {@code this} following the chaining method pattern
     */</span>
    T traversableResolver(TraversableResolver resolver);

    <span class="comment">/**
     * Defines the constraint validator factory. Has priority over the configuration
     * based constraint factory.
     * &lt;p&gt;
     * If {@code null} is passed, the default constraint validator factory is used
     * (defined in XML or the specification default).
     *
     * @param constraintValidatorFactory constraint factory implementation
     * @return {@code this} following the chaining method pattern
     */</span>
    T constraintValidatorFactory(ConstraintValidatorFactory constraintValidatorFactory);

    <span class="comment">/**
     * Defines the parameter name provider. Has priority over the configuration
     * based provider.
     * &lt;p&gt;
     * If {@code null} is passed, the default parameter name provider is used
     * (defined in XML or the specification default).
     *
     * @param parameterNameProvider parameter name provider implementation
     * @return {@code this} following the chaining method pattern.
     *
     * @since 1.1
     */</span>
    T parameterNameProvider(ParameterNameProvider parameterNameProvider);

    <span class="comment">/**
     * Defines the clock provider. Has priority over the configuration
     * based provider.
     * &lt;p&gt;
     * If {@code null} is passed, the default clock provider is used
     * (defined in XML or the specification default).
     *
     * @param clockProvider clock provider implementation
     * @return {@code this} following the chaining method pattern.
     *
     * @since 2.0
     */</span>
    T clockProvider(ClockProvider clockProvider);

    <span class="comment">/**
     * <span class="rcl-da">Adds</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span><span class="rcl-da">.</span> <span class="rcl-da">Has</span> <span class="rcl-da">priority</span> <span class="rcl-da">over</span> <span class="rcl-da">any</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span>
     <span class="rcl-da">*</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">detected</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span> <span class="rcl-da">or</span> <span class="rcl-da">given</span> <span class="rcl-da">in</span>
     <span class="rcl-da">*</span> <span class="rcl-da">the</span> <span class="rcl-da">XML</span> <span class="rcl-da">configuration</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">extractor</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">implementation</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">this</span><span class="rcl-da">}</span> <span class="rcl-da">following</span> <span class="rcl-da">the</span> <span class="rcl-da">chaining</span> <span class="rcl-da">method</span> <span class="rcl-da">pattern</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">throws</span> <span class="rcl-da">ValueExtractorDeclarationException</span> <span class="rcl-da">If</span> <span class="rcl-da">more</span> <span class="rcl-da">than</span> <span class="rcl-da">one</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span>
     <span class="rcl-da">*</span>         <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">use</span> <span class="rcl-da">is</span> <span class="rcl-da">added</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="rcl-da">T</span> <span class="rcl-da">addValueExtractor</span><span class="rcl-da">(</span><span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">extractor</span><span class="rcl-da">);</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> Add a stream describing constraint mapping in the Bean Validation XML
     * format.
     * &lt;p&gt;
     * The stream should be closed by the client API after the
     * {@link ValidatorFactory} has been built. The Bean Validation provider
     * must not close the stream.
     *
     * @param stream
     *        XML mapping stream; the given stream should support the
     *        mark/reset contract (see {@link InputStream#markSupported()});
     *        if it doesn't, it will be wrapped into a stream supporting the
     *        mark/reset contract by the Bean Validation provider
     *
     * @return {@code this} following the chaining method pattern
     * @throws IllegalArgumentException if {@code stream} is null
     */</span>
    T addMapping(<span class="predefined-type">InputStream</span> stream);

    <span class="comment">/**
     * Adds a provider specific property. This property is equivalent to
     * XML configuration properties.
     * If the underlying provider does not know how to handle the property,
     * it must silently ignore it.
     * &lt;p&gt;
     * Note: Using this non type-safe method is generally not recommended.
     * &lt;p&gt;
     * It is more appropriate to use, if available, the type-safe equivalent provided
     * by a specific provider via its {@link Configuration} subclass.
     * &lt;pre&gt;
     * ValidatorFactory factory = Validation.byProvider(ACMEProvider.class)
     *     .configure()
     *         .providerSpecificProperty(ACMEState.FAST)
     *     .buildValidatorFactory();
     * &lt;/pre&gt;
     * This method is typically used by containers parsing {@code META-INF/validation.xml}
     * themselves and injecting the state to the {@code Configuration} object.
     * &lt;p&gt;
     * If a property with a given name is defined both via this method and in the
     * XML configuration, the value set programmatically has priority.
     * &lt;p&gt;
     * If {@code null} is passed as a value, the value defined in XML is used. If no value
     * is defined in XML, the property is considered unset.
     *
     * @param name property name
     * @param value property value
     * @return {@code this} following the chaining method pattern
     * @throws IllegalArgumentException if {@code name} is null
     */</span>
    T addProperty(<span class="predefined-type">String</span> name, <span class="predefined-type">String</span> value);

    <span class="comment">/**
     * Returns an implementation of the {@link MessageInterpolator} interface
     * following the default {@code MessageInterpolator} defined in the
     * specification:
     * &lt;ul&gt;
     *     &lt;li&gt;use the {@code ValidationMessages} resource bundle to load keys&lt;/li&gt;
     *     &lt;li&gt;use {@code Locale.getDefault()}&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return default {@code MessageInterpolator} implementation compliant with the
     *         specification
     */</span>
    MessageInterpolator getDefaultMessageInterpolator();

    <span class="comment">/**
     * Returns an implementation of the {@link TraversableResolver} interface
     * following the default {@code TraversableResolver} defined in the
     * specification:
     * &lt;ul&gt;
     *     &lt;li&gt;if Java Persistence is available in the runtime environment,
     *     a property is considered reachable if Java Persistence considers
     *     the property as loaded&lt;/li&gt;
     *     &lt;li&gt;if Java Persistence is not available in the runtime environment,
     *     all properties are considered reachable&lt;/li&gt;
     *     &lt;li&gt;all properties are considered cascadable.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return default {@code TraversableResolver} implementation compliant with the
     *         specification
     */</span>
    TraversableResolver getDefaultTraversableResolver();

    <span class="comment">/**
     * Returns an implementation of the {@link ConstraintValidatorFactory} interface
     * following the default {@code ConstraintValidatorFactory} defined in the
     * specification:
     * &lt;ul&gt;
     *     &lt;li&gt;uses the public no-arg constructor of the {@link ConstraintValidator}&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return default {@code ConstraintValidatorFactory} implementation compliant with the
     *         specification
     */</span>
    ConstraintValidatorFactory getDefaultConstraintValidatorFactory();

    <span class="comment">/**
     * Returns an implementation of the {@link ParameterNameProvider}
     * interface following the default {@code ParameterNameProvider}
     * defined in the specification:
     * &lt;ul&gt;
     *     &lt;li&gt;returns names in the form {@code arg&amp;lt;PARAMETER_INDEX&amp;gt;}
     *     where {@code PARAMETER_INDEX} starts at 0 for the first parameter,
     *     e.g. {@code arg0}, {@code arg1} etc.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return default {@code ParameterNameProvider} implementation compliant with
     *         the specification
     *
     * @since 1.1
     */</span>
    ParameterNameProvider getDefaultParameterNameProvider();

    <span class="comment">/**
     * Returns an implementation of the {@link ClockProvider}
     * interface following the default {@code ClockProvider}
     * defined in the specification:
     * <span class="rcl-da">&lt;</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
     *     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span><span class="rcl-da">returns</span> <span class="rcl-da">a</span> <span class="rcl-da">clock</span> <span class="rcl-da">representing</span><span class="rcl-dd">TODO </span><span class="rcl-dd">BVAL-</span><span class="rcl-dd">496 </span><span class="rcl-dd">paste </span><span class="rcl-dd">definition </span><span class="rcl-dd">of </span> the <span class="rcl-da">current</span> <span class="rcl-da">system</span> <span class="rcl-da">time</span> <span class="rcl-da">and</span> <span class="rcl-da">default</span> <span class="rcl-da">time</span><span class="rcl-dd">specification </span>
     *     <span class="rcl-da">zone</span><span class="rcl-da">.&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
     * <span class="rcl-da">&lt;/</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> @return default {@code ClockProvider} implementation compliant with
     *         the specification
     *
     * @since 2.0
     */</span>
    ClockProvider getDefaultClockProvider();

    <span class="comment">/**
     * Returns configuration information stored in the {@code META-INF/validation.xml} file.
     * &lt;p&gt;
     * &lt;b&gt;Note&lt;/b&gt;:
     * &lt;br&gt;
     * Implementations are encouraged to lazily build this object to delay parsing.
     *
     * @return returns an instance of {@link BootstrapConfiguration}; this method never
     *         returns {@code null}; if there is no {@code META-INF/validation.xml} the
     *         different getters of the returned instance will return {@code null}
     *         respectively an empty set or map
     *
     * @since 1.1
     */</span>
    BootstrapConfiguration getBootstrapConfiguration();

    <span class="comment">/**
     * Build a {@link ValidatorFactory} implementation.
     *
     * @return the {@code ValidatorFactory}
     * @throws ValidationException if the {@code ValidatorFactory} cannot be built
     */</span>
    ValidatorFactory buildValidatorFactory();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">import</span></span> <span class="include"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">valueextraction</span><span class="rcl-da">.</span><span class="rcl-da">ValueExtractor</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Represents the user specified default configuration in
 * {@code META-INF/validation.xml}.
 * &lt;p&gt;
 * Note that modifications to the returned objects do not have any effect.
 * Instead use the methods provided on {@link Configuration} in order to
 * apply modifications to the configuration.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 * @author Hardy Ferentschik
 * @author Guillaume Smet
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BootstrapConfiguration</span> {

    <span class="comment">/**
     * Class name of the {@link ValidationProvider} implementation
     * or {@code null} if none is specified.
     *
     * @return validation provider class name
     */</span>
    <span class="predefined-type">String</span> getDefaultProviderClassName();

    <span class="comment">/**
     * Class name of the {@link ConstraintValidatorFactory} implementation
     * or {@code null} if none is specified.
     *
     * @return constraint validator factory class name
     */</span>
    <span class="predefined-type">String</span> getConstraintValidatorFactoryClassName();

    <span class="comment">/**
     * Class name of the {@link MessageInterpolator} implementation
     * or {@code null} if none is specified.
     *
     * @return message interpolator class name or {@code null}
     */</span>
    <span class="predefined-type">String</span> getMessageInterpolatorClassName();

    <span class="comment">/**
     * Class name of the {@link TraversableResolver} implementation
     * or {@code null} if none is specified.
     *
     * @return traversable resolver class name or {@code null}
     */</span>
    <span class="predefined-type">String</span> getTraversableResolverClassName();

    <span class="comment">/**
     * Class name of the {@link ParameterNameProvider} implementation
     * or {@code null} if none is specified.
     *
     * @return parameter name provider class name or {@code null}
     */</span>
    <span class="predefined-type">String</span> getParameterNameProviderClassName();

    <span class="comment">/**
     * Class name of the {@link ClockProvider} implementation or
     * {@code null} if none is specified.
     *
     * @return clock provider class name or {@code null}
     *
     * @since 2.0
     */</span>
    <span class="predefined-type">String</span> getClockProviderClassName();

    <span class="comment">/**
     * Returns <span class="rcl-da">the</span> <span class="rcl-da">class</span> <span class="rcl-da">names</span> <span class="rcl-da">of</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ValueExtractor</span><span class="rcl-da">}</span><span class="rcl-da">s</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">class</span> <span class="rcl-da">names</span> <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">empty</span> <span class="rcl-da">set</span> <span class="rcl-da">if</span> <span class="rcl-da">none</span> <span class="rcl-da">are</span> <span class="rcl-da">specified</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="predefined-type"><span class="rcl-da">Set</span></span><span class="rcl-da">&lt;</span><span class="predefined-type"><span class="rcl-da">String</span></span><span class="rcl-da">&gt;</span> <span class="rcl-da">getValueExtractorClassNames</span><span class="rcl-da">();</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Returns</span> a set of resource paths pointing to XML constraint mapping files.
     * The set is empty if none are specified.
     *
     * @return set of constraint mapping resource paths
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; getConstraintMappingResourcePaths();

    <span class="comment">/**
     * Returns true if the validation execution is explicitly marked as enabled
     * or if it is left undefined.
     *
     * @return whether validation execution is globally enabled
     */</span>
    <span class="type">boolean</span> isExecutableValidationEnabled();

    <span class="comment">/**
     * Returns the set of executable types that should be considered
     * unless explicitly overridden via {@link ValidateOnExecution}
     * &lt;p&gt;
     * Returns a set containing {@link ExecutableType#CONSTRUCTORS} and
     * {@link ExecutableType#NON_GETTER_METHODS} if unspecified in the configuration.
     *
     * @return set of validated executable types
     */</span>
    <span class="predefined-type">Set</span>&lt;ExecutableType&gt; getDefaultValidatedExecutableTypes();

    <span class="comment">/**
     * Returns properties as a map of string based key/value pairs.
     * The map is empty if no property has been specified.
     *
     * @return the properties map
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getProperties();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">A Bean Validation provider must define a sub interface of <code class="classname">Configuration</code> uniquely identifying the provider.</span> This subclass is linked to its provider via the <code class="classname">ValidationProvider</code> generic parameter. The <code class="classname">Configuration</code> sub interface typically hosts provider specific configuration methods.</p>
</div>
<div class="paragraph">
<p>To facilitate the use of provider specific configuration methods, <code class="classname">Configuration</code> uses generics: <code class="classname">Configuration&lt;T extends Configuration&lt;T&gt;&gt;</code> ; the generic return type <code class="classname">T</code> is returned by chaining methods. The provider specific sub interface must resolve the generic T as itself as shown in <a href="#example-providerspecific-config">Example of provider specific Configuration sub interface</a>.</p>
</div>
<div id="example-providerspecific-config" class="exampleblock">
<div class="title">Example 82. Example of provider specific Configuration sub interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Unique identifier of the ACME provider
 * also hosts some provider specific configuration methods
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ACMEConfiguration</span>
    <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;ACMEConfiguration&gt; {

    <span class="comment">/**
     * Enables constraints implementation dynamic reloading when using ACME
     * default to false
     */</span>
    ACMEConfiguration enableDynamicReloading(<span class="type">boolean</span>);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When <code class="methodname">Configuration.buildValidatorFactory()</code> is called, the initialized <code class="classname">ValidatorFactory</code> is returned. More specifically, the requested Bean Validation provider is determined and the result of <code class="code">validationProvider.buildValidatorFactory(ConfigurationState)</code> is returned. <code class="classname">ConfigurationState</code> gives access to the configuration artifacts defined in <code class="filename">META-INF/validation.xml</code> (unless XML configuration is ignored) and provided programmatically to <code class="classname">Configuration</code>. Generally speaking, programmatically defined elements have priority over XML defined configuration elements (read the <code class="classname">Configuration</code> JavaDoc and see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a> for more information).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A typical implementation of <code class="classname">Configuration</code> also implements <code class="classname">ConfigurationState</code>, hence <code class="code">this</code> can be passed to <code class="methodname">buildValidatorFactory(ConfigurationState)</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Streams represented in the XML configuration and opened by the <code class="classname">Configuration</code> implementation must be closed by the <code class="classname">Configuration</code> implementation after the <code class="classname">ValidatorFactory</code> creation (or if an exception occurs).</span> Streams provided programmatically are the responsibility of the application.</p>
</div>
<div class="exampleblock">
<div class="title">Example 83. ConfigurationState interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.spi</span>;


<span class="comment">/**
 * Contract between a {@link Configuration} and a
 * {@link ValidationProvider} to create a {@link ValidatorFactory}.
 * &lt;p&gt;
 * The configuration artifacts defined in the XML configuration and provided to the
 * {@code Configuration} are merged and passed along via
 * {@code ConfigurationState}.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 * @author Gunnar Morling
 * @author Guillaume Smet
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConfigurationState</span> {

    <span class="comment">/**
     * Returns {@code true} if {@link Configuration#ignoreXmlConfiguration()} has been called.
     * &lt;p&gt;
     * In this case, the {@link ValidatorFactory} must ignore
     * {@code META-INF/validation.xml}.
     *
     * @return {@code true} if {@code META-INF/validation.xml} should be ignored
     */</span>
    <span class="type">boolean</span> isIgnoreXmlConfiguration();

    <span class="comment">/**
     * Returns the message interpolator of this configuration.
     * &lt;p&gt;
     * Message interpolator is defined in the following decreasing priority:
     * &lt;ul&gt;
     *     &lt;li&gt;set via the {@link Configuration} programmatic API&lt;/li&gt;
     *     &lt;li&gt;defined in {@code META-INF/validation.xml} provided that
     *     {@code ignoreXmlConfiguration} is false. In this case the instance
     *     is created via its no-arg constructor.&lt;/li&gt;
     *     &lt;li&gt;{@code null} if undefined.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return message interpolator instance or {@code null} if not defined
     */</span>
    MessageInterpolator getMessageInterpolator();

    <span class="comment">/**
     * Returns a set of configuration streams.
     * &lt;p&gt;
     * The streams are defined by:
     * &lt;ul&gt;
     *     &lt;li&gt;mapping XML streams passed programmatically in {@link Configuration}&lt;/li&gt;
     *     &lt;li&gt;mapping XML streams located in the resources defined in
     *     {@code META-INF/validation.xml} (constraint-mapping element)&lt;/li&gt;
     * &lt;/ul&gt;
     * &lt;p&gt;
     * Streams represented in the XML configuration and opened by the
     * {@code Configuration} implementation must be closed by the
     * {@code Configuration} implementation after the {@link ValidatorFactory}
     * creation (or if an exception occurs). All streams are guaranteed to
     * adhere to the mark/reset contract (see {@link InputStream#markSupported()}
     * by the Bean Validation provider.
     *
     * @return set of input stream
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">InputStream</span>&gt; getMappingStreams();

    <span class="comment">/**
     * Returns <span class="rcl-da">a</span> <span class="rcl-da">set</span> <span class="rcl-da">of</span> <span class="rcl-da">value</span> <span class="rcl-da">extractors</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">extractors</span> <span class="rcl-da">are</span> <span class="rcl-da">retrieved</span> <span class="rcl-da">from</span> the <span class="rcl-da">following</span> <span class="rcl-da">sources</span> <span class="rcl-da">in</span> <span class="rcl-da">decreasing</span>
     <span class="rcl-da">*</span> <span class="rcl-da">order</span><span class="rcl-da">:</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span><span class="rcl-da">extractors</span> <span class="rcl-da">passed</span> <span class="rcl-da">programmatically</span> <span class="rcl-da">to</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Configuration</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span><span class="rcl-da">extractors</span> <span class="rcl-da">defined</span> <span class="rcl-da">in</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span><span class="rcl-da">}</span> <span class="rcl-da">provided</span>
     <span class="rcl-da">*</span>     <span class="rcl-da">that</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">ignoredXmlConfiguration</span><span class="rcl-da">}</span> <span class="rcl-da">is</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">false</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span><span class="rcl-da">extractors</span> <span class="rcl-da">loaded</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span> <span class="rcl-da">Java</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span><span class="rcl-da">&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;/</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">An</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <span class="rcl-da">a</span> <span class="rcl-da">given</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">passed</span> <span class="rcl-da">in</span>
     <span class="rcl-da">*</span> <span class="rcl-da">programmatically</span> <span class="rcl-da">takes</span> <span class="rcl-da">precedence</span> <span class="rcl-da">over</span> <span class="rcl-da">any</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span>
     <span class="rcl-da">*</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">defined</span> <span class="rcl-da">in</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">loaded</span>
     <span class="rcl-da">*</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span><span class="rcl-da">.</span> <span class="rcl-da">Extractors</span> <span class="rcl-da">defined</span> <span class="rcl-da">in</span>
     <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span><span class="rcl-da">}</span> <span class="rcl-da">take</span> <span class="rcl-da">precedence</span> <span class="rcl-da">over</span> <span class="rcl-da">any</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span>
     <span class="rcl-da">*</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">loaded</span> <span class="rcl-da">through</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Extractors</span> <span class="rcl-da">defined</span> <span class="rcl-da">in</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">loaded</span> <span class="rcl-da">through</span>
     <span class="rcl-da">*</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span> <span class="rcl-da">are</span> <span class="rcl-da">instantiated</span> <span class="rcl-da">using</span> <span class="rcl-da">their</span> <span class="rcl-da">no-arg</span> <span class="rcl-da">constructor</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">set</span> <span class="rcl-da">of</span> <span class="rcl-da">value</span> <span class="rcl-da">extractors</span><span class="rcl-da">;</span> <span class="rcl-da">may</span> <span class="rcl-da">be</span> <span class="rcl-da">empty</span> <span class="rcl-da">but</span> <span class="rcl-da">never</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span>
     <span class="rcl-da">*/</span></span>
    <span class="predefined-type"><span class="rcl-da">Set</span></span><span class="rcl-da">&lt;</span><span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;?&gt;&gt;</span> <span class="rcl-da">getValueExtractors</span><span class="rcl-da">();</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Returns</span> <span class="rcl-da">the</span> constraint validator factory of this configuration.
     * &lt;p&gt;
     * The {@link ConstraintValidatorFactory} implementation is defined in the following
     * decreasing priority:
     * &lt;ul&gt;
     *     &lt;li&gt;set via the {@link Configuration} programmatic API&lt;/li&gt;
     *     &lt;li&gt;defined in {@code META-INF/validation.xml} provided that
     *     {@code ignoredXmlConfiguration} is {@code false}. In this case the instance
     *     is created via its no-arg constructor.&lt;/li&gt;
     *     &lt;li&gt;{@code null} if undefined.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return factory instance or {@code null} if not defined
     */</span>
    ConstraintValidatorFactory getConstraintValidatorFactory();

    <span class="comment">/**
     * Returns the traversable resolver for this configuration.
     * &lt;p&gt;
     * {@link TraversableResolver} is defined in the following decreasing priority:
     * &lt;ul&gt;
     *     &lt;li&gt;set via the {@link Configuration} programmatic API&lt;/li&gt;
     *     &lt;li&gt;defined in {@code META-INF/validation.xml} provided that
     *     {@code ignoredXmlConfiguration} is {@code false}. In this case the
     *     instance is created via its no-arg constructor.&lt;/li&gt;
     *     &lt;li&gt;{@code null} if undefined.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return traversable resolver instance or {@code null} if not defined
     */</span>
    TraversableResolver getTraversableResolver();

    <span class="comment">/**
     * Returns the parameter name provider for this configuration.
     * &lt;p&gt;
     * {@link ParameterNameProvider} is defined in the following decreasing priority:
     * &lt;ul&gt;
     *     &lt;li&gt;set via the {@link Configuration} programmatic API&lt;/li&gt;
     *     &lt;li&gt;defined in {@code META-INF/validation.xml} provided that
     *     {@code ignoreXmlConfiguration} is {@code false}. In this case the instance
     *     is created via its no-arg constructor.&lt;/li&gt;
     *     &lt;li&gt;{@code null} if undefined.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return parameter name provider instance or {@code null} if not defined
     *
     * @since 1.1
     */</span>
    ParameterNameProvider getParameterNameProvider();

    <span class="comment">/**
     * Returns the clock provider for this configuration.
     * &lt;p&gt;
     * {@link ClockProvider} is defined in the following decreasing priority:
     * &lt;ul&gt;
     *     &lt;li&gt;set via the {@link Configuration} programmatic API&lt;/li&gt;
     *     &lt;li&gt;defined in {@code META-INF/validation.xml} provided that
     *     {@code ignoreXmlConfiguration} is {@code false}. In this case the instance
     *     is created via its no-arg constructor.&lt;/li&gt;
     *     &lt;li&gt;{@code null} if undefined.&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return clock provider instance or {@code null} if not defined
     *
     * @since 2.0
     */</span>
    ClockProvider getClockProvider();

    <span class="comment">/**
     * Returns a map of non type-safe custom properties.
     * &lt;p&gt;
     * Properties defined via:
     * &lt;ul&gt;
     *     &lt;li&gt;{@link Configuration#addProperty(String, String)}&lt;/li&gt;
     *     &lt;li&gt;{@code META-INF/validation.xml} provided that
     *     {@code ignoreXmlConfiguration} is {@code false}.&lt;/li&gt;
     * &lt;/ul&gt;
     * &lt;p&gt;
     * If a property is defined both programmatically and in XML,
     * the value defined programmatically has priority.
     *
     * @return {@code Map} whose key is the property key and the value
     *         the property value
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getProperties();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The requested provider implementation is resolved according to the following rules in the following order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the provider implementation requested if <code class="classname">Configuration</code> has been created from <code class="classname">Validation.byProvider(Class)</code>.</p>
</li>
<li>
<p>Use the provider implementation described in the XML configuration (under <code>validation-config.default-provider</code> see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a>) if defined: the value of this element is the fully qualified class name of the <code class="classname">ValidationProvider</code> implementation uniquely identifying the provider.</p>
</li>
<li>
<p>Use the first provider implementation returned by <code class="classname">validationProviderResolver.getValidationProviders()</code>.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p>The <code class="classname">ValidationProviderResolver</code> is specified when <code class="classname">Configuration</code> instances are created (see <code class="classname">ValidationProvider</code>). <span class="tck-not-testable">If no <code class="classname">ValidationProviderResolver</code> instance has been specified, the default <code class="classname">ValidationProviderResolver</code> is used.</span></p>
</div>
<div class="paragraph">
<p><code class="classname">Configuration</code> instances are provided to the Bean Validation client through the <code class="classname">Validation</code> methods. <code class="classname">Configuration</code> instances are created by <code class="classname">ValidationProvider</code>.</p>
</div>
<div class="paragraph">
<p>If a problem occurs while building the <code class="classname">ValidatorFactory</code>, a <code class="classname">ValidationException</code> is raised. This can be due to various reasons including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>malformed XML configuration</p>
</li>
<li>
<p>malformed XML mapping</p>
</li>
<li>
<p>inability to find the provider (or a provider)</p>
</li>
<li>
<p>inability to instantiate extension classes provided in the XML configuration</p>
</li>
<li>
<p>inconsistent XML mapping (entity declared more than once, incorrect field etc.)</p>
</li>
<li>
<p>invalid constraint declaration or definition</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other exception causes may occur.</p>
</div>
<div class="paragraph">
<p>Here is an example of <code class="classname">Configuration</code> use.</p>
</div>
<div class="exampleblock">
<div class="title">Example 84. Use Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Configuration</span>&lt;?&gt; configuration = [...];
ValidatorFactory factory = configuration
              .messageInterpolator( <span class="keyword">new</span> WBMessageInterpolator() )
              .traversableResolver( <span class="keyword">new</span> JPAAwareTraversableResolver() )
              .buildValidatorFactory();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following shows an example of setting up a <code class="classname">Configuration</code>, retrieving a validator factory from it, subsequently altering the configuration and then retrieving another factory:</p>
</div>
<div id="using-configuration-several-times" class="exampleblock">
<div class="title">Example 85. Using Configuration to create several validator factories</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">Configuration</span>&lt;?&gt; configuration = [...];
ValidatorFactory factory1 = configuration
              .messageInterpolator( <span class="keyword">new</span> WBMessageInterpolator() )
              .buildValidatorFactory();

ValidatorFactory factory2 = configuration
              .traversableResolver( <span class="keyword">new</span> JPAAwareTraversableResolver() )
              .buildValidatorFactory();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here, <code class="varname">factory1</code> is set up using a custom message interpolator, while <code class="varname">factory2</code> is set up using the same message interpolator and additionally using a custom traversable resolver.</p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-validationprovider"><a class="anchor" href="#validationapi-bootstrapping-validationprovider"></a>5.5.4. ValidationProvider and ValidationProviderResolver</h4>
<div class="paragraph">
<p><code class="classname">ValidationProvider</code> is the contract between the bootstrap process and a specific Bean Validation provider. <code class="classname">ValidationProviderResolver</code> implements the discovery mechanism for Bean Validation provider implementations. Any Bean Validation client can implement such a discovery mechanism but it is typically implemented by containers having specific classloader structures and restrictions.</p>
</div>
<div class="sect4">
<h5 id="validationapi-bootstrapping-validationprovider-resolver"><a class="anchor" href="#validationapi-bootstrapping-validationprovider-resolver"></a><span class="rcl-da">5.5.4.1</span><span class="rcl-da">.</span> ValidationProviderResolver</h5>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">ValidationProviderResolver</code> returns the list of Bean Validation providers available at runtime and more specifically a <code class="classname">ValidationProvider</code> instance for each provider available in the context.</span> This service can be customized by implementing <code class="classname">ValidationProviderResolver</code>. <span class="tck-not-testable">Implementations must be thread-safe.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 86. ValidationProviderResolver</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span></span><span class="rcl-da">;</span>

<span class="comment">/**
 * Determines the list of Bean Validation providers available in the runtime environment
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Bean Validation providers are identified by the presence of
 * {@code META-INF/services/javax.validation.spi.ValidationProvider}
 * files following the Service Provider pattern described
 * &lt;a href="http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider"&gt;here&lt;/a&gt;.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Each {@code META-INF/services/javax.validation.spi.ValidationProvider} file contains the list of
 * {@link ValidationProvider} implementations each of them representing a provider.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Implementations must be thread-safe.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ValidationProviderResolver</span> {

    <span class="comment">/**
     * Returns a list of {@link ValidationProvider} available in the runtime environment.
     *
     * @return list of validation providers
     */</span>
    <span class="predefined-type">List</span>&lt;ValidationProvider&lt;?&gt;&gt; getValidationProviders();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, providers are resolved using the Service Provider pattern described in <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider" class="bare">http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider</a>. <span class="tck-not-testable">Bean Validation providers must supply a service provider configuration file by creating a text file <code class="filename">javax.validation.spi.ValidationProvider</code> and placing it in the <code class="filename">META-INF/services</code> directory of one of its jar files.</span> The content of the file contains the name of the provider implementation class of the <code class="classname">javax.validation.spi.ValidationProvider</code> interface.</p>
</div>
<div class="paragraph">
<p>Bean Validation provider jars may be installed or made available in the same ways as other service providers, e.g. as extensions or added to the application classpath according to the guidelines in the JAR file specification.</p>
</div>
<div class="paragraph">
<p>The default <code class="classname">ValidationProviderResolver</code> implementation will locate all the Bean Validation providers by their provider configuration files visible in the classpath. The default <code class="classname">ValidationProviderResolver</code> implementation is recommended and custom <code class="classname">ValidationProviderResolver</code> implementations should be rarely used. A typical use of a custom resolution is resolving providers in a classloader constrained container like OSGi or in a tool environment (IDE).</p>
</div>
<div class="paragraph">
<p>The default <code class="classname">ValidationProviderResolver</code> can be accessed via <code class="classname">BootStrapState.getDefaultValidationProviderResolver()</code>. This method is typically used by the Bean Validation provider <code class="classname">Configuration</code> implementation.</p>
</div>
</div>
<div class="sect4">
<h5 id="validationapi-bootstrapping-validationprovider-provider"><a class="anchor" href="#validationapi-bootstrapping-validationprovider-provider"></a><span class="rcl-da">5.5.4.2</span><span class="rcl-da">.</span> ValidationProvider</h5>
<div class="paragraph">
<p><code class="classname">ValidationProvider</code> represents the SPI (Service Provider Interface) defining the contract between the provider discovery and initialization mechanism, and the provider. A <code class="classname">ValidationProvider</code> does:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provide a generic <code class="classname">Configuration</code> implementation (i.e. not tied to a given provider).</p>
</li>
<li>
<p>Provide a provider specific <code class="classname">Configuration</code> implementation. This <code class="classname">Configuration</code> will specifically build <code class="classname">ValidatorFactory</code> instances of the provider it comes from.</p>
</li>
<li>
<p>Build a <code class="classname">ValidatorFactory</code> object from the configuration provided by <code class="classname">ConfigurationState</code>.</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 87. ValidationProvider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.spi</span>;

<span class="comment">/**
 * Contract between the validation bootstrap mechanism and the provider engine.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Implementations must have a public no-arg constructor. The construction of a provider
 * should be as "lightweight" as possible.
 *
 * {@code T} represents the provider specific Configuration subclass
 * which typically host provider's additional configuration methods.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ValidationProvider</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;T&gt;&gt; {

    <span class="comment">/**
     * Returns a {@link Configuration} instance implementing {@code T},
     * the {@code Configuration} sub-interface.
     * The returned {@code Configuration} instance must use the current provider
     * ({@code this}) to build the {@code ValidatorFactory} instance.
     *
     * @param state bootstrap state
     * @return specific {@code Configuration} implementation
     */</span>
    T createSpecializedConfiguration(BootstrapState state);

    <span class="comment">/**
     * Returns a {@link Configuration} instance. This instance is not bound to
     * use the current provider. The choice of provider follows the algorithm described
     * in {@code Configuration}
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The {@link ValidationProviderResolver} used by {@code Configuration}
     * is provided by {@code state}.
     * If null, the default {@code ValidationProviderResolver} is used.
     *
     * @param state bootstrap state
     * @return non specialized Configuration implementation
     */</span>
    <span class="predefined-type">Configuration</span>&lt;?&gt; createGenericConfiguration(BootstrapState state);

    <span class="comment">/**
     * Build a {@link ValidatorFactory} using the current provider implementation.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The {@code ValidatorFactory} is assembled and follows the configuration passed
     * via {@link ConfigurationState}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The returned {@code ValidatorFactory} is properly initialized and ready for use.
     *
     * @param configurationState the configuration descriptor
     * @return the instantiated {@code ValidatorFactory}
     * @throws ValidationException if the {@code ValidatorFactory} cannot be built
     */</span>
    ValidatorFactory buildValidatorFactory(ConfigurationState configurationState);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 88. BootstrapState interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.spi</span>;

<span class="comment">/**
 * Defines the state used to bootstrap the {@link Configuration}.
 *
 * @author Emmanuel Bernard
 * @author Sebastian Thomschke
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BootstrapState</span> {

    <span class="comment">/**
     * User defined {@code ValidationProviderResolver} strategy
     * instance or {@code null} if undefined.
     *
     * @return ValidationProviderResolver instance or null
     */</span>
    ValidationProviderResolver getValidationProviderResolver();

    <span class="comment">/**
     * Specification default {@code ValidationProviderResolver}
     * strategy instance.
     *
     * @return default implementation of ValidationProviderResolver
     */</span>
    ValidationProviderResolver getDefaultValidationProviderResolver();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">A client can request a specific Bean Validation provider by using <code class="classname">&lt;T extends Configuration&lt;T&gt;, U extends ValidationProvider&lt;T&gt;&gt; Validation.byProvider(Class&lt;U&gt;)</code> or by defining the provider in the XML configuration file.</span> The key uniquely identifying a Bean Validation provider is the <code class="classname">ValidationProvider</code> implementation specific to this provider.</p>
</div>
<div class="paragraph">
<p>A <code class="classname">ValidationProvider</code> implementation is linked (via its generic parameter) to a specific sub interface of <code class="classname">Configuration</code>. The Bean Validation bootstrap API makes use of this link to return the specific <code class="classname">Configuration</code> subinterface implementation in a type-safe way when a specific provider is requested. The sub interface does not have to add any new methods but is the natural holder for provider specific configuration methods.</p>
</div>
<div class="exampleblock">
<div class="title">Example 89. Example of provider specific Configuration sub interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Unique identifier of the ACME provider
 * also hosts some provider specific configuration methods
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ACMEConfiguration</span>
    <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;ACMEConfiguration&gt; {

    <span class="comment">/**
     * Enables constraints implementation dynamic reloading when using ACME
     * default to false
     */</span>
    ACMEConfiguration enableDynamicReloading(<span class="type">boolean</span>);

}

<span class="comment">/**
 * ACME validation provider
 * Note how ACMEConfiguration and ACMEProvider are linked together
 * via the generic parameter.
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ACMEProvider</span> <span class="directive">implements</span> ValidationProvider&lt;ACMEConfiguration&gt; {
    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code class="classname">Configuration</code> references itself in the generic definition. Methods of <code class="classname">Configuration</code> will return the <code class="classname">ACMEConfiguration</code> making the API easy to use even for vendor specific extensions.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>The provider discovery mechanism uses the following algorithm:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Retrieve available providers using <code class="methodname">ValidationProviderResolver.getValidationProviders()</code>.</p>
</li>
<li>
<p>The first <code class="classname">ValidationProvider</code> matching the requested provider is returned. Providers are evaluated in the order they are returned by <code class="classname">ValidationProviderResolver</code>. A provider instance is considered matching if it is assignable to the requested provider class.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When the default Bean Validation provider is requested, the first <code class="classname">ValidationProvider</code> returned by the <code class="classname">ValidationProviderResolver</code> strategy is returned.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Every Bean Validation provider must provide a <code class="classname">ValidationProvider</code> implementation containing a public no-arg constructor</span> and add the corresponding <code class="filename">META-INF/services/javax.validation.spi.ValidationProvider</code> file descriptor in one of its jars.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a problem occurs while building the <code class="classname">ValidatorFactory</code>, a <code class="classname">ValidationException</code> is raised.</span> This can be due to various reasons including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>malformed XML mapping</p>
</li>
<li>
<p>inability to find the provider (or a provider)</p>
</li>
<li>
<p>inability to instantiate extension classes provided in the XML configuration</p>
</li>
<li>
<p>inconsistent XML mapping (entity declared more than once, incorrect field etc.)</p>
</li>
<li>
<p>invalid constraint declaration or definition</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-validation"><a class="anchor" href="#validationapi-bootstrapping-validation"></a>5.5.5. Validation</h4>
<div class="paragraph">
<p>The <code class="classname">Validation</code> class is the entry point used to bootstrap Bean Validation providers. <span class="tck-testable">The first entry point, <code class="methodname">buildDefaultValidatorFactory()</code>, is considered to be the default <code class="classname">ValidatorFactory</code> and is equivalent to the <code class="classname">ValidatorFactory</code> returned by <code class="code">Validation.byDefaultProvider().configure().buildValidatorFactory()</code>.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 90. Validation methods available</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * This class is the entry point for Bean Validation.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * There are three ways to bootstrap it:
 * &lt;ul&gt;
 *     &lt;li&gt;The easiest approach is to build the default {@link ValidatorFactory}.
 *     &lt;pre&gt;
 * ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
 * &lt;/pre&gt;
 *     In this case, the default validation provider resolver
 *     will be used to locate available providers.
 *     &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 *     The chosen provider is defined as followed:
 *     &lt;ul&gt;
 *         &lt;li&gt;if the XML configuration defines a provider, this provider is used&lt;/li&gt;
 *         &lt;li&gt;if the XML configuration does not define a provider or if no XML
 *         configuration is present the first provider returned by the
 *         {@link ValidationProviderResolver} instance is used.&lt;/li&gt;
 *     &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt;
 *     The second bootstrap approach allows to choose a custom
 *     {@code ValidationProviderResolver}. The chosen
 *     {@link ValidationProvider} is then determined in the same way
 *     as in the default bootstrapping case (see above).
 *     &lt;pre&gt;
 * Configuration<span class="rcl-da">&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;?&amp;</span><span class="rcl-da">gt</span><span class="rcl-da">;</span><span class="rcl-dd">&lt;?&gt; </span> configuration = Validation
 *    .byDefaultProvider()
 *    .providerResolver( new MyResolverStrategy() )
 *    .configure();
 * ValidatorFactory factory = configuration.buildValidatorFactory();
 * &lt;/pre&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt;
 *     The third approach allows you to specify explicitly and in
 *     a type safe fashion the expected provider.
 *     &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 *     Optionally you can choose a custom {@code ValidationProviderResolver}.
 *     &lt;pre&gt;
 * ACMEConfiguration configuration = Validation
 *    .byProvider(ACMEProvider.class)
 *    .providerResolver( new MyResolverStrategy() )  // optionally set the provider resolver
 *    .configure();
 * ValidatorFactory factory = configuration.buildValidatorFactory();
 * &lt;/pre&gt;
 *     &lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Note:
 * &lt;ul&gt;
 *     &lt;li&gt;
 *     The {@code ValidatorFactory} object built by the bootstrap process should be cached
 *     and shared amongst {@code Validator} consumers.
 *     &lt;/li&gt;
 *     &lt;li&gt;This class is thread-safe.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Validation</span> {

    <span class="comment">/**
     * Builds and returns a {@link ValidatorFactory} instance based on the
     * default Bean Validation provider and following the XML configuration.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The provider list is resolved using the default validation provider resolver
     * logic.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The code is semantically equivalent to
     * {@code Validation.byDefaultProvider().configure().buildValidatorFactory()}.
     *
     * @return {@code ValidatorFactory} instance
     *
     * @throws <span class="rcl-da">NoProviderFoundException</span> <span class="rcl-da">if</span> <span class="rcl-da">no</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">provider</span> <span class="rcl-da">was</span> <span class="rcl-da">found</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">throws</span> ValidationException if <span class="rcl-da">a</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">provider</span> <span class="rcl-da">was</span> <span class="rcl-da">found</span> <span class="rcl-da">but</span> the
     <span class="rcl-da">*</span> {@code ValidatorFactory} cannot be built
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> ValidatorFactory buildDefaultValidatorFactory() {
        [...]
    }

    <span class="comment">/**
     * Builds a {@link Configuration}. The provider list is resolved
     * using the strategy provided to the bootstrap state.
     * &lt;pre&gt;
     * Configuration&amp;lt<span class="rcl-da">;?&amp;</span><span class="rcl-dd">?&amp;</span>gt; configuration = Validation
     *    .byDefaultProvider()
     *    .providerResolver( new MyResolverStrategy() )
     *    .configure();
     * ValidatorFactory factory = configuration.buildValidatorFactory();
     * &lt;/pre&gt;
     * The provider can be specified in the XML configuration. If the XML
     * configuration does not exist or if no provider is specified,
     * the first available provider will be returned.
     *
     * @return instance building a generic {@code Configuration}
     *         compliant with the bootstrap state provided
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> GenericBootstrap byDefaultProvider() {
        [...]
    }

    <span class="comment">/**
     * Builds a {@link Configuration} for a particular provider implementation.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Optionally overrides the provider resolution strategy used to determine the provider.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Used by applications targeting a specific provider programmatically.
     * &lt;<span class="rcl-dd">p</span><span class="rcl-dd">/&gt; </span><span class="rcl-dd">* </span><span class="rcl-dd">&lt;</span>pre&gt;
     * ACMEConfiguration configuration =
     *     Validation.byProvider(ACMEProvider.class)
     *             .providerResolver( new MyResolverStrategy() )
     *             .configure();
     * &lt;/pre&gt;,
     * where {@code ACMEConfiguration} is the
     * {@code Configuration} sub interface uniquely identifying the
     * ACME Bean Validation provider. and {@code ACMEProvider} is the
     * {@link ValidationProvider} implementation of the ACME provider.
     *
     * @param providerType the {@code ValidationProvider} implementation type
     * <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">&lt;</span><span class="rcl-da">T</span><span class="rcl-da">&gt;</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Configuration</span><span class="rcl-da">}</span> <span class="rcl-da">corresponding</span> <span class="rcl-da">to</span> <span class="rcl-da">this</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">ValidationProvider</span><span class="rcl-da">}</span>
     * @<span class="rcl-da">param</span> <span class="rcl-da">&lt;</span><span class="rcl-da">U</span><span class="rcl-da">&gt;</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">ValidationProvider</span><span class="rcl-da">}</span> <span class="rcl-da">implementation</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span>return instance building a provider specific {@code Configuration}
     *         sub interface implementation
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> &lt;T <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;T&gt;, U <span class="directive">extends</span> ValidationProvider&lt;T&gt;&gt;
    ProviderSpecificBootstrap&lt;T&gt; byProvider(<span class="predefined-type">Class</span>&lt;U&gt; providerType) {
        [...]
    }

    [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The second entry point lets the client provide a custom <code class="classname"><span class="rcl-da">ValidationProviderResolver</span><span class="rcl-dd">ValidationProviderResolution </span></code> instance. This instance is passed to <code class="classname">GenericBootstrap</code>. <code class="classname">GenericBootstrap</code> builds a generic <code class="classname">Configuration</code> using the first <code class="classname">ValidationProvider</code> returned by <code class="classname">ValidationProviderResolution</code> and calling <code class="code">ValidationProvider.createGenericConfiguration(BootstrapState state)</code>.</span> <code class="classname">BootstrapState</code> holds the <code class="classname">ValidationProviderResolution</code> instance passed to <code class="classname">GenericBootstrap</code> and will be used by the <code class="classname">Configuration</code> instance when resolving the provider to use. Note that <code class="code">ValidationProvider.createGenericConfiguration</code> returns a <code class="classname">Configuration</code> object not bound to any particular provider.</p>
</div>
<div class="exampleblock">
<div class="title">Example 91. GenericBootstrap interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.bootstrap</span>;

<span class="comment">/**
 * Defines the state used to bootstrap Bean Validation and
 * creates a provider agnostic {@link Configuration}.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">GenericBootstrap</span> {

    <span class="comment">/**
     * Defines the provider resolution strategy.
     * This resolver returns the list of providers evaluated
     * to build the {@link Configuration}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If no resolver is defined, the default {@link ValidationProviderResolver}
     * implementation is used.
     *
     * @param resolver the {@code ValidationProviderResolver} to use for bootstrapping
     * @return {@code this} following the chaining method pattern
     */</span>
    GenericBootstrap providerResolver(ValidationProviderResolver resolver);

    <span class="comment">/**
     * Returns a generic {@link Configuration} implementation.
     * At this stage the provider used to build the {@link ValidatorFactory}
     * is not defined.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * The {@code Configuration} implementation is provided by the first provider
     * returned by the {@link ValidationProviderResolver} strategy.
     *
     * @return a {@code Configuration} implementation compliant with the bootstrap state
     * @throws <span class="rcl-da">NoProviderFoundException</span> <span class="rcl-da">if</span> <span class="rcl-da">no</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">provider</span> <span class="rcl-da">was</span> <span class="rcl-da">found</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">throws</span> ValidationException if <span class="rcl-da">a</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">provider</span> <span class="rcl-da">was</span> <span class="rcl-da">found</span> <span class="rcl-da">but</span> the
     <span class="rcl-da">*</span>         {@code Configuration} object cannot be built;<span class="rcl-dd">* </span> this is generally due to an
     <span class="rcl-da">*</span>         issue with the {@code ValidationProviderResolver}
     */</span>
    <span class="predefined-type">Configuration</span>&lt;?&gt; configure();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The last entry point lets the client define the specific Bean Validation provider requested as well as a custom <code class="classname">ValidationProviderResolver</code> implementation if needed. The entry point method, <code class="methodname">Validation.byProvider(Class&lt;U&gt; providerType)</code>, takes the provider specific <code class="classname">ValidationProvider</code> implementation type and returns a <code class="classname">ProviderSpecificBootstrap</code> object that guarantees to return an instance of the specific <code class="classname">Configuration</code> sub interface.</span> Thanks to the use of generics, the client API does not have to cast to the <code class="classname">Configuration</code> sub interface.</p>
</div>
<div class="paragraph">
<p>A <code class="classname">ProviderSpecificBootstrap</code> object can optionally receive a <code class="classname">ValidationProviderResolver</code> instance.</p>
</div>
<div class="exampleblock">
<div class="title">Example 92. ProviderSpecificBootstrap interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.bootstrap</span>;

<span class="comment">/**
 * Defines the state used to bootstrap Bean Validation and
 * creates a provider specific {@link Configuration}
 * of type {@code T}.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * The specific {@code Configuration} is linked to the provider via the generic
 * parameter of the {@link ValidationProvider} implementation.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * The requested provider is the first provider instance assignable to
 * the requested provider type (known when {@link ProviderSpecificBootstrap} is built).
 * The list of providers evaluated is returned by {@link ValidationProviderResolver}.
 * If no {@code ValidationProviderResolver} is defined, the
 * default {@code ValidationProviderResolver} strategy is used.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ProviderSpecificBootstrap</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Configuration</span>&lt;T&gt;&gt; {

    <span class="comment">/**
     * Optionally defines the provider resolver implementation used.
     * If not defined, use the default {@link ValidationProviderResolver}
     *
     * @param resolver {@code ValidationProviderResolver} implementation used
     *
     * @return {@code this} following the chaining method pattern
     */</span>
    <span class="directive">public</span> ProviderSpecificBootstrap&lt;T&gt; providerResolver(ValidationProviderResolver resolver);

    <span class="comment">/**
     * Determines the provider implementation suitable for {@code T} and delegates
     * the creation of this specific {@link Configuration} subclass to the provider.
     *
     * @return {@code Configuration} sub interface implementation
     *
     * @throws ValidationException if the {@code Configuration} object cannot be built;
     *         this is generally due to an issue with the {@code ValidationProviderResolver}
     */</span>
    <span class="directive">public</span> T configure();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="methodname">ProviderSpecificBootstrap.configure()</code> must return the result of <code class="methodname">ValidationProvider.createSpecializedConfiguration(BootstrapState state)</code>. The state parameter holds the <code class="classname">ValidationProviderResolver</code> passed to <code class="classname">ProviderSpecificBootstrap</code>. The validation provider instance used is the one assignable to the type passed as a parameter in <code class="methodname">Validation.byProvider(Class)</code>. The validation provider is selected according to the algorithm described in<span class="rcl-dd">( </span> <a href="#validationapi-bootstrapping-validationprovider-provider">ValidationProvider</a><span class="rcl-da">.</span><span class="rcl-dd">). </span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="classname">Validation</code> implementation must not contain any non private attribute or method aside from the three public static bootstrap methods:</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="methodname">public static ValidatorFactory buildDefaultValidatorFactory()</code></p>
</li>
<li>
<p><code class="methodname">public static GenericBootstrap byDefaultProvider()</code></p>
</li>
<li>
<p><code class="methodname">public static &lt;T extends Configuration&lt;T&gt;, U extends ValidationProvider&lt;T&gt;&gt; ProviderSpecificBootstrap&lt;T&gt; byProvider(Class&lt;U&gt; providerType)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The bootstrap API is designed to allow complete portability amongst Bean Validation provider implementations. <span class="tck-testable">The bootstrap implementation must ensure it can bootstrap third party providers.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When bootstrapping a Bean Validation provider, if the <code class="classname">ValidationProviderResolver</code> either fails or if the expected provider is not found, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-xmlconfiguration"><a class="anchor" href="#validationapi-bootstrapping-xmlconfiguration"></a>5.5.6. XML configuration: META-INF/validation.xml</h4>
<div class="paragraph">
<p><span class="tck-testable">Unless explicitly ignored by calling <code class="classname">Configuration.ignoreXMLConfiguration()</code>, a <code class="classname">Configuration</code> takes into account the configuration available in <code class="filename">META-INF/validation.xml</code>.</span> <span class="tck-testable">This configuration file is optional</span> but can be used by applications to refine some of the Bean Validation behavior. <span class="tck-not-testable">If more than one <code class="filename">META-INF/validation.xml</code> file is found in the classpath, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Unless stated otherwise, XML based configuration settings are overridden by values explicitly set via the <code class="classname">Configuration</code> API.</span> For example, the <code class="classname">MessageInterpolator</code> defined via <code class="methodname">Configuration.messageInterpolator(MessageInterpolator)</code> has priority over the <code>message-interpolator</code> definition.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>default-provider</code>: represents the class name of the provider specific <code class="classname">ValidationProvider</code> implementation class. If defined, the specific provider is used</span> (unless a specific provider has been chosen via the programmatic approach).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>message-interpolator</code>: represents the fully qualified class name of the <code class="classname">MessageInterpolator</code> implementation. When defined in XML, the implementation must have a public no-arg constructor.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>traversable-resolver</code>: represents the fully qualified class name of the <code class="classname">TraversableResolver</code> implementation. When defined in XML, the implementation must have a public no-arg constructor.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>constraint-validator-factory</code>: represents the fully qualified class name of the <code class="classname">ConstraintValidatorFactory</code> implementation. When defined in XML, the implementation must have a public no-arg constructor.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>parameter-name-provider</code>: represents the fully qualified class name of the <code class="classname">ParameterNameProvider</code> implementation. When defined in XML, the implementation must have a public no-arg constructor.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>clock-provider</code>: represents the fully qualified class name of the <code class="classname">ClockProvider</code> implementation. When defined in XML, the implementation must have a public no-arg constructor.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>executable-validation</code>: allows to disable executable validation entirely via its attribute <code class="code">enabled="false"</code> and optionally contains <code>default-validated-executable-types</code>. <code>enabled</code> defaults to <code>true</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>default-validated-executable-types</code>: declared under <code>executable-validation</code>, contains the list of <code>executable-type</code> that are considered by default by the integration technology validating executables upon execution.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>constraint-mapping</code>: represents the resource path of an XML mapping file.</span> <span class="tck-testable">More than one <code>constraint-mapping</code> element can be present.</span> <span class="tck-testable">Mappings provided via <code class="methodname">Configuration.addMapping(InputStream)</code> are added to the list of mappings described via <code>constraint-mapping</code>.</span></p>
</div>
<div class="paragraph">
<p><code>property</code>: represents a key/value pair property providing room to provider specific configurations. Vendors should use vendor namespaces for properties (e.g., <code>com.acme.validation.logging</code>). Entries that make use of the namespace <code>javax.validation</code> and its subnamespaces must not be used for vendor-specific information. <span class="tck-not-testable">The namespace <code>javax.validation</code> is reserved for use by this specification.</span> <span class="tck-not-testable">Properties defined via <code class="methodname">Configuration.addProperty(String, String)</code> are added to the properties defined via <code>property</code>.</span> <span class="tck-not-testable">If a property with the same name are defined in both XML and via the programmatic API, the value provided via programmatic API has priority.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">All these top level elements are optional.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a public no-arg constructor is missing on any of the classes referenced by the relevant XML elements, a <code class="classname">ValidationException</code> is raised during the <code class="methodname">Configuration.buildValidatorFactory()</code> call.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example 93. Example of META-INF/validation.xml file</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">&lt;?xml version=<span class="string"><span class="delimiter">"</span><span class="content">1.0</span><span class="delimiter">"</span></span> encoding=<span class="string"><span class="delimiter">"</span><span class="content">UTF-8</span><span class="delimiter">"</span></span>?&gt;
&lt;validation-config
        xmlns=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration</span><span class="delimiter">"</span></span>
        xmlns:xsi=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        xsi:schemaLocation=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration validation-configuration-2.0.xsd</span><span class="delimiter">"</span></span>
        version=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span>&gt;
    &lt;<span class="keyword">default</span>-provider&gt;com.acme.ACMEProvider&lt;/<span class="keyword">default</span>-provider&gt;
    &lt;message-interpolator&gt;com.acme.ACMEAwareMessageInterpolator&lt;/message-interpolator&gt;

    &lt;executable-validation&gt;
        &lt;<span class="keyword">default</span>-validated-executable-types&gt;
            &lt;executable-type&gt;NONE&lt;/executable-type&gt;
        &lt;/<span class="keyword">default</span>-validated-executable-types&gt;
    &lt;/executable-validation&gt;

    &lt;constraint-mapping&gt;META-INF/validation/order-constraints.xml&lt;/constraint-mapping&gt;
    &lt;constraint-mapping&gt;META-INF/validation/catalog-constraints.xml&lt;/constraint-mapping&gt;
    &lt;constraint-mapping&gt;META-INF/validation/customer-constraints.xml&lt;/constraint-mapping&gt;

    &lt;property name=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.validation.logging</span><span class="delimiter">"</span></span>&gt;WARN&lt;/property&gt;
    &lt;property name=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.validation.safetyChecking</span><span class="delimiter">"</span></span>&gt;failOnError&lt;/property&gt;

&lt;/validation-config&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The XML schema is described in <a href="#xml-config-xsd">Configuration schema</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="validationapi-bootstrapping-usageandcontainerexpectation"><a class="anchor" href="#validationapi-bootstrapping-usageandcontainerexpectation"></a>5.5.7. Bootstrapping considerations</h4>
<div class="paragraph">
<p>The Bean Validation bootstrap API can be used directly by any application or made available through a container or other framework. In all cases, the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-not-testable"><code class="classname">ValidatorFactory</code> is a thread-safe object that should be built once per deployment unit</span></p>
</li>
<li>
<p><code class="classname">ValidatorFactory</code> should be closed when it is no longer needed (e.g. when the unit is undeployed or the server stopped).</p>
</li>
<li>
<p><span class="tck-not-testable"><code class="classname">Validator</code> is a thread-safe and lightweight object which can be cached by the <code class="classname">ValidatorFactory</code> instance.</span></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="constraintmetadata"><a class="anchor" href="#constraintmetadata"></a>6. Constraint metadata request APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Bean Validation specification provides a way to query the constraint repository. This API is expected to be used for tooling support as well as integration with other frameworks, libraries and JSRs. The Bean Validation specification aims to provide both a validation engine and a metadata repository for object constraints. Frameworks (EE or SE) in need for constraint definition, validation and metadata will be able to rely on the Bean Validation specification for these services avoiding any unnecessary duplication work from an application and infrastructure point of view.</p>
</div>
<div class="sect2">
<h3 id="constraintmetadata-validator"><a class="anchor" href="#constraintmetadata-validator"></a>6.1. Validator</h3>
<div class="paragraph">
<p>The main API to access all metadata related to a given object is <code class="classname">Validator</code> (see <a href="#validationapi-bootstrapping">Bootstrapping</a> for more information on how to retrieve a <code class="classname">Validator</code> instance).</p>
</div>
<div class="paragraph">
<p>A <code class="classname">Validator</code> instance hosts the method to access to the metadata repository for a given class. It is recommended to leave the caching of <code class="classname">Validator</code> instances to the <code class="classname">ValidatorFactory</code>. <code class="classname">Validator</code> implementations are thread-safe.</p>
</div>
<div class="exampleblock">
<div class="title">Example 94. Validator interface (metadata request API)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Validates bean instances. Implementations of this interface must be thread-safe.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Validator</span> {

    [...] <span class="comment">//See 5.1</span>

    <span class="comment">/**
     * Returns the descriptor object describing bean constraints.
     * &lt;p/&gt;
     * The returned object (and associated objects including
     * {@link ConstraintDescriptor}s) are immutable.
     *
     * @param clazz class or interface type evaluated
     * @return the bean descriptor for the specified class
     * @throws IllegalArgumentException if clazz is {@code null}
     * @throws ValidationException if a non recoverable error happens
     *         during the metadata discovery or if some
     *         constraints are invalid.
     */</span>
    <span class="predefined-type">BeanDescriptor</span> getConstraintsForClass(<span class="predefined-type">Class</span>&lt;?&gt; clazz);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintsForClass()</code> returns a <code class="classname">BeanDescriptor</code> object describing the bean level constraints (see <a href="#constraintdeclarationvalidationprocess-requirements-objectvalidation">Object validation</a>) and providing access to the property level constraints metadata.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> is raised if the <code class="varname">clazz</code> parameter is null.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If a constraint definition or declaration hosted by the requested class (or any of its superclasses and interfaces according to the constraint propagation rules) is invalid, a <code class="classname">ValidationException</code> is raised.</span> This can be a subclass of <code class="classname">ValidationException</code> like <code class="classname">ConstraintDefinitionException</code>, <code class="classname">ConstraintDeclarationException</code> or <code class="classname">UnexpectedTypeException</code>.</p>
</div>
<div class="paragraph">
<p>All descriptor types accessible via <code class="methodname">getConstraintsForClass()</code> and introduced in the following sections are located in the package <code class="classname">javax.validation.metadata</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-elementdescriptor"><a class="anchor" href="#constraintmetadata-elementdescriptor"></a>6.2. ElementDescriptor</h3>
<div class="paragraph">
<p><code class="classname">ElementDescriptor</code> is the root interface describing elements hosting constraints. It is used to describe the list of constraints for a given element (whether it be a class, property, method etc.).</p>
</div>
<div class="exampleblock">
<div class="title">Example 95. ElementDescriptor interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a validated element (class, property, method etc.).
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ElementDescriptor</span> {

    <span class="comment">/**
     * @return returns {@code true} if at least one constraint declaration is present
     *         for this element in the class hierarchy, {@code false} otherwise
     */</span>
    <span class="type">boolean</span> hasConstraints();

    <span class="comment">/**
     * @return the statically defined returned type
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt; getElementClass();

    <span class="comment">/**
     * Returns all constraint descriptors for this element in the class hierarchy
     * or an empty {@code Set} if none are present.
     *
     * @return {@code Set} of constraint descriptors for this element
     */</span>
    <span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; getConstraintDescriptors();

    <span class="comment">/**
     * Finds constraints and potentially restricts them to certain criteria.
     *
     * @return {@code ConstraintFinder} object
     */</span>
    ConstraintFinder findConstraints();

    <span class="comment">/**
     * Declares restrictions on retrieved constraints.
     * Restrictions are cumulative.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * A {@code ConstraintFinder} is not thread-safe. The set of matching
     * {@link ConstraintDescriptor} is.
     */</span>
    <span class="type">interface</span> <span class="class">ConstraintFinder</span> {

        <span class="comment">/**
         * Restricts to the constraints matching a given set of groups for this element.
         * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
         * This method respects group conversion, group sequences
         * and group inheritance (including class-level {@link Default} group
         * overriding) but does not return {@link ConstraintDescriptor}s
         * in any particular order.
         * Specifically, ordering of the group sequence is not respected.
         *
         * @param groups groups targeted
         * @return {@code this} following the chaining method pattern
         */</span>
        ConstraintFinder unorderedAndMatchingGroups(<span class="predefined-type">Class</span>&lt;?&gt;... groups);

        <span class="comment">/**
         * Restricts to the constraints matching the provided scope for this element.
         *
         * Defaults to {@link Scope#HIERARCHY}
         *
         * @param scope expected scope
         * @return {@code this} following the chaining method pattern
         */</span>
        ConstraintFinder lookingAt(Scope scope);

        <span class="comment">/**
         * Restricts to the constraints hosted on the listed {@code types}
         * for a given element.
         * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
         * Defaults to all possible types of the element.
         * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
         * Typically used to restrict to fields ({@code FIELD})
         * or getters ({@code METHOD}).
         *
         * @param types targeted types
         *
         * @return {@code this} following the chaining method pattern
         */</span>
        ConstraintFinder declaredOn(<span class="predefined-type">ElementType</span>... types);

        <span class="comment">/**
         * Retrieves the constraint descriptors following the defined
         * restrictions and hosted on the element described by
         * {@link ElementDescriptor}.
         *
         * @return matching constraint descriptors
         */</span>
        <span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; getConstraintDescriptors();

        <span class="comment">/**
         * Returns {@code true} if at least one constraint declaration
         * matching the restrictions is present on the element,
         * {@code false} otherwise.
         *
         * @return {@code true} if there is at least one constraint
         */</span>
        <span class="type">boolean</span> hasConstraints();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Scope looked at when discovering constraints.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">enum</span> Scope {

    <span class="comment">/**
     * Look for constraints declared on the current class element
     * and ignore inheritance and elements with the same name in
     * the class hierarchy.
     */</span>
    LOCAL_ELEMENT,

    <span class="comment">/**
     * Look for constraints declared on all elements of the class hierarchy
     * with the same name.
     */</span>
    HIERARCHY
}</code></pre>
</div>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p><code class="methodname">getElementClass()</code> returns</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the object type when invoked on <code class="classname">BeanDescriptor</code>,</p>
</li>
<li>
<p>the type of a property or parameter when invoked on <code class="classname">PropertyDescriptor</code> or <code class="classname">ParameterDescriptor</code> respectively,</p>
</li>
<li>
<p><code>Object[].class</code> when invoked on <code class="classname">CrossParameterDescriptor</code>,</p>
</li>
<li>
<p>the return type when invoked on <code class="classname">ConstructorDescriptor</code>, <code class="classname">MethodDescriptor</code> or <code class="classname">ReturnValueDescriptor</code>.</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">getConstraintDescriptors()</code> returns all the <code class="classname">ConstraintDescriptor</code>s (see <a href="#constraintmetadata-constraintdescriptor">ConstraintDescriptor</a>) hosted on the given element in the class hierarchy, each <code class="classname">ConstraintDescriptor</code> describing one of the constraints declared on the given element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">hasConstraints()</code> returns <code>true</code> if the given element in the class hierarchy holds at least one constraint declaration.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If you need to query the metadata API in a more fine grained way for example by restricting the constraints to the one described on fields or on getters or by restricting to a given set of groups, you can use the <code class="classname">ConstraintFinder</code> fluent API by calling <code class="methodname">findConstraints()</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">unorderedAndMatchingGroups()</code> restricts the results to the <code class="classname">ConstraintDescriptor</code>s (see <a href="#constraintmetadata-constraintdescriptor">ConstraintDescriptor</a>) matching the given groups. Order is not respected but group inheritance and inheritance via sequence (including the <code class="classname">Default</code> group overriding at the class level) are honored.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">declaredOn()</code> lets you restrict the list of element types constraints are hosted on.</span> This is particularly useful to retrieve property constraints only hosted on fields (<code class="classname">ElementType.FIELD</code>) or only hosted on getters (<code class="classname">ElementType.METHOD</code>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">lookingAt()</code> lets you restrict which constraints are considered. Either constraints belonging to the element but hosted on the class represented by the given descriptor (<code class="classname">Scope.LOCAL_ELEMENT</code>), or constraints belonging to the element but hosted anywhere in the class hierarchy (<code class="classname">Scope.HIERARCHY</code>).</span></p>
</div>
<div class="paragraph">
<p>Here is an example restricting the list of constraints on getters, matching the default group and declared physically on the <code>name</code> getter of <code class="classname">Customer</code> (and not any of the getters on the super classes).</p>
</div>
<div class="exampleblock">
<div class="title">Example 96. Using the fluent API to restrict matching constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {

    <span class="annotation">@Size</span>(max=<span class="integer">50</span>)
    <span class="predefined-type">String</span> getName() {
        [...]
    }

    [...]
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> <span class="directive">extends</span> User {

    <span class="annotation">@NotNull</span>
    <span class="predefined-type">String</span> getName() {
        [...]
    }
}

<span class="predefined-type">PropertyDescriptor</span> pd =
    validator.getConstraintsForClass(Customer.class).getConstraintsForProperty(<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span>);
<span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; constraints =
    pd.findConstraints()
        .declaredOn(<span class="predefined-type">ElementType</span>.METHOD)
        .unorderedAndMatchingGroups(Default.class)
        .lookingAt(Scope.LOCAL_ELEMENT)
        .getConstraintDescriptors();

<span class="keyword">assert</span> <span class="integer">1</span> == constraints.size();

constraints = pd.getConstraintDescriptors();
<span class="comment">//equivalent to pd.findConstraints().getConstraintDescriptors();</span>
<span class="keyword">assert</span> <span class="integer">2</span> == constraints.size();</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example shows how the fluent API is used to retrieve parameter, cross-parameter and return value constraints, taking into account locally declared constraints as well as constraints declared in the inheritance hierarchy.</p>
</div>
<div class="exampleblock">
<div class="title">Example 97. Using the fluent API to select method and constructor constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {

    <span class="directive">public</span> User(<span class="annotation">@Size</span>(max=<span class="integer">50</span>) <span class="predefined-type">String</span> name) {
        [...]
    }

    <span class="annotation">@PasswordParametersMatch</span>
    <span class="annotation">@NotNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> resetPassword(
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">8</span>) <span class="predefined-type">String</span> password,
        <span class="annotation">@NotNull</span> <span class="annotation">@Size</span>(min=<span class="integer">8</span>) <span class="predefined-type">String</span> confirmation) {
        [...]
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> <span class="directive">extends</span> User {

    <span class="directive">public</span> Customer(<span class="annotation">@NotNull</span> <span class="predefined-type">String</span> name) {
        [...]
    }

    <span class="annotation">@Size</span>(min=<span class="integer">8</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> resetPassword(<span class="predefined-type">String</span> password, <span class="predefined-type">String</span> confirmation) {
        [...]
    }
}

<span class="predefined-type">MethodDescriptor</span> methodDescriptor = validator
    .getConstraintsForClass( Customer.class )
    .getConstraintsForMethod( <span class="string"><span class="delimiter">"</span><span class="content">resetPassword</span><span class="delimiter">"</span></span>, <span class="predefined-type">String</span>.class, <span class="predefined-type">String</span>.class );

<span class="comment">//one cross-parameter constraint</span>
<span class="keyword">assert</span> <span class="integer">1</span> == methodDescriptor.getCrossParameterDescriptor().getConstraintDescriptors().size();

<span class="comment">//one local return value constraint</span>
<span class="keyword">assert</span> <span class="integer">1</span> == methodDescriptor.getReturnValueDescriptor()
    .findConstraints()
    .lookingAt( Scope.LOCAL_ELEMENT )
    .getConstraintDescriptors()
    .size();

<span class="comment">//two return value constraints in the complete hierarchy</span>
<span class="keyword">assert</span> <span class="integer">2</span> == methodDescriptor.getReturnValueDescriptor()
    .findConstraints()
    .lookingAt( Scope.HIERARCHY )
    .getConstraintDescriptors()
    .size();

<span class="comment">//two parameter constraints, defined on overridden method</span>
<span class="keyword">assert</span> <span class="integer">2</span> == methodDescriptor.getParameterDescriptors()
    .get( <span class="integer">0</span> )
    .getConstraintDescriptors()
    .size();

ConstructorDescriptor constructorDescriptor = validator
    .getConstraintsForClass( Customer.class )
    .getConstraintsForConstructor( <span class="predefined-type">String</span>.class );

<span class="comment">//one parameter constraint; constraints from super constructor don't apply</span>
<span class="keyword">assert</span> <span class="integer">1</span> == constructorDescriptor.getParameterDescriptors()
    .get( <span class="integer">0</span> )
    .findConstraints()
    .lookingAt( Scope.HIERARCHY )
    .getConstraintDescriptors()
    .size();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-beandescriptor"><a class="anchor" href="#constraintmetadata-beandescriptor"></a>6.3. BeanDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">BeanDescriptor</code> interface describes a constrained Java Bean. This interface is returned by <code class="methodname">Validator.getConstraintsForClass(Class&lt;?&gt;)</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 98. BeanDescriptor interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a constrained Java Bean and the constraints associated to it. All
 * objects returned by the methods of this descriptor (and associated objects
 * including {@link ConstraintDescriptor}s) are immutable.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BeanDescriptor</span> <span class="directive">extends</span> ElementDescriptor {

    <span class="comment">/**
     * Returns {@code true} if the bean involves validation:
     * &lt;ul&gt;
     *     &lt;li&gt;a constraint is hosted on the bean itself&lt;/li&gt;
     *     &lt;li&gt;a constraint is hosted on one of the bean properties&lt;/li&gt;
     *     &lt;li&gt;or a bean property is marked for cascaded validation ({@link Valid})&lt;/li&gt;
     * &lt;/ul&gt;
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Constrained methods and constructors are ignored.
     *
     * @return {@code true} if the bean involves validation, {@code false} otherwise
     */</span>
    <span class="type">boolean</span> isBeanConstrained();

    <span class="comment">/**
     * Returns the property descriptor for a given property.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Returns {@code null} if the property does not exist or has no
     * constraint nor is marked as cascaded (see {@link #getConstrainedProperties()})
     * Properties of super types are considered.
     *
     * @param propertyName property evaluated
     * @return the property descriptor for a given property
     * @throws IllegalArgumentException if {@code propertyName} is {@code null}
     */</span>
    <span class="predefined-type">PropertyDescriptor</span> getConstraintsForProperty(<span class="predefined-type">String</span> propertyName);

    <span class="comment">/**
     * Returns a set of property descriptors having at least one constraint defined
     * or marked as cascaded ({@link Valid}).
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If not property matches, an empty set is returned.
     * Properties of super types are considered.
     *
     * @return the set of {@link PropertyDescriptor}s for the constraint properties; if
     *         there are no constraint properties, the empty set is returned
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">PropertyDescriptor</span>&gt; getConstrainedProperties();

    <span class="comment">/**
     * Returns a method descriptor for the given method.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Returns {@code null} if no method with the given name and parameter types
     * exists or the specified method neither has parameter or return value constraints nor a parameter
     * or return value marked for cascaded validation.
     * Methods of super types are considered.
     *
     * @param methodName the name of the method
     * @param parameterTypes the parameter types of the method
     * @return a method descriptor for the given method
     * @throws IllegalArgumentException if {@code methodName} is {@code null}
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">MethodDescriptor</span> getConstraintsForMethod(<span class="predefined-type">String</span> methodName, <span class="predefined-type">Class</span>&lt;?&gt;... parameterTypes);

    <span class="comment">/**
     * Returns a set with descriptors for the constrained methods of the bean
     * represented by this descriptor.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Constrained methods have at least one parameter or return value constraint
     * or at least one parameter or return value marked for cascaded validation.
     * Methods of super types are considered.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Only methods matching the given method type(s) are considered.
     *
     * @param methodType method type to consider
     * @param methodTypes remaining optional method types to consider
     * @return a set with descriptors for the constrained methods of this bean;
     *         will be empty if this bean has no constrained methods of the considered
     *         method type(s) but never {@code null}
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">MethodDescriptor</span>&gt; getConstrainedMethods(MethodType methodType, MethodType... methodTypes);

    <span class="comment">/**
     * Returns a constructor descriptor for the given constructor.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Returns {@code null} if no constructor with the given parameter types
     * exists or the specified constructor neither has parameter or return value
     * constraints nor a parameter or return value marked for cascaded
     * validation.
     * Constructor of super types are considered.
     *
     * @param parameterTypes the parameter types of the constructor
     * @return a constructor descriptor for the given constructor
     *
     * @since 1.1
     */</span>
    ConstructorDescriptor getConstraintsForConstructor(<span class="predefined-type">Class</span>&lt;?&gt;... parameterTypes);

    <span class="comment">/**
     * Returns a set with descriptors for the constrained constructors of the
     * bean represented by this descriptor.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Constrained constructors have at least one parameter or return value constraint
     * or at least one parameter or return value marked for cascaded validation.
     *
     * @return a set with descriptors for the constrained constructor of this
     *         bean; will be empty if this bea has no constrained constructor
     *         but never {@code null}
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">Set</span>&lt;ConstructorDescriptor&gt; getConstrainedConstructors();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 99. MethodType</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Represents the type of a method: getter or non getter.
 *
 * @author Emmanuel Bernard<span class="rcl-dd">&lt;</span><span class="rcl-dd">emmanuel</span><span class="rcl-dd">@</span><span class="rcl-dd">hibernate</span><span class="rcl-dd">.</span><span class="rcl-dd">org</span><span class="rcl-dd">&gt; </span>
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">enum</span> MethodType {

    <span class="comment">/**
     * A method following the getter pattern. A getter according to the
     * JavaBeans specification is a method whose:
     * &lt;ul&gt;
     *     &lt;li&gt;name starts with get, has a return type but no parameter&lt;/li&gt;
     *     &lt;li&gt;name starts with is, has a return type and is returning {@code boolean}.&lt;/li&gt;
     * &lt;/ul&gt;
     */</span>
    GETTER,

    <span class="comment">/**
     * A method that does not follow the getter pattern. A getter according to the
     * JavaBeans specification is a method whose:
     * &lt;ul&gt;
     *     &lt;li&gt;name starts with get, has a return type but no parameter&lt;/li&gt;
     *     &lt;li&gt;name starts with is, has a return type and is returning {@code boolean}.&lt;/li&gt;
     * &lt;/ul&gt;
     */</span>
    NON_GETTER
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">isBeanConstrained()</code> returns <code>true</code> if the given class (and superclasses and interfaces) has at least one class-level or property-level constraint or validation cascade.</span> If the method returns false, the Bean Validation engine can safely ignore the bean as it will not be impacted by validation.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintsForProperty()</code> returns a <code class="classname">PropertyDescriptor</code> object describing the property level constraints (See <a href="#constraintdeclarationvalidationprocess-requirements-propertyvalidation">Field and property validation</a>). The property is uniquely identified by its name as per the JavaBeans convention: field level and getter level constraints of the given name are all returned.</span> <span class="tck-testable">An <code class="classname">IllegalArgumentException</code> is raised if the <code class="varname">propertyName</code> parameter is null.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstrainedProperties()</code> returns the <code class="classname">PropertyDescriptor</code>s of the bean properties having at least one constraint or being cascaded (<code class="classname">@Valid</code> annotation).</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintsForMethod()</code> returns a <code class="classname">MethodDescriptor</code> object describing the method constraints of the given method. The method is uniquely identified by its name and the types of its parameters.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstrainedMethods()</code> returns the <code class="classname">MethodDescriptor</code>s of the methods matching the <code class="classname">MethodType</code>s provided as parameter and having at least one constraint or cascaded parameter or return value.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintsForConstructor()</code> returns a <code class="classname">ConstructorDescriptor</code> object describing the method constraints of the given constructor. The constructor is uniquely identified by its name and the types of its parameters.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstrainedConstructors()</code> returns the <code class="classname">ConstructorDescriptor</code>s of the constructors having at least one constraint or cascaded parameter or return value.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-cascadabledescriptor"><a class="anchor" href="#constraintmetadata-cascadabledescriptor"></a>6.4. CascadableDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">CascadableDescriptor</code> interface describes a cascadable element, i.e. an element which can be marked with <code class="classname">@Valid</code> in order to perform a cascaded validation of the element as described in <a href="#constraintdeclarationvalidationprocess-requirements-graphvalidation">Graph validation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Represents a cascadable element.
 *
 * @author Gunnar Morling
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CascadableDescriptor</span> {

    <span class="comment">/**
     * Whether this element is marked for cascaded validation or not.
     *
     * @return {@code true}, if this element is marked for cascaded validation,
     *         {@code false} otherwise
     */</span>
    <span class="type">boolean</span> isCascaded();

    <span class="comment">/**
     * Returns the group conversions configured for this element.
     *
     * @return a set containing this element's group conversions; an empty set
     *         may be returned if no conversions are configured but never
     *         {@code null}
     */</span>
    <span class="predefined-type">Set</span>&lt;GroupConversionDescriptor&gt; getGroupConversions();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">isCascaded()</code> method returns <code>true</code> if the element is marked for cascaded validation.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The method <code class="methodname">getGroupConversions()</code> returns a set with the group conversions declared for the cascadable element. An empty set will be returned if no group conversions are configured.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-groupconversiondescriptor"><a class="anchor" href="#constraintmetadata-groupconversiondescriptor"></a>6.5. GroupConversionDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">GroupConversionDescriptor</code> interface describes a group conversion rule configured for a cascadable element as described in <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a>. It is returned by <code class="methodname">CascadableDescriptor.getGroupConversions()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * A group conversion rule to be applied during cascaded validation. Two group
 * conversion descriptors are considered equal if they have the same
 * {@code from} and {@code to} group respectively.
 *
 * @author Gunnar Morling
 * @see ConvertGroup
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">GroupConversionDescriptor</span> {

    <span class="comment">/**
     * Returns the source group of this conversion rule.
     *
     * @return the source group of this conversion rule
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt; getFrom();

    <span class="comment">/**
     * Returns the target group of this conversion rule.
     *
     * @return the target group of this conversion rule
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt; getTo();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getFrom()</code> method returns the source of a group conversion rule.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The <code class="methodname">getTo()</code> method returns the target of a group conversion rule.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-propertydescriptor"><a class="anchor" href="#constraintmetadata-propertydescriptor"></a>6.6. PropertyDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">PropertyDescriptor</code> interface describes a constrained property of a Java Bean.</p>
</div>
<div class="paragraph">
<p>This interface is returned by <code class="methodname">BeanDescriptor.getConstraintsForProperty(String)</code> or <code class="methodname">BeanDescriptor.getConstrainedProperties()</code>. Constraints declared on the attribute and the getter of the same name according to the JavaBeans rules are returned by this descriptor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a Java Bean property hosting validation constraints.
 *
 * Constraints placed on the attribute and the getter of a given property
 * are all referenced.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">PropertyDescriptor</span> <span class="directive">extends</span> ElementDescriptor, CascadableDescriptor {

    <span class="comment">/**
     * Name of the property according to the Java Bean specification.
     *
     * @return property name
     */</span>
    <span class="predefined-type">String</span> getPropertyName();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getPropertyName()</code> returns the property name as described in <a href="#validationapi-constraintviolation">ConstraintViolation</a>.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-executabledescriptor"><a class="anchor" href="#constraintmetadata-executabledescriptor"></a>6.7. ExecutableDescriptor, MethodDescriptor and ConstructorDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">ExecutableDescriptor</code> interface describes a constrained method or constructor of a Java type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Provides the common functionality of {@link MethodDescriptor} and
 * {@link ConstructorDescriptor}.
 *
 * @author Gunnar Morling
 *
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ExecutableDescriptor</span> <span class="directive">extends</span> ElementDescriptor {

    <span class="comment">/**
     * Returns the method name in case this descriptor represents a method or
     * the non-qualified name of the declaring class in case this descriptor
     * represents a constructor.
     *
     * @return the name of the executable represented by this descriptor
     */</span>
    <span class="predefined-type">String</span> getName();

    <span class="comment">/**
     * Returns a list of descriptors representing this executable's
     * parameters, in the order of their declaration, including synthetic
     * parameters.
     *
     * @return a list of descriptors representing this executable's
     *         parameters; an empty list will be returned if this executable has
     *         no parameters, but never {@code null}
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">ParameterDescriptor</span>&gt; getParameterDescriptors();

    <span class="comment">/**
     * Returns a descriptor containing the cross-parameter constraints
     * of this executable.
     *
     * @return a descriptor containing the cross-parameter constraints of
     *         this executable
     */</span>
    CrossParameterDescriptor getCrossParameterDescriptor();

    <span class="comment">/**
     * Returns a descriptor for this executable's return value.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * An executable without return value will return a descriptor
     * representing {@code void}. This descriptor will have no constraint
     * associated.
     *
     * @return a descriptor for this executable's return value
     */</span>
    ReturnValueDescriptor getReturnValueDescriptor();

    <span class="comment">/**
     * Returns {@code true} if the executable parameters are constrained either:
     * &lt;ul&gt;
     *     &lt;li&gt;because of a constraint on at least one of the parameters&lt;/li&gt;
     *     &lt;li&gt;because of a cascade on at least one of the parameters (via
     *     {@link Valid})&lt;/li&gt;
     *     &lt;li&gt;because of at least one cross-parameter constraint&lt;/li&gt;
     * &lt;/ul&gt;
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Also returns {@code false} if there is no parameter.
     *
     * @return {@code true} if the executable parameters are constrained
     */</span>
    <span class="type">boolean</span> hasConstrainedParameters();

    <span class="comment">/**
     * Returns {@code true} if the executable return value is constrained
     * either:
     * &lt;ul&gt;
     *     &lt;li&gt;because of a constraint on the return value&lt;/li&gt;
     *     &lt;li&gt;because validation is cascaded on the return value (via
     *     {@link Valid})&lt;/li&gt;
     * &lt;/ul&gt;
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Also returns {@code false} if there is no return value.
     *
     * @return {@code true} if the executable return value is constrained
     */</span>
    <span class="type">boolean</span> hasConstrainedReturnValue();

    <span class="comment">/**
     * Returns {@code false}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * An executable per se does not host constraints, use
     * {@link #getParameterDescriptors()}, {@link #getCrossParameterDescriptor()}
     * and {@link #getReturnValueDescriptor()} to discover constraints.
     *
     * @return {@code false}
     */</span>
    <span class="annotation">@Override</span>
    <span class="type">boolean</span> hasConstraints();

    <span class="comment">/**
     * Returns an empty {@code Set}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * An executable per se does not host constraints, use
     * {@link #getParameterDescriptors()}, {@link #getCrossParameterDescriptor()}
     * and {@link #getReturnValueDescriptor()} to discover constraints.
     *
     * @return an empty {@code Set}
     */</span>
    <span class="annotation">@Override</span>
    <span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; getConstraintDescriptors();

    <span class="comment">/**
     * Returns a finder that will always return an empty {@code Set}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * An executable per se does not host constraints, use
     * {@link #getParameterDescriptors()}, {@link #getCrossParameterDescriptor()}
     * and {@link #getReturnValueDescriptor()} to discover constraints.
     *
     * @return {@code ConstraintFinder} object
     */</span>
    <span class="annotation">@Override</span>
    ConstraintFinder findConstraints();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getName()</code> returns the name of the represented method (e.g. "placeOrder") respectively the non-qualified name of the declaring class of the represented constructor (e.g. "OrderService").</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getParameterDescriptors()</code> returns a list of <code class="classname">ParameterDescriptor</code>s representing the method’s or constructor’s parameters in order of their declaration, including synthetic parameters. An empty list will be returned in case the method or constructor has no parameters.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getCrossParameterDescriptor()</code> returns a descriptor containing cross-parameter constraints of the method or constructor. If no cross-parameter constraint is present, the descriptor will return an empty set of constraint descriptors.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getReturnValueDescriptor()</code> returns a descriptor for the method’s or constructor’s return value. A descriptor representing the special class <code class="classname">void</code>, without any constraint descriptors, will be returned for executables which have no return value.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">hasConstrainedParameters()</code> returns <code>true</code> if any of the parameters is constrained or cascaded or if the represented executable has at least one cross-parameter constraint. Returns <code>false</code> if there is no parameter.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="classname">hasConstrainedReturnValue()</code> returns <code>true</code> if the return value is constrained or cascaded. Returns <code>false</code> if there is no return value.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The methods <code class="methodname">hasConstraints()</code>, <code class="methodname">getConstraintDescriptors()</code> and <code class="methodname">findConstraints()</code> defined on <code class="classname">ElementDescriptor</code> are redefined to clarify that executables do not host constraints directly and thus will always return <code>false</code> or an empty set of constraints, respectively. Constraint descriptors for individual parameters can be obtained from the corresponding <code class="classname">ParameterDescriptor</code> object, constraint descriptors for cross-parameter constraints can be obtained from the corresponding <code class="classname">CrossParameterDescriptor</code> object and constraint descriptors for the return value can be obtained from <code class="classname">ReturnValueDescriptor</code>.</span></p>
</div>
<div class="paragraph">
<p>The interfaces <code class="classname">MethodDescriptor</code> and <code class="classname">ConstructorDescriptor</code> are derived from <code class="classname">ExecutableDescriptor</code> and allow to distinguish between descriptors representing methods and descriptors representing constructors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a validated method.
 *
 * @author Gunnar Morling
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MethodDescriptor</span> <span class="directive">extends</span> ExecutableDescriptor {
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a validated constructor.
 *
 * @author Gunnar Morling
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstructorDescriptor</span> <span class="directive">extends</span> ExecutableDescriptor {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code class="classname">MethodDescriptor</code> objects are returned by <code class="methodname">BeanDescriptor.getConstraintsForMethod(String, Class&lt;?&gt;…​)</code> and <code class="methodname">BeanDescriptor.getConstrainedMethods(MethodType, MethodType…​)</code>, while <code class="classname">ConstructorDescriptor</code> objects are returned by <code class="methodname">BeanDescriptor.getConstraintsForConstructor(Class&lt;?&gt;…​)</code> and <code class="methodname">BeanDescriptor.getConstrainedConstructors()</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">None of the metadata API methods honor the XML configuration around executable validation nor the presence of <code class="classname">@ValidateOnExecution</code>. In other words, all constrained methods and constructors will be returned by the metadata API regardless of these settings.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-parameterdescriptor"><a class="anchor" href="#constraintmetadata-parameterdescriptor"></a>6.8. ParameterDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">ParameterDescriptor</code> interface describes a constrained parameter of a method or constructor.</p>
</div>
<div class="paragraph">
<p>This interface is returned by <code class="methodname">MethodDescriptor.getParameterDescriptors()</code> and <code class="methodname">ConstructorDescriptor.getParameterDescriptors()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a validated method or constructor parameter.
 *
 * @author Gunnar Morling
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ParameterDescriptor</span> <span class="directive">extends</span> ElementDescriptor, CascadableDescriptor {

    <span class="comment">/**
     * Returns this parameter's index within the parameter array of the method
     * or constructor holding it.
     *
     * @return this parameter's index
     */</span>
    <span class="type">int</span> getIndex();

    <span class="comment">/**
     * Returns this parameter's name as retrieved by the current parameter name
     * resolver.
     *
     * @return this parameter's name
     */</span>
    <span class="predefined-type">String</span> getName();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getIndex()</code> returns the index of the represented parameter within the parameter array of the method or constructor holding it.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getName()</code> returns the name of the represented parameter.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-crossparameterdescriptor"><a class="anchor" href="#constraintmetadata-crossparameterdescriptor"></a>6.9. CrossParameterDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">CrossParameterDescriptor</code> interface describes a element containing all cross-parameter constraints of a method or constructor.</p>
</div>
<div class="paragraph">
<p>This interface is returned by <code class="methodname">MethodDescriptor.getCrossParameterDescriptor()</code> and <code class="methodname">ConstructorDescriptor.getCrossParameterDescriptor()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes an element holding cross-parameter constraints of a method or constructor
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">CrossParameterDescriptor</span> <span class="directive">extends</span> ElementDescriptor {

    <span class="comment">/**
     * @return {@code Object[].class} - the type of the parameter array
     */</span>
    <span class="annotation">@Override</span>
    <span class="predefined-type">Class</span>&lt;?&gt; getElementClass();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getElementClass()</code> returns <code class="classname">Object[]</code>.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-returnvaluedescriptor"><a class="anchor" href="#constraintmetadata-returnvaluedescriptor"></a>6.10. ReturnValueDescriptor</h3>
<div class="paragraph">
<p>The <code class="classname">ReturnValueDescriptor</code> interface describes the return value of a method or constructor.</p>
</div>
<div class="paragraph">
<p>This interface is returned by <code class="methodname">MethodDescriptor.getReturnValueDescriptor()</code> and <code class="methodname">ConstructorDescriptor.getReturnValueDescriptor()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a validated return value of a method or constructor.
 *
 * @author Gunnar Morling
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ReturnValueDescriptor</span> <span class="directive">extends</span> ElementDescriptor, CascadableDescriptor {
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-constraintdescriptor"><a class="anchor" href="#constraintmetadata-constraintdescriptor"></a>6.11. ConstraintDescriptor</h3>
<div class="paragraph">
<p>A <code class="classname">ConstraintDescriptor</code> object describes a given constraint declaration (i.e. a constraint annotation).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.metadata</span>;

<span class="comment">/**
 * Describes a single constraint and its composing constraints.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * {@code T} is the constraint's annotation type.
 *
 * @author Emmanuel Bernard
 * @author Hardy Ferentschik
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ConstraintDescriptor</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Annotation</span>&gt; {

    <span class="comment">/**
     * Returns the annotation describing the constraint declaration.
     * If a composing constraint, attribute values are reflecting
     * the overridden attributes of the composing constraint
     *
     * @return the annotation for this constraint
     */</span>
    T getAnnotation();

    <span class="comment">/**
     * The non-interpolated error message
     *
     * @return the non-interpolated error message
     *
     * @since 1.1
     */</span>
    <span class="predefined-type">String</span> getMessageTemplate();

    <span class="comment">/**
     * The set of groups the constraint is applied on.
     * If the constraint declares no group, a set with only the {@link Default}
     * group is returned.
     *
     * @return the groups the constraint is applied on
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getGroups();

    <span class="comment">/**
     * The set of payload the constraint hosts.
     *
     * @return payload classes hosted on the constraint or an empty set if none
     */</span>
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;&gt; getPayload();

    <span class="comment">/**
     * The {@link ConstraintTarget} value of {@code validationAppliesTo} if the constraint
     * hosts it or {@code null} otherwise.
     *
     * @return the {@code ConstraintTarget} value or {@code null}
     *
     * @since 1.1
     */</span>
    ConstraintTarget getValidationAppliesTo();

    <span class="comment">/**
     * List of the constraint validation implementation classes.
     *
     * @return list of the constraint validation implementation classes
     */</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> ConstraintValidator&lt;T, ?&gt;&gt;&gt; getConstraintValidatorClasses();

    <span class="comment">/**
     * Returns a map containing the annotation attribute names as keys and the
     * annotation attribute values as value.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If this constraint is used as part of a composed constraint, attribute
     * values are reflecting the overridden attribute of the composing constraint.
     *
     * @return a map containing the annotation attribute names as keys
     *         and the annotation attribute values as value
     */</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getAttributes();

    <span class="comment">/**
     * Return a set of composing {@link ConstraintDescriptor}s where each
     * descriptor describes a composing constraint. {@code ConstraintDescriptor}
     * instances of composing constraints reflect overridden attribute values in
     * {@link #getAttributes()}  and {@link #getAnnotation()}.
     *
     * @return a set of {@code ConstraintDescriptor} objects or an empty set
     *         in case there are no composing constraints
     */</span>
    <span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; getComposingConstraints();

    <span class="comment">/**
     * @return {@code true} if the constraint is annotated with {@link ReportAsSingleViolation}
     */</span>
    <span class="type">boolean</span> isReportAsSingleViolation();

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ValidateUnwrappedValue</span>} <span class="rcl-da">defining</span> <span class="rcl-da">the</span> <span class="rcl-da">unwrapping</span> <span class="rcl-da">behavior</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
     <span class="rcl-da">*/</span></span>
    <span class="rcl-da">ValidateUnwrappedValue</span> <span class="rcl-da">validateUnwrappedValue</span><span class="rcl-da">();</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getAnnotation()</code> returns the annotation instance (or an annotation instance representing the given constraint declaration).</span> <span class="tck-testable">If <code class="classname">ConstraintDescriptor</code> represents a composing annotation (see <a href="#constraintsdefinitionimplementation-constraintcomposition">Constraint composition</a>), the returned annotation must reflect parameter overriding.</span> In other words, the annotation parameter values are the overridden values.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getAttributes()</code> returns a map containing the annotation attribute names as a key, and the annotation attribute values as a value</span> (this API is anticipated to be simpler to use by tools than reflection over the annotation instance). <span class="tck-testable">If <code class="classname">ConstraintDescriptor()</code> represents a composing annotation (see <a href="#constraintsdefinitionimplementation-constraintcomposition">Constraint composition</a>), the returned <code class="classname">Map</code> must reflect attribute overriding.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getMessageTemplate()</code> returns the non-interpolated error message.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getGroups()</code> returns the groups the constraint is supposed to be applied upon.</span> <span class="tck-testable">If no group is set on the constraint declaration, the <code class="classname">Default</code> group is returned.</span> <span class="tck-testable">The groups of a composing constraint are the groups of the composed constraint.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code>getPayload()</code> returns the payloads associated to the constraint or an empty set if none.</span> <span class="tck-testable">The payload from the main constraint annotation is inherited by the composing annotations.</span> <span class="tck-testable">Any payload definition on a composing annotation is ignored.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getValidationAppliesTo()</code> returns the <code class="classname">ConstraintTarget</code> returned by <code class="methodname">validationAppliesTo</code> if the constraint hosts the attribute or <code>null</code> otherwise. The constraint target from the main constraint annotation is inherited by the composing annotation. Any constraint target definition on a composing annotation is ignored.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">isReportAsSingleViolation()</code> returns <code>true</code> if the constraint is annotated with <code class="classname">@ReportAsSingleViolation</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getComposingConstraints()</code> return a set of composing <code class="classname">ConstraintDescriptor</code>s where each descriptor describes a composing constraint.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable"><code class="methodname">getConstraintValidatorClasses()</code> returns the <code class="classname">ConstraintValidator</code> classes associated with the constraint.</span></p>
</div>
</div>
<div class="sect2">
<h3 id="constraintmetadata-example"><a class="anchor" href="#constraintmetadata-example"></a>6.12. Example</h3>
<div class="paragraph">
<p>Assuming the following constraint definitions</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">com.acme.constraint</span>;

<span class="annotation">@Documented</span>
<span class="annotation">@NotNull</span>
<span class="annotation">@Size</span>(min = <span class="integer">1</span>)
<span class="annotation">@ReportAsSingleViolation</span>
<span class="annotation">@Constraint</span>(validatedBy = NotEmpty.NotEmptyValidator.class)
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> NotEmpty {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.NotEmpty.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        NotEmpty<span class="type">[]</span> value();
    }

    <span class="type">class</span> <span class="class">NotEmptyValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;NotEmpty, <span class="predefined-type">String</span>&gt; {

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> initialize(NotEmpty constraintAnnotation) {
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">String</span> value, ConstraintValidatorContext context) {
            <span class="keyword">return</span> <span class="predefined-constant">true</span>;
        }
    }
}

<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = ValidInterval.Validator.class)
<span class="annotation">@Target</span>({ METHOD, ANNOTATION_TYPE, CONSTRUCTOR })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> ValidInterval {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{com.acme.constraint.ValidInterval.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};

    <span class="type">int</span> startParameter();

    <span class="type">int</span> endParameter();

    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        ValidInterval<span class="type">[]</span> value();
    }

    <span class="annotation">@SupportedValidationTarget</span>(PARAMETERS)
    <span class="type">class</span> <span class="class">Validator</span> <span class="directive">implements</span> ConstraintValidator&lt;ValidInterval, <span class="predefined-type">Object</span><span class="type">[]</span>&gt; {

        <span class="directive">private</span> <span class="type">int</span> start;
        <span class="directive">private</span> <span class="type">int</span> end;

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> initialize(ValidInterval constraintAnnotation) {
            <span class="local-variable">this</span>.start = constraintAnnotation.startParameter();
            <span class="local-variable">this</span>.end = constraintAnnotation.endParameter();
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">boolean</span> isValid(<span class="predefined-type">Object</span><span class="type">[]</span> value, ConstraintValidatorContext context) {
            <span class="keyword">return</span> <span class="predefined-type">Integer</span>.parseInt( <span class="predefined-type">String</span>.valueOf( value[start] ) ) &lt; <span class="predefined-type">Integer</span>.parseInt( <span class="predefined-type">String</span>.valueOf( value[end] ) );
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the following class definitions</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> {

    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;

    <span class="annotation">@NotEmpty</span>(message = <span class="string"><span class="delimiter">"</span><span class="content">lastname must not be null</span><span class="delimiter">"</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;

    <span class="annotation">@Size</span>(max = <span class="integer">30</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> company;

    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() {
        <span class="keyword">return</span> firstName;
    }

    <span class="directive">public</span> <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> firstName) {
        <span class="local-variable">this</span>.firstName = firstName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastName() {
        <span class="keyword">return</span> lastName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getCompany() {
        <span class="keyword">return</span> company;
    }

    <span class="directive">public</span> <span class="type">void</span> setCompany(<span class="predefined-type">String</span> company) {
        <span class="local-variable">this</span>.company = company;
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {

    <span class="directive">public</span> <span class="type">interface</span> <span class="class">FirstLevelCheck</span> {
    }

    <span class="directive">public</span> <span class="type">interface</span> <span class="class">SecondLevelCheck</span> {
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> title;
    <span class="directive">private</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@Valid</span>
    <span class="annotation">@NotNull</span>
    <span class="directive">private</span> Author author;

    <span class="annotation">@Valid</span>
    <span class="directive">public</span> <span class="predefined-type">Book</span>(
            <span class="predefined-type">String</span> title,
            <span class="annotation">@Size</span>(max = <span class="integer">30</span>) <span class="predefined-type">String</span> description,
            <span class="annotation">@Valid</span> <span class="annotation">@ConvertGroup</span>(from = Default.class, to = SecondLevelCheck.class) Author author) {
        <span class="comment">// [...]</span>
    }

    <span class="directive">public</span> <span class="predefined-type">Book</span>() {
        <span class="comment">// [...]</span>
    }

    <span class="annotation">@NotEmpty</span>(groups = { FirstLevelCheck.class, Default.class })
    <span class="annotation">@Size</span>(max = <span class="integer">30</span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }

    <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }

    <span class="directive">public</span> Author getAuthor() {
        <span class="keyword">return</span> author;
    }

    <span class="directive">public</span> <span class="type">void</span> setAuthor(Author author) {
        <span class="local-variable">this</span>.author = author;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
        <span class="keyword">return</span> description;
    }

    <span class="directive">public</span> <span class="type">void</span> setAuthor(<span class="predefined-type">String</span> description) {
        <span class="local-variable">this</span>.description = description;
    }

    <span class="annotation">@ValidInterval</span>(startParameter = <span class="integer">1</span>, endParameter = <span class="integer">2</span>)
    <span class="directive">public</span> <span class="type">void</span> addChapter(<span class="predefined-type">String</span> title, <span class="type">int</span> startPage, <span class="type">int</span> endPage) {
        <span class="comment">// [...]</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following assertions are true.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="predefined-type">BeanDescriptor</span> bookDescriptor = validator.getConstraintsForClass(<span class="predefined-type">Book</span>.class);

<span class="keyword">assert</span> ! bookDescriptor.hasConstraints();

<span class="keyword">assert</span> bookDescriptor.isBeanConstrained();
<span class="keyword">assert</span> bookDescriptor.getConstrainedMethods( MethodType.NON_GETTER ).size() &gt; <span class="integer">0</span>;


<span class="keyword">assert</span> bookDescriptor.getConstraintDescriptors().size() == <span class="integer">0</span>; <span class="comment">//no bean-level constraint</span>

<span class="comment">//more specifically "author" and "title"</span>
<span class="keyword">assert</span> bookDescriptor.getConstrainedProperties().size() == <span class="integer">2</span>;

<span class="comment">//not a property</span>
<span class="keyword">assert</span> bookDescriptor.getConstraintsForProperty(<span class="string"><span class="delimiter">"</span><span class="content">doesNotExist</span><span class="delimiter">"</span></span>) == <span class="predefined-constant">null</span>;

<span class="comment">//property with no constraint</span>
<span class="keyword">assert</span> bookDescriptor.getConstraintsForProperty(<span class="string"><span class="delimiter">"</span><span class="content">description</span><span class="delimiter">"</span></span>) == <span class="predefined-constant">null</span>;

<span class="predefined-type">PropertyDescriptor</span> propertyDescriptor = bookDescriptor.getConstraintsForProperty(<span class="string"><span class="delimiter">"</span><span class="content">title</span><span class="delimiter">"</span></span>);
<span class="keyword">assert</span> propertyDescriptor.getConstraintDescriptors().size() == <span class="integer">2</span>;
<span class="keyword">assert</span> <span class="string"><span class="delimiter">"</span><span class="content">title</span><span class="delimiter">"</span></span>.equals( propertyDescriptor.getPropertyName() );

<span class="comment">//assuming the implementation returns the @NotEmpty constraint first</span>
ConstraintDescriptor&lt;?&gt; constraintDescriptor = propertyDescriptor.getConstraintDescriptors()
                                                              .iterator().next();
<span class="keyword">assert</span> constraintDescriptor.getAnnotation().annotationType().equals( NotEmpty.class );
<span class="keyword">assert</span> constraintDescriptor.getGroups().size() == <span class="integer">2</span>; <span class="comment">//FirstLevelCheck and Default</span>
<span class="keyword">assert</span> constraintDescriptor.getComposingConstraints().size() == <span class="integer">2</span>;
<span class="keyword">assert</span> constraintDescriptor.isReportAsSingleViolation() == <span class="predefined-constant">true</span>;

<span class="comment">//@NotEmpty cannot be null</span>
<span class="type">boolean</span> notNullPresence = <span class="predefined-constant">false</span>;
<span class="keyword">for</span> ( ConstraintDescriptor&lt;?&gt; composingDescriptor : constraintDescriptor.getComposingConstraints() ) {
    <span class="keyword">if</span> ( composingDescriptor.getAnnotation().annotationType().equals( NotNull.class ) ) {
        notNullPresence = <span class="predefined-constant">true</span>;
    }
}
<span class="keyword">assert</span> notNullPresence;

<span class="comment">//assuming the implementation returns the Size constraint second</span>
constraintDescriptor = propertyDescriptor.getConstraintDescriptors().iterator().next();
<span class="keyword">assert</span> constraintDescriptor.getAnnotation().annotationType().equals( Size.class );
<span class="keyword">assert</span> constraintDescriptor.getAttributes().get(<span class="string"><span class="delimiter">"</span><span class="content">max</span><span class="delimiter">"</span></span>) == <span class="predefined-type">Integer</span>.valueOf( <span class="integer">30</span> );
<span class="keyword">assert</span> constraintDescriptor.getGroups().size() == <span class="integer">1</span>;

propertyDescriptor = bookDescriptor.getConstraintsForProperty(<span class="string"><span class="delimiter">"</span><span class="content">author</span><span class="delimiter">"</span></span>);
<span class="keyword">assert</span> propertyDescriptor.getConstraintDescriptors().size() == <span class="integer">1</span>;
<span class="keyword">assert</span> propertyDescriptor.isCascaded();

<span class="comment">//getTitle() and addChapter()</span>
<span class="keyword">assert</span> bookDescriptor.getConstrainedMethods( MethodType.GETTER, MethodType.NON_GETTER ).size() == <span class="integer">2</span>;

<span class="comment">//the constructor accepting title, description and author</span>
<span class="keyword">assert</span> bookDescriptor.getConstrainedConstructors().size() == <span class="integer">1</span>;

ConstructorDescriptor constructorDescriptor = bookDescriptor.getConstraintsForConstructor(
    <span class="predefined-type">String</span>.class, <span class="predefined-type">String</span>.class, Author.class
);
<span class="keyword">assert</span> constructorDescriptor.getName().equals( <span class="string"><span class="delimiter">"</span><span class="content">Book</span><span class="delimiter">"</span></span> );
<span class="keyword">assert</span> constructorDescriptor.getElementClass() == <span class="predefined-type">Book</span>.class;
<span class="keyword">assert</span> constructorDescriptor.hasConstrainedParameters() == <span class="predefined-constant">true</span>;

<span class="comment">//return value is marked for cascaded validation</span>
<span class="keyword">assert</span> constructorDescriptor.hasConstrainedReturnValue() == <span class="predefined-constant">true</span>;

<span class="comment">//constraints are retrieved via the sub-descriptors for parameters etc.</span>
<span class="keyword">assert</span> constructorDescriptor.hasConstraints() == <span class="predefined-constant">false</span>;

<span class="comment">//one descriptor for each parameter</span>
<span class="keyword">assert</span> constructorDescriptor.getParameterDescriptors().size() == <span class="integer">3</span>;

<span class="comment">//"description" parameter</span>
<span class="predefined-type">ParameterDescriptor</span> parameterDescriptor = constructorDescriptor.getParameterDescriptors().get( <span class="integer">1</span> );

<span class="comment">//Assuming the default parameter name provider</span>
<span class="keyword">assert</span> parameterDescriptor.getName().equals( <span class="string"><span class="delimiter">"</span><span class="content">arg1</span><span class="delimiter">"</span></span> );
<span class="keyword">assert</span> parameterDescriptor.getElementClass() == <span class="predefined-type">String</span>.class;
<span class="keyword">assert</span> parameterDescriptor.getIndex() == <span class="integer">1</span>;
<span class="keyword">assert</span> parameterDescriptor.hasConstraints() == <span class="predefined-constant">true</span>;

<span class="predefined-type">Set</span>&lt;ConstraintDescriptor&lt;?&gt;&gt; parameterConstraints = parameterDescriptor.getConstraintDescriptors();
<span class="keyword">assert</span> parameterConstraints.iterator().next().getAnnotation().annotationType() == Size.class;

<span class="comment">//"author" parameter</span>
parameterDescriptor = constructorDescriptor.getParameterDescriptors().get( <span class="integer">2</span> );
<span class="keyword">assert</span> parameterDescriptor.hasConstraints() == <span class="predefined-constant">false</span>;
<span class="keyword">assert</span> parameterDescriptor.isCascaded() == <span class="predefined-constant">true</span>;

<span class="comment">//group conversion on "author" parameter</span>
GroupConversionDescriptor groupConversion =
    parameterDescriptor.getGroupConversions().iterator().next();
<span class="keyword">assert</span> groupConversion.getFrom() == Default.class;
<span class="keyword">assert</span> groupConversion.getTo() == SecondLevelCheck.class;

<span class="comment">//constructor return value</span>
ReturnValueDescriptor returnValueDescriptor = constructorDescriptor.getReturnValueDescriptor();
<span class="keyword">assert</span> returnValueDescriptor.hasConstraints() == <span class="predefined-constant">false</span>;
<span class="keyword">assert</span> returnValueDescriptor.isCascaded() == <span class="predefined-constant">true</span>;

<span class="comment">//a getter is also a method which is constrained on its return value</span>
<span class="predefined-type">MethodDescriptor</span> methodDescriptor = bookDescriptor.getConstraintsForMethod( <span class="string"><span class="delimiter">"</span><span class="content">getTitle</span><span class="delimiter">"</span></span> );
<span class="keyword">assert</span> methodDescriptor.getName().equals( <span class="string"><span class="delimiter">"</span><span class="content">getTitle</span><span class="delimiter">"</span></span> );
<span class="keyword">assert</span> methodDescriptor.getElementClass() == <span class="predefined-type">String</span>.class;
<span class="keyword">assert</span> methodDescriptor.hasConstrainedParameters() == <span class="predefined-constant">false</span>;
<span class="keyword">assert</span> methodDescriptor.hasConstrainedReturnValue() == <span class="predefined-constant">true</span>;
<span class="keyword">assert</span> methodDescriptor.hasConstraints() == <span class="predefined-constant">false</span>;

returnValueDescriptor = methodDescriptor.getReturnValueDescriptor();
<span class="keyword">assert</span> returnValueDescriptor.getElementClass() == <span class="predefined-type">String</span>.class;
<span class="keyword">assert</span> returnValueDescriptor.getConstraintDescriptors().size() == <span class="integer">2</span>;
<span class="keyword">assert</span> returnValueDescriptor.isCascaded() == <span class="predefined-constant">false</span>;

<span class="comment">//void method which has a cross-parameter constraint</span>
methodDescriptor = bookDescriptor.getConstraintsForMethod(
    <span class="string"><span class="delimiter">"</span><span class="content">addChapter</span><span class="delimiter">"</span></span>, <span class="predefined-type">String</span>.class, <span class="type">int</span>.class, <span class="type">int</span>.class
);
<span class="keyword">assert</span> methodDescriptor.getElementClass() == <span class="type">void</span>.class;
<span class="keyword">assert</span> methodDescriptor.hasConstrainedParameters() == <span class="predefined-constant">true</span>;
<span class="keyword">assert</span> methodDescriptor.hasConstrainedReturnValue() == <span class="predefined-constant">false</span>;

<span class="comment">//cross-parameter constraints accessible via separate descriptor</span>
<span class="keyword">assert</span> methodDescriptor.hasConstraints() == <span class="predefined-constant">false</span>;

<span class="keyword">assert</span> methodDescriptor.getReturnValueDescriptor().getElementClass() == <span class="type">void</span>.class;

<span class="comment">//cross-parameter descriptor</span>
CrossParameterDescriptor crossParameterDescriptor = methodDescriptor.getCrossParameterDescriptor();
<span class="keyword">assert</span> crossParameterDescriptor.getElementClass() == <span class="predefined-type">Object</span><span class="type">[]</span>.class;
<span class="keyword">assert</span> crossParameterDescriptor.hasConstraints() == <span class="predefined-constant">true</span>;

ConstraintDescriptor&lt;?&gt; crossParameterConstraint =
    crossParameterDescriptor.getConstraintDescriptors().iterator().next();
<span class="keyword">assert</span> crossParameterConstraint.getAnnotation().annotationType() == ValidInterval.class;</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="builtinconstraints"><a class="anchor" href="#builtinconstraints"></a>7. Built-in Constraint definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The specification defines a small set of built-in constraints. Their usage is encouraged both in regular constraint declarations and as composing constraints. Using this set of constraints will enhance portability of your constraints across constraint-consuming frameworks relying on the metadata API (such as client side validation frameworks or database schema generation frameworks).</p>
</div>
<div class="paragraph">
<p>Built-in annotations are annotated with an empty <code class="classname">@Constraint</code> annotation to avoid any dependency between the specification API and a specific implementation. <span class="tck-testable">Each Bean Validation provider must recognize built-in constraint annotations as valid constraint definitions and provide compliant constraint implementations for each.</span> <span class="tck-testable">The built-in constraint validation implementation is having a lower priority than an XML mapping definition.</span> In other words <code class="classname">ConstraintValidator</code> implementations for built-in constraints can be overridden by using the XML mapping (see <a href="#xml-mapping-constraintdefinition">Overriding constraint definitions in XML</a>).</p>
</div>
<div class="paragraph">
<p>All built-in constraints are in the <code class="classname">javax.validation.constraints</code> package. Here is the list of constraints and their declaration.</p>
</div>
<div class="exampleblock">
<div class="title">Example 100. <span class="tck-testable">@Null constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be {@code null}.
 * Accepts any type.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Null {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Null.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * Defines several {@link Null} annotations on the same element.
     *
     * @see javax.validation.constraints.Null
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Null<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 101. <span class="tck-testable">@NotNull constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must not be {@code null}.
 * Accepts any type.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> NotNull {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.NotNull.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * Defines several {@link NotNull} annotations on the same element.
     *
     * @see javax.validation.constraints.NotNull
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        NotNull<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 102. <span class="tck-testable">@AssertTrue constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be true.
 * Supported types are {@code boolean} and {@code Boolean}.
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> AssertTrue {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.AssertTrue.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * Defines several {@link AssertTrue} annotations on the same element.
     *
     * @see AssertTrue
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        AssertTrue<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 103. <span class="tck-testable">@AssertFalse constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be false.
 * Supported types are {@code boolean} and {@code Boolean}.
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> AssertFalse {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.AssertFalse.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * Defines several {@link AssertFalse} annotations on the same element.
     *
     * @see javax.validation.constraints.AssertFalse
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        AssertFalse<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 104. <span class="tck-testable">@Min constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be a number whose value must be higher or
 * equal to the specified minimum.
 * &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code BigDecimal}&lt;/li&gt;
 *     &lt;li&gt;{@code BigInteger}&lt;/li&gt;
 *     &lt;li&gt;{@code byte}, {@code short}, {@code int}, {@code long}, and their respective
 *     wrappers&lt;/li&gt;
 * &lt;/ul&gt;
 * Note that {@code double} and {@code float} are not supported due to rounding errors
 * (some providers might provide some approximative support).
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Min {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Min.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return value the element must be higher or equal to
     */</span>
    <span class="type">long</span> value();

    <span class="comment">/**
     * Defines several {@link Min} annotations on the same element.
     *
     * @see Min
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Min<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 105. <span class="tck-testable">@Max constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be a number whose value must be lower or
 * equal to the specified maximum.
 * &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code BigDecimal}&lt;/li&gt;
 *     &lt;li&gt;{@code BigInteger}&lt;/li&gt;
 *     &lt;li&gt;{@code byte}, {@code short}, {@code int}, {@code long}, and their respective
 *     wrappers&lt;/li&gt;
 * &lt;/ul&gt;
 * Note that {@code double} and {@code float} are not supported due to rounding errors
 * (some providers might provide some approximative support).
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Max {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Max.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return value the element must be lower or equal to
     */</span>
    <span class="type">long</span> value();

    <span class="comment">/**
     * Defines several {@link Max} annotations on the same element.
     *
     * @see Max
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Max<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 106. <span class="tck-testable">@DecimalMin constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be a number whose value must be higher or
 * equal to the specified minimum.
 * &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code BigDecimal}&lt;/li&gt;
 *     &lt;li&gt;{@code BigInteger}&lt;/li&gt;
 *     &lt;li&gt;{@code CharSequence}&lt;/li&gt;
 *     &lt;li&gt;{@code byte}, {@code short}, {@code int}, {@code long}, and their respective
 *     wrappers&lt;/li&gt;
 * &lt;/ul&gt;
 * Note that {@code double} and {@code float} are not supported due to rounding errors
 * (some providers might provide some approximative support).
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> DecimalMin {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.DecimalMin.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * The {@code String} representation of the min value according to the
     * {@code BigDecimal} string representation.
     *
     * @return value the element must be higher or equal to
     */</span>
    <span class="predefined-type">String</span> value();

    <span class="comment">/**
     * Specifies whether the specified minimum is inclusive or exclusive.
     * By default, it is inclusive.
     *
     * @return {@code true} if the value must be higher or equal to the specified minimum,
     *         {@code false} if the value must be higher
     *
     * @since 1.1
     */</span>
    <span class="type">boolean</span> inclusive() <span class="keyword">default</span> <span class="predefined-constant">true</span>;

    <span class="comment">/**
     * Defines several {@link DecimalMin} annotations on the same element.
     *
     * @see DecimalMin
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        DecimalMin<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 107. <span class="tck-testable">@DecimalMax constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be a number whose value must be lower or
 * equal to the specified maximum.
 * &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code BigDecimal}&lt;/li&gt;
 *     &lt;li&gt;{@code BigInteger}&lt;/li&gt;
 *     &lt;li&gt;{@code CharSequence}&lt;/li&gt;
 *     &lt;li&gt;{@code byte}, {@code short}, {@code int}, {@code long}, and their respective
 *     wrappers&lt;/li&gt;
 * &lt;/ul&gt;
 * Note that {@code double} and {@code float} are not supported due to rounding errors
 * (some providers might provide some approximative support).
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> DecimalMax {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.DecimalMax.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * The {@code String} representation of the max value according to the
     * {@code BigDecimal} string representation.
     *
     * @return value the element must be lower or equal to
     */</span>
    <span class="predefined-type">String</span> value();

    <span class="comment">/**
     * Specifies whether the specified maximum is inclusive or exclusive.
     * By default, it is inclusive.
     *
     * @return {@code true} if the value must be lower or equal to the specified maximum,
     *         {@code false} if the value must be lower
     *
     * @since 1.1
     */</span>
    <span class="type">boolean</span> inclusive() <span class="keyword">default</span> <span class="predefined-constant">true</span>;

    <span class="comment">/**
     * Defines several {@link DecimalMax} annotations on the same element.
     *
     * @see DecimalMax
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        DecimalMax<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 108. <span class="tck-testable">@<span class="rcl-da">Negative</span> <span class="rcl-da">constraint</span></span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span></span><span class="rcl-da">;</span>

<span class="comment"><span class="rcl-da">/**</span>
 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">a</span> <span class="rcl-da">negative</span> <span class="rcl-da">number</span><span class="rcl-da">.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">Supported</span> <span class="rcl-da">types</span> <span class="rcl-da">are</span><span class="rcl-da">:</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">BigDecimal</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">BigInteger</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">byte</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">short</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">int</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">long</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">float</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">double</span><span class="rcl-da">}</span> <span class="rcl-da">and</span> <span class="rcl-da">their</span> <span class="rcl-da">respective</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">wrappers</span><span class="rcl-da">&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;/</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">elements</span> <span class="rcl-da">are</span> <span class="rcl-da">considered</span> <span class="rcl-da">valid</span><span class="rcl-da">.</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Gunnar</span> <span class="rcl-da">Morling</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
 <span class="rcl-da">*/</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{</span> <span class="rcl-da">})</span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="rcl-da">Negative</span> <span class="rcl-da">{</span>

    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">message</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">{</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">Negative</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">}</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">groups</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?</span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Payload</span><span class="rcl-da">&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">payload</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Whether</span> <span class="rcl-da">the</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">strictly</span> <span class="rcl-da">negative</span> <span class="rcl-da">(</span><span class="rcl-da">0</span> <span class="rcl-da">is</span> <span class="rcl-da">considered</span> <span class="rcl-da">as</span> <span class="rcl-da">an</span> <span class="rcl-da">invalid</span> <span class="rcl-da">value</span><span class="rcl-da">)</span> <span class="rcl-da">or</span> <span class="rcl-da">not</span> <span class="rcl-da">(</span><span class="rcl-da">0</span> <span class="rcl-da">is</span> <span class="rcl-da">a</span>
     <span class="rcl-da">*</span> <span class="rcl-da">valid</span> <span class="rcl-da">value</span><span class="rcl-da">).</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">whether</span> <span class="rcl-da">the</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">strictly</span> <span class="rcl-da">negative</span>
     <span class="rcl-da">*/</span></span>
    <span class="type"><span class="rcl-da">boolean</span></span> <span class="rcl-da">strict</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="predefined-constant"><span class="rcl-da">false</span></span><span class="rcl-da">;</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">several</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Negative</span><span class="rcl-da">}</span> <span class="rcl-da">constraints</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">element</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">see</span> <span class="rcl-da">Negative</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="predefined-type"><span class="rcl-da">List</span></span> <span class="rcl-da">{</span>

        <span class="rcl-da">Negative</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">value</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title"><span class="rcl-da">Example</span> <span class="rcl-da">109</span><span class="rcl-da">.</span> <span class="tck-testable"><span class="rcl-da">@</span><span class="rcl-da">Positive</span> <span class="rcl-da">constraint</span></span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span></span><span class="rcl-da">;</span>

<span class="comment"><span class="rcl-da">/**</span>
 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">a</span> <span class="rcl-da">positive</span> <span class="rcl-da">number</span><span class="rcl-da">.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">Supported</span> <span class="rcl-da">types</span> <span class="rcl-da">are</span><span class="rcl-da">:</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">BigDecimal</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">BigInteger</span><span class="rcl-da">}&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{@</span><span class="rcl-da">code</span> <span class="rcl-da">byte</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">short</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">int</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">long</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">float</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">double</span><span class="rcl-da">}</span> <span class="rcl-da">and</span> <span class="rcl-da">their</span> <span class="rcl-da">respective</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">wrappers</span><span class="rcl-da">&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;/</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">elements</span> <span class="rcl-da">are</span> <span class="rcl-da">considered</span> <span class="rcl-da">valid</span><span class="rcl-da">.</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Gunnar</span> <span class="rcl-da">Morling</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">since</span> <span class="rcl-da">2.0</span>
 <span class="rcl-da">*/</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{</span> <span class="rcl-da">})</span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="rcl-da">Positive</span> <span class="rcl-da">{</span>

    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">message</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">{</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">Positive</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">}</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">groups</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?</span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Payload</span><span class="rcl-da">&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">payload</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Whether</span> <span class="rcl-da">the</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">strictly</span> <span class="rcl-da">positive</span> <span class="rcl-da">(</span><span class="rcl-da">0</span> <span class="rcl-da">is</span> <span class="rcl-da">considered</span> <span class="rcl-da">as</span> <span class="rcl-da">an</span> <span class="rcl-da">invalid</span> <span class="rcl-da">value</span><span class="rcl-da">)</span> <span class="rcl-da">or</span> <span class="rcl-da">not</span> <span class="rcl-da">(</span><span class="rcl-da">0</span> <span class="rcl-da">is</span> <span class="rcl-da">a</span>
     <span class="rcl-da">*</span> <span class="rcl-da">valid</span> <span class="rcl-da">value</span><span class="rcl-da">).</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">whether</span> <span class="rcl-da">the</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">strictly</span> <span class="rcl-da">positive</span>
     <span class="rcl-da">*/</span></span>
    <span class="type"><span class="rcl-da">boolean</span></span> <span class="rcl-da">strict</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="predefined-constant"><span class="rcl-da">false</span></span><span class="rcl-da">;</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">several</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Positive</span><span class="rcl-da">}</span> <span class="rcl-da">constraints</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">element</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">see</span> <span class="rcl-da">Positive</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="predefined-type"><span class="rcl-da">List</span></span> <span class="rcl-da">{</span>

        <span class="rcl-da">Positive</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">value</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title"><span class="rcl-da">Example</span> <span class="rcl-da">110</span><span class="rcl-da">.</span> <span class="tck-testable"><span class="rcl-da">@</span>Size constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element size must be between the specified boundaries (included).
 * &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code CharSequence} (length of character sequence is evaluated)&lt;/li&gt;
 *     &lt;li&gt;{@code Collection} (collection size is evaluated)&lt;/li&gt;
 *     &lt;li&gt;{@code Map} (map size is evaluated)&lt;/li&gt;
 *     &lt;li&gt;Array (array length is evaluated)&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Size {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Size.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return size the element must be higher or equal to
     */</span>
    <span class="type">int</span> min() <span class="keyword">default</span> <span class="integer">0</span>;

    <span class="comment">/**
     * @return size the element must be lower or equal to
     */</span>
    <span class="type">int</span> max() <span class="keyword">default</span> <span class="predefined-type">Integer</span>.MAX_VALUE;

    <span class="comment">/**
     * Defines several {@link Size} annotations on the same element.
     *
     * @see Size
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Size<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">111</span><span class="rcl-dd">109</span>. <span class="tck-testable">@Digits constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be a number within accepted range
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code BigDecimal}&lt;/li&gt;
 *     &lt;li&gt;{@code BigInteger}&lt;/li&gt;
 *     &lt;li&gt;{@code CharSequence}&lt;/li&gt;
 *     &lt;li&gt;{@code byte}, {@code short}, {@code int}, {@code long}, and their respective
 *     wrapper types&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Digits {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Digits.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return maximum number of integral digits accepted for this number
     */</span>
    <span class="type">int</span> integer();

    <span class="comment">/**
     * @return maximum number of fractional digits accepted for this number
     */</span>
    <span class="type">int</span> fraction();

    <span class="comment">/**
     * Defines several {@link Digits} annotations on the same element.
     *
     * @see Digits
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Digits<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">112</span><span class="rcl-dd">110</span>. <span class="tck-testable">@Past constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 <span class="rcl-da">*</span> The annotated element must be an instant, date or time in the past.
 * &lt;p&gt;
 * <span class="rcl-da">&lt;</span><span class="rcl-da">i</span><span class="rcl-da">&gt;</span><span class="rcl-da">Now</span><span class="rcl-da">&lt;/</span><span class="rcl-da">i</span><span class="rcl-da">&gt;</span><span class="rcl-dd">By </span><span class="rcl-dd">default</span><span class="rcl-dd">, </span><span class="rcl-dd">"</span><span class="rcl-dd">now</span><span class="rcl-dd">" </span> is defined <span class="rcl-da">by</span><span class="rcl-dd">as </span> the <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ClockProvider</span><span class="rcl-da">}</span> <span class="rcl-da">attached</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">Validator</span><span class="rcl-da">}</span>
 <span class="rcl-da">*</span> <span class="rcl-da">or</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">ValidatorFactory</span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">default</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">clockProvider</span><span class="rcl-da">}</span> <span class="rcl-da">defines</span> <span class="rcl-da">the</span> current time according to the virtual machine,
 <span class="rcl-da">*</span> applying the current default time<span class="rcl-dd">* </span> zone if needed.<span class="rcl-dd">If </span><span class="rcl-dd">required</span><span class="rcl-dd">, </span><span class="rcl-dd">an </span><span class="rcl-dd">alternative </span><span class="rcl-dd">{@</span><span class="rcl-dd">link </span><span class="rcl-dd">ClockProvider</span><span class="rcl-dd">} </span><span class="rcl-dd">can </span><span class="rcl-dd">be </span><span class="rcl-dd">specified </span><span class="rcl-dd">when </span><span class="rcl-dd">bootstrapping </span><span class="rcl-dd">a </span><span class="rcl-dd">validator </span>
 *<span class="rcl-dd">factory </span><span class="rcl-dd">or </span><span class="rcl-dd">validator</span><span class="rcl-dd">, </span><span class="rcl-dd">allowing </span><span class="rcl-dd">to </span><span class="rcl-dd">customize </span><span class="rcl-dd">the </span><span class="rcl-dd">{@</span><span class="rcl-dd">link </span><span class="rcl-dd">Clock</span><span class="rcl-dd">} </span><span class="rcl-dd">representing </span><span class="rcl-dd">the </span><span class="rcl-dd">current </span><span class="rcl-dd">instant</span><span class="rcl-dd">, </span><span class="rcl-dd">date </span><span class="rcl-dd">and </span><span class="rcl-dd">time</span><span class="rcl-dd">. </span><span class="rcl-dd">* </span> &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code java.util.Date}&lt;/li&gt;
 *     &lt;li&gt;{@code java.util.Calendar}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.Instant}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.MonthDay}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.OffsetDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.OffsetTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.Year}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.YearMonth}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.ZonedDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.HijrahDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.JapaneseDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.MinguoDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.ThaiBuddhistDate}&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> Past {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Past.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * The notion of present here is defined relatively to the type on which the constraint is used. For instance, if
     * the constraint is on a {@link Year}, present would mean the whole current year.
     *
     * @return {@code true} if the present date should be considered valid
     */</span>
    <span class="type">boolean</span> orPresent() <span class="keyword">default</span> <span class="predefined-constant">false</span>;

    <span class="comment">/**
     * Defines several {@link Past} annotations on the same element.
     *
     * @see Past
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        Past<span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">113</span><span class="rcl-dd">111</span>. <span class="tck-testable">@Future constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated element must be an instant, date or time in the future.
 * &lt;p&gt;
 * <span class="rcl-da">&lt;</span><span class="rcl-da">i</span><span class="rcl-da">&gt;</span><span class="rcl-da">Now</span><span class="rcl-da">&lt;/</span><span class="rcl-da">i</span><span class="rcl-da">&gt;</span><span class="rcl-dd">By </span><span class="rcl-dd">default</span><span class="rcl-dd">, </span><span class="rcl-dd">"</span><span class="rcl-dd">now</span><span class="rcl-dd">" </span> is defined <span class="rcl-da">by</span><span class="rcl-dd">as </span> the <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ClockProvider</span><span class="rcl-da">}</span> <span class="rcl-da">attached</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">Validator</span><span class="rcl-da">}</span>
 <span class="rcl-da">*</span> <span class="rcl-da">or</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">ValidatorFactory</span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">default</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">clockProvider</span><span class="rcl-da">}</span> <span class="rcl-da">defines</span> <span class="rcl-da">the</span> current time according to the virtual machine,
 <span class="rcl-da">*</span> applying the current default time<span class="rcl-dd">* </span> zone if needed.<span class="rcl-dd">If </span><span class="rcl-dd">required</span><span class="rcl-dd">, </span><span class="rcl-dd">an </span><span class="rcl-dd">alternative </span><span class="rcl-dd">{@</span><span class="rcl-dd">link </span><span class="rcl-dd">ClockProvider</span><span class="rcl-dd">} </span><span class="rcl-dd">can </span><span class="rcl-dd">be </span><span class="rcl-dd">specified </span><span class="rcl-dd">when </span><span class="rcl-dd">bootstrapping </span><span class="rcl-dd">a </span><span class="rcl-dd">validator </span>
 *<span class="rcl-dd">factory </span><span class="rcl-dd">or </span><span class="rcl-dd">validator</span><span class="rcl-dd">, </span><span class="rcl-dd">allowing </span><span class="rcl-dd">to </span><span class="rcl-dd">customize </span><span class="rcl-dd">the </span><span class="rcl-dd">{@</span><span class="rcl-dd">link </span><span class="rcl-dd">Clock</span><span class="rcl-dd">} </span><span class="rcl-dd">representing </span><span class="rcl-dd">the </span><span class="rcl-dd">current </span><span class="rcl-dd">instant</span><span class="rcl-dd">, </span><span class="rcl-dd">date </span><span class="rcl-dd">and </span><span class="rcl-dd">time</span><span class="rcl-dd">. </span><span class="rcl-dd">* </span> &lt;p&gt;
 * Supported types are:
 * &lt;ul&gt;
 *     &lt;li&gt;{@code java.util.Date}&lt;/li&gt;
 *     &lt;li&gt;{@code java.util.Calendar}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.Instant}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.LocalTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.MonthDay}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.OffsetDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.OffsetTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.Year}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.YearMonth}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.ZonedDateTime}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.HijrahDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.JapaneseDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.MinguoDate}&lt;/li&gt;
 *     &lt;li&gt;{@code java.time.chrono.ThaiBuddhistDate}&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Future</span> {

    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Future.message}</span><span class="delimiter">"</span></span>;

    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * The notion of present here is defined relatively to the type on which the constraint is used. For instance, if
     * the constraint is on a {@link Year}, present would mean the whole current year.
     *
     * @return {@code true} if the present date should be considered valid
     */</span>
    <span class="type">boolean</span> orPresent() <span class="keyword">default</span> <span class="predefined-constant">false</span>;

    <span class="comment">/**
     * Defines several {@link Future} annotations on the same element.
     *
     * @see Future
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        <span class="predefined-type">Future</span><span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">114</span><span class="rcl-dd">112</span>. <span class="tck-testable">@Pattern constraint</span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.constraints</span>;

<span class="comment">/**
 * The annotated {@code CharSequence} must match the specified regular expression.
 * The regular expression follows the Java regular expression conventions
 * see {@link java.util.regex.Pattern}.
 * &lt;p&gt;
 * Accepts {@code CharSequence}. {@code null} elements are considered valid.
 *
 * @author Emmanuel Bernard
 */</span>
<span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Repeatable</span>(<span class="predefined-type">List</span>.class)
<span class="annotation">@Documented</span>
<span class="annotation">@Constraint</span>(validatedBy = { })
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Pattern</span> {

    <span class="comment">/**
     * @return the regular expression to match
     */</span>
    <span class="predefined-type">String</span> regexp();

    <span class="comment">/**
     * @return array of {@code Flag}s considered when resolving the regular expression
     */</span>
    Flag<span class="type">[]</span> flags() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return the error message template
     */</span>
    <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">"</span><span class="content">{javax.validation.constraints.Pattern.message}</span><span class="delimiter">"</span></span>;

    <span class="comment">/**
     * @return the groups the constraint belongs to
     */</span>
    <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> { };

    <span class="comment">/**
     * @return the payload associated to the constraint
     */</span>
    <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> { };

    <span class="comment">/**
     * Possible Regexp flags.
     */</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> Flag {

        <span class="comment">/**
         * Enables Unix lines mode.
         *
         * @see java.util.regex.Pattern#UNIX_LINES
         */</span>
        UNIX_LINES( java.util.regex.Pattern.UNIX_LINES ),

        <span class="comment">/**
         * Enables case-insensitive matching.
         *
         * @see java.util.regex.Pattern#CASE_INSENSITIVE
         */</span>
        CASE_INSENSITIVE( java.util.regex.Pattern.CASE_INSENSITIVE ),

        <span class="comment">/**
         * Permits whitespace and comments in pattern.
         *
         * @see java.util.regex.Pattern#COMMENTS
         */</span>
        COMMENTS( java.util.regex.Pattern.COMMENTS ),

        <span class="comment">/**
         * Enables multiline mode.
         *
         * @see java.util.regex.Pattern#MULTILINE
         */</span>
        MULTILINE( java.util.regex.Pattern.MULTILINE ),

        <span class="comment">/**
         * Enables dotall mode.
         *
         * @see java.util.regex.Pattern#DOTALL
         */</span>
        DOTALL( java.util.regex.Pattern.DOTALL ),

        <span class="comment">/**
         * Enables Unicode-aware case folding.
         *
         * @see java.util.regex.Pattern#UNICODE_CASE
         */</span>
        UNICODE_CASE( java.util.regex.Pattern.UNICODE_CASE ),

        <span class="comment">/**
         * Enables canonical equivalence.
         *
         * @see java.util.regex.Pattern#CANON_EQ
         */</span>
        CANON_EQ( java.util.regex.Pattern.CANON_EQ );

        <span class="comment">//JDK flag value</span>
        <span class="directive">private</span> <span class="directive">final</span> <span class="type">int</span> value;

        <span class="directive">private</span> Flag(<span class="type">int</span> value) {
            <span class="local-variable">this</span>.value = value;
        }

        <span class="comment">/**
         * @return flag value as defined in {@link java.util.regex.Pattern}
         */</span>
        <span class="directive">public</span> <span class="type">int</span> getValue() {
            <span class="keyword">return</span> value;
        }
    }

    <span class="comment">/**
     * Defines several {@link Pattern} annotations on the same element.
     *
     * @see Pattern
     */</span>
    <span class="annotation">@Target</span>({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
    <span class="annotation">@Retention</span>(RUNTIME)
    <span class="annotation">@Documented</span>
    <span class="annotation">@interface</span> <span class="predefined-type">List</span> {

        <span class="predefined-type">Pattern</span><span class="type">[]</span> value();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title"><span class="rcl-da">Example</span> <span class="rcl-da">115</span><span class="rcl-da">.</span> <span class="tck-testable"><span class="rcl-da">@</span><span class="rcl-da">NotEmpty</span> <span class="rcl-da">constraint</span></span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span></span><span class="rcl-da">;</span>

 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">not</span> <span class="rcl-da">be</span> <span class="rcl-da">{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-constant"><span class="rcl-da">null</span></span><span class="rcl-da">}</span> <span class="rcl-da">nor</span> <span class="rcl-da">empty</span><span class="rcl-da">.</span> <span class="rcl-da">Supported</span> <span class="rcl-da">types</span> <span class="rcl-da">are</span><span class="rcl-da">:</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-type"><span class="rcl-da">CharSequence</span></span><span class="rcl-da">}</span> <span class="rcl-da">(</span><span class="rcl-da">length</span> <span class="rcl-da">of</span> <span class="rcl-da">character</span> <span class="rcl-da">sequence</span> <span class="rcl-da">is</span> <span class="rcl-da">evaluated</span><span class="rcl-da">)&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-type"><span class="rcl-da">Collection</span></span><span class="rcl-da">}</span> <span class="rcl-da">(</span><span class="rcl-da">collection</span> <span class="rcl-da">size</span> <span class="rcl-da">is</span> <span class="rcl-da">evaluated</span><span class="rcl-da">)&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-type"><span class="rcl-da">Map</span></span><span class="rcl-da">}</span> <span class="rcl-da">(</span><span class="rcl-da">map</span> <span class="rcl-da">size</span> <span class="rcl-da">is</span> <span class="rcl-da">evaluated</span><span class="rcl-da">)&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span><span class="predefined-type"><span class="rcl-da">Array</span></span> <span class="rcl-da">(</span><span class="rcl-da">array</span> <span class="rcl-da">length</span> <span class="rcl-da">is</span> <span class="rcl-da">evaluated</span><span class="rcl-da">)&lt;/</span><span class="rcl-da">li</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;/</span><span class="rcl-da">ul</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">author</span></span> <span class="rcl-da">Emmanuel</span> <span class="rcl-da">Bernard</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">author</span></span> <span class="rcl-da">Hardy</span> <span class="rcl-da">Ferentschik</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">since</span></span> <span class="float"><span class="rcl-da">2.0</span></span>
 <span class="rcl-da">*/</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="rcl-da">NotEmpty</span> <span class="rcl-da">{</span>

    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">message</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">{</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">NotEmpty</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">}</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">groups</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?</span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Payload</span><span class="rcl-da">&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">payload</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">several</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">@</span><span class="rcl-da">NotEmpty</span><span class="rcl-da">}</span> <span class="rcl-da">constraints</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">element</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">see</span> <span class="rcl-da">NotEmpty</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
    <span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="predefined-type"><span class="rcl-da">List</span></span> <span class="rcl-da">{</span>
        <span class="rcl-da">NotEmpty</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">value</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title"><span class="rcl-da">Example</span> <span class="rcl-da">116</span><span class="rcl-da">.</span> <span class="tck-testable"><span class="rcl-da">@</span><span class="rcl-da">NotBlank</span> <span class="rcl-da">constraint</span></span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span></span><span class="rcl-da">;</span>

 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">not</span> <span class="rcl-da">be</span> <span class="rcl-da">{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-constant"><span class="rcl-da">null</span></span><span class="rcl-da">}</span> <span class="rcl-da">nor</span> <span class="rcl-da">empty</span> <span class="rcl-da">after</span> <span class="rcl-da">removing</span> <span class="rcl-da">any</span> <span class="rcl-da">leading</span> <span class="rcl-da">or</span> <span class="rcl-da">trailing</span>
 <span class="rcl-da">*</span> <span class="rcl-da">whitespace</span><span class="rcl-da">.</span> <span class="rcl-da">Accepts</span> <span class="rcl-da">{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-type"><span class="rcl-da">CharSequence</span></span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">author</span></span> <span class="rcl-da">Hardy</span> <span class="rcl-da">Ferentschik</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">since</span></span> <span class="float"><span class="rcl-da">2.0</span></span>
 <span class="rcl-da">*/</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="rcl-da">NotBlank</span> <span class="rcl-da">{</span>

    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">message</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">{</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">NotBlank</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">}</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">groups</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?</span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Payload</span><span class="rcl-da">&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">payload</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">several</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">@</span><span class="rcl-da">NotBlank</span><span class="rcl-da">}</span> <span class="rcl-da">constraints</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">element</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">see</span> <span class="rcl-da">NotBlank</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
    <span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="predefined-type"><span class="rcl-da">List</span></span> <span class="rcl-da">{</span>
        <span class="rcl-da">NotBlank</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">value</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title"><span class="rcl-da">Example</span> <span class="rcl-da">117</span><span class="rcl-da">.</span> <span class="tck-testable"><span class="rcl-da">@</span><span class="rcl-da">Email</span> <span class="rcl-da">constraint</span></span></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword"><span class="rcl-da">package</span></span> <span class="namespace"><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span></span><span class="rcl-da">;</span>

 <span class="rcl-da">*</span> <span class="rcl-da">address</span> <span class="rcl-da">are</span> <span class="rcl-da">left</span> <span class="rcl-da">to</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">providers</span><span class="rcl-da">.</span> <span class="rcl-da">Accepts</span> <span class="rcl-da">{</span><span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">code</span></span> <span class="predefined-type"><span class="rcl-da">CharSequence</span></span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">author</span></span> <span class="rcl-da">Emmanuel</span> <span class="rcl-da">Bernard</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">author</span></span> <span class="rcl-da">Hardy</span> <span class="rcl-da">Ferentschik</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">since</span></span> <span class="float"><span class="rcl-da">2.0</span></span>
 <span class="rcl-da">*/</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Constraint</span></span><span class="rcl-da">(</span><span class="rcl-da">validatedBy</span> <span class="rcl-da">=</span> <span class="rcl-da">{</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Repeatable</span></span><span class="rcl-da">(</span><span class="predefined-type"><span class="rcl-da">List</span></span><span class="rcl-da">.</span><span class="rcl-da">class</span><span class="rcl-da">)</span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="rcl-da">Email</span> <span class="rcl-da">{</span>

    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">message</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">{</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">Email</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">}</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">groups</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?</span> <span class="directive"><span class="rcl-da">extends</span></span> <span class="rcl-da">Payload</span><span class="rcl-da">&gt;</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">payload</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">an</span> <span class="rcl-da">additional</span> <span class="rcl-da">regular</span> <span class="rcl-da">expression</span> <span class="rcl-da">the</span> <span class="rcl-da">annotated</span> <span class="rcl-da">element</span> <span class="rcl-da">must</span> <span class="rcl-da">match</span><span class="rcl-da">.</span> <span class="rcl-da">The</span> <span class="rcl-da">default</span> <span class="rcl-da">is</span> <span class="rcl-da">any</span> <span class="rcl-da">string</span> <span class="rcl-da">('.*')</span>
     <span class="rcl-da">*/</span></span>
    <span class="predefined-type"><span class="rcl-da">String</span></span> <span class="rcl-da">regexp</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">.*</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="rcl-da">;</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">used</span> <span class="rcl-da">in</span> <span class="rcl-da">combination</span> <span class="rcl-da">with</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">#</span><span class="rcl-da">regexp</span><span class="rcl-da">()}</span> <span class="rcl-da">in</span> <span class="rcl-da">order</span> <span class="rcl-da">to</span> <span class="rcl-da">specify</span> <span class="rcl-da">a</span> <span class="rcl-da">regular</span> <span class="rcl-da">expression</span> <span class="rcl-da">option</span>
     <span class="rcl-da">*/</span></span>
    <span class="predefined-type"><span class="rcl-da">Pattern</span></span><span class="rcl-da">.</span><span class="rcl-da">Flag</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">flags</span><span class="rcl-da">()</span> <span class="keyword"><span class="rcl-da">default</span></span> <span class="rcl-da">{</span> <span class="rcl-da">};</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">several</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">@</span><span class="rcl-da">Email</span><span class="rcl-da">}</span> <span class="rcl-da">constraints</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">element</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">see</span> <span class="rcl-da">Email</span>
     <span class="rcl-da">*/</span></span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Target</span></span><span class="rcl-da">({</span> <span class="rcl-da">METHOD</span><span class="rcl-da">,</span> <span class="rcl-da">FIELD</span><span class="rcl-da">,</span> <span class="rcl-da">ANNOTATION</span><span class="rcl-da">_</span><span class="rcl-da">TYPE</span><span class="rcl-da">,</span> <span class="rcl-da">CONSTRUCTOR</span><span class="rcl-da">,</span> <span class="rcl-da">PARAMETER</span><span class="rcl-da">,</span> <span class="rcl-da">TYPE</span><span class="rcl-da">_</span><span class="rcl-da">USE</span> <span class="rcl-da">})</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Retention</span></span><span class="rcl-da">(</span><span class="rcl-da">RUNTIME</span><span class="rcl-da">)</span>
    <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
    <span class="directive"><span class="rcl-da">public</span></span> <span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">interface</span></span> <span class="predefined-type"><span class="rcl-da">List</span></span> <span class="rcl-da">{</span>
        <span class="rcl-da">Email</span><span class="type"><span class="rcl-da">[]</span></span> <span class="rcl-da">value</span><span class="rcl-da">();</span>
    <span class="rcl-da">}</span>
<span class="rcl-da">}</span></code></pre>
</div>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="xml"><a class="anchor" href="#xml"></a>8. XML deployment descriptor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two kinds of XML descriptors are used by Bean Validation. The first one describes the Bean Validation configuration provided as <code class="filename">META-INF/validation.xml</code>. The second one describes constraints declarations and closely matches the annotations declaration approach. <span class="tck-testable">If an XML descriptor does not validate against the corresponding XSD file, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="sect2">
<h3 id="xml-mapping"><a class="anchor" href="#xml-mapping"></a>8.1. Constraint definition and declaration</h3>
<div class="paragraph">
<p>Bean Validation lets you declare constraints via XML rather than annotations. You can either ignore constraints declared via annotations or consider XML as adding additional constraints on top of annotation constraints. While it is not possible to define a new constraint via XML, you can redefine the list of <code class="classname">ConstraintValidator</code> classes associated to a given constraint definition.</p>
</div>
<div class="paragraph">
<p>There is no distinction between an annotation based constraint declaration and an XML based constraint declaration: they are considered equivalent and should be treated as such by the Bean Validation provider. The rest of the specification only refers to annotations as validation metadata: it should be read as annotation or their XML descriptor equivalent.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Specifically when exploring metadata, the Bean Validation provider must ensure that an annotation instance corresponding to the XML declaration is provided via <code class="classname">ConstraintDescriptor.getAnnnotation()</code>.</span> The annotation elements as well as <code class="methodname">ConstraintValidator.getAttributes()</code> must reflect the values described in the XML declaration (see <a href="#xml-mapping-typeconversion">Converting the string representation of a value</a>). Likewise, <code class="methodname">ConstraintDescriptor.getConstraintValidatorClasses()</code> must reflect XML based constraint definition overriding (see <a href="#xml-mapping-constraintdefinition">Overriding constraint definitions in XML</a>).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A given class must not be described more than once amongst all the XML mapping descriptors.</span> <span class="tck-testable">A given field or getter must not be described more than once on a given class description.</span> <span class="tck-testable">A given constraint definition must not be overridden more than once amongst all the XML mapping descriptors.</span> <span class="tck-testable">If any of these rules is violated in a given validation deployment, a <code class="classname">ValidationException</code> is raised during the creation of the <code class="classname">ValidatorFactory</code>.</span></p>
</div>
<div class="paragraph">
<p>The schema is provided in <a href="#xml-mapping-xsd">XML Schema</a>.</p>
</div>
<div class="sect3">
<h4 id="xml-mapping-constraintdeclarationinxml"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml"></a>8.1.1. Constraint declaration in XML</h4>
<div class="paragraph">
<p><span class="tck-testable">If <code>default-package</code> is set, all unqualified class names (including annotations) are considered part of the package described by <code>default-package</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A given JavaBean is described by the <code class="classname">bean</code> element.</span> <span class="tck-testable">The name of the class is mandatory.</span> <span class="tck-testable">By default, all constraint declarations expressed via annotations are ignored for classes described in XML.</span> <span class="tck-testable">You can force Bean Validation to consider both annotations and XML constraint declarations by using <code>ignore-annotations="false"</code> on <code>bean</code>.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>ignore-annotations</code> setting is not inherited from nor by the class hierarchy. In other words, it applies to the current bean only.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the name of the class does refer to a class not present in the classpath, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">118</span><span class="rcl-dd">113</span>. Example of bean XML declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>

    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        [...]
    <span class="tag">&lt;/bean&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.common.model.Address</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        [...]
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-classleveloverriding"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-classleveloverriding"></a><span class="rcl-da">8.1.1.1</span><span class="rcl-da">.</span> Class-level overriding</h5>
<div class="paragraph">
<p>Class level annotations are described via the <code>class</code> element. <span class="tck-testable">If <code>ignore-annotations</code> is declared, Bean Validation must honor the explicit value for this element.</span> <span class="tck-testable">If not declared, the default value defined in the encapsulating <code class="classname">bean</code> element is considered.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When <code>ignore-annotations</code> is true, class-level Bean Validation annotations are ignored for this class (including the <code class="classname">@GroupSequence</code>).</span> When <code>ignore-annotations</code> is false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Constraints declared in XML and constraints declared in annotations are added and form the list of class-level declared constraints.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">@GroupSequence</code> is considered unless <code>group-sequence</code> element is explicitly used.</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">119</span><span class="rcl-dd">114</span>. Example of class-level declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;class</span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            [...]
        <span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.common.model.Address</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;class&gt;</span>
            [...]
        <span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-fieldleveloverriding"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-fieldleveloverriding"></a><span class="rcl-da">8.1.1.2</span><span class="rcl-da">.</span> Field-level overriding</h5>
<div class="paragraph">
<p>Field level annotations are described via the <code>field</code> element. The <code>name</code> attribute corresponds to the name of the field considered. <span class="tck-testable">If <code>ignore-annotations</code> is declared, Bean Validation must honor the explicit value for this element.</span> <span class="tck-testable">If not declared, the default value defined in the encapsulating <code class="classname">bean</code> element is considered.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When <code>ignore-annotations</code> is true, field-level Bean Validation annotations on the targeted field are ignored (including <code class="classname">@Valid</code> and <code class="classname">@ConvertGroup</code>).</span> When <code>ignore-annotations</code> is false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Constraints declared in XML and constraints declared in annotations are added and form the list of field-level declared constraints.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">@Valid</code> is considered unless the <code>valid</code> element is explicitly used.</span> <span class="tck-ignore">Note that the only way to disable cascading on a field marked as <code class="classname">@Valid</code> is to use <code>ignore-annotations=true</code>.</span></p>
</li>
<li>
<p><span class="tck-testable">Group conversions declared in XML and via the <code class="classname">@ConvertGroup</code> annotation are added and form the list of applied conversions. Note that the rules for the declaration of group conversions as outlined in <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a> apply, in particular it is not legal to declare several conversions for the same source group.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the name of the field does not correspond to a field in the given bean a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">120</span><span class="rcl-dd">115</span>. Field-level declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;field</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">firstName</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            [...]
        <span class="tag">&lt;/field&gt;</span>
        <span class="tag">&lt;field</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">orders</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
            [...]
        <span class="tag">&lt;/field&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-propertyleveloverriding"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-propertyleveloverriding"></a><span class="rcl-da">8.1.1.3</span><span class="rcl-da">.</span> Property-level overriding</h5>
<div class="paragraph">
<p>Property-level annotations are described via the <code>getter</code> element. <span class="tck-testable">The <code>name</code> attribute corresponds to the name of the property considered as defined in <a href="#constraintdeclarationvalidationprocess-requirements-propertyvalidation">Field and property validation</a> (for example a getter <code>String getAge()</code> would have <code>&lt;getter name="age"/&gt;</code> as a corresponding descriptor). If <code>ignore-annotations</code> is declared, Bean Validation must honor the explicit value for this element.</span> <span class="tck-testable">If not declared, the default value defined in the encapsulating <code class="classname">bean</code> element is considered.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When <code>ignore-annotations</code> is true, property-level Bean Validation annotations on the targeted property are ignored (including <code class="classname">@Valid</code> and <code class="classname">@ConvertGroup</code>).</span> When <code>ignore-annotations</code> is false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Constraints declared in XML and constraints declared in annotations are added and form the list of property-level declared constraints.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">@Valid</code> is considered unless the <code>valid</code> element is explicitly used.</span> Note that the only way to disable cascading on a property marked as <code class="classname">@Valid</code> is to use <code>ignore-annotations=true</code>.</p>
</li>
<li>
<p><span class="tck-testable">Group conversions declared in XML and via the <code class="classname">@ConvertGroup</code> annotation are added and form the list of applied conversions. Note that the rules for the declaration of group conversions as outlined in <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a> apply, in particular it is not legal to declare several conversions for the same source group.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the name of the property does not correspond to a property in the given bean a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">121</span><span class="rcl-dd">116</span>. Property-level declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;getter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">firstName</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            [...]
        <span class="tag">&lt;/getter&gt;</span>
        <span class="tag">&lt;getter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">orders</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
            [...]
        <span class="tag">&lt;/getter&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-constructorleveloverriding"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-constructorleveloverriding"></a><span class="rcl-da">8.1.1.4</span><span class="rcl-da">.</span> Constructor-level overriding</h5>
<div class="paragraph">
<p>Constructor-level annotations are described via the <code>constructor</code> element.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">To identify a constructor to be configured, zero or more parameter elements are used, matching the number and types of parameters of the configured constructor. When configuring the default constructor, no parameter element is to be used. The parameter types are specified using their fully qualified name using the syntax described in the documentation of <code class="methodname">java.lang.Class.getName()</code>.</span></p>
</div>
<div class="paragraph">
<p>Let’s look at some examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"java.lang.String"</code> must be specified for a parameter of type <code class="classname">java.lang.String</code></p>
</li>
<li>
<p><code>"long"</code> must be specified for a parameter of type <code class="classname">long</code></p>
</li>
<li>
<p><code>"[Ljava.lang.Object;"</code> must be specified for a parameter of type <code class="classname">java.lang.Object[]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">Varargs parameters are specified using the corresponding array type, e.g. a parameter <code>String...</code> must be specified as <code>"[Ljava.lang.String;"</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the <code>default-package</code> element is configured for the mapping file, any unqualified class names will be resolved using the given default package.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You must declare all parameters even if they are not reconfigured to ensure the right constructor is identified.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">If no constructor with the specified parameter types exists in the given bean a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The optional <code>return-value</code> element is used to change the configuration of a constructor’s return value if required.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The optional <code>cross-parameter</code> element is used to change the configuration of a constructor’s cross-parameter constraints if required.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The constraints applying for a constructor’s parameters and its return value are specified by adding <code>constraint</code> elements to the <code>parameter</code> and <code>return-value</code> elements respectively.</span> <span class="tck-testable">Whether or not to perform cascaded validation is controlled using the <code>valid</code> element</span> . <span class="tck-testable">Group conversion rules for cascaded validation are specified using the <code>convert-group</code> element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The cross-parameter constraints applied on a constructor parameter list are specified by adding <code>constraint</code> elements to the <code>cross-parameter</code> element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If <code>ignore-annotations</code> is declared on the parameter, cross-parameter element or return value level, Bean Validation must honor the explicit value for this element. Otherwise, if <code>ignore-annotations</code> is declared for the <code>constructor</code> element, Bean Validation must honor this value. Otherwise, the default value declared in the encapsulating <code>bean</code> element is considered.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When <code>ignore-annotations</code> is true, Bean Validation annotations on the targeted constructor or parameter are ignored (including <code class="classname">@Valid</code> and <code class="classname">@ConvertGroup</code>).</span> When <code>ignore-annotations</code> is false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Constraints declared in XML and constraints declared in annotations are added and form the list of declared parameter, cross-parameter or return value constraints respectively.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">@Valid</code> is considered unless the <code>valid</code> element is explicitly used.</span> <span class="tck-ignore">Note that the only way to disable cascading on a constructor parameter or return value marked as <code class="classname">@Valid</code> is to use <code>ignore-annotations=true</code>. This does not apply to cross-parameter elements as cascading does not make sense in this situation.</span></p>
</li>
<li>
<p><span class="tck-testable">Group conversions declared in XML and via the <code class="classname">@ConvertGroup</code> annotation are added and form the list of applied conversions. Note that the rules for the declaration of group conversions as outlined in <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a> apply, in particular it is not legal to declare several conversions for the same source group. This does not apply to cross-parameter elements as cascading does not make sense in this situation.</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">122</span><span class="rcl-dd">117</span>. Constructor-level declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;constructor</span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                [...]
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">int</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                [...]
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">long</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;cross-parameter</span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                [...]
            <span class="tag">&lt;/cross-parameter&gt;</span>
            <span class="tag">&lt;return-value&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                [...]
            <span class="tag">&lt;/return-value&gt;</span>
            [...]
        <span class="tag">&lt;/constructor&gt;</span>

    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-methodleveloverriding"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-methodleveloverriding"></a><span class="rcl-da">8.1.1.5</span><span class="rcl-da">.</span> Method-level overriding</h5>
<div class="paragraph">
<p>Method-level annotations are described via the <code>method</code> element.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">To identify a method to be configured, zero or more parameter elements are used, matching the number and types of parameters of the configured method. The parameter types are specified using their fully qualified name using the syntax described in the documentation of <code class="methodname">java.lang.Class.getName()</code>.</span></p>
</div>
<div class="paragraph">
<p>Let’s look at some examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"java.lang.String"</code> must be specified for a parameter of type <code class="classname">java.lang.String</code></p>
</li>
<li>
<p><code>"long"</code> must be specified for a parameter of type <code class="classname">long</code></p>
</li>
<li>
<p><code>"[Ljava.lang.Object;"</code> must be specified for a parameter of type <code class="classname">java.lang.Object[]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-testable">Varargs parameters are specified using the corresponding array type, e.g. a parameter <code>String...</code> must be specified as <code>"[Ljava.lang.String;"</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the <code>default-package</code> element is configured for the mapping file, any unqualified class names will be resolved using the given default package.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You must declare all parameters even if they are not reconfigured to ensure the right method is identified.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><span class="tck-testable">A given getter method representing a JavaBeans property may either be configured using the <code>getter</code> or the <code>method</code> element, but not both. If a <code>getter</code> element and a <code>method</code> element referring to the same method are detected by the Bean Validation provider, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">If no method with the specified name and parameter types exists in the given bean a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The optional <code>return-value</code> element is used to change the configuration of a method’s return value if required.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The optional <code>cross-parameter</code> element is used to change the configuration of a method’s cross-parameter constraints if required.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The constraints applying for a method’s parameters and its return value are specified by adding <code>constraint</code> elements to the <code>parameter</code> and <code>return-value</code> elements respectively.</span> <span class="tck-testable">Whether or not to perform cascaded validation is controlled using the <code>valid</code> element.</span> <span class="tck-testable">Group conversion rules for cascaded validation are specified using the <code>convert-group</code> element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">The cross-parameter constraints applied on a method parameter list are specified by adding <code>constraint</code> elements to the <code>cross-parameter</code> element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If <code>ignore-annotations</code> is declared on the parameter, cross-parameter element or return value level, Bean Validation must honor the explicit value for this element. Otherwise, if <code>ignore-annotations</code> is declared for the <code>method</code> element, Bean Validation must honor this value. Otherwise, the default value declared in the encapsulating <code>bean</code> element is considered.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When <code>ignore-annotations</code> is true, Bean Validation annotations on the targeted method or parameter are ignored (including <code class="classname">@Valid</code> and <code class="classname">@ConvertGroup</code>).</span> When <code>ignore-annotations</code> is false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">Constraints declared in XML and constraints declared in annotations are added and form the list of declared parameter, cross-parameter or return value constraints respectively.</span></p>
</li>
<li>
<p><span class="tck-testable"><code class="classname">@Valid</code> is considered unless the <code>valid</code> element is explicitly used.</span> <span class="tck-ignore">Note that the only way to disable cascading on a method parameter or return value marked as <code class="classname">@Valid</code> is to use <code>ignore-annotations=true</code>. This does not apply to cross-parameter elements as cascading does not make sense in this situation.</span></p>
</li>
<li>
<p><span class="tck-testable">Group conversions declared in XML and via the <code class="classname">@ConvertGroup</code> annotation are added and form the list of applied conversions. Note that the rules for the declaration of group conversions as outlined in <a href="#constraintdeclarationvalidationprocess-groupsequence-groupconversion">Group conversion</a> apply, in particular it is not legal to declare several conversions for the same source group. This does not apply to cross-parameter elements as cascading does not make sense in this situation.</span></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">123</span><span class="rcl-dd">118</span>. Method-level declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;method</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">update</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                [...]
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">int</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                [...]
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">long</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;cross-parameter</span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                [...]
            <span class="tag">&lt;/cross-parameter&gt;</span>
            <span class="tag">&lt;return-value&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                [...]
            <span class="tag">&lt;/return-value&gt;</span>
            [...]
        <span class="tag">&lt;/method&gt;</span>

    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-constraintdeclaration"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-constraintdeclaration"></a><span class="rcl-da">8.1.1.6</span><span class="rcl-da">.</span> Constraint declaration</h5>
<div class="paragraph">
<p>New constraint declarations are represented by the <code>constraint</code> element. <span class="tck-testable">The <code>annotation</code> attribute is the class name of the annotation representing the constraint. Message, groups and payload are defined respectively by the <code>message</code>, <code>groups</code> and <code>payload</code> elements.</span></p>
</div>
<div class="paragraph">
<p>Other custom elements of an annotation are represented by <code>element</code>. <span class="tck-testable">The <code>name</code> attribute is mandatory and represents the name of the element in the constraint declaration.</span> <span class="tck-testable"><code>message</code>, <code>groups</code> and <code>payload</code> are not permitted names, use the <code>message</code>, <code>groups</code> or <code>payload</code> elements instead. Otherwise a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>validationAppliesTo</code> (see <a href="#constraintsdefinitionimplementation-constraintdefinition-properties-validationappliesto">validationAppliesTo</a>) is not necessary as cross-parameter constraints and return value constraints are declared in different XML elements, respectively <code>cross-parameter</code> and <code>return-value</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the element represents a primitive type, a class or an enum, the string representation of its value is placed in the element itself.</span> See <a href="#xml-mapping-typeconversion">Converting the string representation of a value</a> for a detailed explanation of the conversion rules from string to the type.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the element represents a primitive type array, a class array or an enum array, the string representation of each value is placed in a <code>value</code> element placed under the element itself.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the element represents an annotation, the <code>annotation</code> element is used to represent the annotation and placed under <code>element</code>.</span> An <code>annotation</code> element contains <code>element</code> elements.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If the element represents an array of annotations, one or more <code>annotation</code> elements are placed under <code>element</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Elements with default values in the annotation definition do not have to be represented in XML: the default value will be used in this case.</span> <span class="tck-testable">If an XML constraint declaration is missing mandatory elements, or if it contains elements not part of the constraint definition, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">124</span><span class="rcl-dd">119</span>. Constraint declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

        <span class="tag">&lt;field</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">firstName</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>


            <span class="comment">&lt;!-- @LooksLike(patterns={
                      @Pattern(value="myRegExp", flag=PatternFlag.INSENSITIVE),
                      @Pattern(value="my2ndRegExp")}
                  )
             --&gt;</span>
            <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.LooksLike</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">patterns</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;annotation&gt;</span>
                        <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>myRegExp<span class="tag">&lt;/element&gt;</span>
                        <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">flag</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;value&gt;</span>INSENSITIVE<span class="tag">&lt;/value&gt;</span>
                        <span class="tag">&lt;/element&gt;</span>
                    <span class="tag">&lt;/annotation&gt;</span>
                    <span class="tag">&lt;annotation&gt;</span>
                        <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>my2ndRegExp<span class="tag">&lt;/element&gt;</span>
                    <span class="tag">&lt;/annotation&gt;</span>
                <span class="tag">&lt;/element&gt;</span>
            <span class="tag">&lt;/constraint&gt;</span>


        <span class="tag">&lt;/field&gt;</span>
        <span class="tag">&lt;field</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">orders</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>


            <span class="comment">&lt;!-- @DiscreteSize(value={ 0, 20 } )
             --&gt;</span>
            <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.DiscreteSize</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;value&gt;</span>0<span class="tag">&lt;/value&gt;</span>
                    <span class="tag">&lt;value&gt;</span>20<span class="tag">&lt;/value&gt;</span>
                <span class="tag">&lt;/element&gt;</span>
            <span class="tag">&lt;/constraint&gt;</span>


        <span class="tag">&lt;/field&gt;</span>

        <span class="tag">&lt;getter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">orders</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>


            <span class="comment">&lt;!-- @Size(message="Size is limited",
                       groups={Default.class, LightValidation.class},
                       max=30
                 )
            --&gt;</span>
            <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.constraints.Size</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;message&gt;</span>Size is limited<span class="tag">&lt;/message&gt;</span>
                <span class="tag">&lt;groups&gt;</span>
                    <span class="tag">&lt;value&gt;</span>com.acme.app.model.LightValidation<span class="tag">&lt;/value&gt;</span>
                    <span class="tag">&lt;value&gt;</span>javax.persistence.Default<span class="tag">&lt;/value&gt;</span>
                <span class="tag">&lt;/groups&gt;</span>
                <span class="tag">&lt;payload&gt;</span>
                    <span class="tag">&lt;value&gt;</span>com.acme.app.model.WARN<span class="tag">&lt;/value&gt;</span>
                <span class="tag">&lt;/payload&gt;</span>
                <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">max</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>30<span class="tag">&lt;/element&gt;</span>
            <span class="tag">&lt;/constraint&gt;</span>


        <span class="tag">&lt;/getter&gt;</span>

        <span class="tag">&lt;constructor</span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

                <span class="comment">&lt;!-- @DiscreteSize(value={ 0, 20 } ) --&gt;</span>
                <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.DiscreteSize</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;value&gt;</span>0<span class="tag">&lt;/value&gt;</span>
                        <span class="tag">&lt;value&gt;</span>20<span class="tag">&lt;/value&gt;</span>
                    <span class="tag">&lt;/element&gt;</span>
                <span class="tag">&lt;/constraint&gt;</span>
            <span class="tag">&lt;/parameter&gt;</span>
        <span class="tag">&lt;/constructor&gt;</span>

        <span class="tag">&lt;method</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">update</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

                <span class="comment">&lt;!-- @DiscreteSize(value={ 0, 20 } ) --&gt;</span>
                <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.DiscreteSize</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;value&gt;</span>0<span class="tag">&lt;/value&gt;</span>
                        <span class="tag">&lt;value&gt;</span>20<span class="tag">&lt;/value&gt;</span>
                    <span class="tag">&lt;/element&gt;</span>
                <span class="tag">&lt;/constraint&gt;</span>
            <span class="tag">&lt;/parameter&gt;</span>

            <span class="tag">&lt;return-value&gt;</span>

                <span class="comment">&lt;!-- @ValidCustomer --&gt;</span>
                <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.ValidCustomer</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/return-value&gt;</span>
        <span class="tag">&lt;/method&gt;</span>

        <span class="tag">&lt;method</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">resetPassword</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>

            <span class="tag">&lt;cross-parameter&gt;</span>
                <span class="comment">&lt;!-- @ValidResetPasswordParameters --&gt;</span>
                <span class="tag">&lt;constraint</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.app.constraint.ValidResetPasswordParameters</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/cross-parameter&gt;</span>
        <span class="tag">&lt;/method&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-mapping-constraintdeclarationinxml-groupconversions"><a class="anchor" href="#xml-mapping-constraintdeclarationinxml-groupconversions"></a><span class="rcl-da">8.1.1.7</span><span class="rcl-da">.</span> Declaration of group conversions</h5>
<div class="paragraph">
<p><span class="tck-testable">Group conversion rules are declared by specifying one or more <code>convert-group</code> elements within the <code>field</code>, <code>getter</code>, <code>parameter</code> and <code>return-value</code> elements.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Source and target group of a conversion rule are given by specifying their fully-qualified names within the <code>from</code> and <code>to</code> attribute respectively. If the <code>default-package</code> element is configured for the mapping file, any unqualified class names will be resolved using the given default package.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">125</span><span class="rcl-dd">120</span>. Declaration of group conversions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">Customer</span><span class="delimiter">"</span></span> <span class="attribute-name">ignore-annotations</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

        <span class="tag">&lt;field</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">firstName</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acmenote.Advanced</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerComplex</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/field&gt;</span>

        <span class="tag">&lt;getter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">orders</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/getter&gt;</span>

        <span class="tag">&lt;constructor&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;return-value&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/return-value&gt;</span>
        <span class="tag">&lt;/constructor&gt;</span>

        <span class="tag">&lt;method</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">update</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;parameter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">java.lang.String</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/parameter&gt;</span>
            <span class="tag">&lt;return-value&gt;</span>
                <span class="tag">&lt;valid</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;convert-group</span> <span class="attribute-name">from</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.groups.Default</span><span class="delimiter">"</span></span> <span class="attribute-name">to</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.CustomerBasic</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/return-value&gt;</span>
        <span class="tag">&lt;/constructor&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="xml-mapping-constraintdefinition"><a class="anchor" href="#xml-mapping-constraintdefinition"></a>8.1.2. Overriding constraint definitions in XML</h4>
<div class="paragraph">
<p>A constraint definition (i.e. the annotation representing a constraint), cannot be fully expressed in XML but the list of <code class="classname">ConstraintValidator</code>s associated to a given constraint can be altered.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A constraint definition is represented by a <code>constraint-definition</code> element.</span> The <code>annotation</code> attribute represents the constraint annotation being altered. The <code>validated-by</code> elements represent the (ordered) list of <code class="classname">ConstraintValidator</code> implementations associated to the constraint.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If <code>include-existing-validator</code> is set to false, <code class="classname">ConstraintValidator</code> defined on the constraint annotation are ignored.</span> <span class="tck-testable">If set to true, the list of <code class="classname">ConstraintValidator</code>s described in XML are concatenated to the list of <code class="classname">ConstraintValidator</code> described on the annotation to form a new array of <code class="classname">ConstraintValidator</code> evaluated.</span> <span class="tck-testable">Annotation based <code class="classname">ConstraintValidator</code> come before XML based <code class="classname">ConstraintValidator</code>s in the array.</span> <span class="tck-testable">The new list is returned by <code class="methodname">ConstraintDescriptor.getConstraintValidatorClasses()</code>.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">126</span><span class="rcl-dd">121</span>. Overriding constraint definitions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;constraint-mappings</span>
        <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping validation-mapping-2.0.xsd</span><span class="delimiter">"</span></span>
        <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;default-package&gt;</span>com.acme.app.domain<span class="tag">&lt;/default-package&gt;</span>
   <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.common.model.Address</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
       [...]
    <span class="tag">&lt;/bean&gt;</span>

    <span class="tag">&lt;constraint-definition</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">javax.validation.constraints.Size</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;validated-by</span> <span class="attribute-name">include-existing-validators</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;value&gt;</span>com.acme.app.constraint.SizeValidatorForDictionary<span class="tag">&lt;/value&gt;</span>
        <span class="tag">&lt;/validated-by&gt;</span>
    <span class="tag">&lt;/constraint-definition&gt;</span>
    <span class="tag">&lt;constraint-definition</span> <span class="attribute-name">annotation</span>=<span class="string"><span class="delimiter">"</span><span class="content">AcmeOrderNumber</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        [...]
    <span class="tag">&lt;/constraint-definition&gt;</span>
<span class="tag">&lt;/constraint-mappings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="xml-mapping-typeconversion"><a class="anchor" href="#xml-mapping-typeconversion"></a>8.1.3. Converting the string representation of a value</h4>
<div class="paragraph">
<p><span class="tck-testable">Primitive types, <code class="classname">Class</code> and <code class="classname">Enum</code> are represented as strings in the XML descriptor. Elements of an array are represented by the <code>value</code> element.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">byte</code> is represented according to the rules defined in <code class="methodname">Byte.parseByte(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">short</code> is represented according to the rules defined in <code class="methodname">Short.parseShort(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">An <code class="classname">int</code> is represented according to the rules defined in <code class="methodname">Integer.parseInt(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">long</code> is represented according to the rules defined in <code class="methodname">Long.parseLong(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">float</code> is represented according to the rules defined in <code class="methodname">Float.parseFloat(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">double</code> is represented according to the rules defined in <code class="methodname">Double.parseDouble(String)</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">boolean</code> is represented according to the rules defined in <code class="methodname">Boolean.parseBoolean(String)</code>.</span></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>A <code class="classname">char</code> is represented according to the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the string must be of one character long</p>
</li>
<li>
<p>the character extracted from the string is the returned <code class="classname">char</code></p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">A <code class="classname">Class</code> is represented by the fully qualified class name of the class or more precisely according to the syntax described in the documentation of <code class="methodname">java.lang.Class.getName()</code>. Note that if the raw string is unqualified, default package is taken into account.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">An enum is represented by its <code>enum.name()</code> value.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">If any of the string representation does not match its type counterpart, a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="xml-mapping-xsd"><a class="anchor" href="#xml-mapping-xsd"></a>8.1.4. XML Schema</h4>
<div class="paragraph">
<p>This section contains the XML schema used for constraint mapping descriptors.</p>
</div>
<div class="paragraph">
<p>From Bean Validation revision 1.1 onwards, mapping authors must specify the used version of the schema within the <code>version</code> attribute of the <code>constraint-mappings</code> element. <span class="tck-testable">Implementations supporting Bean Validation 2.0 must properly parse mapping descriptors of Bean Validation 1.0, 1.1 and 2.0.</span> <span class="tck-not-testable">If the <code>version</code> attribute attribute is not given, schema version 1.0 is to be assumed by the Bean Validation provider.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">In case an unknown version is given (e.g. if a mapping descriptor adhering to a future schema version is parsed by a Bean Validation 2.0 provider) a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">127</span><span class="rcl-dd">122</span>. XML schema for constraint mapping descriptors</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="comment"><span class="rcl-da">&lt;!--</span>
  <span class="rcl-da">~</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">API</span>
  <span class="rcl-da">~</span>
  <span class="rcl-da">~</span> <span class="rcl-da">License</span><span class="rcl-da">:</span> <span class="rcl-da">Apache</span> <span class="rcl-da">License</span><span class="rcl-da">,</span> <span class="rcl-da">Version</span> <span class="rcl-da">2.0</span>
  <span class="rcl-da">~</span> <span class="rcl-da">See</span> <span class="rcl-da">the</span> <span class="rcl-da">license</span><span class="rcl-da">.</span><span class="rcl-da">txt</span> <span class="rcl-da">file</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">root</span> <span class="rcl-da">directory</span> <span class="rcl-da">or</span> &lt;<span class="rcl-da">http</span><span class="rcl-da">://</span><span class="rcl-da">www</span><span class="rcl-da">.</span><span class="rcl-da">apache</span><span class="rcl-da">.</span><span class="rcl-da">org</span><span class="rcl-da">/</span><span class="rcl-da">licenses</span><span class="rcl-da">/</span><span class="rcl-da">LICENSE-</span><span class="rcl-da">2.0</span><span class="rcl-da">&gt;.</span>
  <span class="rcl-da">--&gt;</span></span>
<span class="tag"><span class="rcl-da">&lt;</span>xs:schema</span> <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">"</span><span class="content">unqualified</span><span class="delimiter">"</span></span>
           <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">"</span><span class="content">qualified</span><span class="delimiter">"</span></span>
           <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
           <span class="attribute-name">xmlns:xs</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">"</span></span>
           <span class="attribute-name">xmlns:map</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/mapping</span><span class="delimiter">"</span></span>
           <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;xs:annotation&gt;</span>
        <span class="tag">&lt;xs:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>
            This is the XML Schema for Bean Validation constraint mapping files.

            Bean Validation constraint mapping files must indicate the Bean Validation
            XML schema by using the constraint mapping namespace:

            http://xmlns.jcp.org/xml/ns/validation/mapping

            and indicate the version of the schema by using the version attribute
            as shown below:

            &lt;constraint-mappings
                xmlns="http://xmlns.jcp.org/xml/ns/validation/mapping"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="
                    http://xmlns.jcp.org/xml/ns/validation/mapping
                    validation-mapping-2.0.xsd"
                version="2.0"&gt;
                ...
            &lt;/constraint-mappings&gt;
        <span class="inline-delimiter">]]&gt;</span>
        <span class="tag">&lt;/xs:documentation&gt;</span>
    <span class="tag">&lt;/xs:annotation&gt;</span>

    <span class="tag">&lt;xs:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-mappings</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:constraint-mappingsType</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>

    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">payloadType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">groupsType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">groupSequenceType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">groupConversionType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">from</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">to</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-mappingsType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default-package</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:beanType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">bean</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:constraint-definitionType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-definition</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">version</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:versionType</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">versionType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:token</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;xs:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:restriction&gt;</span>
    <span class="tag">&lt;/xs:simpleType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">validated-byType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">include-existing-validators</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraintType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupsType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">groups</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:payloadType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">payload</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:elementType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">element</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">annotation</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">elementType</span><span class="delimiter">"</span></span> <span class="attribute-name">mixed</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:annotationType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">annotation</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content"><span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">&gt;</span></span>
        <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">sequence</span><span class="rcl-da">&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">string</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">valid</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">fixed</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span><span class="rcl-da">constraintType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">constraint</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span><span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">containerElementType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
        <span class="tag"><span class="rcl-da">&lt;/</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">sequence</span><span class="rcl-da">&gt;</span></span>
        <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">attribute</span></span> <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">typeArgumentIndex</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">use</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">optional</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">simpleType</span><span class="rcl-da">&gt;</span></span>
                <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">restriction</span></span> <span class="attribute-name"><span class="rcl-da">base</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">int</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">&gt;</span></span>
                    <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">minInclusive</span></span> <span class="attribute-name"><span class="rcl-da">value</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="tag"><span class="rcl-da">/&gt;</span></span>
                <span class="tag"><span class="rcl-da">&lt;/</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">restriction</span><span class="rcl-da">&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;/</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">simpleType</span><span class="rcl-da">&gt;</span></span>
        <span class="tag"><span class="rcl-da">&lt;/</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">attribute</span><span class="rcl-da">&gt;</span></span>
    <span class="tag"><span class="rcl-da">&lt;/</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">complexType</span><span class="rcl-da">&gt;</span></span>
    <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">complexType</span></span> <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content">classType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupSequenceType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">group-sequence</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">beanType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:classType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">class</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;/xs:element&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:fieldType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">field</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:getterType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">getter</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:constructorType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constructor</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:methodType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">method</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">class</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span> <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">annotationType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:elementType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">element</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">getterType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">valid</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupConversionType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">convert-group</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:<span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">containerElementType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span>constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">methodType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:parameterType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">parameter</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:crossParameterType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">cross-parameter</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:returnValueType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">return-value</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constructorType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:parameterType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">parameter</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:crossParameterType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">cross-parameter</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:returnValueType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">return-value</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">parameterType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">valid</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupConversionType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">convert-group</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:<span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">containerElementType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span>constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">type</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">returnValueType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">valid</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupConversionType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">convert-group</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:<span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">containerElementType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span>constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">crossParameterType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-definitionType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:validated-byType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">validated-by</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">annotation</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">fieldType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">valid</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:groupConversionType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">convert-group</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">map:<span class="rcl-da">containerElementTypeType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">containerElementType</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span>
                        <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">map</span><span class="rcl-da">:</span>constraintType</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span>
                        <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">ignore-annotations</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
<span class="tag">&lt;/xs:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="xml-config-xsd"><a class="anchor" href="#xml-config-xsd"></a>8.2. Configuration schema</h3>
<div class="paragraph">
<p>XML Configuration is set in <code class="filename">META-INF/validation.xml</code>. The file is optional. The XML schema followed by the configuration file is as followed.</p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">128</span><span class="rcl-dd">123</span>. XML configuration XSD</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="XML"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="comment"><span class="rcl-da">&lt;!--</span>
  <span class="rcl-da">~</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">API</span>
  <span class="rcl-da">~</span>
  <span class="rcl-da">~</span> <span class="rcl-da">License</span><span class="rcl-da">:</span> <span class="rcl-da">Apache</span> <span class="rcl-da">License</span><span class="rcl-da">,</span> <span class="rcl-da">Version</span> <span class="rcl-da">2.0</span>
  <span class="rcl-da">~</span> <span class="rcl-da">See</span> <span class="rcl-da">the</span> <span class="rcl-da">license</span><span class="rcl-da">.</span><span class="rcl-da">txt</span> <span class="rcl-da">file</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">root</span> <span class="rcl-da">directory</span> <span class="rcl-da">or</span> &lt;<span class="rcl-da">http</span><span class="rcl-da">://</span><span class="rcl-da">www</span><span class="rcl-da">.</span><span class="rcl-da">apache</span><span class="rcl-da">.</span><span class="rcl-da">org</span><span class="rcl-da">/</span><span class="rcl-da">licenses</span><span class="rcl-da">/</span><span class="rcl-da">LICENSE-</span><span class="rcl-da">2.0</span><span class="rcl-da">&gt;.</span>
  <span class="rcl-da">--&gt;</span></span>
<span class="tag"><span class="rcl-da">&lt;</span>xs:schema</span> <span class="attribute-name">attributeFormDefault</span>=<span class="string"><span class="delimiter">"</span><span class="content">unqualified</span><span class="delimiter">"</span></span>
           <span class="attribute-name">elementFormDefault</span>=<span class="string"><span class="delimiter">"</span><span class="content">qualified</span><span class="delimiter">"</span></span>
           <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration</span><span class="delimiter">"</span></span>
           <span class="attribute-name">xmlns:xs</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">"</span></span>
           <span class="attribute-name">xmlns:config</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration</span><span class="delimiter">"</span></span>
           <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;xs:annotation&gt;</span>
        <span class="tag">&lt;xs:documentation&gt;</span><span class="inline-delimiter">&lt;![CDATA[</span>
            This is the XML Schema for the Bean Validation configuration file.
            The configuration file must be named "META-INF/validation.xml".

            Bean Validation configuration files must indicate the Bean Validation
            XML schema by using the validation namespace:

            http://xmlns.jcp.org/xml/ns/validation/configuration

            and indicate the version of the schema by using the version attribute
            as shown below:

            &lt;validation-config
                xmlns="http://xmlns.jcp.org/xml/ns/validation/configuration"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="
                    http://xmlns.jcp.org/xml/ns/validation/configuration
                    validation-configuration-2.0.xsd"
                version="2.0"&gt;
                [...]
            &lt;/validation-config&gt;
        <span class="inline-delimiter">]]&gt;</span>
        <span class="tag">&lt;/xs:documentation&gt;</span>
    <span class="tag">&lt;/xs:annotation&gt;</span>

    <span class="tag">&lt;xs:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">validation-config</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">config:validation-configType</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">validation-configType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default-provider</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">message-interpolator</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">traversable-resolver</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-validator-factory</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">parameter-name-provider</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">clock-provider</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content"><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">string</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">name</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">value-extractor</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">maxOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">unbounded</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span> <span class="attribute-name"><span class="rcl-da">minOccurs</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content"><span class="rcl-da">0</span></span><span class="delimiter"><span class="rcl-da">"</span></span></span><span class="tag"><span class="rcl-da">/&gt;</span></span>
            <span class="tag"><span class="rcl-da">&lt;</span><span class="rcl-da">xs</span><span class="rcl-da">:</span><span class="rcl-da">element</span></span> <span class="attribute-name"><span class="rcl-da">type</span></span><span class="rcl-da">=</span><span class="string"><span class="delimiter"><span class="rcl-da">"</span></span><span class="content">config:executable-validationType</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">executable-validation</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">constraint-mapping</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">config:propertyType</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">property</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">version</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">config:versionType</span><span class="delimiter">"</span></span> <span class="attribute-name">fixed</span>=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>

    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">executable-validationType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">config:default-validated-executable-typesType</span><span class="delimiter">"</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default-validated-executable-types</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">0</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
        <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">enabled</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">optional</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:boolean</span><span class="delimiter">"</span></span> <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default-validated-executable-typesType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:sequence&gt;</span>
            <span class="tag">&lt;xs:element</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">executable-type</span><span class="delimiter">"</span></span> <span class="attribute-name">maxOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">unbounded</span><span class="delimiter">"</span></span> <span class="attribute-name">minOccurs</span>=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xs:simpleType&gt;</span>
                    <span class="tag">&lt;xs:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;xs:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">NONE</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xs:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">CONSTRUCTORS</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xs:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">NON_GETTER_METHODS</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xs:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">GETTER_METHODS</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;xs:enumeration</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">ALL</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;/xs:restriction&gt;</span>
                <span class="tag">&lt;/xs:simpleType&gt;</span>
            <span class="tag">&lt;/xs:element&gt;</span>
        <span class="tag">&lt;/xs:sequence&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:complexType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">propertyType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:simpleContent&gt;</span>
            <span class="tag">&lt;xs:extension</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;xs:attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">name</span><span class="delimiter">"</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">"</span><span class="content">required</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:string</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;/xs:extension&gt;</span>
        <span class="tag">&lt;/xs:simpleContent&gt;</span>
    <span class="tag">&lt;/xs:complexType&gt;</span>
    <span class="tag">&lt;xs:simpleType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">versionType</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xs:restriction</span> <span class="attribute-name">base</span>=<span class="string"><span class="delimiter">"</span><span class="content">xs:token</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;xs:pattern</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">[0-9]+(\.[0-9]+)*</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/xs:restriction&gt;</span>
    <span class="tag">&lt;/xs:simpleType&gt;</span>
<span class="tag">&lt;/xs:schema&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>From Bean Validation revision 1.1 onwards, the used version of the schema must be specified within the <code>version</code> attribute of the <code>validation-config</code> element. <span class="tck-testable">Implementations supporting Bean Validation 2.0 must properly parse configuration descriptors of Bean Validation 1.0, 1.1 and 2.0.</span> <span class="tck-not-testable">If the <code>version</code> attribute attribute is not given, schema version 1.0 is to be assumed by the Bean Validation Provider.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">In case an unknown version is given a <code class="classname">ValidationException</code> is raised.</span></p>
</div>
<div class="paragraph">
<p>See <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a> for more information on XML based configuration.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exception"><a class="anchor" href="#exception"></a>9. Exception model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Illegal arguments passed to the Bean Validation APIs generally lead to an <code class="classname">IllegalArgumentException</code> (see the JavaDoc for specific details). Other exceptions raised by Bean Validation are or inherit from the runtime exception <code class="classname">javax.validation.ValidationException</code>. Exception cases are described in their respective sections but include (non exhaustive list):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>invalid constraint definitions (missing mandatory elements, illegal composition cycle, illegal attribute overriding, etc.)</p>
</li>
<li>
<p>invalid constraint declarations (<code class="classname">ConstraintValidator</code> implementation matching failure, etc.)</p>
</li>
<li>
<p>invalid group definition (circularity)</p>
</li>
<li>
<p>invalid <code class="classname">Default</code> group redefinition for classes (missing class group etc)</p>
</li>
<li>
<p>invalid group conversion definitions</p>
</li>
<li>
<p>error when retrieving, initializing, executing <code class="classname">ConstraintValidator</code>s</p>
</li>
<li>
<p>error when parsing the XML configuration or mappings</p>
</li>
<li>
<p>multiple XML configuration files found</p>
</li>
<li>
<p>missing expected provider or no default provider found</p>
</li>
<li>
<p>missing no-arg constructor on extension implementations described in XML configuration files</p>
</li>
<li>
<p>same entity described more than once across the XML mapping files</p>
</li>
<li>
<p>same property or field described more than once for a given entity in the XML mapping files</p>
</li>
<li>
<p>class, field or getter declared in XML mapping files but not found</p>
</li>
<li>
<p>illegal XML constraint definition</p>
</li>
<li>
<p>illegal XML constraint declaration</p>
</li>
<li>
<p>exception raised either at initialization time or execution time by any of the extension interfaces</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these error cases lead to a <code class="classname">ValidationException</code> or a subclass of <code class="classname">ValidationException</code> (see following subsections).</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Every (runtime) exception raised either at initialization time or execution time by any of the extension interfaces (<code class="classname">ConstraintValidator</code>, <code class="classname">ConstraintValidatorFactory</code>, <code class="classname">MessageInterpolator</code>, <code class="classname">TraversableResolver</code>, <code class="classname">ValidationProviderResolver</code>, <code class="classname">ParameterNameProvider</code>, <code class="classname">ClockProvider</code>) is wrapped in a <code class="classname">ValidationException</code>.</span></p>
</div>
<div class="paragraph">
<p>If a constraint definition or constraint declaration is invalid for a given class, the metadata API should raise the according exception.</p>
</div>
<div class="sect2">
<h3 id="exception-errorreport"><a class="anchor" href="#exception-errorreport"></a>9.1. Error report: <code class="classname">ConstraintViolationException</code></h3>
<div class="paragraph">
<p>Some frameworks or applications need to convey the result of a validation by raising an exception if the validation returns constraint violations.</p>
</div>
<div class="paragraph">
<p>Bean Validation provides a reference exception for such cases. Frameworks and applications are encouraged to use <code class="classname">ConstraintViolationException</code> as opposed to a custom exception to increase consistency of the Java platform. The exception can be raised directly or wrapped into the framework or application specific parent exception.</p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">129</span><span class="rcl-dd">124</span>. ConstraintViolationException</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">/**
 * Reports the result of constraint violations.
 *
 * @author Emmanuel Bernard
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ConstraintViolationException</span> <span class="directive">extends</span> ValidationException {
    [...]

    <span class="comment">/**
     * Creates a constraint violation report.
     *
     * @param message error message
     * @param constraintViolations {@code Set} of {@link ConstraintViolation}
     */</span>
    <span class="directive">public</span> ConstraintViolationException(<span class="predefined-type">String</span> message,
                                        <span class="predefined-type">Set</span>&lt;? <span class="directive">extends</span> ConstraintViolation&lt;?&gt;&gt; constraintViolations) {
        [...]
    }

    <span class="comment">/**
     * Creates a constraint violation report.
     *
     * @param constraintViolations {@code Set} of {@link ConstraintViolation}
     */</span>
    <span class="directive">public</span> ConstraintViolationException(<span class="predefined-type">Set</span>&lt;? <span class="directive">extends</span> ConstraintViolation&lt;?&gt;&gt; constraintViolations) {
        [...]
    }

    <span class="comment">/**
     * Set of constraint violations reported during a validation.
     *
     * @return {@code Set} of {@link ConstraintViolation}
     */</span>
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;?&gt;&gt; getConstraintViolations() {
        [...]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code class="classname">ConstraintViolationException</code> carries a <code class="classname">Set</code> of <code class="classname">ConstraintViolation</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Bean Validation never raises this exception itself. Other frameworks like Java Persistence 2 or interception framework wiring method validation do.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If this exception is meant to be <span class="rcl-da">sent</span><span class="rcl-dd">send </span> remotely, <code class="classname">ConstraintViolation</code> objects should be <code class="classname">Serializable</code> as defined and explained in <a href="#validationapi-constraintviolation">ConstraintViolation</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="exception-constraintdefinition"><a class="anchor" href="#exception-constraintdefinition"></a>9.2. Constraint definition: <code class="classname">ConstraintDefinitionException</code></h3>
<div class="paragraph">
<p><span class="tck-testable">If a constraint definition does not respect the Bean Validation rules or is inconsistent, a <code class="classname">ConstraintDefinitionException</code> is raised.</span> <code class="classname">ConstraintDefinitionException</code> is a subclass of <code class="classname">ValidationException</code>.</p>
</div>
<div class="paragraph">
<p>This exception can be raised during validation or when the metadata model for the class hosting this constraint is requested.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>These exception cases can be determined at compile time by a tool such as an annotation processor.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="exception-constraintdeclaration"><a class="anchor" href="#exception-constraintdeclaration"></a>9.3. Constraint declaration: <code class="classname">ConstraintDeclarationException</code> and <code class="classname">UnexpectedTypeException</code></h3>
<div class="paragraph">
<p><span class="tck-not-testable">When a constraint declaration is illegal, <code class="classname">ConstraintDeclarationException</code> is raised.</span> This includes amongst other things incorrect group conversion rules (definition or positioning) and illegal method constraint declarations (e.g. inheritance rules, cross-parameter constraint used in an illegal situation, improper use of <code class="methodname">validationAppliesTo</code>).</p>
</div>
<div class="paragraph">
<p><code class="classname">ConstraintDeclarationException</code> is a subclass of <code class="classname">ValidationException</code>.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">When the return type of a property cannot be processed for a given constraint, an <code class="classname">UnexpectedTypeException</code> is raised.</span> This problem typically arises when either no <code class="classname">ConstraintValidator</code>s or too many <code class="classname">ConstraintValidator</code>s match the return type (see <a href="#constraintdeclarationvalidationprocess-validationroutine-typevalidatorresolution">ConstraintValidator resolution algorithm</a>).</p>
</div>
<div class="paragraph">
<p><code class="classname">UnexpectedTypeException</code> is a subclass of <code class="classname">ConstraintDeclarationException</code>.</p>
</div>
<div class="paragraph">
<p>This exception can be raised during validation or when the metadata model for the class hosting this constraint is requested.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>These exception cases can be determined at compile time by a tool such as an annotation processor.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="exception-groupdefinition"><a class="anchor" href="#exception-groupdefinition"></a>9.4. Group definition: <code class="classname">GroupDefinitionException</code></h3>
<div class="paragraph">
<p><span class="tck-testable">When a group definition is illegal, a <code class="classname">GroupDefinitionException</code> is raised.</span> This typically arises when a cyclic group dependency is discovered, an illegal attribute overriding is defined etc.</p>
</div>
<div class="paragraph">
<p><code class="classname">GroupDefinitionException</code> is a subclass of <code class="classname">ValidationException</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>These exception cases can be determined at compile time by a tool such as an annotation processor.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="exception-noprovider"><a class="anchor" href="#exception-noprovider"></a><span class="rcl-da">9.5</span><span class="rcl-da">.</span> <span class="rcl-da">No</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">Provider</span> <span class="rcl-da">detected</span><span class="rcl-da">:</span> <code><span class="rcl-da">NoProviderFoundException</span></code></h3>
<div class="paragraph">
<p><span class="tck-not-testable"><span class="rcl-da">When</span> <span class="rcl-da">trying</span> <span class="rcl-da">to</span> <span class="rcl-da">bootstrap</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">via</span> <code><span class="rcl-da">Validation</span><span class="rcl-da">.</span><span class="rcl-da">buildDefaultValidatorFactory</span><span class="rcl-da">()</span></code> <span class="rcl-da">or</span> <code><span class="rcl-da">Validation</span><span class="rcl-da">.</span><span class="rcl-da">byDefaultProvider</span><span class="rcl-da">().</span><span class="rcl-da">configure</span><span class="rcl-da">()</span></code> <span class="rcl-da">and</span> <span class="rcl-da">no</span> <span class="rcl-da">Bean</span> <span class="rcl-da">Validation</span> <span class="rcl-da">provider</span> <span class="rcl-da">could</span> <span class="rcl-da">be</span> <span class="rcl-da">found</span><span class="rcl-da">,</span> <span class="rcl-da">a</span> <code><span class="rcl-da">NoProviderFoundException</span></code> <span class="rcl-da">is</span> <span class="rcl-da">raised</span><span class="rcl-da">.</span></span></p>
</div>
<div class="paragraph">
<p><code><span class="rcl-da">NoProviderFoundException</span></code> <span class="rcl-da">is</span> <span class="rcl-da">a</span> <span class="rcl-da">subclass</span> <span class="rcl-da">of</span> <code><span class="rcl-da">ValidationException</span></code><span class="rcl-da">.</span></p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integration"><a class="anchor" href="#integration"></a>10. Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this chapter, integration points between Bean Validation and other technologies are discussed. We first address the integration in generic terms applying to all integrations and we then detail how integration with various Java EE specifications is handled more specifically.</p>
</div>
<div class="sect2">
<h3 id="integration-general"><a class="anchor" href="#integration-general"></a>10.1. General requirements</h3>
<div class="paragraph">
<p>This section covers general requirements that should be followed by any container and interception technology integrating Bean Validation.</p>
</div>
<div class="sect3">
<h4 id="integration-general-objectslifecycle"><a class="anchor" href="#integration-general-objectslifecycle"></a>10.1.1. Objects lifecycle</h4>
<div class="paragraph">
<p>Generally speaking, containers and frameworks controlling the lifecycle of objects (such as Java EE, dependency injection frameworks or component frameworks) should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable">build and bootstrap the <code class="classname">ValidatorFactory</code> instance for an application.</span></p>
</li>
<li>
<p><span class="tck-testable">provide access to the <code class="classname">ValidatorFactory</code> instance as well as <code class="classname">Validator</code> instances in their default configuration using the paradigm of the container: for example, such instances would be injectable in other objects via a dependency injection framework.</span></p>
</li>
<li>
<p><span class="tck-testable">configure <code class="classname">ValidatorFactory</code> with a custom <code class="classname">ConstraintValidatorFactory</code> instance that returns managed <code class="classname">ConstraintValidator</code> instances, unless a custom <code class="classname">ConstraintValidatorFactory</code> is requested by the user. The scope of <code class="classname">ConstraintValidator</code> instances is still fully controlled by the Bean Validation provider as described in <a href="#constraintsdefinitionimplementation-constraintfactory">The ConstraintValidatorFactory</a>, but as managed beans they can receive expected services like injection of other objects.</span></p>
</li>
<li>
<p><span class="tck-testable">configure <code class="classname">ValidatorFactory</code> with managed instances of <code class="classname">ConstraintValidatorFactory</code>, <code class="classname">MessageInterpolator</code>, <code class="classname">ParameterNameProvider</code>, <code class="classname">ClockProvider</code> and <code class="classname">TraversableResolver</code>, if such instances are defined in the XML deployment descriptor. Services provided by the container (like dependency injection) should thus be available to these instances.</span></p>
</li>
<li>
<p><span class="tck-not-testable">invoke <code class="methodname">ValidatorFactory.close()</code> when the <code class="classname">ValidatorFactory</code> instance is no longer needed.</span></p>
</li>
<li>
<p><span class="tck-not-testable">dispose of managed instances provided to the Bean Validation bootstrap process after <code class="methodname">ValidatorFactory.close()</code> has been invoked.</span></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>In this context, a default <code class="classname">ValidatorFactory</code> is a factory configured like the factory returned by <code class="classname">Validation.buildDefaultValidatorFactory</code> (see also <a href="#validationapi-bootstrapping-validation">Validation</a>) except for the enhancements described above. A default <code class="classname">Validator</code> instance is a <code class="classname">Validator</code> instance retrieved via <code class="methodname">getValidator()</code> from the default <code class="classname">ValidatorFactory</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="integration-general-executable"><a class="anchor" href="#integration-general-executable"></a>10.1.2. Method and constructor validation</h4>
<div class="paragraph">
<p>This section expresses the behavior that integration with interception frameworks should follow. Any deviation should be considered with care as it will surprise Bean Validation users.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Method interception frameworks (such as AOP or interceptor frameworks) enable interception of constrained methods following the steps defined in <a href="#validationapi-triggeringmethodvalidation">Triggering method validation</a>.</span> <span class="tck-testable">Method validation execution is implicit for any method or constructor annotated with constraints.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">By default, method validation is applied to all constrained methods or constructors provided the integration technology can intercept the call. By default, getters (as defined in <a href="#constraintdeclarationvalidationprocess-requirements">Requirements on classes to be validated</a>) are not considered constrained methods.</span> <span class="tck-not-testable">Static methods are ignored by validation. Putting constraints on a static method is not portable.</span></p>
</div>
<div class="paragraph">
<p>Bean Validation - via the interception technology - offers a way to customize whether or not a constructor, method or getter is validated when executed. This is achieved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>via the <code class="classname">@ValidateOnExecution</code> annotation on the executable (see <a href="#example-validateonexecution">@ValidateOnExecution annotation</a>)</p>
</li>
<li>
<p>via the <code class="classname">@ValidateOnExecution</code> annotation on the type declaring the executable</p>
</li>
<li>
<p>via a global configuration defined in <code class="filename">validation.xml</code>: <code>executable-validation</code> and <code>default-validated-executable-types</code>. See <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a> for more details.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Integration layers can read the list of validated executable types defined in the global configuration as well as read whether or not executable validation is disabled via the <code class="classname">Configuration</code> object: <code class="code">configuration.getBootstrapConfiguration().getDefaultValidatedExecutableTypes()</code> and <code class="code">configuration.getBootstrapConfiguration().isExecutableValidationEnabled()</code> respectively. This list is extracted from <code class="filename">validation.xml</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>More formally, a given executable (constructor or method) is validated upon execution according to the following rules in decreasing order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable tcck-needs-update">the executable is validated if it is annotated with <code class="classname">@ValidateOnExecution</code> and the <code class="methodname">type</code> attribute contains the executable type or <code>IMPLICIT</code>. If the <code class="methodname">type</code> attribute does neither contain the executable type nor <code>IMPLICIT</code>, the executable is not validated.</span></p>
</li>
<li>
<p><span class="tck-testable">otherwise the executable is validated if the type (class, interface) on which it is declared is annotated with <code class="classname">@ValidateOnExecution</code> and the <code class="methodname">type</code> attribute contains the executable type. If the <code>type</code> attribute contains <code>IMPLICIT</code>, then this rule is ignored and the behavior is equivalent to <code class="classname">@ValidateOnExecution</code> not being present. If the <code class="methodname">type</code> attribute does not contain the executable type, the executable is not validated.</span></p>
</li>
<li>
<p><span class="tck-testable">otherwise the executable is validated if the global executable validation setting contains the executable type. If the global setting does not contain the executable type, the executable is not validated.</span></p>
</li>
<li>
<p><span class="tck-testable">The rules above do not apply to methods overriding a superclass method or implementing an interface method. In this case, the method inherits the behavior of the method it overrides / implements. Out of the box, a conforming integration implementation raises a <code class="classname">ValidationException</code> if the overriding / implementing method hosts the <code class="classname">@ValidateOnExecution</code> annotation.</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last point is present to enforce the Liskov substitution principle (more info at <a href="#constraintdeclarationvalidationprocess-methodlevelconstraints-inheritance">Method constraints in inheritance hierarchies</a>). In addition, providers may implement alternative, potentially more liberal, approaches for handling validated methods in inheritance hierarchies. Possible means for activating such alternative behavior include provider-specific configuration properties or annotations. Note that client code relying on such alternative behavior is not portable.</p>
</div>
<div class="paragraph">
<p>The following executable types are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="tck-testable"><code>NONE</code>: parameters and return values are not validated upon execution. This option is equivalent to an empty list of executable types and is present to improve readability. A list containing <code>NONE</code> and other types of executables is equivalent to a list containing the types of executables without <code>NONE</code>.</span></p>
</li>
<li>
<p><span class="tck-testable"><code>CONSTRUCTORS</code>: parameters and return values are validated provided the executable is a constructor.</span></p>
</li>
<li>
<p><span class="tck-testable"><code>NON_GETTER_METHODS</code>: parameters and return values are validated provided the executable is a method but not a getter.</span></p>
</li>
<li>
<p><span class="tck-testable"><code>GETTER_METHODS</code>: return values are validated provided the executable is a getter method.</span></p>
</li>
<li>
<p><span class="tck-testable"><code>ALL</code>: parameters and return values are validated for all executables (getters, non getters and constructors). This option is equivalent to a list of all executable types and is present to improve readability. A list containing <code>ALL</code> and other types of executables is equivalent to a list containing only <code>ALL</code>.</span></p>
</li>
<li>
<p><span class="tck-testable"><code>IMPLICIT</code>: if <code class="classname">@ValidateOnExecution</code> is on a type (class or interface), then it is equivalent to <code class="classname">@ValidateOnExecution</code> not being present; if <code class="classname">@ValidateOnExecution</code> is on a an executable, the following applies:</span></p>
<div class="ulist">
<ul>
<li>
<p>if on a constructor, it is equivalent to <code>CONSTRUCTORS</code>.</p>
</li>
<li>
<p>if on a non-getter method, it is equivalent to <code>NON_GETTER_METHODS</code>.</p>
</li>
<li>
<p>if on a getter, it is equivalent to <code>GETTER_METHODS</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Mixing <code>IMPLICIT</code> and other executable types is illegal.</span></p>
</div>
<div id="example-validateonexecution" class="exampleblock">
<div class="title">Example <span class="rcl-da">130</span><span class="rcl-dd">125</span>. @ValidateOnExecution annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.executable</span>;

<span class="comment">/**
 * Expresses which executables (methods or constructors) should have their parameters
 * and return value validated upon execution. Can be on executable (method, constructor)
 * or type level (with the former taking precedence).
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * If not present for a given executable, the default configuration from
 * {@code META-INF/validation.xml} and finally the implicit default
 * validated executable types (constructors and non-getters) are taken into account to determine
 * whether a given executable is validated upon execution or not.
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * The following describes the formal rules for deciding whether an executable is validated.
 * They are applied in decreasing order:
 * &lt;ul&gt;
 *     &lt;li&gt;the executable is validated if it is annotated with {@code @ValidateOnExecution} and
 *     the {@code type} attribute contains the executable type or {@link ExecutableType#IMPLICIT}.
 *     If the {@code type} attribute does neither contain the executable type nor {@code IMPLICIT},
 *     the executable is not validated.&lt;/li&gt;
 *     &lt;li&gt;otherwise the executable is validated if the type (class, interface) on which it is
 *     declared is annotated with {@code @ValidateOnExecution} and the {@code type} attribute
 *     contains the executable type. If the {@code type} attribute contains
 *     {@code IMPLICIT}, then this rule is ignored and the behavior is
 *     equivalent to {@code ValidateOnExecution} not being present. If the
 *     {@code type} attribute does not contain the executable type, the executable is not
 *     validated.&lt;/li&gt;
 *     &lt;li&gt;otherwise the executable is validated if the global executable validation setting
 *     contains the executable type. If the global setting does not contain the executable type,
 *     the executable is not validated.&lt;/li&gt;
 *     &lt;li&gt;The rules above do not apply to methods overriding a superclass method or
 *     implementing an interface method. In this case, the method inherits the behavior
 *     of the method it overrides or implements. Out of the box, a conforming implementation
 *     raises a {@link ValidationException} if the overriding / implementing method hosts
 *     the {@code ValidateOnExecution} annotation.&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
 * Note that you can exclude an executable from validation by making sure the rules above do not match
 * or by annotating the executable with {@code @ValidateOnExecution(NONE)}.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="annotation">@Target</span>({ CONSTRUCTOR, METHOD, TYPE, PACKAGE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> ValidateOnExecution {

    <span class="comment">/**
     * List of executable types to be validated when called.
     * Defaults to the types discovered implicitly (see {@link ExecutableType#IMPLICIT}).
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">array</span> <span class="rcl-da">of</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">ExecutableType</span><span class="rcl-da">}</span><span class="rcl-da">s</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">validated</span>
     */</span>
    ExecutableType<span class="type">[]</span> type() <span class="keyword">default</span> {ExecutableType.IMPLICIT};
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.executable</span>;

<span class="comment">/**
 * Defines the types of executables targeted by an operation.
 *
 * @author Emmanuel Bernard
 * @since 1.1
 */</span>
<span class="directive">public</span> <span class="type">enum</span> ExecutableType {

    <span class="comment">/**
     * If the annotation using {@code ExecutableType} is on a type (class or interface),
     * the behavior is equivalent to the annotation not being present.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If on a constructor, it is equivalent to {@link #CONSTRUCTORS}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If on a non-getter method, it is equivalent to {@link #NON_GETTER_METHODS}.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * If on a getter method, it is equivalent to {@link #GETTER_METHODS}.
     */</span>
    IMPLICIT,

    <span class="comment">/**
     * None of the executables.
     * &lt;p<span class="rcl-da">&gt;</span><span class="rcl-dd">/&gt; </span>
     * Note that this option is equivalent to an empty list of executable types
     * and is present to improve readability. If {@code NONE} and other types of executables
     * are present in a list, {@code NONE} is ignored.
     */</span>
    NONE,

    <span class="comment">/**
     * All constructors.
     */</span>
    CONSTRUCTORS,

    <span class="comment">/**
     * All methods except the ones following the getter pattern. A getter according to the
     * JavaBeans specification is a method whose:
     * &lt;ul&gt;
     *     &lt;li&gt;name starts with get, has a return type but no parameter&lt;/li&gt;
     *     &lt;li&gt;name starts with is, has a return type and is returning {@code boolean}.&lt;/li&gt;
     * &lt;/ul&gt;
     */</span>
    NON_GETTER_METHODS,

    <span class="comment">/**
    /**
     * All methods following the getter pattern. A getter according to the
     * JavaBeans specification is a method whose:
     * &lt;ul&gt;
     *     &lt;li&gt;name starts with get, has a return type but no parameter&lt;/li&gt;
     *     &lt;li&gt;name starts with is, has a return type and is returning {@code boolean}.&lt;/li&gt;
     * &lt;/ul&gt;
     */</span>
    GETTER_METHODS,

    <span class="comment">/**
     * All executables (constructors and methods).
     */</span>
    ALL
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">If a sub type overrides/implements a method originally defined in several parallel types of the hierarchy (e.g. two interfaces not extending each other, or a class and an interface not implemented by said class), <code class="classname">@ValidateOnExecution</code> cannot be placed in the parallel types of the hierarchy.</span> This is to avoid an unexpected altering of the post conditions to be guaranteed to the caller.</p>
</div>
<div class="paragraph">
<p><span class="tck-testable">You can globally disable executable validation by using <code class="code">&lt;executable-validation enabled="false"/&gt;</code>, in this case, <code class="code">&lt;default-validated-executable-types/&gt;</code> and <code class="classname">@ValidateOnExecution</code> are ignored.</span></p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">131</span><span class="rcl-dd">126</span>. validation.xml disabling executable validation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">&lt;?xml version=<span class="string"><span class="delimiter">"</span><span class="content">1.0</span><span class="delimiter">"</span></span> encoding=<span class="string"><span class="delimiter">"</span><span class="content">UTF-8</span><span class="delimiter">"</span></span>?&gt;
&lt;validation-config
        xmlns=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration</span><span class="delimiter">"</span></span>
        xmlns:xsi=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
        xsi:schemaLocation=
            <span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/validation/configuration validation-configuration-2.0.xsd</span><span class="delimiter">"</span></span>
        version=<span class="string"><span class="delimiter">"</span><span class="content">2.0</span><span class="delimiter">"</span></span>&gt;
    &lt;<span class="keyword">default</span>-provider&gt;com.acme.ACMEProvider&lt;/<span class="keyword">default</span>-provider&gt;
    &lt;message-interpolator&gt;com.acme.ACMEAwareMessageInterpolator&lt;/message-interpolator&gt;

    &lt;executable-validation enabled=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span>/&gt;

    &lt;constraint-mapping&gt;META-INF/validation/order-constraints.xml&lt;/constraint-mapping&gt;
    &lt;constraint-mapping&gt;META-INF/validation/catalog-constraints.xml&lt;/constraint-mapping&gt;
    &lt;constraint-mapping&gt;META-INF/validation/customer-constraints.xml&lt;/constraint-mapping&gt;

    &lt;property name=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.validation.logging</span><span class="delimiter">"</span></span>&gt;WARN&lt;/property&gt;
    &lt;property name=<span class="string"><span class="delimiter">"</span><span class="content">com.acme.validation.safetyChecking</span><span class="delimiter">"</span></span>&gt;failOnError&lt;/property&gt;

&lt;/validation-config&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code class="code">@ValidateOnExecution(type=IMPLICIT)</code> on a type (class or interface) is useful to mark a class as being involved in executable validation without affecting the behavior. This is used when the integration technology needs a little help to find the classes and interfaces involved.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The proper selection of the validated executables is the responsibility of the integration between the interception technology and Bean Validation. Bean Validation engines ignore the XML configuration around executable validation and <code class="classname">@ValidateOnExecution</code> when validating executables and when providing metadata.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="integration-general-executable-examples"><a class="anchor" href="#integration-general-executable-examples"></a><span class="rcl-da">10.1.2.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>The following example shows some of the way you can refine executable validation with <code class="classname">@ValidateOnExecution</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">132</span><span class="rcl-dd">127</span>. Method validation configurations</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="comment">//optional: @ValidateOnExecution</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderService</span> {

    <span class="type">boolean</span> isValidCustomer(<span class="annotation">@NotNull</span> <span class="predefined-type">String</span> customerCode) { [...] }

    <span class="annotation">@ValidateOnExecution</span>
    <span class="annotation">@Min</span>(<span class="integer">0</span>)
    <span class="predefined-type">Integer</span> getBacklog() { [...] }

    <span class="annotation">@ValidateOnExecution</span>(type=NONE)
    Order placeOrder(<span class="annotation">@NotNull</span> <span class="predefined-type">String</span> customerCode, <span class="annotation">@Valid</span> Item item, <span class="type">int</span> quantity) { [...] }

}

<span class="annotation">@ValidateOnExecution</span>(type={GETTER_METHODS, NON_GETTER_METHODS})
<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleOrderService</span> <span class="directive">extends</span> OrderService {

    <span class="directive">public</span> SimpleOrderService(<span class="annotation">@NotNull</span> ServiceProvider provider) { [...] }

    <span class="annotation">@Overrides</span>
    Order placeOrder(<span class="predefined-type">String</span> customerCode, Item item, <span class="type">int</span> quantity) { [...] }

}

<span class="comment">//optional: @ValidateOnExecution</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ComplexOrderService</span> <span class="directive">extends</span> SimpleOrderService {
    <span class="directive">public</span> ComplexOrderService(<span class="annotation">@NotNull</span> ServiceProvider provider) { [...] }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All constructors and non-getter methods of <code class="classname">OrderService</code> are validated upon execution as this is the default setting. <code class="methodname">isValidCustomer()</code> is validated as this method is not a getter (it has a parameter). <code class="methodname">getBacklog()</code> is a getter but is validated thanks to <code class="classname">@ValidateOnExecution</code> defaulting to <code>GETTER_METHODS</code>. <code class="methodname">placeOrder()</code> is not validated as <code class="classname">@ValidateOnExecution</code> is set to <code>NONE</code>.</p>
</div>
<div class="paragraph">
<p>All getter and non-getter methods of <code class="classname">SimpleOrderService</code> are validated upon execution by default due to the presence of <code class="classname">@ValidateOnExecution</code> on the class. The <code class="classname">SimpleOrderService</code> constructor is thus not validated. <code class="classname">SimpleOrderService.placeOrder()</code> is not validated either because it overrides <code class="classname">OrderService.placeOrder()</code> and thus inherits its settings.</p>
</div>
<div class="paragraph">
<p>All constructors and non-getter methods of <code class="classname">ComplexOrderService</code> are validated upon execution as this is the default setting - the type level settings of <code class="classname">SimpleOrderService</code> are not inherited. This means that the <code class="classname">ComplexOrderService</code> constructor is validated.</p>
</div>
<div class="paragraph">
<p><code class="classname">@ValidateOnExecution</code> can be optionally set on <code class="classname">OrderService</code> and <code class="classname">ComplexOrderService</code> without altering the semantic. This marker is necessary for some integration technology in some situations.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="integration-javaee"><a class="anchor" href="#integration-javaee"></a>10.2. Java EE</h3>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>Java EE must obey the rules defined above and make the following instances available under JNDI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="classname">ValidatorFactory</code> under <code>java:comp/ValidatorFactory</code></p>
</li>
<li>
<p><code class="classname">Validator</code> under <code>java:comp/Validator</code></p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-testable">Instead of looking the instances up via JNDI, the user can request them to be injected via the <code class="classname">Resource</code> annotation:</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Resource</span> ValidatorFactory validatorFactory;
<span class="annotation">@Resource</span> <span class="predefined-type">Validator</span> validator;</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="tck-testable">When the application is CDI enabled, the <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> instances returned by JNDI or <code class="classname">@Resource</code> injection are CDI enhanced as defined in <a href="#integration-cdi">Context and Dependency Injection (CDI) integration</a>.</span> In particular, dependency injection is available to Bean Validation components.</p>
</div>
</div>
<div class="sect2">
<h3 id="integration-cdi"><a class="anchor" href="#integration-cdi"></a>10.3. Context and Dependency Injection (CDI) integration</h3>
<div class="paragraph">
<p>There are several integrations points between Bean Validation and CDI. If a Bean Validation provider integrates with CDI, it must follow the rules laid out in this section. In a Java EE container, a <span class="tck-testable">Bean Validation provider must integrate with CDI.</span></p>
</div>
<div class="sect3">
<h4 id="integration-cdi-validatorfactory"><a class="anchor" href="#integration-cdi-validatorfactory"></a>10.3.1. <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code></h4>
<div class="paragraph">
<p><span class="tck-testable">Similar to the Java EE integration via <code class="classname">@Resource</code> (see <a href="#integration-javaee">Java EE</a>), a CDI container must support injection of built-in default <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> beans via <code class="classname">@Inject</code>. These default beans are injectable via the <code class="classname">@Default</code> qualifier.</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Inject</span> ValidatorFactory;
<span class="annotation">@Inject</span> <span class="predefined-type">Validator</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, the CDI container can support injection of provider specific - as defined by <code class="code">Validation.byProvider()</code> - <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> beans via <code class="classname">@Inject</code>. These beans must be registered with a custom qualifier, for example <code class="classname">@ACME</code>. Using the product name or brand for the qualifier is considered good practice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="annotation">@Inject</span> <span class="annotation">@ACME</span> ValidatorFactory;
<span class="annotation">@Inject</span> <span class="annotation">@ACME</span> <span class="predefined-type">Validator</span>;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Discussion on possible implementations</div>
<div class="paragraph">
<p>Registration of the built-in default beans and the provider specific beans may be achieved using the CDI portable extension SPI or a vendor specific SPI.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="integration-cdi-customconfiguration"><a class="anchor" href="#integration-cdi-customconfiguration"></a>10.3.2. <code class="classname">ConstraintValidatorFactory</code>, <code class="classname">MessageInterpolator</code>, <code class="classname">ParameterNameProvider</code>, <code class="classname">ClockProvider</code> and <code class="classname">TraversableResolver</code></h4>
<div class="paragraph">
<p><span class="tck-testable">If a custom <code class="classname">ConstraintValidatorFactory</code>, <code class="classname">MessageInterpolator</code>, <code class="classname">ParameterNameProvider</code>, <code class="classname">ClockProvider</code> or <code class="classname">TraversableResolver</code> class is defined in the XML deployment descriptor (see <a href="#validationapi-bootstrapping-xmlconfiguration">XML configuration: META-INF/validation.xml</a>), the <code class="classname">ValidatorFactory</code> must be configured with CDI managed beans representing the requested classes. Services like dependency injection, interception and decoration must thus be made available to these instances by the container.</span></p>
</div>
<div class="paragraph tck-testable">
<p></p><div class="paragraph">
<p>If no custom <code class="classname">ConstraintValidatorFactory</code> is requested by the user, the <code class="classname">ValidatorFactory</code> must be configured with a custom <code class="classname">ConstraintValidatorFactory</code> instance that returns CDI managed beans representing the requested <code class="classname">ConstraintValidator</code> types. The factory</p>
</div>
<div class="ulist">
<ul>
<li>
<p>creates non-contextual <code class="classname">ConstraintValidator</code> instances for each <code class="methodname">ConstraintValidatorFactory.getInstance()</code> call. To inject dependencies into the <code class="classname">ConstraintValidator</code> instance, the CDI <code class="classname">InjectionTarget</code> API should be used. Before returning the instance the following calls should be made: <code class="classname">InjectionTarget.produce()</code>, <code class="classname">InjectionTarget.inject()</code> and <code class="classname">InjectionTarget.postConstruct()</code>.</p>
</li>
<li>
<p>calls <code class="classname">InjectionTarget.preDestroy()</code> and <code class="classname">InjectionTarget.dispose()</code> upon <code class="classname">ConstraintValidatorFactory.releaseInstance</code> (see also <a href="#constraintsdefinitionimplementation-constraintfactory">The ConstraintValidatorFactory</a> for more information about the lifecycle of a <code class="classname">ConstraintValidator</code>).</p>
</li>
</ul>
</div><p></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">Using directly or indirectly a JPA <code class="classname">EntityManager</code> that might call back Bean Validation for validation is not allowed in the Bean Validation extension points and in <code class="classname">ConstraintValidator</code> instances. This would lead to infinite flush or unexpected behavior.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="integration-cdi-methodconstructorvalidation"><a class="anchor" href="#integration-cdi-methodconstructorvalidation"></a>10.3.3. Method and constructor validation</h4>
<div class="paragraph">
<p><span class="tck-testable">Bean Validation requires that CDI beans support constructor and method validation as defined in <a href="#integration-general-executable">Method and constructor validation</a>. Validation must happen at the equivalent time an interceptor occurs when having priority <code>Interceptor.Priority.PLATFORM_AFTER+800</code>, in other words priority of <code>4800</code>.</span></p>
</div>
<div class="paragraph">
<p><span class="tck-not-testable">For maximum portability, it is recommended to mark CDI bean interfaces and classes involved in executable validation with <code class="classname">@ValidateOnExecution</code> (defaults to <code>IMPLICIT</code>). This helps some implementations to <span class="rcl-da">bind</span> <span class="rcl-da">the</span> <span class="rcl-da">method</span> <span class="rcl-da">validation</span> <span class="rcl-da">interceptor</span><span class="rcl-dd">be </span><span class="rcl-dd">more </span><span class="rcl-dd">efficient</span>. Most CDI - Bean Validation integration implementations do not need such marker. In particular this marker should not be needed on validated beans annotated with constraint annotations, <code class="classname">@Valid</code> or <code class="classname">@ValidateOnExecution</code> anywhere in the class. Such limitation will be removed in a future version of this specification.</span></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Discussion on possible implementations</div>
<div class="paragraph">
<p>The CDI interceptor binding facility does not directly support this, but the effect may be achieved using the CDI portable extension SPI, or vendor specific SPIs. For example, an interceptor with the expected priority can be programmatically bound to the constructors and methods expected to be validated according to the rules at <a href="#integration-general-executable">Method and constructor validation</a>.</p>
</div>
<div class="paragraph">
<p>It is recommended to only intercept methods and constructors that are both constrained and validated according to the rules defined at <a href="#integration-general-executable">Method and constructor validation</a>. <a href="#validationapi-triggeringmethodvalidation">Triggering method validation</a> gives examples how the metadata API can be used to determine whether or not a method is constrained (regardless of the filtering rules of <code class="classname">@ValidateOnExecution</code>).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><span class="rcl-da">[[</span><span class="rcl-da">integration-jpa</span><span class="rcl-da">]</span>
<span class="rcl-da">===</span><span class="rcl-dd">10.4</span><span class="rcl-dd">. </span> Java Persistence 2.0 integration</p>
</div>
<div class="paragraph">
<p>Integration with Java Persistence is described in the Java Persistence 2 specification (<a href="http://jcp.org/en/jsr/detail?id=317">JSR-317</a> and later <a href="http://jcp.org/en/jsr/detail?id=338">JSR-338</a>). Persistence frameworks are encouraged to mimic the integration work done with Java Persistence.</p>
</div>
<div class="paragraph">
<p><span class="rcl-da">[[</span><span class="rcl-da">integration-jsf</span><span class="rcl-da">]</span>
<span class="rcl-da">===</span><span class="rcl-dd">10.5</span><span class="rcl-dd">. </span> Java Server Faces 2.0 integration</p>
</div>
<div class="paragraph">
<p>Integration with Java Server Faces is described in the Java Server Faces 2 specification (<a href="http://jcp.org/en/jsr/detail?id=314">JSR-314</a> and later <a href="http://jcp.org/en/jsr/detail?id=338">JSR-344</a>). Presentation frameworks are encouraged to study the integration work done with JSF 2.</p>
</div>
<div class="paragraph">
<p><span class="rcl-da">[[</span><span class="rcl-da">integration-jaxrs</span><span class="rcl-da">]</span>
<span class="rcl-da">===</span><span class="rcl-dd">10.6</span><span class="rcl-dd">. </span> JAX-RS 2 integration</p>
</div>
<div class="paragraph">
<p>Integration with JAX-RS is described in the JAX-RS 2 specification (<a href="http://jcp.org/en/jsr/detail?id=339">JSR-339</a>).</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminology"><a class="anchor" href="#terminology"></a>Appendix A: Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix aims at giving an overview on the different key terms used through this specification. They are not to be considered formal definitions. Formal definitions are to be inferred from the core specification.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Constraint</dt>
<dd>
<p>A restriction on a bean instance, the value of a field or the value of a JavaBean property.</p>
</dd>
<dt class="hdlist1">Constraint declaration</dt>
<dd>
<p>Assignment of a constraint to a target (bean, field, property) for a specific class. Typically by declaring an annotation on the target but can also be done through a XML deployment descriptor.</p>
</dd>
<dt class="hdlist1">Validation routine</dt>
<dd>
<p>Sequence of operations executed by the Bean Validation provider to validate a given object graph.</p>
</dd>
<dt class="hdlist1">Constraint definition</dt>
<dd>
<p>Defines a type of constraint, its attributes and the actual constraint validation implementations. Done through annotations. The list of constraint validation implementations can be provided via XML.</p>
</dd>
<dt class="hdlist1">Group</dt>
<dd>
<p>Constraints can belong to one or more group or context. Useful to apply a subset of the constraints for a given use case. By default, the <code>Default</code>  group is used.</p>
</dd>
<dt class="hdlist1">Group Sequence</dt>
<dd>
<p>Defines a group ordering in the validation process. If a given group in the sequence contains one or more failure, the following groups in the sequence must be ignored.</p>
</dd>
<dt class="hdlist1">Constraint validation</dt>
<dd>
<p>Constraint logic algorithm used to determine whether a given value passes a constraint or not.</p>
</dd>
<dt class="hdlist1">Constraint validation implementation</dt>
<dd>
<p>Class implementing the constraint logic and used to determine whether a given value pass a constraint or not.</p>
</dd>
<dt class="hdlist1">Bean Validation provider</dt>
<dd>
<p>Product implementing this specification.</p>
</dd>
<dt class="hdlist1">Message interpolator</dt>
<dd>
<p>Algorithm used to build the end user message associated to a constraint failure. Typically useful for i18n.</p>
</dd>
<dt class="hdlist1">Constraint metadata API</dt>
<dd>
<p>API exposing the constraints applied to a given bean type. Also considered one of the integration points with other JSR or frameworks.</p>
</dd>
<dt class="hdlist1">Bootstrap API</dt>
<dd>
<p>Bootstrapping part of the Bean Validation API producing a <code class="classname">ValidatorFactory</code>.</p>
</dd>
<dt class="hdlist1">javax.validation.ConstraintValidator</dt>
<dd>
<p>Interface implemented by a constraint validation implementation.</p>
</dd>
<dt class="hdlist1">Composing constraint</dt>
<dd>
<p>Constraint declared on another constraint definition. When the main constraint is validated, the composing constraints are validated too.</p>
</dd>
<dt class="hdlist1">javax.validation.Validator</dt>
<dd>
<p>Main API. Holds contracts to validate object graphs.</p>
</dd>
<dt class="hdlist1">javax.validation.ConstraintViolation</dt>
<dd>
<p>Interface describing a given constraint failure on a given bean.</p>
</dd>
<dt class="hdlist1">Getter</dt>
<dd>
<p>Method whose:</p>
<div class="ulist">
<ul>
<li>
<p>name starts with <code>get</code> and has a return type but no parameter</p>
</li>
<li>
<p>name starts with <code>is</code>, has no parameter and is returning <code class="classname">boolean</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-value-extraction"><a class="anchor" href="#appendix-value-extraction"></a>Appendix B: Value extraction for cascaded validation and type argument constraints (BVAL-508)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix describes the current work-in-progress around the retrieval of values to be validated during cascaded validation (e.g. <code><span class="rcl-dd">@</span><span class="rcl-dd">Valid </span>List<span class="rcl-da">&lt;@</span><span class="rcl-da">Valid</span><span class="rcl-dd">&lt;</span> Order&gt; orders</code>)
and evaluation of type argument constraints (e.g. <code>Optional&lt;@Email String&gt; email</code>)
It is based on the original <a href="http://beanvalidation.org/proposals/BVAL-508/">proposals for BVAL-508</a>.</p>
</div>
<div class="sect2">
<h3 id="_motivation"><a class="anchor" href="#_motivation"></a>B.1. Motivation</h3>
<div class="paragraph">
<p>Value extraction is needed when constraints are applied to the element(s) stored within a container type.
There are two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cascaded validation of iterables, maps and arrays as triggered via <code>@Valid</code>: <code>@Valid List&lt;Order&gt; orders</code>; in this case all the values stored in the list must be extracted so each can be validated</p>
</li>
<li>
<p>Validation of type argument constraints as enabled by Java 8: <code>Optional&lt;@Email String&gt; email</code> or <code>Property&lt;@Min(1) Integer&gt; value</code>;
in this case, e.g. the wrapped <code>String</code> and <code>Integer</code> values must be extracted so the <code>@Email</code> and <code>@Min</code> constraints can be applied</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both cases can also overlap: <code>List&lt;@RetailOrder @Valid Order&gt; retailOrders</code>.</p>
</div>
<div class="paragraph">
<p>Type argument constraints and pluggable extractors will also make cascaded validation more flexible.
As of BV 1.1, there was a fixed set of data types supported by cascaded validation mandated by the spec (<code>Iterable</code>, arrays, <code>Map</code> (only the values would be validated).
This excludes use cases such as custom collection types (e.g. Guava’s multi-map),
validation of map keys or collection types of other JVM languages (such as Ceylon’s collection framework).</p>
</div>
<div class="paragraph">
<p>Allowing to put <code>@Valid</code> on type parameters allows to express the subject of cascaded validation more specifically:
<code>Map&lt;@Valid AddressType, @Valid Address&gt; addresses</code> would describe that both, map keys and values, should be validated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>B.2. Requirements</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Constraints can be applied to type arguments (of bean properties, but also executable parameters and method return values): <code>Property&lt;@Min(1) Integer&gt; value</code></p>
</li>
<li>
<p>Individual type parameters can be marked for cascaded validation: <code>Map&lt;@Valid AddressType, Address&gt; addresses</code></p>
</li>
<li>
<p>How values are retrieved must be customizable by means of a pluggable value extractor mechanism, with a set of defined default extractors</p>
</li>
<li>
<p>Sometimes constraints should apply to a value wrapped by a container type, but there is no type parameter to put the constraints to.
JavaFX’s <code>Property</code> hierarchy is the most prominent example: <code>@Email StringProperty emailProperty</code>.
In such case the value should be implicitly extracted from the container if unambiguously doable.</p>
</li>
<li>
<p>Allow to configure type argument constraints and cascades via XML mappings</p>
</li>
<li>
<p>Expose meta-data on type argument constraints and cascades in the constraint metadata API</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_non_requirements"><a class="anchor" href="#_non_requirements"></a>B.3. Non-requirements</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Constraints on type uses in local variables, invocations etc: <code>@NotNull String name = "Emmanuel";</code>, <code>new @NonEmpty @Readonly List&lt;String&gt;(myNonEmptyStringSet)</code></p>
</li>
<li>
<p>constraints on type uses in type definitions:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">CustList</span> <span class="directive">extends</span> <span class="predefined-type">List</span>&lt;<span class="annotation">@NotNull</span> Customer&gt; {
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_solution"><a class="anchor" href="#_solution"></a>B.4. Solution</h3>
<div class="paragraph">
<p>Value retrieval for cascaded validation and validation of type argument constraints is done via the <code>ValueExtractor</code> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.<span class="rcl-da">valueextraction</span><span class="rcl-dd">valueretrieval </span></span>;

<span class="comment"><span class="rcl-da">/**</span>
 <span class="rcl-da">*</span> <span class="rcl-da">Defines</span> <span class="rcl-da">the</span> <span class="rcl-da">logic</span> <span class="rcl-da">used</span> <span class="rcl-da">to</span> <span class="rcl-da">extract</span> <span class="rcl-da">the</span> <span class="rcl-da">values</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span> <span class="rcl-da">from</span> <span class="rcl-da">an</span> <span class="rcl-da">object</span> <span class="rcl-da">of</span> <span class="rcl-da">type</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">T</span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">A</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">is</span> <span class="rcl-da">tied</span> <span class="rcl-da">to</span> <span class="rcl-da">one</span> <span class="rcl-da">specific</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">of</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">T</span><span class="rcl-da">}.</span> <span class="rcl-da">The</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ExtractedValue</span><span class="rcl-da">}</span> <span class="rcl-da">annotation</span>
 <span class="rcl-da">*</span> <span class="rcl-da">is</span> <span class="rcl-da">used</span> <span class="rcl-da">to</span> <span class="rcl-da">mark</span> <span class="rcl-da">that</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span><span class="rcl-da">.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">extracted</span> <span class="rcl-da">values</span> <span class="rcl-da">are</span> <span class="rcl-da">passed</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">corresponding</span> <span class="rcl-da">method</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ValueReceiver</span><span class="rcl-da">}.</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">A</span> <span class="rcl-da">typical</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">implementation</span> <span class="rcl-da">for</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">may</span> <span class="rcl-da">look</span> <span class="rcl-da">like</span> <span class="rcl-da">this</span><span class="rcl-da">:</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">pre</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> public <span class="rcl-da">class</span> <span class="rcl-da">ListValueExtractor</span> <span class="rcl-da">implements</span> <span class="rcl-da">ValueExtractor</span><span class="rcl-da">&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;</span><span class="rcl-da">List</span><span class="rcl-da">&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;&amp;#</span><span class="rcl-da">064</span><span class="rcl-da">;</span><span class="rcl-da">ExtractedValue</span> <span class="rcl-da">?&amp;</span><span class="rcl-da">gt</span><span class="rcl-da">;&amp;</span><span class="rcl-da">gt</span><span class="rcl-da">;</span> <span class="rcl-da">{</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">&amp;#</span><span class="rcl-da">064</span><span class="rcl-da">;</span><span class="rcl-da">Override</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">public</span> <span class="rcl-da">void</span> <span class="rcl-da">extractValues</span><span class="rcl-da">(</span><span class="rcl-da">List</span><span class="rcl-da">&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;?&amp;</span><span class="rcl-da">gt</span><span class="rcl-da">;</span> <span class="rcl-da">originalValue</span><span class="rcl-da">,</span> <span class="rcl-da">ValueReceiver</span> <span class="rcl-da">receiver</span><span class="rcl-da">)</span> <span class="rcl-da">{</span>
 <span class="rcl-da">*</span>         <span class="rcl-da">for</span> <span class="rcl-da">(</span> <span class="rcl-da">int</span> <span class="rcl-da">i</span> <span class="rcl-da">=</span> <span class="rcl-da">0</span><span class="rcl-da">;</span> <span class="rcl-da">i</span> <span class="rcl-da">&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;</span> <span class="rcl-da">originalValue</span><span class="rcl-da">.</span><span class="rcl-da">size</span><span class="rcl-da">();</span> <span class="rcl-da">i</span><span class="rcl-da">++</span> <span class="rcl-da">)</span> <span class="rcl-da">{</span>
 <span class="rcl-da">*</span>             <span class="rcl-da">receiver</span><span class="rcl-da">.</span><span class="rcl-da">indexedValue</span><span class="rcl-da">(</span> <span class="rcl-da">"&amp;</span><span class="rcl-da">lt</span><span class="rcl-da">;</span><span class="rcl-da">iterable</span> <span class="rcl-da">element</span><span class="rcl-da">&amp;</span><span class="rcl-da">gt</span><span class="rcl-da">;",</span> <span class="rcl-da">i</span><span class="rcl-da">,</span> <span class="rcl-da">originalValue</span><span class="rcl-da">.</span><span class="rcl-da">get</span><span class="rcl-da">(</span> <span class="rcl-da">i</span> <span class="rcl-da">)</span> <span class="rcl-da">);</span>
 <span class="rcl-da">*</span>         <span class="rcl-da">}</span>
 <span class="rcl-da">*</span>     <span class="rcl-da">}</span>
 <span class="rcl-da">*</span> <span class="rcl-da">}</span>
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;/</span><span class="rcl-da">pre</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Gunnar</span> <span class="rcl-da">Morling</span>
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Guillaume</span> <span class="rcl-da">Smet</span>
 <span class="rcl-da">*/</span></span>
<span class="directive"><span class="rcl-da">public</span></span> <span class="type">interface</span> <span class="class">ValueExtractor</span>&lt;T&gt; {

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Extracts</span> <span class="rcl-da">the</span> <span class="rcl-da">values</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span> <span class="rcl-da">from</span> <span class="rcl-da">the</span> <span class="rcl-da">original</span> <span class="rcl-da">object</span><span class="rcl-da">.</span>
     <span class="rcl-da">*</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">originalValue</span> <span class="rcl-da">the</span> <span class="rcl-da">original</span> <span class="rcl-da">value</span> <span class="rcl-da">from</span> <span class="rcl-da">which</span> <span class="rcl-da">we</span> <span class="rcl-da">want</span> <span class="rcl-da">to</span> <span class="rcl-da">extract</span> <span class="rcl-da">the</span> <span class="rcl-da">values</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">receiver</span> <span class="rcl-da">the</span> <span class="rcl-da">corresponding</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">ValueReceiver</span><span class="rcl-da">}</span>
     <span class="rcl-da">*/</span></span>
    <span class="type">void</span> extractValues(T originalValue, ValueReceiver receiver);

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">Provides</span> <span class="rcl-da">a</span> <span class="rcl-da">set</span> <span class="rcl-da">of</span> <span class="rcl-da">methods</span> <span class="rcl-da">receiving</span> <span class="rcl-da">value</span> <span class="rcl-da">extracted</span> <span class="rcl-da">by</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ValueExtractor</span><span class="rcl-da">}.</span>
     <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
     <span class="rcl-da">*</span> <span class="rcl-da">The</span> <span class="rcl-da">value</span> <span class="rcl-da">has</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">passed</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">method</span> <span class="rcl-da">corresponding</span> <span class="rcl-da">best</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">original</span> <span class="rcl-da">value</span><span class="rcl-da">.</span>
     <span class="rcl-da">*/</span></span>
    <span class="type">interface</span> <span class="class">ValueReceiver</span> {

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Receives</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">extracted</span> <span class="rcl-da">from</span> <span class="rcl-da">an</span> <span class="rcl-da">object</span><span class="rcl-da">.</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">nodeName</span> <span class="rcl-da">the</span> <span class="rcl-da">name</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">added</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Path</span><span class="rcl-da">}</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">object</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span>
         <span class="rcl-da">*/</span></span>
        <span class="type">void</span> value(<span class="predefined-type">String</span> nodeName, <span class="predefined-type">Object</span> object);

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Receives</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">extracted</span> <span class="rcl-da">from</span> <span class="rcl-da">an</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Iterable</span><span class="rcl-da">}</span> <span class="rcl-da">object</span> <span class="rcl-da">that</span> <span class="rcl-da">is</span> <span class="rcl-da">not</span> <span class="rcl-da">indexed</span> <span class="rcl-da">(</span><span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Set</span><span class="rcl-da">}).</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">nodeName</span> <span class="rcl-da">the</span> <span class="rcl-da">name</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">added</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Path</span><span class="rcl-da">}</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">object</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span>
         <span class="rcl-da">*/</span></span>
        <span class="type">void</span> iterableValue(<span class="predefined-type">String</span> nodeName, <span class="predefined-type">Object</span> object);

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Receives</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">extracted</span> <span class="rcl-da">from</span> <span class="rcl-da">an</span> <span class="rcl-da">indexed</span> <span class="rcl-da">object</span> <span class="rcl-da">(</span><span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span><span class="rcl-da">).</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">nodeName</span> <span class="rcl-da">the</span> <span class="rcl-da">name</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">added</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Path</span><span class="rcl-da">}</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">i</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">original</span> <span class="rcl-da">object</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">object</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span>
         <span class="rcl-da">*/</span></span>
        <span class="type">void</span> indexedValue(<span class="predefined-type">String</span> nodeName, <span class="type">int</span> i, <span class="predefined-type">Object</span> object);

        <span class="comment"><span class="rcl-da">/**</span>
         <span class="rcl-da">*</span> <span class="rcl-da">Receives</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">extracted</span> <span class="rcl-da">from</span> <span class="rcl-da">a</span> <span class="rcl-da">keyed</span> <span class="rcl-da">object</span> <span class="rcl-da">(</span><span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Map</span><span class="rcl-da">}).</span>
         <span class="rcl-da">*</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">nodeName</span> <span class="rcl-da">the</span> <span class="rcl-da">name</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">to</span> <span class="rcl-da">be</span> <span class="rcl-da">added</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">Path</span><span class="rcl-da">}</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">key</span> <span class="rcl-da">the</span> <span class="rcl-da">key</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">original</span> <span class="rcl-da">object</span>
         <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">param</span> <span class="rcl-da">object</span> <span class="rcl-da">the</span> <span class="rcl-da">value</span> <span class="rcl-da">to</span> <span class="rcl-da">validate</span>
         <span class="rcl-da">*/</span></span>
        <span class="type">void</span> keyedValue(<span class="predefined-type">String</span> nodeName, <span class="predefined-type">Object</span> key, <span class="predefined-type">Object</span> object);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An extractor is tied to one specific type parameter of the type from which it extracts values. The <code>@ExtractedValue</code> annotation is used to mark that type parameter.</p>
</div>
<div class="paragraph">
<p>As an example, this is how the implementation of the list extractor may look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">ListValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="predefined-type">List</span>&lt;<span class="annotation">@ExtractedValue</span> ?&gt;&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(<span class="predefined-type">List</span>&lt;?&gt; originalValue, ValueReceiver receiver) {
        <span class="keyword">for</span> ( <span class="type">int</span> i = <span class="integer">0</span>; i &lt; originalValue.size(); i++ ) {
            receiver.indexedValue( <span class="string"><span class="delimiter">"</span><span class="content">&lt;iterable element&gt;</span><span class="delimiter">"</span></span>, i, originalValue.get( i ) );
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The right callback methods (<code>indexedValue()</code>, <code>keyedValue()</code> etc.) must be called in order to allow for proper construction of the property path as per the rules laid out in the BV 1.1 spec.</p>
</div>
<div class="paragraph">
<p>If a non-null value is passed for <code>nodeName</code>, a path node of type <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code> will be appended to the property path.
That’s desirable for collection types for instance. If null is passed, no node will be appended,
resulting in the same path as if the constraint had been given on the element itself instead of a type parameter.
That’s desirable for pure "wrapper types" such as <code>Optional</code>.</p>
</div>
<div class="sect3">
<h4 id="__extractedvalue"><a class="anchor" href="#__extractedvalue"></a>B.4.1. @ExtractedValue</h4>
<div class="paragraph">
<p>The <code>@ExtractedValue</code> annotation is used to denote the element extracted by a given value extractor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.valueextraction</span>;

<span class="comment"><span class="rcl-da">/**</span>
 <span class="rcl-da">*</span> <span class="rcl-da">Annotation</span> <span class="rcl-da">used</span> <span class="rcl-da">to</span> <span class="rcl-da">mark</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">to</span> <span class="rcl-da">which</span> <span class="rcl-da">a</span> <span class="rcl-da">{@</span><span class="rcl-da">link</span> <span class="rcl-da">ValueExtractor</span><span class="rcl-da">}</span> <span class="rcl-da">is</span> <span class="rcl-da">tied</span><span class="rcl-dd">import </span><span class="rcl-dd">java</span>.
 <span class="rcl-da">*</span> <span class="rcl-da">&lt;</span><span class="rcl-da">p</span><span class="rcl-da">&gt;</span>
 <span class="rcl-da">*</span> <span class="rcl-da">Must</span> <span class="rcl-da">be</span> <span class="rcl-da">given</span> <span class="rcl-da">exactly</span> <span class="rcl-da">once</span> <span class="rcl-da">for</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">type</span><span class="rcl-dd">lang</span>.<span class="rcl-dd">annotation</span><span class="rcl-dd">.</span><span class="rcl-dd">ElementType </span><span class="rcl-dd">; </span><span class="rcl-dd">import </span><span class="rcl-dd">java</span><span class="rcl-dd">.</span><span class="rcl-dd">lang</span><span class="rcl-dd">.</span><span class="rcl-dd">annotation</span><span class="rcl-dd">.</span><span class="rcl-dd">Retention </span><span class="rcl-dd">; </span><span class="rcl-dd">import </span><span class="rcl-dd">java</span><span class="rcl-dd">.</span><span class="rcl-dd">lang</span><span class="rcl-dd">.</span><span class="rcl-dd">annotation</span><span class="rcl-dd">.</span><span class="rcl-dd">RetentionPolicy </span><span class="rcl-dd">; </span><span class="rcl-dd">import </span><span class="rcl-dd">java</span><span class="rcl-dd">.</span><span class="rcl-dd">lang</span><span class="rcl-dd">.</span><span class="rcl-dd">annotation</span><span class="rcl-dd">.</span><span class="rcl-dd">Target </span><span class="rcl-dd">; </span><span class="rcl-dd">/** </span>
 *
 <span class="rcl-da">*</span> @author Gunnar Morling
 <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">author</span> <span class="rcl-da">Guillaume</span> <span class="rcl-da">Smet</span>
 */</span>
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.TYPE_USE)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> ExtractedValue {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@ExtractedValue</code> annotation must be specified exactly once for a value extractor type.
Thus the following extractor definition is illegal as it specifies <code>@ExtractedValue</code> several times:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DoubleExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;Multimap&lt;<span class="annotation">@ExtractedValue</span> ?, <span class="annotation">@ExtractedValue</span> ?&gt;&gt; { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>When defined for a generic type, only wildcard type arguments may be annotated with <code>@ExtractedValue</code>.
Thus the following extractor definition is illegal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">StringListValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="predefined-type">List</span>&lt;<span class="annotation">@ExtractedValue</span> <span class="predefined-type">String</span>&gt;&gt; { ... }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This implies that there may not be more than one extractor for a given generic type.
I.e. there can be an extractor for <code>List&lt;?&gt;</code>, but not one for <code>List&lt;String&gt;</code> and one for <code>List&lt;Integer&gt;</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>In case an illegal value extractor definition is detected, a <code>ValueExtractorDefinitionException</code> is raised.</p>
</div>
<div class="paragraph">
<p>If a value extractor returns the entire extracted type itself
(as it is the case for the built-in extractor for handling any non-collection object associations),
the <code>@ExtractedValue</code> annotation is to be given on the extracted type itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">ObjectValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="annotation">@ExtractedValue</span> <span class="predefined-type">Object</span>&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(<span class="predefined-type">Object</span> originalValue, ValueReceiver receiver) {
        receiver.value( <span class="predefined-constant">null</span>, originalValue );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a value extractor returns the elements of an array type,
the <code>@ExtractedValue</code> annotation is to be given for the array type as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">IntArrayValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="type">int</span> <span class="annotation">@ExtractedValue</span><span class="type">[]</span>&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(<span class="type">int</span><span class="type">[]</span> originalValue, ValueReceiver receiver) {
        <span class="keyword">for</span> ( <span class="type">int</span> i = <span class="integer">0</span>; i &lt; originalValue.length; i++ ) {
            receiver.indexedValue( <span class="string"><span class="delimiter">"</span><span class="content">&lt;iterable element&gt;</span><span class="delimiter">"</span></span>, i, originalValue[i] );
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Motivation for callback-style API</div>
<div class="paragraph">
<p>Instead of returning the extracted values from the method call, implementations of <code>ValueExtractor</code> pass the extracted values to the given receiver callback.
This helps to avoid object allocations and allows to handle the case of a single extracted value (<code>Optional&lt;T&gt;</code>) and multiple extracted values (<code>List&lt;T&gt;</code>) in a uniform fashion.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_extensions_to_code_node_code"><a class="anchor" href="#_extensions_to_code_node_code"></a>B.4.2. Extensions to <code>Node</code></h4>
<div class="paragraph">
<p>There is a new <code>javax.validation.ElementKind</code>, <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code>.
There is also a new <code>Node</code> sub-type, <code><span class="rcl-da">ContainerElementNode</span><span class="rcl-dd">TypeArgumentNode </span></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class"><span class="rcl-da">ContainerElementNode</span><span class="rcl-dd">TypeArgumentNode </span></span> <span class="directive">extends</span> Node {

    <span class="comment">/**
     * <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span><span class="rcl-dd">Returns </span> type <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">container</span> <span class="rcl-da">the</span> <span class="rcl-da">node</span> <span class="rcl-da">is</span> <span class="rcl-da">placed</span> <span class="rcl-da">in</span><span class="rcl-da">,</span> <span class="rcl-da">if</span> <span class="rcl-da">contained</span> <span class="rcl-da">in</span> <span class="rcl-da">a</span> <span class="rcl-da">container</span> <span class="rcl-da">type</span> <span class="rcl-da">such</span> <span class="rcl-da">as</span>
     <span class="rcl-da">*</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">Optional</span><span class="rcl-da">},</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">List</span><span class="rcl-da">}</span> <span class="rcl-da">or</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span><span class="rcl-da">,</span> <span class="rcl-da">{@</span><span class="rcl-da">code</span> <span class="rcl-da">null</span><span class="rcl-da">}</span> <span class="rcl-da">otherwise</span>
     <span class="rcl-da">*/</span></span>
    <span class="predefined-type"><span class="rcl-da">Class</span></span><span class="rcl-da">&lt;?&gt;</span> <span class="rcl-da">getContainerClass</span><span class="rcl-da">();</span>

    <span class="comment"><span class="rcl-da">/**</span>
     <span class="rcl-da">*</span> <span class="rcl-da">@</span><span class="rcl-da">return</span> <span class="rcl-da">the</span> <span class="rcl-da">index</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> parameter affected by the violated constraint <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">container</span> <span class="rcl-da">class</span><span class="rcl-dd">. </span>
     */</span>
    <span class="predefined-type"><span class="rcl-da">Integer</span><span class="rcl-dd">TypeVariable </span></span> <span class="rcl-da">getTypeArgumentIndex</span><span class="rcl-dd">&lt;?&gt; </span><span class="rcl-dd">getTypeParameter</span>();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><span class="rcl-da">getContainerClass</span><span class="rcl-dd">getTypeParameter</span>()</code> <span class="rcl-da">and</span> <code><span class="rcl-da">getTypeArgumentIndex</span><span class="rcl-da">()</span></code> also <span class="rcl-da">need</span><span class="rcl-dd">needs </span> to be added to <code>BeanNode</code> and <code>PropertyNode</code> and will return the affected type parameter when violating a class-level or property constraint in the course of cascaded validation of a generic type, such as <code>List</code> or <code>Map</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_default_extractors"><a class="anchor" href="#_default_extractors"></a>B.4.3. Default extractors</h4>
<div class="paragraph">
<p>Compatible implementations provide extractors for the following types out of the box. They must invoke the right callback methods in order to ensure path nodes in the described form are appended:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Arrays of objects and all primitive data types</p>
<div class="ulist">
<ul>
<li>
<p><code>@Valid</code> can be given for the array itself or for its component type.
Both will cause the validation of all the array elements</p>
</li>
<li>
<p>If a constraint given for an array’s component type is validated, a node with the following properties will be added to the path:</p>
<div class="ulist">
<ul>
<li>
<p>name: "&lt;iterable element&gt;"</p>
</li>
<li>
<p>kind: <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code></p>
</li>
<li>
<p>isInIterable: <code>false</code></p>
</li>
<li>
<p>index: the element’s index</p>
</li>
<li>
<p>key: <code>null</code></p>
</li>
<li>
<p><span class="rcl-da">containerClass</span><span class="rcl-da">:</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">case</span> <span class="rcl-da">of</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span> <span class="rcl-da">of</span> <code><span class="rcl-da">Object</span></code><span class="rcl-da">s</span><span class="rcl-da">,</span> <code><span class="rcl-da">Object</span><span class="rcl-da">[]</span></code><span class="rcl-da">,</span> <span class="rcl-da">in</span> <span class="rcl-da">the</span> <span class="rcl-da">case</span> <span class="rcl-da">of</span> <span class="rcl-da">an</span> <span class="rcl-da">array</span> <span class="rcl-da">of</span> <span class="rcl-da">primitives</span><span class="rcl-da">,</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">of</span> <span class="rcl-da">the</span> <span class="rcl-da">array</span> <span class="rcl-da">(</span><span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <code><span class="rcl-da">int</span><span class="rcl-da">[]</span></code><span class="rcl-da">)</span></p>
</li>
<li>
<p><span class="rcl-da">typeArgumentIndex</span><span class="rcl-da">:</span> <code><span class="rcl-da">null</span></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.util.Iterable</code> <span class="rcl-da">-</span> <span class="rcl-da">excluding</span> <span class="rcl-da">the</span> <span class="rcl-da">case</span> <span class="rcl-da">of</span> <code><span class="rcl-da">java</span><span class="rcl-da">.</span><span class="rcl-da">util</span><span class="rcl-da">.</span><span class="rcl-da">List</span></code> <span class="rcl-da">described</span> <span class="rcl-da">below</span></p>
<div class="ulist">
<ul>
<li>
<p>When <code>@Valid</code> is given on the iterable element itself, the element and all its entries will be validated; this is to grant backwards <span class="rcl-da">compatibility</span><span class="rcl-dd">compatability </span> with BV 1.1</p>
</li>
<li>
<p>When <code>@Valid</code> is given on the type parameter of an iterable element, all the entries will be validated.</p>
</li>
<li>
<p>When validating a type argument constraint for <code>Iterable</code>, a node with the following properties will be added to the path:</p>
<div class="ulist">
<ul>
<li>
<p>name: "&lt;iterable element&gt;"</p>
</li>
<li>
<p>kind: <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code></p>
</li>
<li>
<p>isInIterable: <code>true</code></p>
</li>
<li>
<p>index: the element’s index if the iterable is of type <code>List</code> or a subtype thereof; <code>null</code> otherwise</p>
</li>
<li>
<p>key: <code>null</code></p>
</li>
<li>
<p><span class="rcl-da">containerClass</span><span class="rcl-da">:</span> <code><span class="rcl-da">Iterable</span></code></p>
</li>
<li>
<p><span class="rcl-da">typeArgumentIndex</span><span class="rcl-da">:</span> <code><span class="rcl-da">0</span></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.util.<span class="rcl-da">List</span></code></p>
<div class="ulist">
<ul>
<li>
<p><span class="rcl-da">When</span> <code><span class="rcl-da">@</span><span class="rcl-da">Valid</span></code> <span class="rcl-da">is</span> <span class="rcl-da">given</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">iterable</span> <span class="rcl-da">element</span> <span class="rcl-da">itself</span><span class="rcl-da">,</span> <span class="rcl-da">the</span> <span class="rcl-da">element</span> <span class="rcl-da">and</span> <span class="rcl-da">all</span> <span class="rcl-da">its</span> <span class="rcl-da">entries</span> <span class="rcl-da">will</span> <span class="rcl-da">be</span> <span class="rcl-da">validated</span><span class="rcl-da">;</span> <span class="rcl-da">this</span> <span class="rcl-da">is</span> <span class="rcl-da">to</span> <span class="rcl-da">grant</span> <span class="rcl-da">backwards</span> <span class="rcl-da">compatibility</span> <span class="rcl-da">with</span> <span class="rcl-da">BV</span> <span class="rcl-da">1.1</span></p>
</li>
<li>
<p><span class="rcl-da">When</span> <code><span class="rcl-da">@</span><span class="rcl-da">Valid</span></code> <span class="rcl-da">is</span> <span class="rcl-da">given</span> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">of</span> <span class="rcl-da">an</span> <span class="rcl-da">iterable</span> <span class="rcl-da">element</span><span class="rcl-da">,</span> <span class="rcl-da">all</span> <span class="rcl-da">the</span> <span class="rcl-da">entries</span> <span class="rcl-da">will</span> <span class="rcl-da">be</span> <span class="rcl-da">validated</span><span class="rcl-da">.</span></p>
</li>
<li>
<p><span class="rcl-da">When</span> <span class="rcl-da">validating</span> <span class="rcl-da">a</span> <span class="rcl-da">type</span> <span class="rcl-da">argument</span> <span class="rcl-da">constraint</span> <span class="rcl-da">for</span> <code><span class="rcl-da">List</span></code><span class="rcl-da">,</span> <span class="rcl-da">a</span> <span class="rcl-da">node</span> <span class="rcl-da">with</span> <span class="rcl-da">the</span> <span class="rcl-da">following</span> <span class="rcl-da">properties</span> <span class="rcl-da">will</span> <span class="rcl-da">be</span> <span class="rcl-da">added</span> <span class="rcl-da">to</span> <span class="rcl-da">the</span> <span class="rcl-da">path</span><span class="rcl-da">:</span></p>
<div class="ulist">
<ul>
<li>
<p><span class="rcl-da">name</span><span class="rcl-da">:</span> <span class="rcl-da">"&lt;</span><span class="rcl-da">iterable</span> <span class="rcl-da">element</span><span class="rcl-da">&gt;"</span></p>
</li>
<li>
<p><span class="rcl-da">kind</span><span class="rcl-da">:</span> <code><span class="rcl-da">CONTAINER</span><span class="rcl-da">_</span><span class="rcl-da">ELEMENT</span></code></p>
</li>
<li>
<p><span class="rcl-da">isInIterable</span><span class="rcl-da">:</span> <code><span class="rcl-da">true</span></code></p>
</li>
<li>
<p><span class="rcl-da">index</span><span class="rcl-da">:</span> <span class="rcl-da">the</span> <span class="rcl-da">element</span><span class="rcl-da">’</span><span class="rcl-da">s</span> <span class="rcl-da">index</span></p>
</li>
<li>
<p><span class="rcl-da">key</span><span class="rcl-da">:</span> <code><span class="rcl-da">null</span></code></p>
</li>
<li>
<p><span class="rcl-da">containerClass</span><span class="rcl-da">:</span> <code><span class="rcl-da">List</span></code></p>
</li>
<li>
<p><span class="rcl-da">typeArgumentIndex</span><span class="rcl-da">:</span> <code><span class="rcl-da">0</span></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code><span class="rcl-da">java</span><span class="rcl-da">.</span><span class="rcl-da">util</span><span class="rcl-da">.</span>Map</code></p>
<div class="ulist">
<ul>
<li>
<p>When <code>@Valid</code> is given on the map element itself, the element and all its values will be validated; this is to grant backwards <span class="rcl-da">compatibility</span><span class="rcl-dd">compatability </span> with BV 1.1</p>
</li>
<li>
<p>When <code>@Valid</code> is given on the key type parameter, the map keys will be validated</p>
</li>
<li>
<p>When <code>@Valid</code> is given on the value type parameter, the map values will be validated</p>
</li>
<li>
<p>When validating a constraint on the key type argument of <code>Map</code>, a node with the following properties will be added to the path:</p>
<div class="ulist">
<ul>
<li>
<p>name: "&lt;map key&gt;"</p>
</li>
<li>
<p>kind: <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code></p>
</li>
<li>
<p>isInIterable: <code>true</code></p>
</li>
<li>
<p>index: <code>null</code></p>
</li>
<li>
<p>key: key</p>
</li>
<li>
<p><span class="rcl-da">containerClass</span><span class="rcl-da">:</span> <code><span class="rcl-da">Map</span></code></p>
</li>
<li>
<p><span class="rcl-da">typeArgumentIndex</span><span class="rcl-da">:</span> <code><span class="rcl-da">0</span></code></p>
</li>
</ul>
</div>
</li>
<li>
<p>When validating a constraint on the value type argument of <code>Map</code>, a node with the following properties will be added to the path:</p>
<div class="ulist">
<ul>
<li>
<p>name: "&lt;map value&gt;"</p>
</li>
<li>
<p>kind: <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code></p>
</li>
<li>
<p>isInIterable: <code>true</code></p>
</li>
<li>
<p>index: <code>null</code></p>
</li>
<li>
<p>key: key</p>
</li>
<li>
<p><span class="rcl-da">containerClass</span><span class="rcl-da">:</span> <code><span class="rcl-da">Map</span></code></p>
</li>
<li>
<p><span class="rcl-da">typeArgumentIndex</span><span class="rcl-da">:</span> <code><span class="rcl-da">1</span></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.util.Optional</code></p>
<div class="ulist">
<ul>
<li>
<p>No node will be appended to the path when validating type argument constraints on <code>Optional</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>javafx.beans.observable.ObservableValue</code></p>
<div class="ulist">
<ul>
<li>
<p>No node will be appended to the path when validating type argument constraints on <code>ObservableValue</code></p>
</li>
<li>
<p>Constraints given on an element of type <code>ObservableValue</code> apply to the wrapped value by default (see <a href="#appendix-valueextraction-wrappedelements">Applying element-level constraints to wrapped elements</a>).</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.lang.Object</code></p>
<div class="ulist">
<ul>
<li>
<p>When <code>@Valid</code> is given for an element, the element will be validated</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_examples"><a class="anchor" href="#_examples"></a><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.3.1</span><span class="rcl-da">.</span> Examples</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_plugging_in_custom_extractors"><a class="anchor" href="#_plugging_in_custom_extractors"></a>B.4.4. Plugging in custom extractors</h4>
<div class="paragraph">
<p>Additional value extractors can be <span class="rcl-da">plugged</span><span class="rcl-dd">registered </span><span class="rcl-dd">with </span><span class="rcl-dd">the </span><span class="rcl-dd">Bean </span><span class="rcl-dd">Validation </span><span class="rcl-dd">provider </span> in <span class="rcl-da">when</span> <span class="rcl-da">bootstrapping</span> <span class="rcl-da">a</span> <code><span class="rcl-da">Validator</span></code> <span class="rcl-da">or</span> <code><span class="rcl-da">ValidatorFactory</span></code><span class="rcl-da">,</span> <span class="rcl-da">amending</span> <span class="rcl-da">and</span><span class="rcl-da">/</span><span class="rcl-da">or</span> <span class="rcl-da">overriding</span> the <span class="rcl-da">set</span> <span class="rcl-da">of</span> <span class="rcl-da">built-in</span> <span class="rcl-da">value</span> <span class="rcl-da">extractors</span><span class="rcl-da">.</span>
<span class="rcl-da">The</span> following ways <span class="rcl-da">to</span> <span class="rcl-da">do</span> <span class="rcl-da">so</span> <span class="rcl-da">exist</span><span class="rcl-da">,</span> <span class="rcl-da">in</span> <span class="rcl-da">descending</span> <span class="rcl-da">order</span> <span class="rcl-da">of</span> <span class="rcl-da">precedence</span>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="rcl-da">Invoking</span><span class="rcl-dd">Invoke </span> the<span class="rcl-dd">new </span> method <code><span class="rcl-da">ValidatorContext</span><span class="rcl-dd">Configuration</span>#addValueExtractor(ValueExtractor&lt;?&gt;)</code> (to apply it <span class="rcl-da">for</span> <span class="rcl-da">a</span> <span class="rcl-da">single</span> <code><span class="rcl-da">Validator</span></code><span class="rcl-dd">at </span><span class="rcl-dd">the </span><span class="rcl-dd">validation </span><span class="rcl-dd">factory </span><span class="rcl-dd">level</span>)</p>
</li>
<li>
<p><span class="rcl-da">Invoking</span><span class="rcl-dd">Invoke </span> the<span class="rcl-dd">new </span> method <code><span class="rcl-da">Configuration</span><span class="rcl-dd">ValidatorContext</span>#addValueExtractor(ValueExtractor&lt;?&gt;)</code> (to apply it <span class="rcl-da">at</span> <span class="rcl-da">the</span> <span class="rcl-da">validation</span> <span class="rcl-da">factory</span> <span class="rcl-da">level</span><span class="rcl-dd">for </span><span class="rcl-dd">a </span><span class="rcl-dd">single </span><span class="rcl-dd">Validator </span>)</p>
</li>
<li>
<p><span class="rcl-da">Specifying</span><span class="rcl-dd">Specify </span> the <span class="rcl-da">fully-qualified</span><span class="rcl-dd">fully </span><span class="rcl-dd">qualified </span> class name of one or several extractors in <code>META-INF/validation.xml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;value-extractors&gt;</span>
    <span class="tag">&lt;value-extractor&gt;</span>com.example.MyExtractor<span class="tag">&lt;/value-extractor&gt;</span>
<span class="tag">&lt;/value-extractors&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p><span class="rcl-da">Placing</span> <span class="rcl-da">a</span> <span class="rcl-da">file</span> <span class="rcl-da">named</span> <em><span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">services</span><span class="rcl-da">/</span><span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">valueextraction</span><span class="rcl-da">.</span><span class="rcl-da">ValueExtractor</span></em> <span class="rcl-da">on</span> <span class="rcl-da">the</span> <span class="rcl-da">classpath</span><span class="rcl-da">,</span>
<span class="rcl-da">with</span> <span class="rcl-da">the</span> <span class="rcl-da">fully-qualified</span> <span class="rcl-da">name</span><span class="rcl-da">(</span><span class="rcl-da">s</span><span class="rcl-da">)</span> <span class="rcl-da">of</span> <span class="rcl-da">one</span> <span class="rcl-da">or</span> <span class="rcl-da">more</span> <span class="rcl-da">extractor</span> <span class="rcl-da">implementations</span> <span class="rcl-da">as</span> <span class="rcl-da">its</span> <span class="rcl-da">contents</span> <span class="rcl-da">(</span><span class="rcl-da">i</span><span class="rcl-da">.</span><span class="rcl-da">e</span><span class="rcl-da">.</span> <span class="rcl-da">employing</span> <span class="rcl-da">the</span> <span class="rcl-da">Java</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span> <span class="rcl-da">mechanism</span><span class="rcl-da">)</span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="rcl-da">A</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <span class="rcl-da">a</span> <span class="rcl-da">given</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">extracted</span> <span class="rcl-da">type</span> <span class="rcl-da">parameter</span> <span class="rcl-da">specified</span> <span class="rcl-da">at</span> <span class="rcl-da">a</span> <span class="rcl-da">higher</span> <span class="rcl-da">level</span> <span class="rcl-da">overrides</span> <span class="rcl-da">any</span> <span class="rcl-da">other</span> <span class="rcl-da">extractors</span> <span class="rcl-da">for</span> <span class="rcl-da">the</span> <span class="rcl-da">same</span> <span class="rcl-da">type</span> <span class="rcl-da">and</span> <span class="rcl-da">extracted</span> <span class="rcl-da">type</span> <span class="rcl-da">given</span> <span class="rcl-da">at</span> <span class="rcl-da">lower</span> <span class="rcl-da">levels</span><span class="rcl-da">.</span>
<span class="rcl-da">If</span> <span class="rcl-da">e</span><span class="rcl-da">.</span><span class="rcl-da">g</span><span class="rcl-da">.</span> <span class="rcl-da">a</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">defined</span> <span class="rcl-da">as</span> <code><span class="rcl-da">class</span> <span class="rcl-da">MyListValueExtractor</span> <span class="rcl-da">implements</span> <span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;</span><span class="rcl-da">List</span><span class="rcl-da">&lt;@</span><span class="rcl-da">ExtractedValue</span> <span class="rcl-da">?&gt;&gt;</span> <span class="rcl-da">{</span> <span class="rcl-da">…​</span> <span class="rcl-da">}</span></code> <span class="rcl-da">is</span> <span class="rcl-da">given</span> <span class="rcl-da">via</span> <code><span class="rcl-da">ValidatorContext</span><span class="rcl-da">#</span><span class="rcl-da">addValueExtractor</span><span class="rcl-da">(</span><span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;?&gt;)</span></code><span class="rcl-da">,</span>
<span class="rcl-da">it</span> <span class="rcl-da">will</span> <span class="rcl-da">take</span> <span class="rcl-da">precedence</span> <span class="rcl-da">over</span> <span class="rcl-da">any</span> <span class="rcl-da">other</span> <span class="rcl-da">value</span> <span class="rcl-da">extractor</span> <span class="rcl-da">implementing</span> <code><span class="rcl-da">List</span><span class="rcl-da">&lt;@</span><span class="rcl-da">ExtractedValue</span> <span class="rcl-da">?&gt;</span></code> <span class="rcl-da">given</span> <span class="rcl-da">via</span> <code><span class="rcl-da">Configuration</span><span class="rcl-da">#</span><span class="rcl-da">addValueExtractor</span><span class="rcl-da">(</span><span class="rcl-da">ValueExtractor</span><span class="rcl-da">&lt;?&gt;)</span></code><span class="rcl-da">,</span>
<em><span class="rcl-da">META-INF</span><span class="rcl-da">/</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">xml</span></em> <span class="rcl-da">or</span> <span class="rcl-da">the</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span> <span class="rcl-da">mechanism</span> <span class="rcl-da">as</span> <span class="rcl-da">well</span> <span class="rcl-da">as</span> <span class="rcl-da">the</span> <span class="rcl-da">built-in</span> <span class="rcl-da">extractor</span> <span class="rcl-da">for</span> <code><span class="rcl-da">List</span></code> <span class="rcl-da">elements</span><span class="rcl-da">.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="appendix-valueextraction-wrappedelements"><a class="anchor" href="#appendix-valueextraction-wrappedelements"></a>B.4.5. Applying element-level constraints to wrapped elements</h4>
<div class="paragraph">
<p>Sometimes there is no type parameter to put a constraint to, but still constraints should be applied to the wrapped value instead of the annotated element
(a field, property getter, method return value or executable parameter).
JavaFX’s property hierarchy falls into that category, as it defines specific <code>Property</code> sub-types which are not generic.
As an example, consider a generic type <code>Wrapper&lt;T&gt;</code> and a non-generic sub-type <code>StringWrapper</code> which binds the type parameter <code>&lt;T&gt;</code> to <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Email</span> StringWrapper email;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Two defined sub-types of <code>javax.validation.Payload</code> can be used to control the target of validation in such cases via the constraint’s <code>payload()</code> attribute:</p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">133</span><span class="rcl-dd">128</span>. <code>Payload</code> types for unwrapping control</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.valueextraction</span>;

<span class="comment">/**
 * Set of interfaces used in the {@code payload()} of a constraint to indicate if a value should be unwrapped before
 * validation.
 * &lt;p&gt;
 * This is used to overwrite the default configuration defined on the {@link ValueExtractor}.
 *
 * @author Guillaume Smet
 * @since 2.0
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Unwrapping</span> {

    <span class="comment">/**
     * Unwrap the value before validation.
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">Unwrap</span> <span class="directive">extends</span> Payload {
    }

    <span class="comment">/**
     * Skip the unwrapping if it has been enabled on the {@link ValueExtractor} by the {@link UnwrapByDefault}
     * annotation.
     *
     * @since 2.0
     */</span>
    <span class="directive">public</span> <span class="type">interface</span> <span class="class">Skip</span> <span class="directive">extends</span> Payload {
    }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class) StringWrapper email;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Value extractor definitions can be marked with the <code>@UnwrapByDefault</code> annotation so that constraints are automatically applied to the wrapped value if a constraint is found for an element handled by that extractor:</p>
</div>
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">134</span><span class="rcl-dd">129</span>. <code>@UnwrapByDefault</code> annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA"><span class="keyword">package</span> <span class="namespace">javax.validation.valueextraction</span>;

<span class="comment">/**
 * Annotation used on a {@link ValueExtractor} to indicate that the value should be unwrapped by default.
 * &lt;p&gt;
 * This behavior can be changed per constraint using {@code &amp;#064;Constraint(validateWrappedValue = NO )}.
 *
 * @author Guillaume Smet
 * @since 2.0
 */</span>
<span class="annotation">@Target</span>({ TYPE })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation"><span class="rcl-da">@</span><span class="rcl-da">Documented</span></span>
<span class="directive">public</span> <span class="annotation">@interface</span> UnwrapByDefault {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@UnwrapByDefault</span>
<span class="type">class</span> <span class="class">WrapperExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;Wrapper&lt;<span class="annotation">@ExtractedValue</span> ?&gt;&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(Wrapper originalValue, ValueReceiver receiver) {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this extractor was identified as the single most-specific extractor for <code>StringWrapper</code> (see <a href="#appendix-valueextraction-extractorretrieval">Retrieval of extractors</a>), the <code>@Email</code> constraint above would automatically be applied to the wrapped string value.</p>
</div>
<div class="paragraph">
<p>In rare cases it may happen that a constraint should be applied to the wrapped value although an extractor exists.
In this case the <code>Unwrapping.Skip</code> payload type can be specified for that constraint to prevent the unwrapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NotNull</span>(payload = Unwrapping.Skip.class) StringWrapper email;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For the sake of readability, when applying constraints to the elements of a generic container type,
it is strongly recommended to put the constraints to the type argument instead of the element itself in conjunction with <code>Unwrapping.Unwrap</code>.
I.e. you should prefer</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="annotation">@Email</span> <span class="predefined-type">String</span>&gt; emails;</code></pre>
</div>
</div>
<div class="paragraph">
<p>over</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class)
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; emails;</code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="appendix-valueextraction-extractorretrieval"><a class="anchor" href="#appendix-valueextraction-extractorretrieval"></a>B.4.6. Retrieval of extractors</h4>
<div class="paragraph">
<p>When detecting a type argument constraint or cascade, the applicable extractor is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select all those value extractors which handle a type parameter that maps to the type argument annotated with the constraint or <code>@Valid</code> annotation;
Example:</p>
<div class="ulist">
<ul>
<li>
<p>Given <code>List&lt;@Email String&gt; emails</code> and considering the default extractors listed above, only the extractors for <code>List</code> and <code>Iterable</code> are selected.
The former handles the type parameter <code>T</code> of type <code>List</code>, which directly maps to the type argument annotated with <code>@Email</code>.
The latter handles the type parameter <code>E</code> of type <code>Iterable</code> which (indirectly) maps to the annotated type argument (as <code>List</code> extends <code>Iterable</code> and binds its type parameter <code>T</code> to <code>E</code> from <code>Iterable</code>).
Other extractors such as the ones for <code>K</code> and <code>V</code> of <code>Map</code> are dismissed, as they handle type parameters not mapping to the annotated type argument</p>
</li>
<li>
<p>Given</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class">ConfusingMap</span>&lt;K, V&gt; <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;V, K&gt; {}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ConfusingMap&lt;<span class="annotation">@Email</span> <span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; map;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And considering the default extractors listed above, only the extractor for the type parameter <code>V</code> of <code>Map</code> will be selected. This is because the <code>@Email</code> constraint is given for the type argument representing type parameter <code>K</code> of <code>ConfusingMap</code> which maps to type parameter <code>V</code> of <code>Map</code>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>From the remaining candidate value extractors choose the one which is most specific to the container type declaring the annoted type argument.
An extractor A is more specific than another extractor B if A extracts a subtype of the type extracted by B.
Example:</p>
<div class="ulist">
<ul>
<li>
<p>When obtaining the extractor for type parameter constraint validation, the declared type of the validated element is considered.
This is to be consistent with constraint validator resolution, which is based on the static type of elements, not the runtime type.</p>
</li>
<li>
<p>When obtaining the extractor for cascaded validation, the runtime type of the cascaded element is considered.
This is to be consistent with the rules defined for property path construction which are based on the runtime type.</p>
</li>
<li>
<p>From the two extractors above, the one for <code>List</code> is chosen as <code>List</code> is a subtype of <code>Iterable</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If there are several extractors which are equally specific (e.g. several extractors for <code>List</code>), an <code>UnexpectedTypeException</code> is raised.
TODO: apply rules similar to "ConstraintValidator resolution algorithm" and further clarify wording</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When detecting a regular element-level constraint (i.e. non type argument constraint) the applicable value extractor, if any, is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the constraint carries the <code>Unwrapping.Skip</code> payload, don’t apply any value extractor</p>
</li>
<li>
<p>Determine the set of uniquely mapping type parameters declared by the types in the element type’s type hierarchy; Examples:</p>
<div class="ulist">
<ul>
<li>
<p>element of type <code>java.lang.String</code>: () (empty set)</p>
</li>
<li>
<p>element of type <code>java.lang.Iterable</code>: (T)</p>
</li>
<li>
<p>element of type <code>java.lang.Map</code>: (K, V)</p>
</li>
<li>
<p>element of type <code>java.util.Collection</code>: (E) (as the type parameter <code>E</code> of <code>Collection</code> maps to <code>T</code> of <code>Iterable</code>, only the type parameter of the subtype is considered)</p>
</li>
<li>
<p><code>interface A&lt;T&gt; {}</code>, <code>interface B&lt;U&gt; {}</code>, <code>class C implements A&lt;String&gt;, B&lt;Integer&gt; {}</code>; element of type <code>C</code>: (T, U) (two non mapping type parameters)</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the constraint carries the <code>Unwrapping.Unwrap</code> payload:</p>
<div class="ulist">
<ul>
<li>
<p>If no type parameter or more than one type parameter was found in step 2, raise a <code>ConstraintDeclarationException</code></p>
</li>
<li>
<p>Choose the most specific extractor matching the single type parameter found in step 2</p>
</li>
<li>
<p>If there are several extractors which are equally specific, a <code>ConstraintDeclarationException</code> is raised.</p>
</li>
<li>
<p>If there is exactly one remaining extractor, apply this extractor</p>
</li>
<li>
<p>Otherwise, a <code>ConstraintDeclarationException</code> is raised.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the constraint neither carries the <code>Unwrapping.Unwrap</code> nor the <code>Unwrapping.Skip</code> payload:</p>
<div class="ulist">
<ul>
<li>
<p>If no type parameter or more than one type parameter was found in step 2, don’t apply any value extractor</p>
</li>
<li>
<p>Choose the most specific extractor matching the single type parameter found in step 2</p>
</li>
<li>
<p>If there are multiple such extractors, a <code>ConstraintDeclarationException</code> is raised.</p>
</li>
<li>
<p>If there is exactly one remaining extractor and it is marked with <code>UnwrapByDefault</code>, apply this extractor</p>
</li>
<li>
<p>Otherwise, no extractor is applied</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Implementation note</div>
<div class="paragraph">
<p>As extractor retrieval for type parameter constraints is done using the static type of constrained elements,
the retrieval can be done once at initialization time and then be cached.
This is not possible for retrieval of extractors for cascaded validation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_examples_2"><a class="anchor" href="#_examples_2"></a>B.4.7. Examples</h4>
<div class="ulist">
<ul>
<li>
<p>Applying a constraint to the value wrapped by a container type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Property&lt;<span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; value;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>@Valid</code> is not required; the <code>@Min</code> constraint will be validated when the <code>value</code> property is subject to validation.</p>
</div>
</li>
<li>
<p>Applying constraints to each value in a collection type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="annotation">@NotNull</span> <span class="annotation">@Email</span> <span class="predefined-type">String</span>&gt; emails;</code></pre>
</div>
</div>
</li>
<li>
<p>Cascaded validation of the values in a collection type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="annotation">@Valid</span> Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will validate the constraints on each <code>Order</code> element in the list.</p>
</div>
</li>
<li>
<p>The legacy style for cascaded validation is supported as well:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Valid</span> <span class="predefined-type">List</span>&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would also validate any constraints on a custom list type (e.g. <code>MyList#getId()</code>).
TODO: we never clarified that in 1.1. Should it be made explicit?</p>
</div>
</li>
<li>
<p>Map validation with type argument constraints and cascading:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Valid</span>
<span class="predefined-type">Map</span>&lt;<span class="annotation">@RegExp</span>(...) <span class="predefined-type">String</span>, <span class="annotation">@RetailOrder</span> Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would validate the map’s keys against <code>@RegExp</code>, the map’s values against <code>@RetailOrder</code> and apply cascaded validation of the map values (as well as the map object itself).</p>
</div>
</li>
<li>
<p>When selecting extractors, type parameters must be thoroughly traced in the hierarchy.
Consider this case where the order of the type parameters of <code>Map</code> is swapped in a sub-type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CrazyMap</span>&lt;K, V&gt; <span class="directive">implements</span> <span class="predefined-type">Map</span>&lt;V, K&gt; { ... }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Example</span> {
    <span class="directive">private</span> CrazyMap&lt;<span class="annotation">@RegExp</span>(...) <span class="predefined-type">String</span>, <span class="annotation">@Min</span>(<span class="integer">0</span>) <span class="predefined-type">Long</span>&gt; crazyMap = ...;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming there is no dedicated extractor for <code>CrazyMap</code> but only the default ones for <code>K</code> and <code>V</code> of <code>Map</code>,
extraction for <code>@RegExp</code> must happen via the default map value extractor and extraction for <code>@Min</code> via the default map key extractor.</p>
</div>
<div class="paragraph">
<p>A type parameter in a sub-type may also map to several type parameters in a super-type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class">NumericMap</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Number</span>&gt; <span class="directive">extends</span> <span class="predefined-type">Map</span>&lt;T, T&gt; {}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> NumericMap&lt;<span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; integerMap;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Min</code> constraint is to be applied to the map’s keys and values as the annotated type parameter maps to <code>K</code> and <code>V</code> of <code>Map</code>.</p>
</div>
</li>
<li>
<p>type argument constraints can be applied to the elements of <code>Object</code> arrays and arrays of any primitive type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> <span class="annotation">@Email</span><span class="type">[]</span> emails;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="type">[]</span> positiveNumbers;</code></pre>
</div>
</div>
</li>
<li>
<p>The extractor for cascaded validation is determined based on an element’s runtime type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Collection</span>&lt;<span class="annotation">@Valid</span> Order&gt; orders = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the most-specific extractor for the runtime type <code>ArrayList</code> must be applied, causing the property nodes of violations to have an index set (<code>Node#getIndex()</code>).</p>
</div>
</li>
<li>
<p>The container value passed to a value extractor is retrieved from the element that has the type argument carrying the constraint or <code>@Valid</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="annotation">@Valid</span> <span class="annotation">@RetailOrder</span> Order&gt; ordersByName;

<span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="annotation">@NotNull</span> <span class="predefined-type">String</span>, Order&gt; getOrdersByName() {
    <span class="keyword">return</span> ordersByName;
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When validating the <code>@NotNull</code> constraint, the map as returned by the getter will be passed to the map key extractor in order to obtain the map keys.
When validating the <code>@RetailOrder</code> constraint and performing cascaded validation,
the map as obtained directly from the field will be passed to the map value extractor in order to obtain the map values.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom extractor for a <code>Tuple</code> type:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Tuple</span>&lt;T1, T2&gt; {
    T1 getFirst();
    T2 getSecond();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TupleFirstExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;Tuple&lt;<span class="annotation">@ExtractedValue</span> ?, ?&gt;&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(Tuple&lt;?, ?&gt; originalValue, ValueReceiver receiver) {
        receiver.value( <span class="string"><span class="delimiter">"</span><span class="content">&lt;first&gt;</span><span class="delimiter">"</span></span>, originalValue.getFirst() );
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TupleSecondExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;Tuple&lt;?, <span class="annotation">@ExtractedValue</span> ?&gt;&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(Tuple&lt;?, ?&gt; originalValue, ValueReceiver receiver) {
        receiver.value( <span class="string"><span class="delimiter">"</span><span class="content">&lt;second&gt;</span><span class="delimiter">"</span></span>, originalValue.getSecond() );
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> Tuple&lt;<span class="annotation">@NotNull</span> <span class="annotation">@Email</span> <span class="predefined-type">String</span>, <span class="annotation">@NotNull</span> <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; tuple;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_examples_for_extractor_retrieval"><a class="anchor" href="#_examples_for_extractor_retrieval"></a><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.7.1</span><span class="rcl-da">.</span> Examples for extractor retrieval</h5>
<div class="ulist">
<ul>
<li>
<p>The most specific extractor matching the constrained type argument is chosen:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="annotation">@Email</span> <span class="predefined-type">String</span>&gt; emails;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Based on the algorithm described above and considering the mandated default extractors, only the extractor for <code>List</code> and <code>Iterable</code> are candidate extractors (all other extractors are defined for a type parameter not mapping to <code>T</code> of <code>List</code>). The extractor for <code>List</code> will be applied as it’s more specific than the extractor for <code>Iterable</code> (<code>List</code> is a subtype of <code>Iterable</code>).</p>
</div>
</li>
<li>
<p>Constraints targeting wrapped values can be given on the wrapping element.
Let there be these definitions:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">StringWrapper</span> {
    <span class="predefined-type">String</span> wrapped;
};</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@UnwrapByDefault</span>
<span class="type">class</span> <span class="class">StringWrapperExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="annotation">@ExtractedValue</span> StringWrapper&gt; { ... }
};</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="annotation">@Email</span> StringWrapper email;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Email</code> constraint will be applied to the wrapped string and can be validated as the extractor defines that element-level constraints should be applied to the wrapped value.</p>
</div>
<div class="paragraph">
<p>If the extractor were not decorated with <code>@UnwrapByDefault</code> an exception would be raised as there is no validator for <code>@Email</code> on <code>StringWrapper</code>.</p>
</div>
<div class="paragraph">
<p>Unwrapping could be mandated explicitly in this case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class)
<span class="directive">private</span> StringWrapper email;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_invalid_examples"><a class="anchor" href="#_invalid_examples"></a><span class="rcl-da">B</span><span class="rcl-da">.</span><span class="rcl-da">4.7.2</span><span class="rcl-da">.</span> Invalid examples</h5>
<div class="ulist">
<ul>
<li>
<p>No most specific extractor can be found unambiguously:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">CachedValue</span>&lt;V&gt; {
    V getCachedValue();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">RealValue</span>&lt;V&gt; {
    V getRealValue();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CachableValue</span>&lt;V&gt; <span class="directive">implements</span> CachedValue&lt;V&gt;, RealValue&lt;V&gt; { ... }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CachedValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;CachedValue&lt;<span class="annotation">@ExtractedValue</span> ?&gt;&gt; { ... }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">RealValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;RealValue&lt;<span class="annotation">@ExtractedValue</span> ?&gt;&gt; { ... }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> CachableValue&lt;<span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; foo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validation of <code>foo</code> will fail, as none of the two matching extractors is more specific than the other one.
An extractor for <code>CachableValue</code> must be added, resolving the ambiguity.</p>
</div>
</li>
<li>
<p>Element-level constraints cannot be applied if there is no type parameter at all or multiple non-mapping type parameters in the annotated element’s type hierarchy.
Thus an exception will be raised in the following cases:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// no type parameter</span>
<span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class)
<span class="directive">private</span> <span class="predefined-type">String</span> email;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// multiple type parameters</span>
<span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class)
<span class="directive">private</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; emails;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xml_based_configuration"><a class="anchor" href="#_xml_based_configuration"></a>B.4.8. XML based configuration</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="_metadata_retrieval"><a class="anchor" href="#_metadata_retrieval"></a>B.4.9. Metadata retrieval</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="_misc"><a class="anchor" href="#_misc"></a>B.4.10. Misc.</h4>
<div class="ulist">
<ul>
<li>
<p>Regarding group sequences and default group sequences, the same rules apply for type argument constraints as they apply for regular element-level constraints.</p>
</li>
<li>
<p>For the conversion of validation groups the same rules apply no matter whether <code>@Valid</code> is given for a regular element or for a type argument.
I.e. the following group conversion declaration is valid:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="annotation">@Valid</span> <span class="annotation">@ConvertGroup</span>(from=Default.class, to=Other.class) Order&gt; orders;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extensions_to_the_exception_model"><a class="anchor" href="#_extensions_to_the_exception_model"></a>B.5. Extensions to the exception model</h3>
<div class="paragraph">
<p>A <code>ValueExtractorDefinitionException</code> will be raised when detecting an illegal value extractor definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">javax.validation.valueextraction</span>;

<span class="comment">/**
 * Raised if a {@link ValueExtractor} definition is illegal, e.g. because it doesn't declare its extracted value using
 * {@link ExtractedValue}.
 *
 * @author Gunnar Morling
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ValueExtractorDefinitionException</span> <span class="directive">extends</span> ValidationException {

    <span class="directive">public</span> ValueExtractorDefinitionException() {
        <span class="local-variable">super</span>();
    }

    <span class="directive">public</span> ValueExtractorDefinitionException(<span class="predefined-type">String</span> message) {
        <span class="local-variable">super</span>( message );
    }

    <span class="directive">public</span> ValueExtractorDefinitionException(<span class="predefined-type">Throwable</span> cause) {
        <span class="local-variable">super</span>( cause );
    }

    <span class="directive">public</span> ValueExtractorDefinitionException(<span class="predefined-type">String</span> message, <span class="predefined-type">Throwable</span> cause) {
        <span class="local-variable">super</span>( message, cause );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reasons for raising this exception include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The extracted type is not marked with <code>@ExtractedValue</code></p>
</li>
<li>
<p>The <code>@ExtractedValue</code> annotation is given more than once for one value extractor type</p>
</li>
<li>
<p>A non-wildcard type parameter has been marked with <code>@ExtractedValue</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_open_questions"><a class="anchor" href="#_open_questions"></a>B.6. Open questions</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should nested containers be supported: <code>List&lt;Map&lt;String, @NotNull String&gt;&gt; addressesByType</code>?
Or <code>Optional&lt;List&lt;@Email&gt;&gt; optionalEmails</code>;
The latter seems very reasonable.</p>
</li>
<li>
<p><span class="line-through"><code>ConstraintsApplyTo</code> only allows one behavior per annotated element. Should it be per constraint?</span>
<span class="line-through">E.g. for <code>@NotNull @Email StringProperty email</code> it may be desirable to apply <code>@NotNull</code> to the wrapper but <code>@Email</code> to the wrapped value. That’s not possible currently.</span></p>
<div class="paragraph">
<p><em>For the first draft we settled for using dedicated <code>Payload</code> types to control the unwrapping behavior.</em>
<em>While not ideal, this provides the required level of control.</em>
<em>Discussed alternatives include a new constraint member <code>boolean validateWrappedValue()</code>, but this requires to update every existing constraint and adds a lot of "weight" for a rather small corner case.</em>
<em>Any approach using a separate annotation fails as there is no way to clearly identify the targeted constraint annotation, as annotations cannot obtained from an element in a guaranteed order</em>.</p>
</div>
</li>
<li>
<p><span class="line-through">Should <code>ConstraintsApplyTo</code> also be used for tagging extractors triggering "auto-extraction". Maybe a separate annotation would be less confusing, e.g. <code>@AutoExtract</code> or so?</span></p>
<div class="paragraph">
<p><em>This is done by <code>@UnwrapByDefault</code> now which solely exists for this purpose.</em></p>
</div>
</li>
<li>
<p>Should a path node be added for type argument constraints of <code>Optional</code> and similar types?</p>
<div class="paragraph">
<p><em>This proposal suggests to not do it, but Emmanuel is not convinced of this</em>.</p>
</div>
</li>
<li>
<p><span class="line-through">Should value extractors be discoverable via the service loader mechanism (i.e. by means of <code>META-INF/services/javax.validation.valueextraction.ValueExtractor</code> files)</span></p>
<div class="paragraph">
<p><span class="line-through">Pro: It’d allow 3rd party libs such as Google Guava to provide custom extractors for their container types and have them automatically be applied without any effort for the user.</span></p>
</div>
<div class="paragraph">
<p><span class="line-through">Cons: Need a way to disable or override some extractors with others. Which might make it a nogo.</span></p>
</div>
<div class="paragraph">
<p><em><span class="rcl-da">Added</span> <span class="rcl-da">service</span> <span class="rcl-da">loader</span> <span class="rcl-da">mechanism</span> <span class="rcl-da">as</span> <span class="rcl-da">source</span> <span class="rcl-da">of</span> <span class="rcl-da">value</span> <span class="rcl-da">extractors</span><span class="rcl-da">.</span> <span class="rcl-da">Specified</span> <span class="rcl-da">order</span> <span class="rcl-da">of</span> <span class="rcl-da">precedence</span><span class="rcl-da">.</span></em></p>
</div>
</li>
<li>
<p>What to return from <code>PropertyDescriptor#getElementClass()</code> if there is a field of type <code>Foo</code> but a getter of type <code>Optional&lt;Foo&gt;</code>.
So far, BV assumed the types of field and getter to be the same and exposed a single property descriptor
(which btw. also may fall apart as of BV 1.1 when the field is of a sub-type of the getter’s type).
What to return here?</p>
</li>
<li>
<p><span class="line-through">Should the presence of type argument constraints alone trigger cascaded validation?</span></p>
<div class="paragraph">
<p><span class="line-through">E.g. consider the case of <code>Tuple</code> above:</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Tuple&lt;<span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>, <span class="annotation">@Email</span> <span class="predefined-type">String</span>&gt; tuple;</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="line-through"><em>Here it may be nice to validate e.g. <code>@NotNull</code> constraints given within the <code>Tuple</code> class itself when validating the type argument constraints. With the current proposal their validation requires a separate <code>@Valid</code> on the element. Personally I think that’s better (more consistent)</em>.</span></p>
</div>
<div class="paragraph">
<p><em>We agreed to require <code>@Valid</code> for the sake of consistency.</em></p>
</div>
</li>
<li>
<p>For an element with a type argument, should it be allowed to specify constraints on the element (and use the <code>Unwrapping.Unwrap</code> payload) or should it be disallowed?</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Email</span>(payload = Unwrapping.Unwrap.class) Optional&lt;<span class="predefined-type">String</span>&gt; email;</code></pre>
</div>
</div>
</li>
<li>
<p><span class="line-through">Should we allow extractors to be defined for specific parameterized types, e.g.:</span></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ListOfIntegerExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="predefined-type">List</span>&lt;<span class="annotation">@ExtractedValue</span> <span class="predefined-type">Integer</span>&gt;&gt; { ... }

<span class="directive">public</span> <span class="type">class</span> <span class="class">ListOfStringExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;<span class="predefined-type">List</span>&lt;<span class="annotation">@ExtractedValue</span> <span class="predefined-type">String</span>&gt;&gt; { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="line-through">Currently, only one extractor (for type <code>List&lt;?&gt;</code> is allowed).</span></p>
</div>
<div class="paragraph">
<p><span class="line-through"><em>I can’t see a compelling use case for this (when would extractor behavior differ between different parameterizations of the same generic type) and am leaning towards only supporting the wildcard parameterization (<code>implements ValueExtractor&lt;List&lt;@ExtractedValue ?&gt;&gt;</code>)</em>.</span></p>
</div>
<div class="paragraph">
<p><em>We agreed on only allowing one extractor per type, to be given using the wildcard parameterization, as we cannot see a use case for having multiple extractors right now.</em>
<em>But if needed, this limitation can be lifted in a future revision.</em></p>
</div>
</li>
<li>
<p>Can we find another name than "type argument constraints"? While that suits for the most cases, it doesn’t when applying constraints to the component type of an array: <code>String @NotBlank [] names</code>.</p>
<div class="paragraph">
<p><em>I think "type use" is the correct one in Java terminology. But would anyone get what a "type use constraint" is?</em>.</p>
</div>
</li>
<li>
<p>Vet the API by exploring advanced use cases, e.g. Guava’s <a href="https://github.com/google/guava/wiki/NewCollectionTypesExplained#table">Table</a>, <a href="http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/graph/Graph.html">Graph</a>, <a href="http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/graph/ValueGraph.html">ValueGraph</a> and <a href="http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/graph/Network.html">Network</a> types.</p>
<div class="paragraph">
<p>Example for <code>Table</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">TableValueExtractor</span> <span class="directive">implements</span> ValueExtractor&lt;Table&lt;?, ?, <span class="annotation">@ExtractedValue</span> ?&gt;&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> extractValues(Table&lt;?, ?, ?&gt; originalValue, ValueExtractor.ValueReceiver receiver) {

        <span class="keyword">for</span> ( Cell&lt;?, ?, ?&gt; cell : originalValue.cellSet() ) {
            receiver.keyedValue(
                    <span class="string"><span class="delimiter">"</span><span class="content">&lt;table cell&gt;</span><span class="delimiter">"</span></span>,
                    <span class="keyword">new</span> CellKey( cell.getRowKey(), cell.getColumnKey() ),
                    cell.getValue()
            );
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">CellKey</span> {

    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Object</span> rowKey;
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Object</span> columnKey;

    <span class="directive">public</span> CellKey(<span class="predefined-type">Object</span> rowKey, <span class="predefined-type">Object</span> columnKey) {
        <span class="local-variable">this</span>.rowKey = rowKey;
        <span class="local-variable">this</span>.columnKey = columnKey;
    }

    <span class="comment">// equals(), hashCode() ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When having an invalid table cell in the following and validating it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {

    Table&lt;Year, <span class="predefined-type">String</span>, <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; revenuePerYearAndCategory = HashBasedTable.create();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then this will be the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ConstraintViolation&lt;Customer&gt; violation = ...;

<span class="predefined-type">Iterator</span>&lt;Node&gt; path = violation.getPropertyPath().iterator();

Node node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">revenuePerYearAndCategory</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.PROPERTY );
assertThat( node.getKey() ).isNull();
assertThat( node.getIndex() ).isNull();

node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">&lt;table cell&gt;</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.<span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span> );
assertThat( node.getKey() ).isEqualTo( <span class="keyword">new</span> CellKey(Year.of( <span class="integer">2015</span> ), <span class="string"><span class="delimiter">"</span><span class="content">cds</span><span class="delimiter">"</span></span>) );
assertThat( node.getIndex() ).isNull();

assertThat( path.hasNext() ).isFalse();</code></pre>
</div>
</div>
</li>
<li>
<p>In the original proposal it was foreseen that <code>@ExtractedValue</code> could refer to type-parameters from super-types. Is that still needed?</p>
</li>
<li>
<p>During cascaded validation of an element with several type arguments, it’s currently not possible to tell from the resulting constraint violation and its node path which type argument was cascaded.
Example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="annotation">@Valid</span> OrderType, <span class="annotation">@Valid</span> Order&gt; ordersByType;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there was constraint violation on an <code>OrderType</code> property and one on an <code>Order</code> property, one couldn’t tell from the resulting paths and their nodes which is which.</p>
</div>
<div class="paragraph">
<p><em>One way out could be to add <code>TypeVariable&lt;?&gt; Node#getTypeParameter()</code> </em>.</p>
</div>
<div class="paragraph">
<p><em>This would return the type parameter handled by the extractor used for obtaining the cascaded value</em>.
<em> <code>Node#getTypeParameter()</code> would also return the type parameter for type argument constraints</em>.
<em>Note it must be <code>getTypeParameter()</code> (not <code>getTypeArgument()</code>) because one annotated type argument at the constrained/cascaded element could represent multiple type parameters (see example "A type parameter in a sub-type may also map to several type parameters in a super-type" above).</em>
<em>Assuming a constraint violation on property <code>description</code> of class <code>OrderType</code> we’d get</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ConstraintViolation&lt;Customer&gt; violation = ...;

<span class="predefined-type">Iterator</span>&lt;Node&gt; path = violation.getPropertyPath().iterator();

Node node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">ordersByType</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.PROPERTY );
assertThat( node.getKey() ).isNull();
assertThat( node.getIndex() ).isNull();
assertThat( node.getTypeParameter() ).isNull();

node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">description</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.PROPERTY );
assertThat( node.getKey() ).isEqualTo( <span class="keyword">new</span> OrderType( <span class="string"><span class="delimiter">"</span><span class="content">RETAIL</span><span class="delimiter">"</span></span> ) );
assertThat( node.getIndex() ).isNull();
assertThat( node.getTypeParameter().getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">K</span><span class="delimiter">"</span></span> );

assertThat( path.hasNext() ).isFalse();</code></pre>
</div>
</div>
<div class="paragraph">
<p><em> <code>getTypeParameter()</code> would also return the type parameter in case of type argument constraints:</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;OrderType, <span class="annotation">@Min</span>(<span class="integer">1</span>) <span class="predefined-type">Integer</span>&gt; orderQuantitiesByType;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ConstraintViolation&lt;Customer&gt; violation = ...;

<span class="predefined-type">Iterator</span>&lt;Node&gt; path = violation.getPropertyPath().iterator();

Node node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">orderQuantitiesByType</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.PROPERTY );
assertThat( node.getKey() ).isNull();
assertThat( node.getIndex() ).isNull();
assertThat( node.getTypeParameter() ).isNull();

node = path.next();
assertThat( node.getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">&lt;map value&gt;</span><span class="delimiter">"</span></span> );
assertThat( node.getKind() ).isEqualTo( ElementKind.<span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span> );
assertThat( node.getKey() ).isEqualTo( <span class="keyword">new</span> OrderType( <span class="string"><span class="delimiter">"</span><span class="content">RETAIL</span><span class="delimiter">"</span></span> ) );
assertThat( node.getIndex() ).isNull();
assertThat( node.getTypeParameter().getName() ).isEqualTo( <span class="string"><span class="delimiter">"</span><span class="content">V</span><span class="delimiter">"</span></span> );

assertThat( path.hasNext() ).isFalse();</code></pre>
</div>
</div>
</li>
<li>
<p>Revisit the names of nodes of kind <code><span class="rcl-da">CONTAINER</span><span class="rcl-dd">TYPE</span>_<span class="rcl-da">ELEMENT</span><span class="rcl-dd">ARGUMENT </span></code>;
instead of <code>&lt;iterable element&gt;</code>, <code>&lt;map value&gt;</code> etc. should it be the names of the type parameters in question, i.e. <code>&lt;E&gt;</code>, <code>&lt;V&gt;</code> etc.?</p>
</li>
</ol>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="standard-resolver-messages"><a class="anchor" href="#standard-resolver-messages"></a>Appendix C: Standard ResourceBundle messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The properties listed below are resolved by the default message interpolator.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JAVA">javax.validation.constraints.AssertFalse.message=must be <span class="predefined-constant">false</span>
javax.validation.constraints.AssertTrue.message=must be <span class="predefined-constant">true</span>
javax.validation.constraints.DecimalMax.message=\
    must be less than <span class="error">$</span>{inclusive == <span class="predefined-constant">true</span> ? <span class="string"><span class="delimiter">'</span><span class="content">or equal to </span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>}{value}
javax.validation.constraints.DecimalMin.message=\
    must be greater than <span class="error">$</span>{inclusive == <span class="predefined-constant">true</span> ? <span class="string"><span class="delimiter">'</span><span class="content">or equal to </span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>}{value}
javax.validation.constraints.Digits.message=\
    numeric value out of bounds (&lt;{integer} digits&gt;.&lt;{fraction} digits&gt; expected)
javax.validation.constraints.<span class="rcl-da">Email</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">=</span><span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">a</span> <span class="rcl-da">well-formed</span> <span class="rcl-da">email</span> <span class="rcl-da">address</span>
<span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span>Future.message=must be a future date
javax.validation.constraints.Max.message=must be less than or equal to {value}
javax.validation.constraints.Min.message=must be greater than or equal to {value}
javax.validation.constraints.<span class="rcl-da">Negative</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">=\</span>
    <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">less</span> <span class="rcl-da">than</span> <span class="error"><span class="rcl-da">$</span></span><span class="rcl-da">{</span><span class="rcl-da">strict</span> <span class="rcl-da">==</span> <span class="predefined-constant"><span class="rcl-da">true</span></span> <span class="rcl-da">?</span> <span class="string"><span class="delimiter"><span class="rcl-da">'</span></span><span class="delimiter"><span class="rcl-da">'</span></span></span> <span class="rcl-da">:</span> <span class="string"><span class="delimiter"><span class="rcl-da">'</span></span><span class="content"><span class="rcl-da">or</span> <span class="rcl-da">equal</span> <span class="rcl-da">to</span> </span><span class="delimiter"><span class="rcl-da">'</span></span></span><span class="rcl-da">}</span><span class="integer"><span class="rcl-da">0</span></span>
<span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">NotBlank</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">=</span><span class="rcl-da">must</span> <span class="rcl-da">not</span> <span class="rcl-da">be</span> <span class="rcl-da">blank</span>
<span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span><span class="rcl-da">NotEmpty</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">=</span><span class="rcl-da">must</span> <span class="rcl-da">not</span> <span class="rcl-da">be</span> <span class="rcl-da">empty</span>
<span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span>NotNull.message=must not be <span class="predefined-constant">null</span>
javax.validation.constraints.Null.message=must be <span class="predefined-constant">null</span>
javax.validation.constraints.Past.message=must be a past date
javax.validation.constraints.Pattern.message=\
    must match the following regular expression: {regexp}
javax.validation.constraints.<span class="rcl-da">Positive</span><span class="rcl-da">.</span><span class="rcl-da">message</span><span class="rcl-da">=\</span>
    <span class="rcl-da">must</span> <span class="rcl-da">be</span> <span class="rcl-da">greater</span> <span class="rcl-da">than</span> <span class="error"><span class="rcl-da">$</span></span><span class="rcl-da">{</span><span class="rcl-da">strict</span> <span class="rcl-da">==</span> <span class="predefined-constant"><span class="rcl-da">true</span></span> <span class="rcl-da">?</span> <span class="string"><span class="delimiter"><span class="rcl-da">'</span></span><span class="delimiter"><span class="rcl-da">'</span></span></span> <span class="rcl-da">:</span> <span class="string"><span class="delimiter"><span class="rcl-da">'</span></span><span class="content"><span class="rcl-da">or</span> <span class="rcl-da">equal</span> <span class="rcl-da">to</span> </span><span class="delimiter"><span class="rcl-da">'</span></span></span><span class="rcl-da">}</span><span class="integer"><span class="rcl-da">0</span></span>
<span class="rcl-da">javax</span><span class="rcl-da">.</span><span class="rcl-da">validation</span><span class="rcl-da">.</span><span class="rcl-da">constraints</span><span class="rcl-da">.</span>Size.message=size must be between {min} and {max}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-jpa"><a class="anchor" href="#appendix-jpa"></a>Appendix D: Java Persistence 2.0 and schema generation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While not specified by this specification or the Java Persistence 2.0 specification, Persistence Providers are encouraged to make use of Bean Validation constraint metadata when generating DDL schemas. The proposal is as followed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Ideas explored and not standardized

Java Persistence consumes Bean Validation (BV) metadata to enhance persistence property
metadata.

A Persistence provider must use the BV metadata of a given list of groups.
The default group evaluated is Default (default BV group). Groups evaluated
can be overridden by a property.
This property contains the comma separated groups (fully qualified class name).

For each entity, apply the following algorithm.
For each persistent property in a given entity:
 - extract the list of BV constraints (including the composing constraints)
 - determine the subset of applicable constraints
    (i.e. constraints understood by the persistence provider)
 - apply these constraints on the persistent property metadata
 - if the property type is an embeddable object or a collection
of embeddable objects, apply the algorithm on the embeddable object properties.

The list of constraints that must be understood by persistence providers are
as followed:
 - @NotNull should be considered equivalent to @Column(nullable=false) /
     @JoinColumn(nullable=false)
 - @Size.max should be considered equivalent to @Column.length
     for String properties
 - @Digits (which contains integer and fraction) should be considered
     equivalent to @Column.precision = integer+fraction,
     @Column.scale = fraction for decimal columns

The BV annotation metadata should have priority over JPA metadata
(JPA has no sensible "unset" values on their annotations).

Question: should we add @Unique that would map to @Column(unique=true)?
@Unique cannot be tested at the Java level reliably but could generate
a database unique constraint generation. @Unique is not part
of the BV spec today.

Persistence Provider should optionally recognize and try to apply the
following constraints as well:
 - @Min / @Max on numeric columns (TODO String too?)
 - @Future / @Past on temporal columns
 - @Size for collections and array (not sure it is feasible).

Persistence Providers can also apply non standard constraints to their metadata model.
For example, provider ACME might recognize and understand @com.acme.validation.Email
and apply it to the database model.

While most high level constraints will not be recognized, the BV built-in constraints
will be the common language spoken by Persistence Providers. Any high level constraint
can be composed of more modular constraints (constraint composition).

* additional proposal
In case of a constraint violation report detected and generated by the database
(not null, etc), the Java persistence provider catches this report and translates
it into a BV error report. From the perspective of the application, constraint
errors are viewed through a unified layer. BV must provide some API to create a
constraint violation error (constraintDescriptor.createConstraintViolation(…​)).

While this proposal has a lot of value-add, I wonder how difficult it can be to
implement this in persistence providers.

Provide a way to disable BV metadata use by a persistence provider (property based).</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is not an endorsement of the Java Persistence expert group or the Bean Validation expert group. Such approach may or may not be standardized in the future. Such integration should not be considered portable.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="changelog"><a class="anchor" href="#changelog"></a>Appendix E: Changelog</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="title">Example <span class="rcl-da">135</span><span class="rcl-dd">130</span>. Changelog</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>2.0.0.Alpha1 (Early Draft 1, 2017-02-02)

** Bug
    * [BVAL-558] - Ensure correct concurrent access to cacheValidationProviders in Validation#GetValidationProviderListAction

** New Feature
    * [BVAL-467] - Support JDK8's Optional class
    * [BVAL-496] - @Future/@Past validators for JSR 310 data types
    * [BVAL-497] - Mark BV-defined constraint types with @Repeatable
    * [BVAL-498] - Retrieve method parameter names via new API in Java 8
    * [BVAL-508] - Offer validation of values contained in containers
    * [BVAL-544] - Promote TYPE_USE usage for constraint annotations
    * [BVAL-550] - Make @ConvertGroup repeatable and usable on type arguments

** Task
    * [BVAL-509] - Make BVAL compilable with Java 9
    * [BVAL-512] - Provide a way to reference validation-api source code in the spec
    * [BVAL-513] - Add Google Analytics to HTML version of the specification
    * [BVAL-538] - Rename createTckAuditFile ant task to create-tck-audit-file for consistency
    * [BVAL-540] - Use Maven to download the snapshot of the API sources
    * [BVAL-541] - Change CI links in README.md
    * [BVAL-547] - Use simplified license header for API files
    * [BVAL-554] - Add the ability to generate an asciidoc document containing all the spec in a single file

** Improvement
    * [BVAL-455] - Move XML namespace to jcp.org from jboss.org
    * [BVAL-460] - Set ignore-annotation default value for beans to true in XSD to document the spec behavior
    * [BVAL-486] - Do not use validation provider resolver when provider is explicitly given
    * [BVAL-527] - Raise Java baseline to version 8
    * [BVAL-529] - Mention JSR 380 and BV 2.0 in the spec
    * [BVAL-530] - Rename master.asciidoc to index.asciidoc
    * [BVAL-532] - Fix javadoc warnings
    * [BVAL-533] - Update Maven dependencies
    * [BVAL-534] - Update all outdated links to java.sun.com
    * [BVAL-535] - Reduce the number of compilation warnings in the API
    * [BVAL-536] - Update tck-audit.xsl to the current version of BV
    * [BVAL-537] - Make section numbers stable from 1.1 to 2.0
    * [BVAL-539] - Set the version of the maven-deploy-plugin
    * [BVAL-545] - Fix description of validateValue() method
    * [BVAL-546] - Make ValidatorFactory extend AutoClosable
    * [BVAL-555] - Provide default implementation for ConstraintValidator#initialize()


1.1.0.Final (2013-04-10)
------------------------

** Improvement
    * [BVAL-452] - Remove @Deprecate annotation from addNode() method


1.1.0.CR3 (2013-03-20)
----------------------

** Bug
    * [BVAL-444] - Remove revisionflags from specification
    * [BVAL-445] - Do not consider arrays of primitives equivalent to arrays of wrappers in ConstraintValidation resolution

** Improvement
    * [BVAL-448] - Mention "boolean" instead of "Boolean" in getter definition
    * [BVAL-450] - Make @ValidateOnExecutable for @Override methods raise an exception

** Task
    * [BVAL-449] - Remove tck-needs-update


1.1.0.CR2 (2013-03-14)
----------------------

** Bug
    * [BVAL-431] - Typo in EL expression exemple
    * [BVAL-435] - Rename element &lt;validated-executables/&gt; to &lt;default-validated-executable-types/&gt;
    * [BVAL-436] - Offer global switch to disable executable validation altogether
    * [BVAL-437] - Redesign @ValidateExecutable into @ValidateOnExecution and as CDI marker for portability

** Improvement
    * [BVAL-420] - Add missing @since in metadata package
    * [BVAL-421] - Clarify whether or not getters are provided by the metadata API
    * [BVAL-422] - Update TCK markers
    * [BVAL-423] - Clarify behavior of ConstraintViolation#getLeafBean() for validateValue()
    * [BVAL-424] - Refer to @SupportedValidationTarget in ConstraintValidation JavaDoc
    * [BVAL-429] - Throw a ConstraintDefinitionException if there a several cross-parameter validators
    * [BVAL-432] - Rename areParametersConstrained to hasConstrainedParameters and isReturnValueConstrained to hasConstrainedReturnValue on ExecutableDescriptor
    * [BVAL-433] - Forbid @ValidatedExecutable on methods of parallel hierarchies
    * [BVAL-434] - Clarify exception type if cross-parameter validator support neither Object nor Object[]
    * [BVAL-440] - Improve description of ExecutableType.GETTER_METHODS
    * [BVAL-442] - Make getConstrainedMethods(MethodType methodType, MethodType... methodTypes) to be less error-prone

** New Feature
    * [BVAL-441] - Allow for identical configuration in subtypes

** Task
    * [BVAL-425] - Raise IllegalArgumentException when validateParameters and validateReturnValue are passed parameters that do not match
    * [BVAL-428] - Map remaining assertions for BV 1.1
    * [BVAL-438] - Integration chapter should not mention that the boostrap API can be used to create additional ValidationFactory
    * [BVAL-439] - Clarify that EE validator factory supports CDI services


1.1.0.CR1 (proposed final draft, 2013-02-20)
--------------------------------------------

** Bug
    * [BVAL-322] - Formatting and style improvements
    * [BVAL-369] - Specify copyright year correctly in license headers
    * [BVAL-391] - Use @SupportValidationTarget instead of @CrossParameterConstraint for cross-parameter constraint validators
    * [BVAL-397] - Align the JavaDoc on temps (return vs returns, define vs defines)
    * [BVAL-401] - validateReturnValue should not throw an exception if the method has no return value
    * [BVAL-402] - Remove notion of "reachable" parameters in method validation routine
    * [BVAL-403] - Add example on method validation to 4.6.3. ("Traversable property")
    * [BVAL-407] - ConstraintViolation.unwrap parameterized type hides ConstraintViolation parameterized type

** Improvement
    * [BVAL-275] - Align on style for referencing methods in spec text
    * [BVAL-277] - Align on style for author names in JavaDoc
    * [BVAL-285] - ValidatorFactory#close should clearly state post conditions
    * [BVAL-350] - Add more examples on how to use methods for validating method and constructor constraints
    * [BVAL-362] - Reference the various specs (JPA, JSF, CDI, JavaBeans)
    * [BVAL-400] - Add xml and exception chapters to the list in "How this document is organized"
    * [BVAL-404] - Path examples in table 5.2 are missing node specific attributes like parameterIndex
    * [BVAL-405] - Clarify what isBeanConstrained does and add hasExecutableConstrained
    * [BVAL-406] - Add ConstraintDescriptor.getValidationAppliesTo() and getMessageTemplate()
    * [BVAL-409] - Make ParameterNameProvider use List instead of arrays
    * [BVAL-410] - Make node creation suppress the cross-param and bean-level node in case of subnode creation
    * [BVAL-412] - Make &lt;convert-group/&gt; follow &lt;valid/&gt; and precede &lt;constraint/&gt; in the mapping XSD
    * [BVAL-413] - Fix method validation and ConstraintViolation example
    * [BVAL-414] - Add example for metadata API with executables
    * [BVAL-415] - Make sure maven plugins are set in beanvalidation-api
    * [BVAL-417] - Mention "validationAppliesTo" in docs of @SupportedValidationTarget
    * [BVAL-419] - Clarify that using a cross-parameter constraint on a method without parameter is illegal


1.1.0.Beta4 (2013-02-15)
------------------------

** Sub-task
    * [BVAL-316] - Decide on whether to allow validation of static methods or not
    * [BVAL-330] - Refinements around metadata API

** Bug
    * [BVAL-221] - The constraint violation builder cannot put constraint on a top level map key
    * [BVAL-283] - Clarify that ConstraintValidator instances must be destroyed after each method validation call if the ConstraintValidatorFactory is provided to the Validator
    * [BVAL-284] - Clarify that ConstraintValidator instances passed to CVF.releaseInstance must be coming from the CVF creating them
    * [BVAL-326] - Fix metadata and error reports for cross-parameter validation
    * [BVAL-328] - Add recommendation that @Inherited shouldn't be added to constraint annotation types
    * [BVAL-337] - Clarifications around ConstraintViolation for method validation
    * [BVAL-370] - Re-consider how cross-parameter constraints are represented in metadata API and XML descriptors
    * [BVAL-375] - Add dedicated "validationAppliesTo" element to schema type representing constraints
    * [BVAL-378] - Mismatch between enum ExecutableType and corresponding schema type
    * [BVAL-380] - Remove improper sentence around constraint being validated once globally in validation routine
    * [BVAL-381] - Specify which path is pathed to traversable resolvers in case of cascaded method validation
    * [BVAL-388] - Create sub-types of Node instead of Node#getElementDescriptor() and remove ElementDescriptor.getKind()
    * [BVAL-389] - @ValidateExecutable.type should default to ALL and NONE should be renamed OFF
    * [BVAL-390] - Clarify syntax for specifying parameter types in XML
    * [BVAL-393] - Revert "intersection type trick"

** Improvement
    * [BVAL-191] - Introduce a addBeanNode() method to the fluent node builder API
    * [BVAL-269] - Polish support for dependency injection after draft feedback
    * [BVAL-336] - Decide what to do about element descriptor when using constraint violation builder API
    * [BVAL-344] - Improve wording around CDI integration
    * [BVAL-368] - Return constant value from Node#getName() for return value nodes
    * [BVAL-372] - Consider moving ExecutableValidator to the executable subpackage
    * [BVAL-379] - Clarify that modifications to BootstrapConfiguration have no effect
    * [BVAL-384] - Add example for ElementDescriptor#findConstraints() for methods
    * [BVAL-385] - Return void ReturnValueDescriptor from ExecutableDescriptor#getReturnValueDescriptor() for void methods
    * [BVAL-386] - Clarify that CDI integration is mandatory under Java EE only
    * [BVAL-398] - Make validateReturnValue raise ValidationException if the method has no return value

** New Feature
    * [BVAL-329] - Method validation support (III)
    * [BVAL-383] - Add a  unwrap method in ConstraintViolation
    * [BVAL-387] - Add ability to add a node corresponding to a parameter in ConstraintViolationBuilder

** Task
    * [BVAL-394] - Verify that we don't need a spec defined API to expose classes hosting constrained methods or constructor defined in XML


1.1.0.Beta3 (2013-02-01)
------------------------

** Sub-task
    * [BVAL-273] - Extend the XML descriptor schema to represent method-level constraints
    * [BVAL-314] - Provide ability to disable validation for method/constructor validation

** Bug
    * [BVAL-327] - Provide way to change the executable validation (ie accept getters)
    * [BVAL-342] - Clarify that validateProperty / validateValue does not support property paths
    * [BVAL-343] - "Provider org.hibernate.validator.HibernateValidator not a subtype" error during service discovery
    * [BVAL-345] - List of messages in the standard resource bundle is incomplete
    * [BVAL-346] - Clarify that getters must have no parameter
    * [BVAL-347] - Add implicit assumptions from TCK to spec text
    * [BVAL-351] - Clarify that EntityManager cannot be injected if validating from JPA
    * [BVAL-361] - Expose group conversions via meta-data API
    * [BVAL-363] - Clarify that super method constraints are considered in the validation routine but not constructors
    * [BVAL-366] - Fix typo on ConfigurationState JavaDoc
    * [BVAL-371] - Add package level javadoc (package-info.java)
    * [BVAL-377] - Provide MessageInterpolator.Context#unwrap to allow for custom extensions

** Improvement
    * [BVAL-192] - Add 'exclusive' boolean attribute to @DecimalMin/@DecimalMax constraints
    * [BVAL-332] - Specify semantics of @ConvertGroup when given several times at overridden property
    * [BVAL-340] - Denote method parameter constraints at declaration site (vs. at definition site)
    * [BVAL-352] - Clarify what managed means in the integration chapter in particular for CDI
    * [BVAL-359] - Relax contract of ExecutableDescriptor#getParameterDescriptors()
    * [BVAL-360] - Describe IllegalArgumentException for ExecutableValidator methods
    * [BVAL-364] - Clarify whether or not the metadata API ignore the method enable/disable settings
    * [BVAL-365] - Clarifications around group conversion in hierarchies
    * [BVAL-367] - Make clear whether methods/properties inherited from super types are reflected by the meta-data API
    * [BVAL-373] - Move ConvertGroup to the groups subpackage

** New Feature
    * [BVAL-219] - Add support for interpolating the value in error messages
    * [BVAL-223] - Add formatter syntax for interpolated messages via EL expression support
    * [BVAL-249] - Add unwrap method to ConstraintValidatorContext for provider extension
    * [BVAL-333] - Enable configuration of group conversions via XML

** Task
    * [BVAL-338] - Clarify lifecycle of managed objects created by BV povider
    * [BVAL-348] - Add example for illegal group conversion on a return value in an inheritance hierarchy
    * [BVAL-349] - Mark spec sentences as TCK-relevant (1.0 assertions)
    * [BVAL-353] - Mark spec sentences as TCK-relevant (1.1 assertions)
    * [BVAL-354] - Describe tagging of TCK-relevant sentences in README.md
    * [BVAL-355] - Rename Validator#forMethods() to forExecutables()
    * [BVAL-357] - Clarify that traversable resolver is not used on parameter and return values during method validation
    * [BVAL-358] - Make ExecutableDescriptor#validateConstructorParameters() and validateConstructorReturnValue() more usable
    * [BVAL-374] - Clarify exceptional case in section 5.5.5 bootstrapping
    * [BVAL-376] - Remove @MethodValidated as it is not adding value to the CDI integration


1.1.0.Beta2 (2012-11-27)
------------------------

** Sub-task
    * [BVAL-331] - Establish common super-interface for MethodDescriptor and ConstructorDescriptor

** Bug
    * [BVAL-335] - @ConvertGroup.List is missing target types and retention policy

** Improvement
    * [BVAL-198] - Simplify creation of ConstraintViolationExceptions
    * [BVAL-334] - Refer to CDI provided beans as "built-in" beans


1.1.0.Beta1 (public review draft, 2012-10-19)
---------------------------------------------

** Sub-task
    * [BVAL-232] - Support cross-parameter constraints
    * [BVAL-274] - Extend the meta-data API with required convenience methods for method validation
    * [BVAL-290] - Mark new method with @since annotation
    * [BVAL-300] - Clarify behavior of constructor validation in class hierachies
    * [BVAL-308] - Settle on approach for constraint refinement in sub-types
    * [BVAL-309] - Specify logic to be implemented by method validation interceptors
    * [BVAL-310] - Move methods related to method validation to delegate interface
    * [BVAL-317] - Rename 'method-level validation' with 'method validation'

** Bug
    * [BVAL-296] - Example using ConstraintValidatorContext is incorrect
    * [BVAL-298] - DefaultValidationProviderResolver should check context and current class loader for service file
    * [BVAL-304] - Add OSGi headers in the reference implementation
    * [BVAL-306] - Clarify interceptor order in method validation triggering

** Improvement
    * [BVAL-208] - Support groups translation during cascaded validations
    * [BVAL-226] - Make clear whether the static or the runtime type should be considered when creating property paths in case of cascaded validations
    * [BVAL-230] - Add support for validating CharSequence types instead of just Strings
    * [BVAL-259] - Evaluation of composed constraints should stops on first validation error in case of @ReportAsSingleViolation
    * [BVAL-281] - Improve message when building a ValidatorFactory but no provider is available in the classpath
    * [BVAL-292] - Clarify the behavior of ConfigurationSource methods when no configuration file is present
    * [BVAL-299] - Add note on required Java version

** New Feature
    * [BVAL-272] - Method validation support (II)
    * [BVAL-295] - Should validation-configuration and validation-mapping xsds define a version attribute

** Task
    * [BVAL-280] - Decide whether DefaultValidationProviderResolver should not throw an exception when a specified provider cannot be loaded
    * [BVAL-307] - Decide how CDI and Bean Validation is integrated


1.1.0.Alpha1 (early draft 1, 2012-03-13)
----------------------------------------

** Sub-task
    * [BVAL-242] - Extend the meta-data API to represent method-level constraints
    * [BVAL-243] - Provide a means for specifying method parameter names
    * [BVAL-244] - Extend Validator API with methods for method validation
    * [BVAL-245] - Define how method constraints are declared at parameters and return values

** Bug
    * [BVAL-194] - Invalid license info
    * [BVAL-196] - Missing &lt;/code&gt; element in Javadocs for ConstraintValidatorContext.ConstraintViolationBuilder.NodeContextBuilder
    * [BVAL-212] - Wrong closing &lt;/code&gt; element in javadocs of BeanDescriptor
    * [BVAL-236] - Fails to load META-INF/services provider configuration files on non-ASCII platforms

** Improvement
    * [BVAL-201] - Fix typo in spec, chapter 4.4.3
    * [BVAL-270] - Specify that Bean Validation 1.1 providers must support deployment descriptors version 1.0

** New Feature
    * [BVAL-238] - Support for container injection in ConstraintValidator
    * [BVAL-241] - Support for method validation
    * [BVAL-258] - Clean introduction section to reflect Bean Validation 1.1
    * [BVAL-263] - Add a close() method to ValidatorFactory
    * [BVAL-265] - Expose settings defined in XML in the Configuration API (for ConstraintValidatorFactory, MessageInterpolator etc)

** Task
    * [BVAL-206] - Update pom to use the new distributationManagement information
    * [BVAL-228] - Prepare specification document and Git repository for public eyes
    * [BVAL-279] - Update POM file for Bean Validation API to use latest Git repo urls and generally be ready for a release


1.0.0 final (2009-10-12)
------------------------

** Bug
    * [BVAL-181] - Fix some namespace issues in validation-configuration-1.0.xsd

** Improvement
    * [BVAL-182] - Add getDefaultTraversableResolver and getDefaultConstraintValidatorFactory to Configuration
    * [BVAL-183] - Add getTraversableResolver and getConstraintValidatorFactory to ValidatorFactory
    * [BVAL-184] - Replace Red Hat Middleware LLC to Red Hat, Inc. and/or its affiliates
    * [BVAL-186] - Clarify method names on the constraint violation builder DSL of ConstraintValidatorContext
    * [BVAL-187] - Imply that ConstraintViolation is serializable if entities are serializable

** New Feature
    * [BVAL-185] - Allow overriding of ConstraintValidatorFactory when creating a Validator
    * [BVAL-190] - Add methods to filter ConstraintDescriptor per groups, target and scope

** Task
    * [BVAL-132] - Define behaviour for BeanDescriptor.getConstraintsForProperty(null)


1.0.CR5 (2009-08-27)
--------------------

** Bug
    * [BVAL-173] - Fix typo getUnorderdConstraintDescriptorsMatchingGroups =&gt; getUnorderedConstraintDescriptorsMatchingGroups
    * [BVAL-177] - Payload of composed constraints are ignored, the main constraint payload is propagated
    * [BVAL-178] - Add payload to the XML schema
    * [BVAL-180] - ConstraintDescriptor.getPayload() should return Set&lt;Class&lt;? extends Payload&gt;&gt; not Set&lt;Class&lt;Payload&gt;&gt;

** Improvement
    * [BVAL-174] - clearer default message for assertTrue and assertFalse
    * [BVAL-179] - Rename ConstraintPayload to Payload


1.0.CR4 Unpublished release
---------------------------


1.0.CR3 (Proposed Final Draft 2, 2009-07-08)
--------------------------------------------

** Bug
    * [BVAL-144] - validation-configuration.xsd property element does not extend basic string type preventing Oxygen to be happy
    * [BVAL-159] - Fix example 3.8 on object graph validation

** Improvement
    * [BVAL-143] - Describe path with an object model
    * [BVAL-147] - Support for unbounded wildcards in ConstraintValidator
    * [BVAL-148] - Built-in constraints annotations now annotated with @Constraint(validatedBy={})
    * [BVAL-151] - TraversableResolver#isTraversable can receive null traversableObject when valudateValue is called
    * [BVAL-152] - TraversableResolver should differentiate reachability and cascadability
    * [BVAL-153] - Generify ConstraintValidatorException
    * [BVAL-154] - Iterable is a superclass of all collection, clarify it's interaction with @Valid
    * [BVAL-155] - ignore-annotation is not inherited hierarchically: make that explicit
    * [BVAL-156] - Pattern.Flag takes the JDK flag int at construction time
    * [BVAL-157] - Add [] to non-indexed iterable path
    * [BVAL-158] - Clarify that @Valid is orthogonal to the idea of group
    * [BVAL-160] - rename message template key as [f.q.c.n of the constraint].message
    * [BVAL-162] - Move metadata classes to the metadata package (BeanDescriptor, ElementDescriptor, PropertyDescriptor, ConstraintDescriptor)
    * [BVAL-164] - Validation.byProvider now accept the provider implementation class
    * [BVAL-166] - IllegalArgumentException raised on BeanDescriptor.getConstraintsForProperty and Validator.getConstraintsForClass
    * [BVAL-167] - Recommend f.q.c.n.message for resource bundle keys and migrate examples
    * [BVAL-169] - Rename ElementDescriptor.getType to getElementClass
    * [BVAL-170] - Let built-in annotations to support ElementType.PARAMETER and ElementType.CONSTRUCTOR

** New Feature
    * [BVAL-149] - Provide access to the ValidationProviderResolver via BootstrapState
    * [BVAL-150] - Add ConstraintViolation.getRootBeanClass
    * [BVAL-161] - Add unwrap methods to ValidatorFactory and Validator
    * [BVAL-163] - Add support for constraint payload
    * [BVAL-168] - Return the list of matching ConstraintDescriptor for a given set of groups
    * [BVAL-172] - Provide ConstraintDescriptor#getPayload


1.0.CR2 Unpublished release
---------------------------


1.0.CR1 (Proposed Final Draft, 2009-03-16)
------------------------------------------

** Bug
    * [BVAL-118] - ConstraintDescriptor.getGroups() returns Default if no group is declared on the constraint
    * [BVAL-125] - @Size.min default value should be 0

** Improvement
    * [BVAL-32] - Describe what is happening when a composition is not consistent
    * [BVAL-50] - Be consistent in the spec, use @author or not
    * [BVAL-54] - Specify that constraints on non getter methods are ignored (if BVAL-36 is not accepted)
    * [BVAL-72] - Validating an object multiple times if in a different branch of the graph
    * [BVAL-86] - Default TraversableResolver is JPA aware
    * [BVAL-88] - Improvement on MessageInterpolator
    * [BVAL-91] - Rename Constraint related classes to improve readability
    * [BVAL-95] - @Size should support Map
    * [BVAL-96] - Support byte in @Min/@Max
    * [BVAL-106] - Constraintdescriptor.getConstraintValidatorClasses() should return a List, not an array
    * [BVAL-114] - Relax property names in ConstraintValidatorContext
    * [BVAL-120] - Rename ConstraintViolation getRawMessage=&gt;getMessageTemplate, getInterpolatedMessage=&gt;getMessage
    * [BVAL-122] - Rename @GroupSequence.sequence to @GroupSequence.value
    * [BVAL-126] - Define group sequence logic more formally and eliminate corner cases
    * [BVAL-129] - Clarify ConstraintValidatorContext propertyPath generation
    * [BVAL-130] - Make ConstraintDescriptor generic: ConstraintDescriptor&lt;T extends Annotation&gt;
    * [BVAL-131] - Provide object graph navigation determinism
    * [BVAL-134] - @Valid accepts objects implementing Iterable
    * [BVAL-135] - Remove DefaultValidationProviderResolver from the public API
    * [BVAL-136] - Add Context object for MessageInterpolator
    * [BVAL-137] - prefix for message template key is constraint. instead of validator.
    * [BVAL-138] - Rename OverridesParameter to OverridesAttribute
    * [BVAL-139] - Remove @OverridesParameters and use the inner class mode (OverridesAttribute.LIst)
    * [BVAL-140] - BeanDescriptor.getConstrainedProperties() returns Set&lt;PropertyDescriptor&gt;
    * [BVAL-141] - Rename ConstraintDescriptor.getParameters() to getAttributes()

** New Feature
    * [BVAL-52] - Define the exception hierarchy and rules
    * [BVAL-55] - Exception policy
    * [BVAL-65] - Additional built-in constraints
    * [BVAL-98] - Type-safe ConstraintValidator
    * [BVAL-100] - Support XML mapping overriding
    * [BVAL-102] - Support META-INF/validation.xml
    * [BVAL-119] - Introduce @Pattern for regexp
    * [BVAL-121] - Define built-in constraints plural forms
    * [BVAL-123] - Add ConstraintViolationException
    * [BVAL-124] - Introduce backslash as escaping character
    * [BVAL-142] - @Min/@max no longer accept float/double and introduce @DecimalMin/@DecimalMax

** Task
    * [BVAL-24] - What should be done when multiple META-INF/validation.xml are found?
    * [BVAL-117] - Specify behaviour of ConstraintValidator.initalize in the case of inconsistent values in constraint parameters
    * [BVAL-127] - Remove ConstraintViolation.getGroups()
    * [BVAL-128] - Clarify invalid cases for validateProperty / validateValue on proeprtyName being empty or null
    * [BVAL-133] - Remove JPA and JSF integration proposals


1.0.Beta2 (Public Draft, 2008-12-15)
------------------------------------

** Bug
    * [BVAL-6] - Wrong example in validation methods section
    * [BVAL-17] - Validator&lt;A&gt;.validate(b) where b:B and B extends A should validate B. Metadata APIs are specific to A
    * [BVAL-42] - Names of message keys in spec inconsistent
    * [BVAL-45] - Typo at ConstraintDescriptor.getContstraintClass()

** Improvement
    * [BVAL-29] - Types should be determined at runtime
    * [BVAL-33] - Should ConstraintDescriptor.getConstraintImplementation() replaced by .getConstraintImplementationClass()?
    * [BVAL-40] - Rename InvalidConstraint to ConstraintViolation
    * [BVAL-48] - Add a way to access the default message resolver
    * [BVAL-49] - Mark metadata classes as immutable
    * [BVAL-59] - Rethink the group sequence inheritance rules
    * [BVAL-60] - ConstraintViolation points to the corresponding ConstraintDescriptor
    * [BVAL-68] - Specify that static methods and fields are not validated
    * [BVAL-73] - Rename ConstraintViolation.getBeanClass() to CV. getRootClass() or simply remove it
    * [BVAL-78] - Forbid a Validation implementation to modify the state of the object being validated

** New Feature
    * [BVAL-30] - Define validation Context to be passed to constraint implementation calls
    * [BVAL-36] - Validation of method parameters and returned values
    * [BVAL-67] - Allow MessageResolver to be Localizable
    * [BVAL-71] - Should we have group aggregation?
    * [BVAL-76] - Expose the raw message to ConstraintViolation
    * [BVAL-79] - Groups are now Type based rather than String based
    * [BVAL-81] - Provide a TraversableResolver contract

** Task
    * [BVAL-1] - Remove references to 'beancheck' in the spec
    * [BVAL-3] - Replace array return types with Sets
    * [BVAL-4] - Return value for @NotEmpty for null values
    * [BVAL-5] - Change order of exmaple classes in Book/Author example
    * [BVAL-7] - Use of example in ConstraintFactory section (2.4)
    * [BVAL-8] - StandardConstraint description (2.5)
    * [BVAL-23] - Make Validator&lt;T&gt; thread-safe</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.0.0.Alpha<span class="rcl-da">2</span><span class="rcl-dd">1 </span> (Early Draft <span class="rcl-da">2</span><span class="rcl-dd">1</span>)<br>
Last updated <span class="rcl-da">2017-03-22</span> <span class="rcl-da">11:12:29</span><span class="rcl-dd">2017-02-06 </span><span class="rcl-dd">11:05:17 </span> +01:00
</div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24703879-1', 'auto');
  ga('send', 'pageview');
</script>





</body></html>
